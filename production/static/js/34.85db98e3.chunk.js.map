{"version":3,"sources":["assets/img/empty-state-table.svg","views/widgets/Charts/AggregatesBarChart/index.jsx","views/widgets/Charts/AggregatesBarChart/styles.jsx"],"names":["module","exports","defaults","global","legend","display","AggregatesBarChart","props","state","loading","load_error","aggregate","aggregates","chart_data","labels","datasets","data","aggregateMenuEl","aggregatables","colors","handleShowAggregateMenu","event","currentTarget","setState","handleAggregateMenuItemClick","column","loadAggregates","g","bind","handleCloseAggregateMenu","this","prepareForData","prepareChartData","prevProps","Object","areEqual","defination","api","Array","isArray","cache","equals","dynamic","monochrome","color","service","onResolveAggregates","entries","scope","columns","properties","possibilities","push","name","label","length","no_of_colors","monochrome_colors","UtilitiesHelper","monochromeColorScheme","rotation_colors","rotationColorScheme","auth","onLoadAggregates","user","error","chart_data_labels","chart_data_data","onload_callback_data","i","_id","count","backgroundColor","query_data","apiCallRequest","new_aggregate","group","uri","endpoint","type","params","classes","className","showTitle","showMenu","GridContainer","GridItem","xs","Typography","variant","fullWidth","center","Button","aria-controls","aria-haspopup","onClick","size","aria-label","simple","Menu","id","anchorEl","keepMounted","open","Boolean","onClose","map","aggregatable","index","MenuItem","key","options","maintainAspectRatio","scales","yAxes","ticks","beginAtZero","justify","alignItems","alt","emptyImage","src","EmptyStateImage","emptyText","complete","msg","React","Component","defaultProps","hex","accent","compose","withStyles","theme","root","padding","data_actions_wrapper","whiteSpace","valueChip","margin","spacing","maxWidth","width","marginTop","connect","ownProps","withErrorHandler"],"mappings":"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","file":"static/js/34.85db98e3.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/empty-state-table.cdb06dd9.svg\";","/** @format */\n\nimport { Menu, MenuItem } from \"@material-ui/core\";\n//\nimport withStyles from \"@material-ui/core/styles/withStyles\";\nimport { MoreVert as AggregateMenuIcon } from \"@material-ui/icons\";\nimport EmptyStateImage from \"assets/img/empty-state-table.svg\";\nimport { colors } from \"assets/jss/app-theme\";\nimport Button from \"components/Button\";\nimport GridContainer from \"components/Grid/GridContainer\";\nimport GridItem from \"components/Grid/GridItem\";\nimport Typography from \"components/Typography\";\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\nimport { defaults, Bar } from \"react-chartjs-2\";\nimport { connect } from \"react-redux\";\nimport compose from \"recompose/compose\";\nimport { apiCallRequest } from \"state/actions\";\nimport { withErrorHandler } from \"hoc/ErrorHandler\";\n//\nimport { UtilitiesHelper } from \"hoc/Helpers\";\nimport styles from \"./styles\";\n\n//\ndefaults.global.legend.display = false;\n\nclass AggregatesBarChart extends React.Component {\n\tstate = {\n\t\tloading: true,\n\t\tload_error: false,\n\t\taggregate: \"status\",\n\t\taggregates: [],\n\t\tchart_data: {\n\t\t\tlabels: [],\n\t\t\tdatasets: [\n\t\t\t\t{\n\t\t\t\t\tdata: [],\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\taggregateMenuEl: null,\n\t};\n\taggregatables = [];\n\tcolors = [];\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.handleShowAggregateMenu = this.handleShowAggregateMenu.bind(this);\n\t\tthis.handleCloseAggregateMenu = this.handleCloseAggregateMenu.bind(\n\t\t\tthis\n\t\t);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.prepareForData();\n\t\tthis.loadAggregates();\n\t\tthis.prepareChartData();\n\t}\n\n\tcomponentDidUpdate(prevProps) {\n\t\tif (!Object.areEqual(this.props.defination, prevProps.defination)) {\n\t\t\tthis.prepareForData();\n\t\t\tthis.loadAggregates();\n\t\t} else if (!Object.areEqual(prevProps.api, this.props.api)) {\n\t\t\tthis.prepareChartData();\n\t\t} else if (Array.isArray(this.props.cache)) {\n\t\t\tif (!this.props.cache.equals(prevProps.cache)) {\n\t\t\t\tthis.prepareChartData();\n\t\t\t}\n\t\t} else if (Array.isArray(prevProps.cache)) {\n\t\t\tif (!prevProps.cache.equals(this.props.cache)) {\n\t\t\t\tthis.prepareChartData();\n\t\t\t}\n\t\t}\n\t}\n\n\tprepareForData() {\n\t\tlet {\n\t\t\tdynamic,\n\t\t\tmonochrome,\n\t\t\tcolor,\n\t\t\tcolors,\n\t\t\tdefination,\n\t\t\tservice,\n\t\t\taggregate,\n\t\t\tonResolveAggregates,\n\t\t} = this.props;\n\n\t\tif (dynamic) {\n\t\t\tthis.aggregatables = [];\n\t\t\tfor (let [column, properties] of Object.entries(\n\t\t\t\tdefination.scope.columns\n\t\t\t)) {\n\t\t\t\tif (properties.possibilities) {\n\t\t\t\t\tthis.aggregatables.push({\n\t\t\t\t\t\tname: column,\n\t\t\t\t\t\tlabel: properties.label,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!aggregate && this.aggregatables.length > 0) {\n\t\t\taggregate = this.aggregatables[0].name;\n\t\t\tif (onResolveAggregates) {\n\t\t\t\tonResolveAggregates(defination.name, this.aggregatables);\n\t\t\t}\n\t\t}\n\n\t\tif (dynamic) {\n\t\t\tthis.state.aggregate = aggregate;\n\n\t\t\t//generate color scheme if monochromatic\n\t\t\tif (monochrome) {\n\t\t\t\tlet no_of_colors =\n\t\t\t\t\tthis.aggregatables.length > 0\n\t\t\t\t\t\t? this.aggregatables.length\n\t\t\t\t\t\t: 1;\n\t\t\t\tlet monochrome_colors = UtilitiesHelper.monochromeColorScheme(\n\t\t\t\t\tcolor,\n\t\t\t\t\tno_of_colors\n\t\t\t\t);\n\t\t\t\tthis.colors = monochrome_colors;\n\t\t\t} else if (colors) {\n\t\t\t\tthis.colors = colors;\n\t\t\t} else {\n\t\t\t\tlet no_of_colors =\n\t\t\t\t\tthis.aggregatables.length > 0\n\t\t\t\t\t\t? this.aggregatables.length\n\t\t\t\t\t\t: 1;\n\t\t\t\tlet rotation_colors = UtilitiesHelper.rotationColorScheme(\n\t\t\t\t\tcolor,\n\t\t\t\t\tno_of_colors\n\t\t\t\t);\n\t\t\t\tthis.colors = rotation_colors;\n\t\t\t}\n\t\t}\n\t}\n\n\tprepareChartData() {\n\t\tconst {\n\t\t\tmonochrome,\n\t\t\tcolor,\n\t\t\tcolors,\n\t\t\taggregate,\n\t\t\tdefination,\n\t\t\tservice,\n\t\t\tauth,\n\t\t\tonLoadAggregates,\n\t\t\tcache,\n\t\t\tapi,\n\t\t} = this.props;\n\t\tif (Array.isArray(cache)) {\n\t\t\tlet possibilities = defination.scope.columns[this.state.aggregate]\n\t\t\t\t? defination.scope.columns[this.state.aggregate].possibilities\n\t\t\t\t: {};\n\t\t\tif (typeof possibilities === \"function\") {\n\t\t\t\tpossibilities = possibilities(false, auth.user);\n\t\t\t}\n\t\t\t//generate color scheme if monochromatic\n\t\t\tif (monochrome) {\n\t\t\t\tlet no_of_colors = cache.length > 0 ? cache.length : 1;\n\t\t\t\tlet monochrome_colors = UtilitiesHelper.monochromeColorScheme(\n\t\t\t\t\tapi.loading || api.error ? \"#595959\" : color,\n\t\t\t\t\tno_of_colors\n\t\t\t\t);\n\t\t\t\tthis.colors = monochrome_colors;\n\t\t\t} else if (colors) {\n\t\t\t\tthis.colors =\n\t\t\t\t\tapi.loading || api.error\n\t\t\t\t\t\t? UtilitiesHelper.monochromeColorScheme(\"#595959\")\n\t\t\t\t\t\t: colors;\n\t\t\t} else {\n\t\t\t\tlet no_of_colors = cache.length > 0 ? cache.length : 1;\n\t\t\t\tlet rotation_colors = UtilitiesHelper.rotationColorScheme(\n\t\t\t\t\tapi.loading || api.error ? \"#595959\" : color,\n\t\t\t\t\tno_of_colors\n\t\t\t\t);\n\t\t\t\tthis.colors = rotation_colors;\n\t\t\t}\n\n\t\t\tlet chart_data_labels = [];\n\t\t\tlet chart_data_data = [];\n\t\t\tlet onload_callback_data = [];\n\n\t\t\tif (typeof possibilities === \"object\") {\n\t\t\t\tfor (var i = 0; i < cache.length; i++) {\n\t\t\t\t\tif (cache[i]._id in possibilities) {\n\t\t\t\t\t\tchart_data_labels.push(possibilities[cache[i]._id]);\n\t\t\t\t\t\tchart_data_data.push(cache[i].count);\n\t\t\t\t\t\tif (onLoadAggregates) {\n\t\t\t\t\t\t\tonload_callback_data.push({\n\t\t\t\t\t\t\t\tname: cache[i]._id,\n\t\t\t\t\t\t\t\tlabel: possibilities[cache[i]._id],\n\t\t\t\t\t\t\t\tcount: cache[i].count,\n\t\t\t\t\t\t\t\tcolor: this.colors[i],\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet chart_data = {\n\t\t\t\tlabels: chart_data_labels,\n\t\t\t\tdatasets: [\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: chart_data_data,\n\t\t\t\t\t\tbackgroundColor: this.colors,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t};\n\n\t\t\tthis.setState(state => ({\n\t\t\t\taggregates: cache,\n\t\t\t\tchart_data: chart_data,\n\t\t\t\tloading: false,\n\t\t\t}));\n\t\t\tif (onLoadAggregates) {\n\t\t\t\tonLoadAggregates(onload_callback_data);\n\t\t\t}\n\t\t} else {\n\t\t\tlet chart_data_labels = [];\n\t\t\tlet chart_data_data = [];\n\t\t\tlet onload_callback_data = [];\n\n\t\t\tlet chart_data = {\n\t\t\t\tlabels: chart_data_labels,\n\t\t\t\tdatasets: [\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: chart_data_data,\n\t\t\t\t\t\tbackgroundColor: this.colors,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t};\n\n\t\t\tthis.setState(state => ({\n\t\t\t\taggregates: cache,\n\t\t\t\tchart_data: chart_data,\n\t\t\t\tloading: false,\n\t\t\t}));\n\t\t\tif (onLoadAggregates) {\n\t\t\t\tonLoadAggregates(onload_callback_data);\n\t\t\t}\n\t\t}\n\t}\n\n\tloadAggregates(query_data) {\n\t\tconst { apiCallRequest, defination } = this.props;\n\n\t\tif (!query_data) {\n\t\t\tquery_data = { g: this.state.aggregate };\n\t\t}\n\n\t\tlet new_aggregate =\n\t\t\t\"g\" in query_data\n\t\t\t\t? query_data.g\n\t\t\t\t: \"group\" in query_data\n\t\t\t\t? query_data.group\n\t\t\t\t: false;\n\t\tthis.setState(state => ({ aggregate: new_aggregate }));\n\n\t\tif (defination) {\n\t\t\tapiCallRequest(\n\t\t\t\tdefination.name + \"_aggregates\",\n\t\t\t\t{\n\t\t\t\t\turi: defination.endpoint,\n\t\t\t\t\ttype: \"aggregates\",\n\t\t\t\t\tparams: query_data,\n\t\t\t\t\tdata: {},\n\t\t\t\t\tcache: true,\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t}\n\n\thandleShowAggregateMenu = event => {\n\t\tlet aggregateMenuEl = event.currentTarget;\n\t\tthis.setState({ aggregateMenuEl: aggregateMenuEl });\n\t};\n\n\thandleCloseAggregateMenu() {\n\t\tthis.setState({ aggregateMenuEl: null });\n\t}\n\n\thandleAggregateMenuItemClick = column => event => {\n\t\t//this.handleCloseAggregateMenu();\n\t\tthis.setState({ aggregateMenuEl: null });\n\t\tthis.loadAggregates({ g: column });\n\t};\n\n\trender() {\n\t\tconst {\n\t\t\tclasses,\n\t\t\tclassName,\n\t\t\taggregate,\n\t\t\tdynamic,\n\t\t\tdefination,\n\t\t\tservice,\n\t\t\tshowTitle,\n\t\t\tshowMenu,\n\t\t\tapi,\n\t\t\tcache,\n\t\t} = this.props;\n\t\treturn (\n\t\t\t<GridContainer className={className + \" p-0 m-0\"}>\n\t\t\t\t<GridItem xs={12} className=\"p-0 m-0\">\n\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t{(showMenu || showTitle) && (\n\t\t\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t\t\t<GridContainer>\n\t\t\t\t\t\t\t\t\t\t{showTitle && !showMenu && (\n\t\t\t\t\t\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"body1\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\t\t\t\t\tcenter\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{defination.scope.columns[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state.aggregate\n\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? defination.scope\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.columns[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.aggregate\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  ].label\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"Unknown\"}{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\tAggregate\n\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t\t\t{dynamic && showMenu && (\n\t\t\t\t\t\t\t\t\t\t\t<GridItem\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"p-0 m-0\"\n\t\t\t\t\t\t\t\t\t\t\t\txs={12}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\taria-controls=\"aggregate-menu\"\n\t\t\t\t\t\t\t\t\t\t\t\t\taria-haspopup=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.handleShowAggregateMenu\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"float-right\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"md\"\n\t\t\t\t\t\t\t\t\t\t\t\t\taria-label=\"Aggregate Menu\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tsimple\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{defination.scope.columns[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state.aggregate\n\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? defination.scope\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.columns[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.aggregate\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  ].label\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"Unknown\"}{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\tAggregate\n\t\t\t\t\t\t\t\t\t\t\t\t\t<AggregateMenuIcon />\n\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t\t<Menu\n\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"surveys-aggregate-menu\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tanchorEl={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.aggregateMenuEl\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\tkeepMounted\n\t\t\t\t\t\t\t\t\t\t\t\t\topen={Boolean(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.aggregateMenuEl\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClose={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.handleCloseAggregateMenu\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{this.aggregatables.map(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taggregatable,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tindex\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={this.handleAggregateMenuItemClick(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taggregatable.name\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"aggregate_\" +\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taggregatable.name\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{aggregatable.label +\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\" Aggregate\"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t</Menu>\n\t\t\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t<GridItem className=\"p-0 m-0\" xs={12}>\n\t\t\t\t\t\t\t\t{Array.isArray(this.state.chart_data.labels) &&\n\t\t\t\t\t\t\t\tthis.state.chart_data.labels.length > 0 ? (\n\t\t\t\t\t\t\t\t\t<Bar \n\t\t\t\t\t\t\t\t\t\tdata={this.state.chart_data} \n\t\t\t\t\t\t\t\t\t\toptions={{\n\t\t\t\t\t\t\t\t\t\t\tmaintainAspectRatio: false,\n\t\t\t\t\t\t\t\t\t\t\tscales: {\n\t\t\t\t\t\t\t\t\t\t\t\tyAxes: [{\n\t\t\t\t\t\t\t\t\t\t\t\t\tticks: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tbeginAtZero: true\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}]\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<GridContainer\n\t\t\t\t\t\t\t\t\t\tclassName=\"p-0 m-0\"\n\t\t\t\t\t\t\t\t\t\tjustify=\"center\"\n\t\t\t\t\t\t\t\t\t\talignItems=\"center\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\talt=\"Empty Aggregates\"\n\t\t\t\t\t\t\t\t\t\t\tclassName={classes.emptyImage}\n\t\t\t\t\t\t\t\t\t\t\tsrc={EmptyStateImage}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\t\t\tclassName={classes.emptyText}\n\t\t\t\t\t\t\t\t\t\t\tcolor=\"grey\"\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"body2\"\n\t\t\t\t\t\t\t\t\t\t\tcenter\n\t\t\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\tNo{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t{defination.scope.columns[\n\t\t\t\t\t\t\t\t\t\t\t\tthis.state.aggregate\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t? defination.scope.columns[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state.aggregate\n\t\t\t\t\t\t\t\t\t\t\t\t  ].label\n\t\t\t\t\t\t\t\t\t\t\t\t: \"\"}{\" \"}\n\t\t\t\t\t\t\t\t\t\t\tAggregates\n\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t</GridContainer>\n\n\t\t\t\t\t\t{api.complete && api.error && (\n\t\t\t\t\t\t\t<GridContainer>\n\t\t\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\t\tcolor=\"error\"\n\t\t\t\t\t\t\t\t\t\tvariant=\"body2\"\n\t\t\t\t\t\t\t\t\t\tcenter\n\t\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{\"An error occured. \\n \" +\n\t\t\t\t\t\t\t\t\t\t\tapi.error.msg}\n\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</GridContainer>\n\t\t\t\t</GridItem>\n\t\t\t</GridContainer>\n\t\t);\n\t}\n}\n\nAggregatesBarChart.propTypes = {\n\tclassName: PropTypes.string,\n\tclasses: PropTypes.object.isRequired,\n\tdynamic: PropTypes.bool,\n\tshowTitle: PropTypes.bool,\n\tshowMenu: PropTypes.bool,\n\tmonochrome: PropTypes.bool,\n\tcolor: PropTypes.string,\n\tcolors: PropTypes.array,\n\tdefination: PropTypes.object.isRequired,\n\tservice: PropTypes.any.isRequired,\n\taggregate: PropTypes.string,\n\tonResolveAggregates: PropTypes.func,\n\tonLoadAggregates: PropTypes.func,\n};\n\nAggregatesBarChart.defaultProps = {\n\t//colors: [colors.hex.accent, colors.hex.primary, colors.hex.secondary, colors.hex.primarydark, colors.hex.default],\n\tcolor: colors.hex.accent,\n\tmonochrome: true,\n};\n\nconst mapStateToProps = (state, ownProps) => {\n\tconst { defination } = ownProps;\n\treturn {\n\t\tauth: state.auth,\n\t\tcache: defination\n\t\t\t? state.cache.data[defination.name + \"_aggregates\"]\n\t\t\t: null,\n\t\tapi: defination\n\t\t\t? state.api[defination.name]\n\t\t\t\t? state.api[defination.name]\n\t\t\t\t: {}\n\t\t\t: {},\n\t};\n};\n\nexport default compose(\n\twithStyles(styles),\n\tconnect(mapStateToProps, { apiCallRequest }),\n\twithErrorHandler\n)(AggregatesBarChart);\n","/** @format */\n\nexport default theme => ({\n\troot: {\n\t\tpadding: \"0\",\n\t},\n\tdata_actions_wrapper: {\n\t\tdisplay: \"inline-block\",\n\t\twhiteSpace: \"nowrap\",\n\t\t\"& > *\": {\n\t\t\tdisplay: \"inline-block\",\n\t\t\twhiteSpace: \"nowrap\",\n\t\t},\n\t},\n\tvalueChip: {\n\t\tmargin: theme.spacing(0.5),\n\t},\n\temptyImage: {\n\t\tmaxWidth: 100,\n\t\twidth: \"70%\",\n\t\tmargin: theme.spacing(2),\n\t},\n\temptyText: {\n\t\tmarginTop: theme.spacing(3),\n\t},\n});\n"],"sourceRoot":""}