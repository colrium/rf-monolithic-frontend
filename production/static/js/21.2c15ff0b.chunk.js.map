{"version":3,"sources":["../node_modules/@material-ui/icons/esm/MoreVert.js","views/widgets/Charts/AggregatesBarChart/index.jsx","views/widgets/Charts/AggregatesBarChart/styles.jsx"],"names":["createSvgIcon","React","createElement","d","defaults","global","legend","display","AggregatesBarChart","props","state","loading","load_error","aggregate","aggregates","chart_data","labels","datasets","data","aggregateMenuEl","aggregatables","colors","handleShowAggregateMenu","event","currentTarget","setState","handleAggregateMenuItemClick","column","loadAggregates","g","bind","handleCloseAggregateMenu","this","prepareForData","prepareChartData","prevProps","Object","areEqual","defination","api","Array","isArray","cache","equals","dynamic","monochrome","color","service","onResolveAggregates","JSON","isEmpty","entries","scope","columns","properties","possibilities","push","name","label","length","no_of_colors","monochrome_colors","UtilitiesHelper","monochromeColorScheme","rotation_colors","rotationColorScheme","auth","onLoadAggregates","user","error","chart_data_labels","chart_data_data","onload_callback_data","i","_id","count","backgroundColor","query_data","apiCallRequest","new_aggregate","group","uri","endpoint","type","params","classes","className","showTitle","showMenu","GridContainer","GridItem","xs","Typography","variant","fullWidth","center","Button","aria-controls","aria-haspopup","onClick","size","aria-label","simple","Menu","id","anchorEl","keepMounted","open","Boolean","onClose","map","aggregatable","index","MenuItem","key","options","maintainAspectRatio","scales","yAxes","ticks","beginAtZero","justify","alignItems","alt","emptyImage","src","EmptyStateImage","emptyText","complete","msg","Component","defaultProps","hex","accent","compose","withStyles","theme","root","padding","data_actions_wrapper","whiteSpace","valueChip","margin","spacing","maxWidth","width","marginTop","connect","ownProps","withErrorHandler"],"mappings":"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","file":"static/js/21.2c15ff0b.chunk.js","sourcesContent":["import React from 'react';\nimport createSvgIcon from './utils/createSvgIcon';\nexport default createSvgIcon(React.createElement(\"path\", {\n  d: \"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z\"\n}), 'MoreVert');","/** @format */\r\n\r\nimport { Menu, MenuItem } from \"@material-ui/core\";\r\n//\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport { MoreVert as AggregateMenuIcon } from \"@material-ui/icons\";\r\nimport EmptyStateImage from \"assets/img/empty-state-table.svg\";\r\nimport { colors } from \"assets/jss/app-theme\";\r\nimport Button from \"components/Button\";\r\nimport GridContainer from \"components/Grid/GridContainer\";\r\nimport GridItem from \"components/Grid/GridItem\";\r\nimport Typography from \"components/Typography\";\r\nimport PropTypes from \"prop-types\";\r\nimport React from \"react\";\r\nimport { defaults, Bar } from \"react-chartjs-2\";\r\nimport { connect } from \"react-redux\";\r\nimport compose from \"recompose/compose\";\r\nimport { apiCallRequest } from \"state/actions\";\r\nimport { withErrorHandler } from \"hoc/ErrorHandler\";\r\n//\r\nimport { UtilitiesHelper } from \"hoc/Helpers\";\r\nimport styles from \"./styles\";\r\n\r\n//\r\ndefaults.global.legend.display = false;\r\n\r\nclass AggregatesBarChart extends React.Component {\r\n\tstate = {\r\n\t\tloading: true,\r\n\t\tload_error: false,\r\n\t\taggregate: \"status\",\r\n\t\taggregates: [],\r\n\t\tchart_data: {\r\n\t\t\tlabels: [],\r\n\t\t\tdatasets: [\r\n\t\t\t\t{\r\n\t\t\t\t\tdata: [],\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t},\r\n\t\taggregateMenuEl: null,\r\n\t};\r\n\taggregatables = [];\r\n\tcolors = [];\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.handleShowAggregateMenu = this.handleShowAggregateMenu.bind(this);\r\n\t\tthis.handleCloseAggregateMenu = this.handleCloseAggregateMenu.bind(\r\n\t\t\tthis\r\n\t\t);\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.prepareForData();\r\n\t\tthis.loadAggregates();\r\n\t\tthis.prepareChartData();\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps) {\r\n\t\tif (!Object.areEqual(this.props.defination, prevProps.defination)) {\r\n\t\t\tthis.prepareForData();\r\n\t\t\tthis.loadAggregates();\r\n\t\t} else if (!Object.areEqual(prevProps.api, this.props.api)) {\r\n\t\t\tthis.prepareChartData();\r\n\t\t} else if (Array.isArray(this.props.cache)) {\r\n\t\t\tif (!this.props.cache.equals(prevProps.cache)) {\r\n\t\t\t\tthis.prepareChartData();\r\n\t\t\t}\r\n\t\t} else if (Array.isArray(prevProps.cache)) {\r\n\t\t\tif (!prevProps.cache.equals(this.props.cache)) {\r\n\t\t\t\tthis.prepareChartData();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprepareForData() {\r\n\t\tlet {\r\n\t\t\tdynamic,\r\n\t\t\tmonochrome,\r\n\t\t\tcolor,\r\n\t\t\tcolors,\r\n\t\t\tdefination,\r\n\t\t\tservice,\r\n\t\t\taggregate,\r\n\t\t\tonResolveAggregates,\r\n\t\t} = this.props;\r\n\r\n\t\tif (dynamic && !JSON.isEmpty(defination)) {\r\n\t\t\tthis.aggregatables = [];\r\n\t\t\tfor (let [column, properties] of Object.entries(\r\n\t\t\t\tdefination.scope.columns\r\n\t\t\t)) {\r\n\t\t\t\tif (properties.possibilities) {\r\n\t\t\t\t\tthis.aggregatables.push({\r\n\t\t\t\t\t\tname: column,\r\n\t\t\t\t\t\tlabel: properties.label,\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!aggregate && this.aggregatables.length > 0) {\r\n\t\t\taggregate = this.aggregatables[0].name;\r\n\t\t\tif (onResolveAggregates) {\r\n\t\t\t\tonResolveAggregates(defination.name, this.aggregatables);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (dynamic) {\r\n\t\t\tthis.state.aggregate = aggregate;\r\n\r\n\t\t\t//generate color scheme if monochromatic\r\n\t\t\tif (monochrome) {\r\n\t\t\t\tlet no_of_colors =\r\n\t\t\t\t\tthis.aggregatables.length > 0\r\n\t\t\t\t\t\t? this.aggregatables.length\r\n\t\t\t\t\t\t: 1;\r\n\t\t\t\tlet monochrome_colors = UtilitiesHelper.monochromeColorScheme(\r\n\t\t\t\t\tcolor,\r\n\t\t\t\t\tno_of_colors\r\n\t\t\t\t);\r\n\t\t\t\tthis.colors = monochrome_colors;\r\n\t\t\t} else if (colors) {\r\n\t\t\t\tthis.colors = colors;\r\n\t\t\t} else {\r\n\t\t\t\tlet no_of_colors =\r\n\t\t\t\t\tthis.aggregatables.length > 0\r\n\t\t\t\t\t\t? this.aggregatables.length\r\n\t\t\t\t\t\t: 1;\r\n\t\t\t\tlet rotation_colors = UtilitiesHelper.rotationColorScheme(\r\n\t\t\t\t\tcolor,\r\n\t\t\t\t\tno_of_colors\r\n\t\t\t\t);\r\n\t\t\t\tthis.colors = rotation_colors;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprepareChartData() {\r\n\t\tconst {\r\n\t\t\tmonochrome,\r\n\t\t\tcolor,\r\n\t\t\tcolors,\r\n\t\t\taggregate,\r\n\t\t\tdefination,\r\n\t\t\tservice,\r\n\t\t\tauth,\r\n\t\t\tonLoadAggregates,\r\n\t\t\tcache,\r\n\t\t\tapi,\r\n\t\t} = this.props;\r\n\t\tif (Array.isArray(cache)) {\r\n\t\t\tlet possibilities = defination.scope.columns[this.state.aggregate]\r\n\t\t\t\t? defination.scope.columns[this.state.aggregate].possibilities\r\n\t\t\t\t: {};\r\n\t\t\tif (typeof possibilities === \"function\") {\r\n\t\t\t\tpossibilities = possibilities(false, auth.user);\r\n\t\t\t}\r\n\t\t\t//generate color scheme if monochromatic\r\n\t\t\tif (monochrome) {\r\n\t\t\t\tlet no_of_colors = cache.length > 0 ? cache.length : 1;\r\n\t\t\t\tlet monochrome_colors = UtilitiesHelper.monochromeColorScheme(\r\n\t\t\t\t\tapi.loading || api.error ? \"#595959\" : color,\r\n\t\t\t\t\tno_of_colors\r\n\t\t\t\t);\r\n\t\t\t\tthis.colors = monochrome_colors;\r\n\t\t\t} else if (colors) {\r\n\t\t\t\tthis.colors =\r\n\t\t\t\t\tapi.loading || api.error\r\n\t\t\t\t\t\t? UtilitiesHelper.monochromeColorScheme(\"#595959\")\r\n\t\t\t\t\t\t: colors;\r\n\t\t\t} else {\r\n\t\t\t\tlet no_of_colors = cache.length > 0 ? cache.length : 1;\r\n\t\t\t\tlet rotation_colors = UtilitiesHelper.rotationColorScheme(\r\n\t\t\t\t\tapi.loading || api.error ? \"#595959\" : color,\r\n\t\t\t\t\tno_of_colors\r\n\t\t\t\t);\r\n\t\t\t\tthis.colors = rotation_colors;\r\n\t\t\t}\r\n\r\n\t\t\tlet chart_data_labels = [];\r\n\t\t\tlet chart_data_data = [];\r\n\t\t\tlet onload_callback_data = [];\r\n\r\n\t\t\tif (typeof possibilities === \"object\") {\r\n\t\t\t\tfor (var i = 0; i < cache.length; i++) {\r\n\t\t\t\t\tif (cache[i]._id in possibilities) {\r\n\t\t\t\t\t\tchart_data_labels.push(possibilities[cache[i]._id]);\r\n\t\t\t\t\t\tchart_data_data.push(cache[i].count);\r\n\t\t\t\t\t\tif (onLoadAggregates) {\r\n\t\t\t\t\t\t\tonload_callback_data.push({\r\n\t\t\t\t\t\t\t\tname: cache[i]._id,\r\n\t\t\t\t\t\t\t\tlabel: possibilities[cache[i]._id],\r\n\t\t\t\t\t\t\t\tcount: cache[i].count,\r\n\t\t\t\t\t\t\t\tcolor: this.colors[i],\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tlet chart_data = {\r\n\t\t\t\tlabels: chart_data_labels,\r\n\t\t\t\tdatasets: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdata: chart_data_data,\r\n\t\t\t\t\t\tbackgroundColor: this.colors,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t};\r\n\r\n\t\t\tthis.setState(state => ({\r\n\t\t\t\taggregates: cache,\r\n\t\t\t\tchart_data: chart_data,\r\n\t\t\t\tloading: false,\r\n\t\t\t}));\r\n\t\t\tif (onLoadAggregates) {\r\n\t\t\t\tonLoadAggregates(onload_callback_data);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tlet chart_data_labels = [];\r\n\t\t\tlet chart_data_data = [];\r\n\t\t\tlet onload_callback_data = [];\r\n\r\n\t\t\tlet chart_data = {\r\n\t\t\t\tlabels: chart_data_labels,\r\n\t\t\t\tdatasets: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdata: chart_data_data,\r\n\t\t\t\t\t\tbackgroundColor: this.colors,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t};\r\n\r\n\t\t\tthis.setState(state => ({\r\n\t\t\t\taggregates: cache,\r\n\t\t\t\tchart_data: chart_data,\r\n\t\t\t\tloading: false,\r\n\t\t\t}));\r\n\t\t\tif (onLoadAggregates) {\r\n\t\t\t\tonLoadAggregates(onload_callback_data);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tloadAggregates(query_data) {\r\n\t\tconst { apiCallRequest, defination } = this.props;\r\n\r\n\t\tif (!query_data) {\r\n\t\t\tquery_data = { g: this.state.aggregate };\r\n\t\t}\r\n\r\n\t\tlet new_aggregate =\r\n\t\t\t\"g\" in query_data\r\n\t\t\t\t? query_data.g\r\n\t\t\t\t: \"group\" in query_data\r\n\t\t\t\t? query_data.group\r\n\t\t\t\t: false;\r\n\t\tthis.setState(state => ({ aggregate: new_aggregate }));\r\n\r\n\t\tif (defination) {\r\n\t\t\tapiCallRequest(\r\n\t\t\t\tdefination.name + \"_aggregates\",\r\n\t\t\t\t{\r\n\t\t\t\t\turi: defination.endpoint,\r\n\t\t\t\t\ttype: \"aggregates\",\r\n\t\t\t\t\tparams: query_data,\r\n\t\t\t\t\tdata: {},\r\n\t\t\t\t\tcache: true,\r\n\t\t\t\t},\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\thandleShowAggregateMenu = event => {\r\n\t\tlet aggregateMenuEl = event.currentTarget;\r\n\t\tthis.setState({ aggregateMenuEl: aggregateMenuEl });\r\n\t};\r\n\r\n\thandleCloseAggregateMenu() {\r\n\t\tthis.setState({ aggregateMenuEl: null });\r\n\t}\r\n\r\n\thandleAggregateMenuItemClick = column => event => {\r\n\t\t//this.handleCloseAggregateMenu();\r\n\t\tthis.setState({ aggregateMenuEl: null });\r\n\t\tthis.loadAggregates({ g: column });\r\n\t};\r\n\r\n\trender() {\r\n        const {\r\n\t\t\tclasses,\r\n\t\t\tclassName,\r\n\t\t\taggregate,\r\n\t\t\tdynamic,\r\n\t\t\tdefination,\r\n\t\t\tservice,\r\n\t\t\tshowTitle,\r\n\t\t\tshowMenu,\r\n\t\t\tapi,\r\n\t\t\tcache,\r\n\t\t} = this.props;\r\n\r\n        return (\r\n\t\t\t!JSON.isEmpty(defination) && <GridContainer className={className + \" p-0 m-0\"}>\r\n\t\t\t\t<GridItem xs={12} className=\"p-0 m-0\">\r\n\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\r\n\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\r\n\t\t\t\t\t\t\t{(showMenu || showTitle) && (\r\n\t\t\t\t\t\t\t\t<GridItem xs={12}>\r\n\t\t\t\t\t\t\t\t\t<GridContainer>\r\n\t\t\t\t\t\t\t\t\t\t{showTitle && !showMenu && (\r\n\t\t\t\t\t\t\t\t\t\t\t<GridItem xs={12}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Typography\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"body1\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcenter\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{defination.scope.columns[\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state.aggregate\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? defination.scope\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.columns[\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.aggregate\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  ].label\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"Unknown\"}{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tAggregate\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t{dynamic && showMenu && (\r\n\t\t\t\t\t\t\t\t\t\t\t<GridItem\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"p-0 m-0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\txs={12}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\taria-controls=\"aggregate-menu\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\taria-haspopup=\"true\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.handleShowAggregateMenu\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"float-right\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"md\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\taria-label=\"Aggregate Menu\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsimple\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{defination.scope?.columns[\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state.aggregate\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? defination.scope\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.columns[\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.aggregate\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  ].label\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"Unknown\"}{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tAggregate\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<AggregateMenuIcon />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Menu\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"surveys-aggregate-menu\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tanchorEl={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.aggregateMenuEl\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tkeepMounted\r\n\t\t\t\t\t\t\t\t\t\t\t\t\topen={Boolean(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.aggregateMenuEl\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClose={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.handleCloseAggregateMenu\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{this.aggregatables.map(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taggregatable,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tindex\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<MenuItem\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={this.handleAggregateMenuItemClick(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taggregatable.name\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"aggregate_\" +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taggregatable.name\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{aggregatable.label +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\" Aggregate\"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</MenuItem>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Menu>\r\n\t\t\t\t\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</GridContainer>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t<GridItem className=\"p-0 m-0\" xs={12}>\r\n\t\t\t\t\t\t\t\t{Array.isArray(this.state.chart_data.labels) &&\r\n\t\t\t\t\t\t\t\tthis.state.chart_data.labels.length > 0 ? (\r\n\t\t\t\t\t\t\t\t\t<Bar \r\n\t\t\t\t\t\t\t\t\t\tdata={this.state.chart_data} \r\n\t\t\t\t\t\t\t\t\t\toptions={{\r\n\t\t\t\t\t\t\t\t\t\t\tmaintainAspectRatio: false,\r\n\t\t\t\t\t\t\t\t\t\t\tscales: {\r\n\t\t\t\t\t\t\t\t\t\t\t\tyAxes: [{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tticks: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tbeginAtZero: true\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}]\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t<GridContainer\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"p-0 m-0\"\r\n\t\t\t\t\t\t\t\t\t\tjustify=\"center\"\r\n\t\t\t\t\t\t\t\t\t\talignItems=\"center\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\t\t\talt=\"Empty Aggregates\"\r\n\t\t\t\t\t\t\t\t\t\t\tclassName={classes.emptyImage}\r\n\t\t\t\t\t\t\t\t\t\t\tsrc={EmptyStateImage}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t<Typography\r\n\t\t\t\t\t\t\t\t\t\t\tclassName={classes.emptyText}\r\n\t\t\t\t\t\t\t\t\t\t\tcolor=\"grey\"\r\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"body2\"\r\n\t\t\t\t\t\t\t\t\t\t\tcenter\r\n\t\t\t\t\t\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\tNo{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\t{defination.scope.columns[\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.state.aggregate\r\n\t\t\t\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t\t\t\t\t\t? defination.scope.columns[\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state.aggregate\r\n\t\t\t\t\t\t\t\t\t\t\t\t  ].label\r\n\t\t\t\t\t\t\t\t\t\t\t\t: \"\"}{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\tAggregates\r\n\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t</GridContainer>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t</GridContainer>\r\n\r\n\t\t\t\t\t\t{api.complete && api.error && (\r\n\t\t\t\t\t\t\t<GridContainer>\r\n\t\t\t\t\t\t\t\t<GridItem xs={12}>\r\n\t\t\t\t\t\t\t\t\t<Typography\r\n\t\t\t\t\t\t\t\t\t\tcolor=\"error\"\r\n\t\t\t\t\t\t\t\t\t\tvariant=\"body2\"\r\n\t\t\t\t\t\t\t\t\t\tcenter\r\n\t\t\t\t\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{\"An error occured. \\n \" +\r\n\t\t\t\t\t\t\t\t\t\t\tapi.error.msg}\r\n\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t\t</GridContainer>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</GridContainer>\r\n\t\t\t\t</GridItem>\r\n\t\t\t</GridContainer>\r\n\t\t);\r\n    }\r\n}\r\n\r\nAggregatesBarChart.propTypes = {\r\n\tclassName: PropTypes.string,\r\n\tclasses: PropTypes.object.isRequired,\r\n\tdynamic: PropTypes.bool,\r\n\tshowTitle: PropTypes.bool,\r\n\tshowMenu: PropTypes.bool,\r\n\tmonochrome: PropTypes.bool,\r\n\tcolor: PropTypes.string,\r\n\tcolors: PropTypes.array,\r\n\tdefination: PropTypes.object.isRequired,\r\n\tservice: PropTypes.any.isRequired,\r\n\taggregate: PropTypes.string,\r\n\tonResolveAggregates: PropTypes.func,\r\n\tonLoadAggregates: PropTypes.func,\r\n};\r\n\r\nAggregatesBarChart.defaultProps = {\r\n\t//colors: [colors.hex.accent, colors.hex.primary, colors.hex.secondary, colors.hex.primarydark, colors.hex.default],\r\n\tcolor: colors.hex.accent,\r\n\tmonochrome: true,\r\n};\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n\tconst { defination } = ownProps;\r\n\treturn {\r\n\t\tauth: state.auth,\r\n\t\tcache: defination\r\n\t\t\t? state.cache.data[defination.name + \"_aggregates\"]\r\n\t\t\t: null,\r\n\t\tapi: defination\r\n\t\t\t? state.api[defination.name]\r\n\t\t\t\t? state.api[defination.name]\r\n\t\t\t\t: {}\r\n\t\t\t: {},\r\n\t};\r\n};\r\n\r\nexport default compose(\r\n\twithStyles(styles),\r\n\tconnect(mapStateToProps, { apiCallRequest }),\r\n\twithErrorHandler\r\n)(AggregatesBarChart);\r\n","/** @format */\r\n\r\nexport default theme => ({\r\n\troot: {\r\n\t\tpadding: \"0\",\r\n\t},\r\n\tdata_actions_wrapper: {\r\n\t\tdisplay: \"inline-block\",\r\n\t\twhiteSpace: \"nowrap\",\r\n\t\t\"& > *\": {\r\n\t\t\tdisplay: \"inline-block\",\r\n\t\t\twhiteSpace: \"nowrap\",\r\n\t\t},\r\n\t},\r\n\tvalueChip: {\r\n\t\tmargin: theme.spacing(0.5),\r\n\t},\r\n\temptyImage: {\r\n\t\tmaxWidth: 100,\r\n\t\twidth: \"70%\",\r\n\t\tmargin: theme.spacing(2),\r\n\t},\r\n\temptyText: {\r\n\t\tmarginTop: theme.spacing(3),\r\n\t},\r\n});\r\n"],"sourceRoot":""}