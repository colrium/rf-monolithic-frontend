(this.webpackJsonpdashboard=this.webpackJsonpdashboard||[]).push([[7,21,22],{1907:function(e,a,t){"use strict";var n=t(0),r=t.n(n),s=t(23);a.a=Object(s.a)(r.a.createElement("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVert")},1908:function(e,a,t){"use strict";t.r(a);var n=t(8),r=t(17),s=t(25),l=t(22),o=t(20),i=t(19),g=t(924),c=t(765),h=t(40),u=t.n(h),m=t(1907),d=t(272),p=t.n(d),f=t(11),b=t(29),v=t(12),E=t(5),y=t(21),A=t(0),C=t.n(A),M=t(517),k=t(26),O=t(44),j=t.n(O),S=t(13),w=t(31),_=t(33);M.c.global.legend.display=!1;var x=function(e){Object(o.a)(t,e);var a=Object(i.a)(t);function t(e){var n;return Object(r.a)(this,t),(n=a.call(this,e)).state={loading:!0,load_error:!1,aggregate:"status",aggregates:[],chart_data:{labels:[],datasets:[{data:[]}]},aggregateMenuEl:null},n.aggregatables=[],n.colors=[],n.handleShowAggregateMenu=function(e){var a=e.currentTarget;n.setState({aggregateMenuEl:a})},n.handleAggregateMenuItemClick=function(e){return function(a){n.setState({aggregateMenuEl:null}),n.loadAggregates({g:e})}},n.handleShowAggregateMenu=n.handleShowAggregateMenu.bind(Object(l.a)(n)),n.handleCloseAggregateMenu=n.handleCloseAggregateMenu.bind(Object(l.a)(n)),n}return Object(s.a)(t,[{key:"componentDidMount",value:function(){this.prepareForData(),this.loadAggregates(),this.prepareChartData()}},{key:"componentDidUpdate",value:function(e){Object.areEqual(this.props.defination,e.defination)?Object.areEqual(e.api,this.props.api)?Array.isArray(this.props.cache)?this.props.cache.equals(e.cache)||this.prepareChartData():Array.isArray(e.cache)&&(e.cache.equals(this.props.cache)||this.prepareChartData()):this.prepareChartData():(this.prepareForData(),this.loadAggregates())}},{key:"prepareForData",value:function(){var e=this.props,a=e.dynamic,t=e.monochrome,r=e.color,s=e.colors,l=e.defination,o=(e.service,e.aggregate),i=e.onResolveAggregates;if(a){this.aggregatables=[];for(var g=0,c=Object.entries(l.scope.columns);g<c.length;g++){var h=Object(n.a)(c[g],2),u=h[0],m=h[1];m.possibilities&&this.aggregatables.push({name:u,label:m.label})}}if(!o&&this.aggregatables.length>0&&(o=this.aggregatables[0].name,i&&i(l.name,this.aggregatables)),a)if(this.state.aggregate=o,t){var d=this.aggregatables.length>0?this.aggregatables.length:1,p=_.e.monochromeColorScheme(r,d);this.colors=p}else if(s)this.colors=s;else{var f=this.aggregatables.length>0?this.aggregatables.length:1,b=_.e.rotationColorScheme(r,f);this.colors=b}}},{key:"prepareChartData",value:function(){var e=this.props,a=e.monochrome,t=e.color,n=e.colors,r=(e.aggregate,e.defination),s=(e.service,e.auth),l=e.onLoadAggregates,o=e.cache,i=e.api;if(Array.isArray(o)){var g=r.scope.columns[this.state.aggregate]?r.scope.columns[this.state.aggregate].possibilities:{};if("function"===typeof g&&(g=g(!1,s.user)),a){var c=o.length>0?o.length:1,h=_.e.monochromeColorScheme(i.loading||i.error?"#595959":t,c);this.colors=h}else if(n)this.colors=i.loading||i.error?_.e.monochromeColorScheme("#595959"):n;else{var u=o.length>0?o.length:1,m=_.e.rotationColorScheme(i.loading||i.error?"#595959":t,u);this.colors=m}var d=[],p=[],f=[];if("object"===typeof g)for(var b=0;b<o.length;b++)o[b]._id in g&&(d.push(g[o[b]._id]),p.push(o[b].count),l&&f.push({name:o[b]._id,label:g[o[b]._id],count:o[b].count,color:this.colors[b]}));var v={labels:d,datasets:[{data:p,backgroundColor:this.colors}]};this.setState((function(e){return{aggregates:o,chart_data:v,loading:!1}})),l&&l(f)}else{var E={labels:[],datasets:[{data:[],backgroundColor:this.colors}]};this.setState((function(e){return{aggregates:o,chart_data:E,loading:!1}})),l&&l([])}}},{key:"loadAggregates",value:function(e){var a=this.props,t=a.apiCallRequest,n=a.defination;e||(e={g:this.state.aggregate});var r="g"in e?e.g:"group"in e&&e.group;this.setState((function(e){return{aggregate:r}})),n&&t(n.name+"_aggregates",{uri:n.endpoint,type:"aggregates",params:e,data:{},cache:!0})}},{key:"handleCloseAggregateMenu",value:function(){this.setState({aggregateMenuEl:null})}},{key:"render",value:function(){var e=this,a=this.props,t=a.classes,n=a.className,r=(a.aggregate,a.dynamic),s=a.defination,l=(a.service,a.showTitle),o=a.showMenu,i=a.api;a.cache;return C.a.createElement(v.a,{className:n+" p-0 m-0"},C.a.createElement(E.a,{xs:12,className:"p-0 m-0"},C.a.createElement(v.a,{className:"p-0 m-0"},C.a.createElement(v.a,{className:"p-0 m-0"},(o||l)&&C.a.createElement(E.a,{xs:12},C.a.createElement(v.a,null,l&&!o&&C.a.createElement(E.a,{xs:12},C.a.createElement(y.a,{color:"default",variant:"body1",fullWidth:!0,center:!0},s.scope.columns[this.state.aggregate]?s.scope.columns[this.state.aggregate].label:"Unknown"," ","Aggregate")),r&&o&&C.a.createElement(E.a,{className:"p-0 m-0",xs:12},C.a.createElement(b.a,{"aria-controls":"aggregate-menu","aria-haspopup":"true",onClick:this.handleShowAggregateMenu,color:"default",className:"float-right",size:"md","aria-label":"Aggregate Menu",simple:!0},s.scope.columns[this.state.aggregate]?s.scope.columns[this.state.aggregate].label:"Unknown"," ","Aggregate",C.a.createElement(m.a,null)),C.a.createElement(g.a,{id:"surveys-aggregate-menu",anchorEl:this.state.aggregateMenuEl,keepMounted:!0,open:Boolean(this.state.aggregateMenuEl),onClose:this.handleCloseAggregateMenu},this.aggregatables.map((function(a,t){return C.a.createElement(c.a,{onClick:e.handleAggregateMenuItemClick(a.name),key:"aggregate_"+a.name},a.label+" Aggregate")})))))),C.a.createElement(E.a,{className:"p-0 m-0",xs:12},Array.isArray(this.state.chart_data.labels)&&this.state.chart_data.labels.length>0?C.a.createElement(M.b,{data:this.state.chart_data}):C.a.createElement(v.a,{className:"p-0 m-0",justify:"center",alignItems:"center"},C.a.createElement("img",{alt:"Empty Aggregates",className:t.emptyImage,src:p.a}),C.a.createElement(y.a,{className:t.emptyText,color:"grey",variant:"body2",center:!0,fullWidth:!0},"No"," ",s.scope.columns[this.state.aggregate]?s.scope.columns[this.state.aggregate].label:""," ","Aggregates")))),i.complete&&i.error&&C.a.createElement(v.a,null,C.a.createElement(E.a,{xs:12},C.a.createElement(y.a,{color:"error",variant:"body2",center:!0,fullWidth:!0},"An error occured. \n "+i.error.msg))))))}}]),t}(C.a.Component);x.defaultProps={color:f.b.hex.accent,monochrome:!0};a.default=j()(u()((function(e){return{root:{padding:"0"},data_actions_wrapper:{display:"inline-block",whiteSpace:"nowrap","& > *":{display:"inline-block",whiteSpace:"nowrap"}},valueChip:{margin:e.spacing(.5)},emptyImage:{maxWidth:100,width:"70%",margin:e.spacing(2)},emptyText:{marginTop:e.spacing(3)}}})),Object(k.b)((function(e,a){var t=a.defination;return{auth:e.auth,cache:t?e.cache.data[t.name+"_aggregates"]:null,api:t&&e.api[t.name]?e.api[t.name]:{}}}),{apiCallRequest:S.hb}),w.a)(x)},1909:function(e,a,t){"use strict";t.r(a);var n=t(8),r=t(17),s=t(25),l=t(22),o=t(20),i=t(19),g=t(924),c=t(765),h=t(40),u=t.n(h),m=t(1907),d=t(272),p=t.n(d),f=t(11),b=t(29),v=t(12),E=t(5),y=t(21),A=t(0),C=t.n(A),M=t(517),k=t(26),O=t(44),j=t.n(O),S=t(13),w=t(31),_=t(33);M.c.global.legend.display=!1;var x=function(e){Object(o.a)(t,e);var a=Object(i.a)(t);function t(e){var n;return Object(r.a)(this,t),(n=a.call(this,e)).state={loading:!0,load_error:!1,aggregate:"status",aggregates:[],chart_data:{labels:[],datasets:[{data:[]}]},aggregateMenuEl:null},n.aggregatables=[],n.colors=[],n.handleShowAggregateMenu=function(e){var a=e.currentTarget;n.setState({aggregateMenuEl:a})},n.handleAggregateMenuItemClick=function(e){return function(a){n.setState({aggregateMenuEl:null}),n.loadAggregates({g:e})}},n.handleShowAggregateMenu=n.handleShowAggregateMenu.bind(Object(l.a)(n)),n.handleCloseAggregateMenu=n.handleCloseAggregateMenu.bind(Object(l.a)(n)),n}return Object(s.a)(t,[{key:"componentDidMount",value:function(){this.prepareForData(),this.loadAggregates(),this.prepareChartData()}},{key:"componentDidUpdate",value:function(e){Object.areEqual(this.props.defination,e.defination)?Object.areEqual(e.api,this.props.api)?Array.isArray(this.props.cache)?this.props.cache.equals(e.cache)||this.prepareChartData():Array.isArray(e.cache)&&(e.cache.equals(this.props.cache)||this.prepareChartData()):this.prepareChartData():(this.prepareForData(),this.loadAggregates())}},{key:"prepareForData",value:function(){var e=this.props,a=e.dynamic,t=e.monochrome,r=e.color,s=e.colors,l=e.defination,o=(e.service,e.aggregate),i=e.onResolveAggregates;if(a){this.aggregatables=[];for(var g=0,c=Object.entries(l.scope.columns);g<c.length;g++){var h=Object(n.a)(c[g],2),u=h[0],m=h[1];m.possibilities&&this.aggregatables.push({name:u,label:m.label})}}if(!o&&this.aggregatables.length>0&&(o=this.aggregatables[0].name,i&&i(l.name,this.aggregatables)),a)if(this.state.aggregate=o,t){var d=this.aggregatables.length>0?this.aggregatables.length:1,p=_.e.monochromeColorScheme(r,d);this.colors=p}else if(s)this.colors=s;else{var f=this.aggregatables.length>0?this.aggregatables.length:1,b=_.e.rotationColorScheme(r,f);this.colors=b}}},{key:"prepareChartData",value:function(){var e=this.props,a=e.monochrome,t=e.color,n=e.colors,r=(e.aggregate,e.defination),s=(e.service,e.auth),l=e.onLoadAggregates,o=e.cache,i=e.api;if(Array.isArray(o)){var g=r.scope.columns[this.state.aggregate]?r.scope.columns[this.state.aggregate].possibilities:{};if("function"===typeof g&&(g=g(!1,s.user)),a){var c=o.length>0?o.length:1,h=_.e.monochromeColorScheme(i.loading||i.error?"#595959":t,c);this.colors=h}else if(n)this.colors=i.loading||i.error?_.e.monochromeColorScheme("#595959"):n;else{var u=o.length>0?o.length:1,m=_.e.rotationColorScheme(i.loading||i.error?"#595959":t,u);this.colors=m}var d=[],p=[],f=[];if("object"===typeof g)for(var b=0;b<o.length;b++)o[b]._id in g&&(d.push(g[o[b]._id]),p.push(o[b].count),l&&f.push({name:o[b]._id,label:g[o[b]._id],count:o[b].count,color:this.colors[b]}));var v={labels:d,datasets:[{data:p,backgroundColor:this.colors}]};this.setState((function(e){return{aggregates:o,chart_data:v,loading:!1}})),l&&l(f)}else{var E={labels:[],datasets:[{data:[],backgroundColor:this.colors}]};this.setState((function(e){return{aggregates:o,chart_data:E,loading:!1}})),l&&l([])}}},{key:"loadAggregates",value:function(e){var a=this.props,t=a.apiCallRequest,n=a.defination;e||(e={g:this.state.aggregate});var r="g"in e?e.g:"group"in e&&e.group;this.setState((function(e){return{aggregate:r}})),n&&t(n.name+"_aggregates",{uri:n.endpoint,type:"aggregates",params:e,data:{},cache:!0})}},{key:"handleCloseAggregateMenu",value:function(){this.setState({aggregateMenuEl:null})}},{key:"render",value:function(){var e=this,a=this.props,t=a.classes,n=a.className,r=(a.aggregate,a.dynamic),s=a.defination,l=(a.service,a.showTitle),o=a.showMenu,i=a.api;a.cache;return C.a.createElement(v.a,{className:n+" p-0 m-0"},C.a.createElement(E.a,{xs:12,className:"p-0 m-0"},C.a.createElement(v.a,{className:"p-0 m-0"},C.a.createElement(v.a,{className:"p-0 m-0"},(o||l)&&C.a.createElement(E.a,{xs:12},C.a.createElement(v.a,null,l&&!o&&C.a.createElement(E.a,{xs:12},C.a.createElement(y.a,{color:"default",variant:"body1",fullWidth:!0,center:!0},s.scope.columns[this.state.aggregate]?s.scope.columns[this.state.aggregate].label:"Unknown"," ","Aggregate")),r&&o&&C.a.createElement(E.a,{className:"p-0 m-0",xs:12},C.a.createElement(b.a,{"aria-controls":"aggregate-menu","aria-haspopup":"true",onClick:this.handleShowAggregateMenu,color:"default",className:"float-right",size:"md","aria-label":"Aggregate Menu",simple:!0},s.scope.columns[this.state.aggregate]?s.scope.columns[this.state.aggregate].label:"Unknown"," ","Aggregate",C.a.createElement(m.a,null)),C.a.createElement(g.a,{id:"surveys-aggregate-menu",anchorEl:this.state.aggregateMenuEl,keepMounted:!0,open:Boolean(this.state.aggregateMenuEl),onClose:this.handleCloseAggregateMenu},this.aggregatables.map((function(a,t){return C.a.createElement(c.a,{onClick:e.handleAggregateMenuItemClick(a.name),key:"aggregate_"+a.name},a.label+" Aggregate")})))))),C.a.createElement(E.a,{className:"p-0 m-0",xs:12},Array.isArray(this.state.chart_data.labels)&&this.state.chart_data.labels.length>0?C.a.createElement(M.a,{data:this.state.chart_data,options:{maintainAspectRatio:!1,scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}}):C.a.createElement(v.a,{className:"p-0 m-0",justify:"center",alignItems:"center"},C.a.createElement("img",{alt:"Empty Aggregates",className:t.emptyImage,src:p.a}),C.a.createElement(y.a,{className:t.emptyText,color:"grey",variant:"body2",center:!0,fullWidth:!0},"No"," ",s.scope.columns[this.state.aggregate]?s.scope.columns[this.state.aggregate].label:""," ","Aggregates")))),i.complete&&i.error&&C.a.createElement(v.a,null,C.a.createElement(E.a,{xs:12},C.a.createElement(y.a,{color:"error",variant:"body2",center:!0,fullWidth:!0},"An error occured. \n "+i.error.msg))))))}}]),t}(C.a.Component);x.defaultProps={color:f.b.hex.accent,monochrome:!0};a.default=j()(u()((function(e){return{root:{padding:"0"},data_actions_wrapper:{display:"inline-block",whiteSpace:"nowrap","& > *":{display:"inline-block",whiteSpace:"nowrap"}},valueChip:{margin:e.spacing(.5)},emptyImage:{maxWidth:100,width:"70%",margin:e.spacing(2)},emptyText:{marginTop:e.spacing(3)}}})),Object(k.b)((function(e,a){var t=a.defination;return{auth:e.auth,cache:t?e.cache.data[t.name+"_aggregates"]:null,api:t&&e.api[t.name]?e.api[t.name]:{}}}),{apiCallRequest:S.hb}),w.a)(x)},1912:function(e,a,t){"use strict";var n=t(41);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=n(t(0)),s=(0,n(t(45)).default)(r.default.createElement("path",{d:"M9.17 6l2 2H20v10H4V6h5.17M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"}),"FolderOutlined");a.default=s},1938:function(e,a,t){"use strict";t.r(a);var n=t(8),r=t(17),s=t(25),l=t(22),o=t(20),i=t(19),g=t(161),c=t(924),h=t(765),u=t(40),m=t.n(u),d=t(1912),p=t.n(d),f=t(489),b=t.n(f),v=t(11),E=t(51),y=t(897),A=t(77),C=t(291),M=t(153),k=t(154),O=t(12),j=t(5),S=t(21),w=t(46),_=t(0),x=t.n(_),N=t(26),D=t(44),T=t.n(D),I=t(1908),q=t(1909),L=t(31),z=function(e){Object(o.a)(t,e);var a=Object(i.a)(t);function t(e){var s;Object(r.a)(this,t),(s=a.call(this,e)).state={context:null,defination:!1,definations:{},aggregates:[],menuAnchorEl:null},s.handleMenuOpen=function(e){var a=e.currentTarget;s.setState((function(e){return{menuAnchorEl:a}}))},s.handleDefinationChange=function(e){return function(a){s.setState((function(a){return{menuAnchorEl:null,defination:a.definations[e]}}))}};for(var o=e.auth,i=e.definations,g=e.services,c=e.contexts,h={},u=0,m=Object.entries(i);u<m.length;u++){var d=Object(n.a)(m[u],2),p=d[0],f=d[1];p in g&&!f.access.restricted(o.user)&&f.access.view.summary(o.user)&&c.includes(p)&&(h[p]=f,s.state.defination||(s.state.defination=f))}return s.state.definations=h,s.handleMenuOpen=s.handleMenuOpen.bind(Object(l.a)(s)),s.handleMenuClose=s.handleMenuClose.bind(Object(l.a)(s)),s.handleDefinationChange=s.handleDefinationChange.bind(Object(l.a)(s)),s.handleOnAggregatesLoad=s.handleOnAggregatesLoad.bind(Object(l.a)(s)),s}return Object(s.a)(t,[{key:"handleMenuClose",value:function(){this.setState((function(e){return{menuAnchorEl:null}}))}},{key:"handleOnAggregatesLoad",value:function(e){this.setState((function(a){return{aggregates:e}}))}},{key:"render",value:function(){var e=this,a=this.props,t=a.classes,r=a.auth,s=(a.definations,a.services),l=a.contexts,o=(a.gridSize,a.theme,a.chartType);return x.a.createElement(A.a,{outlineColor:"#cfd8dc"},x.a.createElement(k.a,{avatar:x.a.createElement(E.a,{"aria-label":this.state.defination.label,style:{background:this.state.defination.color}},this.state.defination.icon),title:this.state.defination.label,subheader:"Aggregates Overview",action:l.length>1&&x.a.createElement("div",null,x.a.createElement(g.a,{"aria-label":"menuicon",color:"primary",className:t.margin,onClick:this.handleMenuOpen}," ",x.a.createElement(b.a,null)," "),x.a.createElement(c.a,{id:"definations-menu",anchorEl:this.state.menuAnchorEl,keepMounted:!0,open:Boolean(this.state.menuAnchorEl),onClose:this.handleMenuClose},Object.entries(this.state.definations).map((function(a,t){var o=Object(n.a)(a,2),i=o[0],g=o[1];return!g.access.restricted(r.user)&&g.access.view.summary(r.user)&&i in s&&l.includes(i)&&x.a.createElement(h.a,{onClick:e.handleDefinationChange(i),key:"aggregate-"+g.name}," ",g.label," ")}))))}),x.a.createElement(M.a,{className:"p-0 m-0"},x.a.createElement(O.a,{className:t.fullHeight,direction:"column",justify:"center",alignItems:"center"},x.a.createElement(O.a,{className:"p-0 m-0"},x.a.createElement(j.a,{xs:12},x.a.createElement(O.a,{style:{height:"100%"},direction:"column",justify:"center",alignItems:"center"},"pie"===o&&x.a.createElement(I.default,{defination:this.state.defination,service:s[this.state.defination.name],color:this.state.defination.color?this.state.defination.color:v.b.hex.primary,onLoadAggregates:this.handleOnAggregatesLoad,monochrome:!0,showTitle:!0,showMenu:!0,dynamic:!0}),"bar"===o&&x.a.createElement(q.default,{defination:this.state.defination,service:s[this.state.defination.name],color:this.state.defination.color?this.state.defination.color:v.b.hex.primary,onLoadAggregates:this.handleOnAggregatesLoad,monochrome:!0,showTitle:!0,showMenu:!0,dynamic:!0}))),x.a.createElement(j.a,{xs:12},x.a.createElement(O.a,{className:"center",direction:"column",justify:"center",alignItems:"center"},x.a.createElement(S.a,{color:"grey",variant:"body2",gutterBottom:!0},"Aggregates Index"),x.a.createElement("br",null),x.a.createElement("br",null),x.a.createElement("br",null),0===this.state.aggregates.length&&x.a.createElement(p.a,{fontSize:"large"}),this.state.aggregates.map((function(a,t){return x.a.createElement(y.a,{badgeContent:a.count,color:a.color,textColor:v.b.hex.inverse,key:e.state.defination.name+"-aggregate-"+t},x.a.createElement(S.a,{color:"default",variant:"subtitle1",component:"h3",gutterBottom:!0},a.label))}))))))),x.a.createElement(C.a,null,x.a.createElement(O.a,{className:"p-0 m-0"},x.a.createElement(j.a,{xs:12},x.a.createElement(S.a,{variant:"body2"},this.state.defination.label," by Aggregates")))))}}]),t}(x.a.Component);z.defaultProps={gridSize:12,chartType:"pie",contexts:["commissions","surveys","responses"],aggregates:[]};a.default=Object(w.c)(T()(m()((function(e){return{fullHeight:{height:"100% !important"}}})),Object(N.b)((function(e){return{auth:e.auth}}),{}),L.a)(z))}}]);
//# sourceMappingURL=7.4fa52b1e.chunk.js.map