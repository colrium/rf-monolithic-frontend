(this.webpackJsonpdashboard=this.webpackJsonpdashboard||[]).push([[4],{2066:function(e,a,t){"use strict";t.r(a);var s=t(6),r=t(11),g=t(12),n=t(31),o=t(19),i=t(20),l=t(1107),c=t(2046),h=t(2067),u=t(24),d=t(61),p=t(13),m=t(7),b=t(26),j=t(1),f=t.n(j),v=t(526),O=t(18),A=t(48),y=t.n(A),x=t(21),C=(t(35),t(67)),M=t(0),k=function(e){Object(o.a)(t,e);var a=Object(i.a)(t);function t(e){var s;return Object(r.a)(this,t),(s=a.call(this,e)).state={loading:!0,load_error:!1,aggregate:"status",aggregates:[],chart_data:{labels:[],datasets:[{data:[]}]},aggregateMenuEl:null},s.aggregatables=[],s.colors=[],s.handleShowAggregateMenu=function(e){var a=e.currentTarget;s.setState({aggregateMenuEl:a})},s.handleAggregateMenuItemClick=function(e){return function(a){s.setState({aggregateMenuEl:null}),s.loadAggregates({g:e})}},s.handleShowAggregateMenu=s.handleShowAggregateMenu.bind(Object(n.a)(s)),s.handleCloseAggregateMenu=s.handleCloseAggregateMenu.bind(Object(n.a)(s)),s}return Object(g.a)(t,[{key:"componentDidMount",value:function(){this.prepareForData(),this.loadAggregates(),this.prepareChartData()}},{key:"componentDidUpdate",value:function(e){Object.areEqual(this.props.defination,e.defination)?Object.areEqual(e.api,this.props.api)?Array.isArray(this.props.cache)?this.props.cache.equals(e.cache)||this.prepareChartData():Array.isArray(e.cache)&&(e.cache.equals(this.props.cache)||this.prepareChartData()):this.prepareChartData():(this.prepareForData(),this.loadAggregates())}},{key:"prepareForData",value:function(){var e=this.props,a=e.dynamic,t=e.monochrome,r=e.color,g=e.colors,n=e.defination,o=(e.service,e.aggregate),i=e.onResolveAggregates;if(a&&!JSON.isEmpty(n)){this.aggregatables=[];for(var l=0,c=Object.entries(n.scope.columns);l<c.length;l++){var h=Object(s.a)(c[l],2),u=h[0],d=h[1];d.possibilities&&this.aggregatables.push({name:u,label:d.label})}}if(!o&&this.aggregatables.length>0&&(o=this.aggregatables[0].name,i&&i(n.name,this.aggregatables)),a)if(this.state.aggregate=o,t){var p=this.aggregatables.length>0?this.aggregatables.length:1,m=C.d.monochromeColorScheme(r,p);this.colors=m}else if(g)this.colors=g;else{var b=this.aggregatables.length>0?this.aggregatables.length:1,j=C.d.rotationColorScheme(r,b);this.colors=j}}},{key:"prepareChartData",value:function(){var e=this.props,a=e.monochrome,t=e.color,s=e.colors,r=(e.aggregate,e.defination),g=(e.service,e.auth),n=e.onLoadAggregates,o=e.cache,i=e.api;if(Array.isArray(o)){var l=r.scope.columns[this.state.aggregate]?r.scope.columns[this.state.aggregate].possibilities:{};if("function"===typeof l&&(l=l(!1,g.user)),a){var c=o.length>0?o.length:1,h=C.d.monochromeColorScheme(i.loading||i.error?"#595959":t,c);this.colors=h}else if(s)this.colors=i.loading||i.error?C.d.monochromeColorScheme("#595959"):s;else{var u=o.length>0?o.length:1,d=C.d.rotationColorScheme(i.loading||i.error?"#595959":t,u);this.colors=d}var p=[],m=[],b=[];if("object"===typeof l)for(var j=0;j<o.length;j++)o[j]._id in l&&(p.push(l[o[j]._id]),m.push(o[j].count),n&&b.push({name:o[j]._id,label:l[o[j]._id],count:o[j].count,color:this.colors[j]}));var f={labels:p,datasets:[{data:m,backgroundColor:this.colors}]};this.setState((function(e){return{aggregates:o,chart_data:f,loading:!1}})),n&&n(b)}else{var v={labels:[],datasets:[{data:[],backgroundColor:this.colors}]};this.setState((function(e){return{aggregates:o,chart_data:v,loading:!1}})),n&&n([])}}},{key:"loadAggregates",value:function(e){var a=this.props,t=a.apiCallRequest,s=a.defination;e||(e={g:this.state.aggregate});var r="g"in e?e.g:"group"in e&&e.group;this.setState((function(e){return{aggregate:r}})),s&&t(s.name+"_aggregates",{uri:s.endpoint,type:"aggregates",params:e,data:{},cache:!0})}},{key:"handleCloseAggregateMenu",value:function(){this.setState({aggregateMenuEl:null})}},{key:"render",value:function(){var e,a=this,t=this.props,s=t.className,r=(t.aggregate,t.dynamic),g=t.defination,n=(t.service,t.showTitle),o=t.showMenu,i=t.api;t.cache;return!JSON.isEmpty(g)&&Object(M.jsx)(p.a,{className:s+" p-0 m-0",children:Object(M.jsx)(m.a,{xs:12,className:"p-0 m-0",children:Object(M.jsxs)(p.a,{className:"p-0 m-0",children:[Object(M.jsxs)(p.a,{className:"p-0 m-0",children:[(o||n)&&Object(M.jsx)(m.a,{xs:12,children:Object(M.jsxs)(p.a,{children:[n&&!o&&Object(M.jsx)(m.a,{xs:12,children:Object(M.jsxs)(b.a,{variant:"body1",fullWidth:!0,children:[g.scope.columns[this.state.aggregate]?g.scope.columns[this.state.aggregate].label:"Unknown"," ","Aggregate"]})}),r&&o&&Object(M.jsxs)(m.a,{className:"p-0 m-0",xs:12,children:[Object(M.jsxs)(d.a,{"aria-controls":"aggregate-menu","aria-haspopup":"true",onClick:this.handleShowAggregateMenu,className:"float-right",size:"md","aria-label":"Aggregate Menu",children:[(null===(e=g.scope)||void 0===e?void 0:e.columns[this.state.aggregate])?g.scope.columns[this.state.aggregate].label:"Unknown"," ","Aggregate",Object(M.jsx)(h.a,{})]}),Object(M.jsx)(l.a,{id:"surveys-aggregate-menu",anchorEl:this.state.aggregateMenuEl,keepMounted:!0,open:Boolean(this.state.aggregateMenuEl),onClose:this.handleCloseAggregateMenu,children:this.aggregatables.map((function(e,t){return Object(M.jsx)(c.a,{onClick:a.handleAggregateMenuItemClick(e.name),children:e.label+" Aggregate"},"aggregate_"+e.name)}))})]})]})}),Object(M.jsx)(m.a,{className:"p-0 m-0",xs:12,children:Array.isArray(this.state.chart_data.labels)&&this.state.chart_data.labels.length>0?Object(M.jsx)(v.a,{data:this.state.chart_data,options:{maintainAspectRatio:!1,scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}}):Object(M.jsxs)(p.a,{className:"p-0 m-0",justify:"center",alignItems:"center",children:[Object(M.jsx)("img",{alt:"Empty Aggregates",className:"m-8 w-9/12",src:"https://realfield.nyc3.cdn.digitaloceanspaces.com/public/img/empty-state-table.svg"}),Object(M.jsxs)(b.a,{className:"mt-4",color:"grey",variant:"body2",fullWidth:!0,children:["No"," ",g.scope.columns[this.state.aggregate]?g.scope.columns[this.state.aggregate].label:""," ","Aggregates"]})]})})]}),i.complete&&i.error&&Object(M.jsx)(p.a,{children:Object(M.jsx)(m.a,{xs:12,children:Object(M.jsx)(b.a,{color:"error",variant:"body2",fullWidth:!0,children:"An error occured. \n "+i.error.msg})})})]})})})}}]),t}(f.a.Component);k.defaultProps={color:u.b.hex.accent,monochrome:!0};a.default=y()(Object(O.b)((function(e,a){var t=a.defination;return{auth:e.auth,cache:t?e.cache.data[t.name+"_aggregates"]:null,api:t&&e.api[t.name]?e.api[t.name]:{}}}),{apiCallRequest:x.hb}))(k)},2067:function(e,a,t){"use strict";var s=t(39),r=t(0);a.a=Object(s.a)(Object(r.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVert")}}]);
//# sourceMappingURL=4.8dc4a9d7.chunk.js.map