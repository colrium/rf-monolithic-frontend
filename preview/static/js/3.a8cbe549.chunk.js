(this.webpackJsonpdashboard=this.webpackJsonpdashboard||[]).push([[3,4,5],{1471:function(e,a,t){"use strict";t.r(a);var s=t(6),r=t(9),n=t(11),i=t(30),o=t(19),c=t(20),l=t(836),g=t(1453),h=t(1473),d=t(24),u=t(57),b=t(10),p=t(7),m=t(26),j=t(1),f=t.n(j),O=t(414),v=t(18),x=t(44),y=t.n(x),A=t(21),C=(t(35),t(63)),M=t(0),k=function(e){Object(o.a)(t,e);var a=Object(c.a)(t);function t(e){var s;return Object(r.a)(this,t),(s=a.call(this,e)).state={loading:!0,load_error:!1,aggregate:"status",aggregates:[],chart_data:{labels:[],datasets:[{data:[]}]},aggregateMenuEl:null},s.aggregatables=[],s.colors=[],s.handleShowAggregateMenu=function(e){var a=e.currentTarget;s.setState({aggregateMenuEl:a})},s.handleAggregateMenuItemClick=function(e){return function(a){s.setState({aggregateMenuEl:null}),s.loadAggregates({g:e})}},s.handleShowAggregateMenu=s.handleShowAggregateMenu.bind(Object(i.a)(s)),s.handleCloseAggregateMenu=s.handleCloseAggregateMenu.bind(Object(i.a)(s)),s}return Object(n.a)(t,[{key:"componentDidMount",value:function(){this.prepareForData(),this.loadAggregates(),this.prepareChartData()}},{key:"componentDidUpdate",value:function(e){Object.areEqual(this.props.defination,e.defination)?Object.areEqual(e.api,this.props.api)?Array.isArray(this.props.cache)?this.props.cache.equals(e.cache)||this.prepareChartData():Array.isArray(e.cache)&&(e.cache.equals(this.props.cache)||this.prepareChartData()):this.prepareChartData():(this.prepareForData(),this.loadAggregates())}},{key:"prepareForData",value:function(){var e=this.props,a=e.dynamic,t=e.monochrome,r=e.color,n=e.colors,i=e.defination,o=(e.service,e.aggregate),c=e.onResolveAggregates;if(a){this.aggregatables=[];for(var l=0,g=Object.entries(i.scope.columns);l<g.length;l++){var h=Object(s.a)(g[l],2),d=h[0],u=h[1];u.possibilities&&this.aggregatables.push({name:d,label:u.label})}}if(!o&&this.aggregatables.length>0&&(o=this.aggregatables[0].name,c&&c(i.name,this.aggregatables)),a)if(this.state.aggregate=o,t){var b=this.aggregatables.length>0?this.aggregatables.length:1,p=C.d.monochromeColorScheme(r,b);this.colors=p}else if(n)this.colors=n;else{var m=this.aggregatables.length>0?this.aggregatables.length:1,j=C.d.rotationColorScheme(r,m);this.colors=j}}},{key:"prepareChartData",value:function(){var e=this.props,a=e.monochrome,t=e.color,s=e.colors,r=(e.aggregate,e.defination),n=(e.service,e.auth),i=e.onLoadAggregates,o=e.cache,c=e.api;if(Array.isArray(o)){var l=r.scope.columns[this.state.aggregate]?r.scope.columns[this.state.aggregate].possibilities:{};if("function"===typeof l&&(l=l(!1,n.user)),a){var g=o.length>0?o.length:1,h=C.d.monochromeColorScheme(c.loading||c.error?"#595959":t,g);this.colors=h}else if(s)this.colors=c.loading||c.error?C.d.monochromeColorScheme("#595959"):s;else{var d=o.length>0?o.length:1,u=C.d.rotationColorScheme(c.loading||c.error?"#595959":t,d);this.colors=u}var b=[],p=[],m=[];if("object"===typeof l)for(var j=0;j<o.length;j++)o[j]._id in l&&(b.push(l[o[j]._id]),p.push(o[j].count),i&&m.push({name:o[j]._id,label:l[o[j]._id],count:o[j].count,color:this.colors[j]}));var f={labels:b,datasets:[{data:p,backgroundColor:this.colors}]};this.setState((function(e){return{aggregates:o,chart_data:f,loading:!1}})),i&&i(m)}else{var O={labels:[],datasets:[{data:[],backgroundColor:this.colors}]};this.setState((function(e){return{aggregates:o,chart_data:O,loading:!1}})),i&&i([])}}},{key:"loadAggregates",value:function(e){var a=this.props,t=a.apiCallRequest,s=a.defination;e||(e={g:this.state.aggregate});var r="g"in e?e.g:"group"in e&&e.group;this.setState((function(e){return{aggregate:r}})),s&&t(s.name+"_aggregates",{uri:s.endpoint,type:"aggregates",params:e,data:{},cache:!0})}},{key:"handleCloseAggregateMenu",value:function(){this.setState({aggregateMenuEl:null})}},{key:"render",value:function(){var e=this,a=this.props,t=a.className,s=(a.aggregate,a.dynamic),r=a.defination,n=(a.service,a.showTitle),i=a.showMenu,o=a.api;a.cache;return Object(M.jsx)(b.a,{className:t+" p-0 m-0",children:Object(M.jsx)(p.a,{xs:12,className:"p-0 m-0",children:Object(M.jsxs)(b.a,{className:"p-0 m-0",children:[Object(M.jsxs)(b.a,{className:"p-0 m-0",children:[(i||n)&&Object(M.jsx)(p.a,{xs:12,children:Object(M.jsxs)(b.a,{children:[n&&!i&&Object(M.jsx)(p.a,{xs:12,children:Object(M.jsxs)(m.a,{variant:"body1",fullWidth:!0,children:[r.scope.columns[this.state.aggregate]?r.scope.columns[this.state.aggregate].label:"Unknown"," ","Aggregate"]})}),s&&i&&Object(M.jsxs)(p.a,{className:"p-0 m-0",xs:12,children:[Object(M.jsxs)(u.a,{"aria-controls":"aggregate-menu","aria-haspopup":"true",onClick:this.handleShowAggregateMenu,className:"float-right",size:"md","aria-label":"Aggregate Menu",children:[r.scope.columns[this.state.aggregate]?r.scope.columns[this.state.aggregate].label:"Unknown"," ","Aggregate",Object(M.jsx)(h.a,{})]}),Object(M.jsx)(l.a,{id:"surveys-aggregate-menu",anchorEl:this.state.aggregateMenuEl,keepMounted:!0,open:Boolean(this.state.aggregateMenuEl),onClose:this.handleCloseAggregateMenu,children:this.aggregatables.map((function(a,t){return Object(M.jsx)(g.a,{onClick:e.handleAggregateMenuItemClick(a.name),children:a.label+" Aggregate"},"aggregate_"+a.name)}))})]})]})}),Object(M.jsx)(p.a,{className:"p-0 m-0",xs:12,children:Array.isArray(this.state.chart_data.labels)&&this.state.chart_data.labels.length>0?Object(M.jsx)(O.b,{data:this.state.chart_data}):Object(M.jsxs)(b.a,{className:"p-0 m-0",justify:"center",alignItems:"center",children:[Object(M.jsx)("img",{alt:"Empty Aggregates",className:"w-9/12",src:"https://realfield.nyc3.cdn.digitaloceanspaces.com/public/img/empty-state-table.svg"}),Object(M.jsxs)(m.a,{className:"mt-4",color:"grey",variant:"body2",fullWidth:!0,children:["No"," ",r.scope.columns[this.state.aggregate]?r.scope.columns[this.state.aggregate].label:""," ","Aggregates"]})]})})]}),o.complete&&o.error&&Object(M.jsx)(b.a,{children:Object(M.jsx)(p.a,{xs:12,children:Object(M.jsx)(m.a,{color:"error",variant:"body2",fullWidth:!0,children:"An error occured. \n "+o.error.msg})})})]})})})}}]),t}(f.a.Component);k.defaultProps={color:d.b.hex.accent,monochrome:!0};a.default=y()(Object(v.b)((function(e,a){var t=a.defination;return{auth:e.auth,cache:t?e.cache.data[t.name+"_aggregates"]:null,api:t&&e.api[t.name]?e.api[t.name]:{}}}),{apiCallRequest:A.hb}))(k)},1472:function(e,a,t){"use strict";t.r(a);var s=t(6),r=t(9),n=t(11),i=t(30),o=t(19),c=t(20),l=t(836),g=t(1453),h=t(1473),d=t(24),u=t(57),b=t(10),p=t(7),m=t(26),j=t(1),f=t.n(j),O=t(414),v=t(18),x=t(44),y=t.n(x),A=t(21),C=(t(35),t(63)),M=t(0),k=function(e){Object(o.a)(t,e);var a=Object(c.a)(t);function t(e){var s;return Object(r.a)(this,t),(s=a.call(this,e)).state={loading:!0,load_error:!1,aggregate:"status",aggregates:[],chart_data:{labels:[],datasets:[{data:[]}]},aggregateMenuEl:null},s.aggregatables=[],s.colors=[],s.handleShowAggregateMenu=function(e){var a=e.currentTarget;s.setState({aggregateMenuEl:a})},s.handleAggregateMenuItemClick=function(e){return function(a){s.setState({aggregateMenuEl:null}),s.loadAggregates({g:e})}},s.handleShowAggregateMenu=s.handleShowAggregateMenu.bind(Object(i.a)(s)),s.handleCloseAggregateMenu=s.handleCloseAggregateMenu.bind(Object(i.a)(s)),s}return Object(n.a)(t,[{key:"componentDidMount",value:function(){this.prepareForData(),this.loadAggregates(),this.prepareChartData()}},{key:"componentDidUpdate",value:function(e){Object.areEqual(this.props.defination,e.defination)?Object.areEqual(e.api,this.props.api)?Array.isArray(this.props.cache)?this.props.cache.equals(e.cache)||this.prepareChartData():Array.isArray(e.cache)&&(e.cache.equals(this.props.cache)||this.prepareChartData()):this.prepareChartData():(this.prepareForData(),this.loadAggregates())}},{key:"prepareForData",value:function(){var e=this.props,a=e.dynamic,t=e.monochrome,r=e.color,n=e.colors,i=e.defination,o=(e.service,e.aggregate),c=e.onResolveAggregates;if(a&&!JSON.isEmpty(i)){this.aggregatables=[];for(var l=0,g=Object.entries(i.scope.columns);l<g.length;l++){var h=Object(s.a)(g[l],2),d=h[0],u=h[1];u.possibilities&&this.aggregatables.push({name:d,label:u.label})}}if(!o&&this.aggregatables.length>0&&(o=this.aggregatables[0].name,c&&c(i.name,this.aggregatables)),a)if(this.state.aggregate=o,t){var b=this.aggregatables.length>0?this.aggregatables.length:1,p=C.d.monochromeColorScheme(r,b);this.colors=p}else if(n)this.colors=n;else{var m=this.aggregatables.length>0?this.aggregatables.length:1,j=C.d.rotationColorScheme(r,m);this.colors=j}}},{key:"prepareChartData",value:function(){var e=this.props,a=e.monochrome,t=e.color,s=e.colors,r=(e.aggregate,e.defination),n=(e.service,e.auth),i=e.onLoadAggregates,o=e.cache,c=e.api;if(Array.isArray(o)){var l=r.scope.columns[this.state.aggregate]?r.scope.columns[this.state.aggregate].possibilities:{};if("function"===typeof l&&(l=l(!1,n.user)),a){var g=o.length>0?o.length:1,h=C.d.monochromeColorScheme(c.loading||c.error?"#595959":t,g);this.colors=h}else if(s)this.colors=c.loading||c.error?C.d.monochromeColorScheme("#595959"):s;else{var d=o.length>0?o.length:1,u=C.d.rotationColorScheme(c.loading||c.error?"#595959":t,d);this.colors=u}var b=[],p=[],m=[];if("object"===typeof l)for(var j=0;j<o.length;j++)o[j]._id in l&&(b.push(l[o[j]._id]),p.push(o[j].count),i&&m.push({name:o[j]._id,label:l[o[j]._id],count:o[j].count,color:this.colors[j]}));var f={labels:b,datasets:[{data:p,backgroundColor:this.colors}]};this.setState((function(e){return{aggregates:o,chart_data:f,loading:!1}})),i&&i(m)}else{var O={labels:[],datasets:[{data:[],backgroundColor:this.colors}]};this.setState((function(e){return{aggregates:o,chart_data:O,loading:!1}})),i&&i([])}}},{key:"loadAggregates",value:function(e){var a=this.props,t=a.apiCallRequest,s=a.defination;e||(e={g:this.state.aggregate});var r="g"in e?e.g:"group"in e&&e.group;this.setState((function(e){return{aggregate:r}})),s&&t(s.name+"_aggregates",{uri:s.endpoint,type:"aggregates",params:e,data:{},cache:!0})}},{key:"handleCloseAggregateMenu",value:function(){this.setState({aggregateMenuEl:null})}},{key:"render",value:function(){var e,a=this,t=this.props,s=t.className,r=(t.aggregate,t.dynamic),n=t.defination,i=(t.service,t.showTitle),o=t.showMenu,c=t.api;t.cache;return!JSON.isEmpty(n)&&Object(M.jsx)(b.a,{className:s+" p-0 m-0",children:Object(M.jsx)(p.a,{xs:12,className:"p-0 m-0",children:Object(M.jsxs)(b.a,{className:"p-0 m-0",children:[Object(M.jsxs)(b.a,{className:"p-0 m-0",children:[(o||i)&&Object(M.jsx)(p.a,{xs:12,children:Object(M.jsxs)(b.a,{children:[i&&!o&&Object(M.jsx)(p.a,{xs:12,children:Object(M.jsxs)(m.a,{variant:"body1",fullWidth:!0,children:[n.scope.columns[this.state.aggregate]?n.scope.columns[this.state.aggregate].label:"Unknown"," ","Aggregate"]})}),r&&o&&Object(M.jsxs)(p.a,{className:"p-0 m-0",xs:12,children:[Object(M.jsxs)(u.a,{"aria-controls":"aggregate-menu","aria-haspopup":"true",onClick:this.handleShowAggregateMenu,className:"float-right",size:"md","aria-label":"Aggregate Menu",children:[(null===(e=n.scope)||void 0===e?void 0:e.columns[this.state.aggregate])?n.scope.columns[this.state.aggregate].label:"Unknown"," ","Aggregate",Object(M.jsx)(h.a,{})]}),Object(M.jsx)(l.a,{id:"surveys-aggregate-menu",anchorEl:this.state.aggregateMenuEl,keepMounted:!0,open:Boolean(this.state.aggregateMenuEl),onClose:this.handleCloseAggregateMenu,children:this.aggregatables.map((function(e,t){return Object(M.jsx)(g.a,{onClick:a.handleAggregateMenuItemClick(e.name),children:e.label+" Aggregate"},"aggregate_"+e.name)}))})]})]})}),Object(M.jsx)(p.a,{className:"p-0 m-0",xs:12,children:Array.isArray(this.state.chart_data.labels)&&this.state.chart_data.labels.length>0?Object(M.jsx)(O.a,{data:this.state.chart_data,options:{maintainAspectRatio:!1,scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}}):Object(M.jsxs)(b.a,{className:"p-0 m-0",justify:"center",alignItems:"center",children:[Object(M.jsx)("img",{alt:"Empty Aggregates",className:"m-8 w-9/12",src:"https://realfield.nyc3.cdn.digitaloceanspaces.com/public/img/empty-state-table.svg"}),Object(M.jsxs)(m.a,{className:"mt-4",color:"grey",variant:"body2",fullWidth:!0,children:["No"," ",n.scope.columns[this.state.aggregate]?n.scope.columns[this.state.aggregate].label:""," ","Aggregates"]})]})})]}),c.complete&&c.error&&Object(M.jsx)(b.a,{children:Object(M.jsx)(p.a,{xs:12,children:Object(M.jsx)(m.a,{color:"error",variant:"body2",fullWidth:!0,children:"An error occured. \n "+c.error.msg})})})]})})})}}]),t}(f.a.Component);k.defaultProps={color:d.b.hex.accent,monochrome:!0};a.default=y()(Object(v.b)((function(e,a){var t=a.defination;return{auth:e.auth,cache:t?e.cache.data[t.name+"_aggregates"]:null,api:t&&e.api[t.name]?e.api[t.name]:{}}}),{apiCallRequest:A.hb}))(k)},1473:function(e,a,t){"use strict";var s=t(37),r=t(0);a.a=Object(s.a)(Object(r.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVert")},1474:function(e,a,t){"use strict";var s=t(45);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=s(t(50)),n=t(0),i=(0,r.default)((0,n.jsx)("path",{d:"m9.17 6 2 2H20v10H4V6h5.17M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"}),"FolderOutlined");a.default=i},1481:function(e,a,t){"use strict";t.r(a);var s=t(6),r=t(9),n=t(11),i=t(30),o=t(19),c=t(20),l=t(516),g=t(836),h=t(1453),d=t(1474),u=t.n(d),b=t(490),p=t.n(b),m=t(24),j=t(72),f=t(650),O=t(76),v=t(321),x=t(189),y=t(190),A=t(10),C=t(7),M=t(26),k=t(1),S=t.n(k),N=t(18),_=t(44),E=t.n(_),w=t(1471),D=t(1472),q=t(35),I=t(32),L=t(0),z=function(e){Object(o.a)(t,e);var a=Object(c.a)(t);function t(e){var n;Object(r.a)(this,t),(n=a.call(this,e)).state={context:null,defination:!1,definations:{},aggregates:[],menuAnchorEl:null},n.handleMenuOpen=function(e){var a=e.currentTarget;n.setState((function(e){return{menuAnchorEl:a}}))},n.handleDefinationChange=function(e){return function(a){n.setState((function(a){return{menuAnchorEl:null,defination:a.definations[e]}}))}};for(var o=e.auth,c=e.contexts,l={},g=0,h=Object.entries(I);g<h.length;g++){var d=Object(s.a)(h[g],2),u=d[0],b=d[1];!b.access.restricted(o.user)&&b.access.view.summary(o.user)&&c.includes(u)&&(l[u]=b,n.state.defination||(n.state.defination=b))}return n.state.definations=l,n.handleMenuOpen=n.handleMenuOpen.bind(Object(i.a)(n)),n.handleMenuClose=n.handleMenuClose.bind(Object(i.a)(n)),n.handleDefinationChange=n.handleDefinationChange.bind(Object(i.a)(n)),n.handleOnAggregatesLoad=n.handleOnAggregatesLoad.bind(Object(i.a)(n)),n}return Object(n.a)(t,[{key:"handleMenuClose",value:function(){this.setState((function(e){return{menuAnchorEl:null}}))}},{key:"handleOnAggregatesLoad",value:function(e){this.setState((function(a){return{aggregates:e}}))}},{key:"render",value:function(){var e=this,a=this.props,t=a.classes,r=a.auth,n=a.contexts,i=(a.gridSize,a.theme,a.chartType);return Object(L.jsxs)(O.a,{children:[Object(L.jsx)(y.a,{avatar:Object(L.jsx)(j.a,{"aria-label":this.state.defination.label,style:{background:this.state.defination.color},children:this.state.defination.icon}),title:this.state.defination.label,subheader:"Aggregates Overview",action:n.length>1&&Object(L.jsxs)("div",{children:[Object(L.jsxs)(l.a,{"aria-label":"menuicon",color:"primary",className:null===t||void 0===t?void 0:t.margin,onClick:this.handleMenuOpen,children:[" ",Object(L.jsx)(p.a,{})," "]}),Object(L.jsx)(g.a,{id:"definations-menu",anchorEl:this.state.menuAnchorEl,keepMounted:!0,open:Boolean(this.state.menuAnchorEl),onClose:this.handleMenuClose,children:Object.entries(this.state.definations).map((function(a,t){var i=Object(s.a)(a,2),o=i[0],c=i[1];return!c.access.restricted(r.user)&&c.access.view.summary(r.user)&&n.includes(o)&&Object(L.jsxs)(h.a,{onClick:e.handleDefinationChange(o),children:[" ",c.label," "]},"aggregate-"+c.name)}))})]})}),Object(L.jsx)(x.a,{className:"p-0 m-0",children:Object(L.jsx)(A.a,{className:null===t||void 0===t?void 0:t.fullHeight,direction:"column",justify:"center",alignItems:"center",children:Object(L.jsxs)(A.a,{className:"p-0 m-0",children:[Object(L.jsx)(C.a,{xs:12,children:Object(L.jsxs)(A.a,{style:{height:"100%"},direction:"column",justify:"center",alignItems:"center",children:["pie"===i&&Object(L.jsx)(w.default,{defination:this.state.defination,service:q.a.getContextRequests(this.state.defination.endpoint),color:this.state.defination.color?this.state.defination.color:m.b.hex.primary,onLoadAggregates:this.handleOnAggregatesLoad,monochrome:!0,showTitle:!0,showMenu:!0,dynamic:!0}),"bar"===i&&Object(L.jsx)(D.default,{defination:this.state.defination,service:q.a.getContextRequests(this.state.defination.endpoint),color:this.state.defination.color?this.state.defination.color:m.b.hex.primary,onLoadAggregates:this.handleOnAggregatesLoad,monochrome:!0,showTitle:!0,showMenu:!0,dynamic:!0})]})}),Object(L.jsx)(C.a,{xs:12,children:Object(L.jsxs)(A.a,{className:"center",direction:"column",justify:"center",alignItems:"center",children:[Object(L.jsx)(M.a,{color:"grey",variant:"body2",gutterBottom:!0,children:"Aggregates Index"}),Object(L.jsx)("br",{}),Object(L.jsx)("br",{}),Object(L.jsx)("br",{}),0===this.state.aggregates.length&&Object(L.jsx)(u.a,{fontSize:"large"}),this.state.aggregates.map((function(a,t){return Object(L.jsx)(f.a,{badgeContent:a.count,color:a.color,textColor:m.b.hex.inverse,children:Object(L.jsx)(M.a,{variant:"subtitle1",component:"h3",gutterBottom:!0,children:a.label})},e.state.defination.name+"-aggregate-"+t)}))]})})]})})}),Object(L.jsx)(v.a,{children:Object(L.jsx)(A.a,{className:"p-0 m-0",children:Object(L.jsx)(C.a,{xs:12,children:Object(L.jsxs)(M.a,{variant:"body2",children:[this.state.defination.label," by Aggregates"]})})})})]})}}]),t}(S.a.Component);z.defaultProps={gridSize:12,chartType:"pie",contexts:["commissions","surveys","responses"],aggregates:[]};a.default=E()(Object(N.b)((function(e){return{auth:e.auth}}),{}))(z)}}]);
//# sourceMappingURL=3.a8cbe549.chunk.js.map