{"version":3,"sources":["views/widgets/Overview/CountsOverview/index.jsx"],"names":["Overview","props","state","counts","aggregates","contexts","cache","this","Object","entries","map","context","type","title","query","icon","description","value","definations","includes","loadData","JSON","isJSON","apiCallRequest","contextDefination","name","uri","endpoint","params","data","className","auth","theme","wrapperSize","rootClassName","classNames","defaultValues","count","views_data","rest","label","cursor","size","resolveValue","view","xs","md","elevation","style","backgroundColor","palette","background","paper","variant","color","text","disabled","fontWeight","Function","isFunction","accent","main","fontSize","default","Component","defaultProps","showGraphs","surveys","commissions","responses","queries","tracks","applications","users","group","role","new_value","Array","isArray","entry","_id","length","humanize","compose","connect","withTheme"],"mappings":"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","file":"static/js/14.bcb3f990.chunk.js","sourcesContent":["/** @format */\n\n\nimport classNames from \"classnames\";\nimport Card from \"components/Card\";\nimport CardActions from \"components/Card/CardActions\";\nimport CardContent from \"components/Card/CardContent\";\nimport CardHeader from \"components/Card/CardHeader\";\nimport GridContainer from \"components/Grid/GridContainer\";\nimport GridItem from \"components/Grid/GridItem\";\nimport Typography from \"components/Typography\"\nimport PropTypes from \"prop-types\"\nimport React, { Component } from \"react\"\nimport { connect } from \"react-redux\"\nimport { withTheme } from \"@mui/styles\"\nimport compose from \"recompose/compose\"\nimport { apiCallRequest } from \"state/actions\"\nimport * as definations from \"definations\"\n\n//\n\nclass Overview extends Component {\n\tstate = {\n\t\tcounts: {},\n\t\taggregates: {},\n\t}\n\n\tconstructor(props) {\n\t\tsuper(props)\n\t\tconst { contexts, cache } = this.props\n\t}\n\n\tcomponentDidMount() {\n\t\tconst { contexts } = this.props\n\t\tObject.entries(contexts).map(([context, { title, type, icon, description, query, value, ...rest }]) => {\n\t\t\tif (definations[context]) {\n\t\t\t\tif ([\"count\", \"aggregates\"].includes(type) && !value) {\n\t\t\t\t\tthis.loadData(context, type, JSON.isJSON(query) ? query : {})\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n\n\tloadData(context, type, query) {\n\t\tconst { apiCallRequest } = this.props\n\t\tlet contextDefination = definations[context]\n\t\tif (contextDefination) {\n\t\t\tapiCallRequest(contextDefination.name + (type !== \"records\" ? \"_\" + type : \"\"), {\n\t\t\t\turi: contextDefination.endpoint,\n\t\t\t\ttype: type,\n\t\t\t\tparams: JSON.isJSON(query) ? query : {},\n\t\t\t\tdata: {},\n\t\t\t\tcache: true,\n\t\t\t}) /*.then(count => {\n\t\t\t\tthis.setState(prevState=>({\n\t\t\t\t\tcounts: {\n\t\t\t\t\t\t...prevState.counts,\n\t\t\t\t\t\t[contextDefination.name]: count,\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t});*/\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { className, auth, cache, contexts, theme, wrapperSize } = this.props\n\t\tconst rootClassName = classNames(className)\n\t\tconst defaultValues = {\n\t\t\tcount: 0,\n\t\t\taggregates: {},\n\t\t}\n\t\tlet views_data = {}\n\n\t\tif (JSON.isJSON(contexts)) {\n\t\t\tObject.entries(contexts).map(([context, { title, type, icon, description, query, value, ...rest }]) => {\n\t\t\t\tif (definations[context]) {\n\t\t\t\t\tif (JSON.isJSON(cache.data) && !value) {\n\t\t\t\t\t\tif (context + \"_\" + type in cache.data) {\n\t\t\t\t\t\t\tviews_data[context] = {\n\t\t\t\t\t\t\t\t...rest,\n\t\t\t\t\t\t\t\ttype: type,\n\t\t\t\t\t\t\t\ttitle: title ? title : definations[context].label,\n\t\t\t\t\t\t\t\tdescription: description ? description : (type == \"count\" ? \"Total \" : \"\") + definations[context].label,\n\t\t\t\t\t\t\t\ticon: icon ? icon : definations[context].icon,\n\t\t\t\t\t\t\t\tquery: JSON.isJSON(query) ? query : {},\n\t\t\t\t\t\t\t\tvalue: cache.data[context + \"_\" + type],\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tviews_data[context] = {\n\t\t\t\t\t\t\t\t...rest,\n\t\t\t\t\t\t\t\ttype: type,\n\t\t\t\t\t\t\t\ttitle: title ? title : definations[context].label,\n\t\t\t\t\t\t\t\tdescription: description ? description : (type == \"count\" ? \"Total \" : \"\") + definations[context].label,\n\t\t\t\t\t\t\t\ticon: icon ? icon : definations[context].icon,\n\t\t\t\t\t\t\t\tquery: JSON.isJSON(query) ? query : {},\n\t\t\t\t\t\t\t\tvalue: defaultValues[type],\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (value) {\n\t\t\t\t\t\tviews_data[context] = {\n\t\t\t\t\t\t\t...rest,\n\t\t\t\t\t\t\ttype: type,\n\t\t\t\t\t\t\ttitle: title ? title : definations[context].label,\n\t\t\t\t\t\t\tdescription: description ? description : (type == \"count\" ? \"Total \" : \"\") + definations[context].label,\n\t\t\t\t\t\t\ticon: icon ? icon : definations[context].icon,\n\t\t\t\t\t\t\tquery: JSON.isJSON(query) ? query : {},\n\t\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tviews_data[context] = {\n\t\t\t\t\t\t\t...rest,\n\t\t\t\t\t\t\ttype: type,\n\t\t\t\t\t\t\ttitle: title ? title : definations[context].label,\n\t\t\t\t\t\t\tdescription: description ? description : (type == \"count\" ? \"Total \" : \"\") + definations[context].label,\n\t\t\t\t\t\t\ticon: icon ? icon : definations[context].icon,\n\t\t\t\t\t\t\tquery: JSON.isJSON(query) ? query : {},\n\t\t\t\t\t\t\tvalue: defaultValues[type],\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\treturn (\n\t\t\t<GridContainer className=\"p-0 m-0\" className={rootClassName}>\n\t\t\t\t{Object.entries(views_data).map(\n\t\t\t\t\t([context, { title, type, icon, description, size, query, value, resolveValue, view, ...rest }], cursor) => (\n\t\t\t\t\t\t<GridItem xs={12} md={size ? size : wrapperSize >= 8 ? 3 : 6} key={context + \"-numbers\"}>\n\t\t\t\t\t\t\t<Card elevation={1} style={{ backgroundColor: theme.palette.background.paper }}>\n\t\t\t\t\t\t\t\t<CardHeader\n\t\t\t\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\t\t\t\t<Typography variant=\"h5\" style={{ color: theme.palette.text.disabled, fontWeight: \"500\" }}>\n\t\t\t\t\t\t\t\t\t\t\t{Function.isFunction(title) ? title(value) : title}\n\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t\t<CardContent className=\"p-0 m-0\">\n\t\t\t\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t\t\t\t<GridItem xs={12} className=\"flex items-center justify-center\">\n\t\t\t\t\t\t\t\t\t\t\t{type === \"count\" && (\n\t\t\t\t\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"h2\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ color: theme.palette.accent.main, fontWeight: \"700\", fontSize: \"2rem\" }}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t{value}{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t{type === \"aggregates\" && !view && Function.isFunction(resolveValue) && (\n\t\t\t\t\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"h2\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ color: theme.palette.accent.main, fontWeight: \"700\", fontSize: \"2rem\" }}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t{resolveValue(value)}{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t\t</CardContent>\n\n\t\t\t\t\t\t\t\t<CardActions>\n\t\t\t\t\t\t\t\t\t<Typography variant=\"body2\" style={{ color: theme.palette.text.default }}>\n\t\t\t\t\t\t\t\t\t\t{Function.isFunction(description) ? description(value) : description}\n\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t</CardActions>\n\t\t\t\t\t\t\t</Card>\n\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t)\n\t\t\t\t)}\n\t\t\t</GridContainer>\n\t\t)\n\t}\n}\n\nOverview.propTypes = {\n\tclassName: PropTypes.string,\n\n\tcontexts: PropTypes.object.isRequired,\n\tshowGraphs: PropTypes.bool,\n\twrapperSize: PropTypes.number,\n}\n\nOverview.defaultProps = {\n\tshowGraphs: true,\n\twrapperSize: 12,\n\tcontexts: {\n\t\tsurveys: {\n\t\t\ttype: \"count\",\n\t\t\tquery: {},\n\t\t},\n\t\tcommissions: {\n\t\t\ttype: \"count\",\n\t\t\tquery: {},\n\t\t},\n\t\tresponses: {\n\t\t\ttype: \"count\",\n\t\t\tquery: {},\n\t\t},\n\t\tqueries: {\n\t\t\ttype: \"count\",\n\t\t\tquery: {},\n\t\t},\n\t\ttracks: {\n\t\t\ttype: \"count\",\n\t\t\tquery: {},\n\t\t},\n\t\tapplications: {\n\t\t\ttype: \"count\",\n\t\t\tquery: {},\n\t\t},\n\t\tusers: {\n\t\t\ttype: \"aggregates\",\n\t\t\tquery: {\n\t\t\t\tgroup: \"gender\",\n\t\t\t\trole: \"collector\",\n\t\t\t},\n\t\t\ttitle: value => {\n\t\t\t\tlet new_value = \"\"\n\t\t\t\tif (Array.isArray(value)) {\n\t\t\t\t\tvalue.map(entry => {\n\t\t\t\t\t\tif (entry._id) {\n\t\t\t\t\t\t\tnew_value = new_value + (new_value.length > 0 ? \" / \" : \"\") + entry._id.humanize()\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\treturn new_value\n\t\t\t},\n\t\t\tdescription: value => {\n\t\t\t\tlet new_value = \"\"\n\t\t\t\tif (Array.isArray(value)) {\n\t\t\t\t\tvalue.map(entry => {\n\t\t\t\t\t\tif (entry._id) {\n\t\t\t\t\t\t\tnew_value = new_value + (new_value.length > 0 ? \" / \" : \"\") + entry._id.humanize()\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\treturn \"Total \" + new_value\n\t\t\t},\n\t\t\tresolveValue: value => {\n\t\t\t\tlet new_value = \"\"\n\t\t\t\tif (Array.isArray(value)) {\n\t\t\t\t\tvalue.map(entry => {\n\t\t\t\t\t\tif (entry._id && entry.count) {\n\t\t\t\t\t\t\tnew_value = new_value + (new_value.length > 0 ? \" / \" : \"\") + entry.count\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\treturn new_value\n\t\t\t},\n\t\t},\n\t},\n}\n\nconst mapStateToProps = state => ({\n\tauth: state.auth,\n\tcache: state.cache,\n})\n\nexport default compose(connect(mapStateToProps, { apiCallRequest }), withTheme)(Overview)\n"],"sourceRoot":""}