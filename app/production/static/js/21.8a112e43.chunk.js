(this.webpackJsonpdashboard=this.webpackJsonpdashboard||[]).push([[21],{2045:function(e,a,t){"use strict";var r=t(0),s=t.n(r),n=t(24);a.a=Object(n.a)(s.a.createElement("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVert")},2047:function(e,a,t){"use strict";t.r(a);var r=t(8),s=t(17),n=t(26),g=t(22),o=t(20),l=t(19),i=t(997),c=t(817),h=t(41),u=t.n(h),p=t(2045),m=t(288),d=t.n(m),b=t(11),f=t(29),v=t(12),y=t(5),A=t(21),E=t(0),C=t.n(E),k=t(306),M=t(25),S=t(43),w=t.n(S),_=t(13),j=t(31),N=t(33);k.d.global.legend.display=!1;var O=function(e){Object(o.a)(t,e);var a=Object(l.a)(t);function t(e){var r;return Object(s.a)(this,t),(r=a.call(this,e)).state={loading:!0,load_error:!1,aggregate:"status",aggregates:[],chart_data:{labels:[],datasets:[{data:[]}]},aggregateMenuEl:null},r.aggregatables=[],r.colors=[],r.handleShowAggregateMenu=function(e){var a=e.currentTarget;r.setState({aggregateMenuEl:a})},r.handleAggregateMenuItemClick=function(e){return function(a){r.setState({aggregateMenuEl:null}),r.loadAggregates({g:e})}},r.handleShowAggregateMenu=r.handleShowAggregateMenu.bind(Object(g.a)(r)),r.handleCloseAggregateMenu=r.handleCloseAggregateMenu.bind(Object(g.a)(r)),r}return Object(n.a)(t,[{key:"componentDidMount",value:function(){this.prepareForData(),this.loadAggregates(),this.prepareChartData()}},{key:"componentDidUpdate",value:function(e){Object.areEqual(this.props.defination,e.defination)?Object.areEqual(e.api,this.props.api)?Array.isArray(this.props.cache)?this.props.cache.equals(e.cache)||this.prepareChartData():Array.isArray(e.cache)&&(e.cache.equals(this.props.cache)||this.prepareChartData()):this.prepareChartData():(this.prepareForData(),this.loadAggregates())}},{key:"prepareForData",value:function(){var e=this.props,a=e.dynamic,t=e.monochrome,s=e.color,n=e.colors,g=e.defination,o=(e.service,e.aggregate),l=e.onResolveAggregates;if(a){this.aggregatables=[];for(var i=0,c=Object.entries(g.scope.columns);i<c.length;i++){var h=Object(r.a)(c[i],2),u=h[0],p=h[1];p.possibilities&&this.aggregatables.push({name:u,label:p.label})}}if(!o&&this.aggregatables.length>0&&(o=this.aggregatables[0].name,l&&l(g.name,this.aggregatables)),a)if(this.state.aggregate=o,t){var m=this.aggregatables.length>0?this.aggregatables.length:1,d=N.e.monochromeColorScheme(s,m);this.colors=d}else if(n)this.colors=n;else{var b=this.aggregatables.length>0?this.aggregatables.length:1,f=N.e.rotationColorScheme(s,b);this.colors=f}}},{key:"prepareChartData",value:function(){var e=this.props,a=e.monochrome,t=e.color,r=e.colors,s=(e.aggregate,e.defination),n=(e.service,e.auth),g=e.onLoadAggregates,o=e.cache,l=e.api;if(Array.isArray(o)){var i=s.scope.columns[this.state.aggregate]?s.scope.columns[this.state.aggregate].possibilities:{};if("function"===typeof i&&(i=i(!1,n.user)),a){var c=o.length>0?o.length:1,h=N.e.monochromeColorScheme(l.loading||l.error?"#595959":t,c);this.colors=h}else if(r)this.colors=l.loading||l.error?N.e.monochromeColorScheme("#595959"):r;else{var u=o.length>0?o.length:1,p=N.e.rotationColorScheme(l.loading||l.error?"#595959":t,u);this.colors=p}var m=[],d=[],b=[];if("object"===typeof i)for(var f=0;f<o.length;f++)o[f]._id in i&&(m.push(i[o[f]._id]),d.push(o[f].count),g&&b.push({name:o[f]._id,label:i[o[f]._id],count:o[f].count,color:this.colors[f]}));var v={labels:m,datasets:[{data:d,backgroundColor:this.colors}]};this.setState((function(e){return{aggregates:o,chart_data:v,loading:!1}})),g&&g(b)}else{var y={labels:[],datasets:[{data:[],backgroundColor:this.colors}]};this.setState((function(e){return{aggregates:o,chart_data:y,loading:!1}})),g&&g([])}}},{key:"loadAggregates",value:function(e){var a=this.props,t=a.apiCallRequest,r=a.defination;e||(e={g:this.state.aggregate});var s="g"in e?e.g:"group"in e&&e.group;this.setState((function(e){return{aggregate:s}})),r&&t(r.name+"_aggregates",{uri:r.endpoint,type:"aggregates",params:e,data:{},cache:!0})}},{key:"handleCloseAggregateMenu",value:function(){this.setState({aggregateMenuEl:null})}},{key:"render",value:function(){var e=this,a=this.props,t=a.classes,r=a.className,s=(a.aggregate,a.dynamic),n=a.defination,g=(a.service,a.showTitle),o=a.showMenu,l=a.api;a.cache;return C.a.createElement(v.a,{className:r+" p-0 m-0"},C.a.createElement(y.a,{xs:12,className:"p-0 m-0"},C.a.createElement(v.a,{className:"p-0 m-0"},C.a.createElement(v.a,{className:"p-0 m-0"},(o||g)&&C.a.createElement(y.a,{xs:12},C.a.createElement(v.a,null,g&&!o&&C.a.createElement(y.a,{xs:12},C.a.createElement(A.a,{color:"default",variant:"body1",fullWidth:!0,center:!0},n.scope.columns[this.state.aggregate]?n.scope.columns[this.state.aggregate].label:"Unknown"," ","Aggregate")),s&&o&&C.a.createElement(y.a,{className:"p-0 m-0",xs:12},C.a.createElement(f.a,{"aria-controls":"aggregate-menu","aria-haspopup":"true",onClick:this.handleShowAggregateMenu,color:"default",className:"float-right",size:"md","aria-label":"Aggregate Menu",simple:!0},n.scope.columns[this.state.aggregate]?n.scope.columns[this.state.aggregate].label:"Unknown"," ","Aggregate",C.a.createElement(p.a,null)),C.a.createElement(i.a,{id:"surveys-aggregate-menu",anchorEl:this.state.aggregateMenuEl,keepMounted:!0,open:Boolean(this.state.aggregateMenuEl),onClose:this.handleCloseAggregateMenu},this.aggregatables.map((function(a,t){return C.a.createElement(c.a,{onClick:e.handleAggregateMenuItemClick(a.name),key:"aggregate_"+a.name},a.label+" Aggregate")})))))),C.a.createElement(y.a,{className:"p-0 m-0",xs:12},Array.isArray(this.state.chart_data.labels)&&this.state.chart_data.labels.length>0?C.a.createElement(k.a,{data:this.state.chart_data,options:{maintainAspectRatio:!1,scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}}):C.a.createElement(v.a,{className:"p-0 m-0",justify:"center",alignItems:"center"},C.a.createElement("img",{alt:"Empty Aggregates",className:t.emptyImage,src:d.a}),C.a.createElement(A.a,{className:t.emptyText,color:"grey",variant:"body2",center:!0,fullWidth:!0},"No"," ",n.scope.columns[this.state.aggregate]?n.scope.columns[this.state.aggregate].label:""," ","Aggregates")))),l.complete&&l.error&&C.a.createElement(v.a,null,C.a.createElement(y.a,{xs:12},C.a.createElement(A.a,{color:"error",variant:"body2",center:!0,fullWidth:!0},"An error occured. \n "+l.error.msg))))))}}]),t}(C.a.Component);O.defaultProps={color:b.b.hex.accent,monochrome:!0};a.default=w()(u()((function(e){return{root:{padding:"0"},data_actions_wrapper:{display:"inline-block",whiteSpace:"nowrap","& > *":{display:"inline-block",whiteSpace:"nowrap"}},valueChip:{margin:e.spacing(.5)},emptyImage:{maxWidth:100,width:"70%",margin:e.spacing(2)},emptyText:{marginTop:e.spacing(3)}}})),Object(M.b)((function(e,a){var t=a.defination;return{auth:e.auth,cache:t?e.cache.data[t.name+"_aggregates"]:null,api:t&&e.api[t.name]?e.api[t.name]:{}}}),{apiCallRequest:_.hb}),j.a)(O)}}]);
//# sourceMappingURL=21.8a112e43.chunk.js.map