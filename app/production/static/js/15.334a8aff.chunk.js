(this.webpackJsonpdashboard=this.webpackJsonpdashboard||[]).push([[15,20],{1347:function(e,t,a){e.exports=a.p+"static/media/empty-state-table.cdb06dd9.svg"},1366:function(e,t,a){"use strict";var n=a(2),r=a(14),i=a(26),o=a(27),s=a(18),l=a(17),c=a(41),d=a.n(c),u=(a(1347),a(263)),p=a(22),m=a(16),h=a(20),f=a(0),g=a.n(f),v=a(35),b=a(64),y=a.n(b),w=a(11),x=a(50),E=function(e){Object(s.a)(a,e);var t=Object(l.a)(a);function a(e){var i;Object(r.a)(this,a),(i=t.call(this,e)).state={loading:!0,load_error:!1,defination:null,service:null,query:{p:1},records:[]},i.handleDeleteItemConfirm=function(e){return function(t){var a=i.props,n=a.openDialog,r=a.closeDialog;Object(o.a)(i);n({title:"Confirm Delete",body:"Are you sure you want delete entry? This action might be irreversible",actions:{cancel:{text:"Cancel",color:"default",onClick:function(){return r()}},delete:{text:"Delete",color:"error",onClick:function(t){r(),i.handleDeleteItem(e)}}}})}},i.handleDeleteItem=function(e){return function(e){var t=i.props,a=t.openDialog,n=t.closeDialog;a({title:"Deleting safely",body:"Please wait. Executing safe delete...",actions:{close:{text:"Close",color:"default",onClick:function(){return n()}}}})}};var s=e.defination,l=e.service,c=e.query;return i.state.defination=s,i.state.service=l,i.state.query=c?Object(n.a)(Object(n.a)({},c),{},{p:1}):{p:1},i.handleDeleteItemConfirm=i.handleDeleteItemConfirm.bind(Object(o.a)(i)),i.handleDeleteItem=i.handleDeleteItem.bind(Object(o.a)(i)),i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.cache,a=e.defination;this.mounted=!0,this.loadContext(),this.prepareData(Array.isArray(t.data[a.name])?t.data[a.name]:[])}},{key:"getSnapshotBeforeUpdate",value:function(e){this.mounted=!1;var t=this.props;t.cache,t.defination;return{contextReloadRequired:!Object.areEqual(e.defination,this.props.defination),dataReloadRequired:!Object.areEqual(e.query,this.props.query),dataPreparationRequired:!1}}},{key:"componentDidUpdate",value:function(e,t,a){if(a.contextReloadRequired&&(this.loadContext(),this.prepareData()),a.dataReloadRequired){var r=this.props.query;this.setState({query:r?Object(n.a)(Object(n.a)({},r),{},{p:1}):{p:1}},this.loadData)}}},{key:"loadContext",value:function(){var e=this.props,t=e.defination,a=e.service,r=e.query;e.cache;t&&this.setState({defination:t,service:a,query:r?Object(n.a)(Object(n.a)({},r),{},{p:1}):{p:1},loading:!1},this.loadData)}},{key:"loadData",value:function(){var e=this,t=this.props,a=(t.auth,t.cache),n=t.defination,r=t.apiCallRequest,i=t.cache_data,o=t.onLoadData,s=t.load_data;if(n)if(s)r(n.name,{uri:n.endpoint,type:"records",params:this.state.query,data:{},cache:i}).then((function(t){Function.isFunction(o)&&o(t),e.prepareData(t)})).catch((function(t){e.setState((function(e){return{records:[],load_error:t,loading:!1}}))}));else{var l=Array.isArray(a.data[n.name])?a.data[n.name]:[];Function.isFunction(o)&&o(l),this.prepareData(l)}else this.setState((function(e){return{records:[],load_error:{msg:"No Context defination or provided"},loading:!1}}))}},{key:"prepareData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=this.props,n=(a.auth,a.cache),r=a.defination,i=Array.isArray(t)?t:Array.isArray(n.data[r.name])?n.data[r.name]:[];r&&r.scope.columns;Function.isFunction(r.views.listing.googlemapview.resolveData)&&r.views.listing.googlemapview.resolveData(i,!0).then((function(t){e.setState((function(e){return{records:t,loading:!1}}))})).catch((function(t){e.setState((function(e){return{records:[],loading:!1}}))}))}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.googleMapProps,n=e.api,r=e.defination;return g.a.createElement(p.a,{className:t.root},g.a.createElement(m.a,{className:"p-0 m-0",xs:12},g.a.createElement(p.a,{className:"p-0 m-0"},g.a.createElement(p.a,{className:"p-0 m-0"},g.a.createElement(m.a,{className:"p-0 m-0",xs:12},g.a.createElement(p.a,{className:"p-0 m-0"},g.a.createElement(m.a,{xs:12,className:"p-0 m-0"},g.a.createElement(u.a,Object.assign({defaultZoom:12,zoom:12},a,{polylines:r&&"polyline"===r.views.listing.googlemapview.type?this.state.records:[],markers:"marker"===r.views.listing.googlemapview.type?this.state.records:[],circles:"circle"===r.views.listing.googlemapview.type?this.state.records:[],showCurrentPosition:!0})))))),!!n&&(n.complete&&n.error)&&g.a.createElement(p.a,null,g.a.createElement(m.a,{xs:12},g.a.createElement(h.a,{color:"error",variant:"body2",center:!0,fullWidth:!0},"An error occured. \n "+n.error.msg))))))}}]),a}(g.a.Component);E.defaultProps={googleMapProps:{mapHeight:900,showClientsPositions:!0,showCurrentPosition:!0},query:{},load_data:!0,cache_data:!0};y()(d()((function(e){return{root:{padding:"0"}}})),Object(v.b)((function(e,t){t.defination;return{auth:e.auth,cache:e.cache,api:e.api}}),{apiCallRequest:w.gb,openDialog:w.sb,closeDialog:w.pb}),x.a)(E)},1370:function(e,t,a){"use strict";var n=a(6),r=a(9),i=a.n(r),o=a(21),s=a(12),l=a(2),c=a(14),d=a(26),u=a(27),p=a(18),m=a(17),h=a(254),f=a(41),g=a.n(f),v=a(22),b=a(16),y=a(20),w=a(0),x=a.n(w),E=a(35),O=a(64),C=a.n(O),k=a(1574),_=a(1474),j=a(1475),D=a(212),N=a(629),q=a(1240),S=a(1442),R=a.n(S),A=a(1395),P=a.n(A),I=a(1386),M=a.n(I),F=a(1441),T=a.n(F),V=a(56),L=a(59),B=a(109),U=a(261),z=a.n(U),W=a(264),J=a.n(W),K=a(431),Y=a(1347),H=a.n(Y),Z=a(1301),X=a(1337),G=a(1628),Q=a(1925),$=a(1307),ee=a(1425),te=a.n(ee),ae=a(3),ne=a(43),re=a(434),ie=a(687),oe=a(435),se=a(436),le=a(92),ce=a(76),de=a(34),ue=a(45),pe=a(438),me=g()({indicator:{backgroundColor:ae.b.hex.accent}})(X.a),he=g()((function(e){return{root:{textTransform:"none",minWidth:50,fontWeight:e.typography.fontWeightRegular,marginRight:e.spacing(),"&:hover":{color:ae.b.hex.default,opacity:1},"&$selected":{color:ae.b.hex.accent,fontWeight:e.typography.fontWeightMedium},"&:focus":{color:ae.b.hex.accent}},selected:{}}}))((function(e){return x.a.createElement(Z.a,e)})),fe=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e)).calendarRef=x.a.createRef(),n.state={view:"month",view_title:(new Date).format(ce.b.dateformats.month),calendars:[],tasks:[],schedules:[]},n.handleChangeCalendarView=function(e,t){if(n.calendarRef.current){var a=n.calendarRef.current.getInstance().getDate().toDate();n.setState((function(e){return{view:t,view_title:"day"===t?a.format(ce.b.dateformats.date):"week"===t?a.format(ce.b.dateformats.week):a.format(ce.b.dateformats.month)}}))}else n.setState((function(e){return{view:t}}))},n.handleClickPrevButton=function(){if(n.calendarRef.current){var e=n.calendarRef.current.getInstance();e.prev();var t=e.getDate().toDate();n.setState((function(e){return{view_title:"day"===e.view?t.format(ce.b.dateformats.date):"week"===e.view?t.format(ce.b.dateformats.week):t.format(ce.b.dateformats.month)}}))}},n.handleClickNextButton=function(){if(n.calendarRef.current){var e=n.calendarRef.current.getInstance();e.next();var t=e.getDate().toDate();n.setState((function(e){return{view_title:"day"===e.view?t.format(ce.b.dateformats.date):"week"===e.view?t.format(ce.b.dateformats.week):t.format(ce.b.dateformats.month)}}))}},n.handleOnEditEntryClick=function(e){n.calendarRef.current},n.handleOnDeleteEntryClick=function(e){n.calendarRef.current};var r=e.theme,i=e.view,o=e.calendars,s=e.tasks,d=e.schedules,p=e.show_actions,m=e.icon,h=e.title,f=e.subtitle,g=e.icon_color,v=e.title_color,b=e.subtitle_color,y=e.calendarProps;return n.state=Object(l.a)(Object(l.a)({},n.state),{},{theme:r,view:i,view_title:"day"===i?(new Date).format(ce.b.dateformats.date):"week"===i?(new Date).format(ce.b.dateformats.week):(new Date).format(ce.b.dateformats.month),calendars:o,tasks:s,schedules:d,show_actions:p,icon:m,title:h,subtitle:f,icon_color:g,title_color:v,subtitle_color:b,calendarProps:y}),n.handleChangeCalendarView=n.handleChangeCalendarView.bind(Object(u.a)(n)),n.handleClickPrevButton=n.handleClickPrevButton.bind(Object(u.a)(n)),n.handleClickNextButton=n.handleClickNextButton.bind(Object(u.a)(n)),n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.initCalendarEvents()}},{key:"getSnapshotBeforeUpdate",value:function(e){return{refreshRequired:!Object.areEqual(e,this.props)}}},{key:"componentDidUpdate",value:function(e,t,a){var n=this.props,r=n.theme,i=n.view,o=n.calendars,s=n.tasks,l=n.schedules,c=n.show_actions,d=n.icon,u=n.title,p=n.subtitle,m=n.icon_color,h=n.title_color,f=n.subtitle_color,g=n.calendarProps;a.refreshRequired&&this.setState({theme:r,view:i,view_title:"day"===i?(new Date).format(ce.b.dateformats.date):"week"===i?(new Date).format(ce.b.dateformats.week):(new Date).format(ce.b.dateformats.month),calendars:o,tasks:s,schedules:l,show_actions:c,icon:d,title:u,subtitle:p,icon_color:m,title_color:h,subtitle_color:f,calendarProps:g},this.initCalendarEvents)}},{key:"initCalendarEvents",value:function(){var e=this.props,t=e.onSelect,a=e.onClickEntry,n=e.onClickEdit,r=e.onClickDelete,i=this.calendarRef.current.getInstance();i&&i.on({clickSchedule:function(e){de.e.isOfType(a,"function")&&a(e.schedule)},beforeCreateSchedule:function(e){de.e.isOfType(t,"function")&&t(e)},beforeUpdateSchedule:function(e){de.e.isOfType(n,"function")&&n(e)},beforeDeleteSchedule:function(e){de.e.isOfType(r,"function")&&r(e)}})}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.height,n=e.defaultView,r=e.disableDblClick,i=e.disableClick,o=e.isReadOnly,s=e.useDetailPopup,c=e.useCreationPopup,d=e.scheduleView,u=e.taskView,p=this.state,m=p.theme,h=p.view,f=p.view_title,g=p.calendars,w=p.tasks,E=p.schedules,O=(p.show_actions,p.icon),C=p.title,k=p.subtitle,_=p.icon_color,j=(p.title_color,p.subtitle_color,p.calendarProps),D=Object(l.a)({height:a+"px",defaultView:n,disableDblClick:r,disableClick:i,isReadOnly:o,useDetailPopup:s,useCreationPopup:c,scheduleView:d,taskView:u},j);return x.a.createElement(re.a,{elevation:0,outlineColor:"#cfd8dc"},x.a.createElement(se.a,{avatar:x.a.createElement(ne.a,{"aria-label":C,style:{background:_}},O),title:C,subheader:k}),x.a.createElement(oe.a,{className:"p-0 m-0"},x.a.createElement(v.a,{className:"p-0 m-0"},x.a.createElement(v.a,{className:"p-0 m-0"},x.a.createElement(b.a,{sm:6,md:4},x.a.createElement(me,{value:h,onChange:this.handleChangeCalendarView,indicatorColor:"primary",textColor:"primary",variant:"fullWidth","aria-label":"view change tabs"},x.a.createElement(he,{value:"month",label:"Month"}),x.a.createElement(he,{value:"week",label:"Week"}),x.a.createElement(he,{value:"day",label:"Day"}))),x.a.createElement(b.a,{sm:6,md:4},x.a.createElement(y.a,{variant:"h3",center:!0}," ",f," ")),x.a.createElement(b.a,{sm:12,md:4},x.a.createElement("div",{className:"float-right"},x.a.createElement(B.a,{onClick:this.handleClickPrevButton},x.a.createElement(G.a,null)),x.a.createElement(B.a,{onClick:this.handleClickNextButton},x.a.createElement(Q.a,null))))),x.a.createElement(v.a,{className:"p-0 m-0"},x.a.createElement(b.a,{xs:12},x.a.createElement(te.a,Object.assign({theme:m,view:h,className:t.calendar,calendars:g,tasks:w,schedules:E,ref:this.calendarRef},D)))))),x.a.createElement(ie.a,null,x.a.createElement(v.a,{className:"p-0 m-0"},x.a.createElement(b.a,{xs:12},x.a.createElement(y.a,{variant:"subtitle2",display:"block",color:"default",gutterBottom:!0}," ","Calendar index"," ")),x.a.createElement(b.a,{xs:12},g.map((function(e,t){return x.a.createElement(le.a,{color:e.bgColor?e.bgColor:ae.b.hex.secondary,text:e.name,key:"calendar-"+t})}))))))}}]),a}(x.a.Component);fe.defaultProps={calendars:[],tasks:[],schedules:[],view:"month",theme:{"common.border":"1px solid rgba("+ae.b.rgb.grey+", 0.5)","common.backgroundColor":"#fcfcfc","common.holiday.color":ae.b.hex.grey,"common.saturday.color":ae.b.hex.grey,"common.dayname.color":ae.b.hex.default,"common.today.color":ae.b.hex.primary,"week.currentTime.color":ae.b.hex.primarydark},show_actions:!0,icon:x.a.createElement($.a,null),title:"My",subtitle:"Calendar",icon_color:ae.b.hex.primary,title_color:ae.b.hex.primary,subtitle_color:ae.b.hex.grey,calendarProps:{},height:900,defaultView:"month",disableDblClick:!0,disableClick:!1,isReadOnly:!1,useDetailPopup:!0,useCreationPopup:!1,scheduleView:!0,taskView:!0};var ge=Object(ue.a)(g()(pe.a)(fe)),ve=a(168),be=a(11),ye=a(50),we=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e)).calendarRef=x.a.createRef(),n.state={loading:!0,load_error:!1,records:[]},n.handleDeleteItem=function(e){return function(t){var a=n.props,r=a.openDialog,i=a.closeDialog;r({title:"Deleting safely",body:"Please wait. Executing safe delete...",actions:{}}),n.state.service.delete(e).then((function(e){i(),n.loadData()})).catch((function(e){console.log("CalendarView delete error",e),i()}))}};var r=e.defination,i=e.service,o=e.query;e.app;return n.state.defination=r,n.state.service=i,n.state.query=o?Object(l.a)(Object(l.a)({},o),{},{p:1}):{p:1},n.handleEditItem=n.handleEditItem.bind(Object(u.a)(n)),n.handleDeleteItemConfirm=n.handleDeleteItemConfirm.bind(Object(u.a)(n)),n.handleDeleteItem=n.handleDeleteItem.bind(Object(u.a)(n)),n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.loadContext()}},{key:"getSnapshotBeforeUpdate",value:function(e){return{contextReloadRequired:!Object.areEqual(e.defination,this.props.defination)&&!Object.areEqual(e.service,this.props.service),dataReloadRequired:!Object.areEqual(e.query,this.props.query)}}},{key:"componentDidUpdate",value:function(e,t,a){if(a.contextReloadRequired&&this.loadContext(),a.dataReloadRequired){var n=this.props.query;this.setState({query:n?Object(l.a)(Object(l.a)({},n),{},{p:1}):{p:1}},this.loadData)}}},{key:"componentWillUnmount",value:function(){var e=this.props;e.openDialog;(0,e.closeDialog)()}},{key:"handleEditItem",value:function(e){var t=this.props.auth;this.state.defination.access.actions.update.restricted(t.user)||(window.location.href="/"+this.state.defination.access.actions.update.uri(e.schedule.id))}},{key:"handleDeleteItemConfirm",value:function(e){var t=this.props,a=t.openDialog,n=t.closeDialog;a({title:"Confirm Delete",body:"Are you sure you want delete "+e.schedule.title+"? This action might be irreversible",actions:{cancel:{text:"Cancel",color:"default",onClick:function(){return n()}},delete:{text:"Delete",color:"error",onClick:this.handleDeleteItem(e.schedule.id)}}})}},{key:"loadContext",value:function(){var e=this.props,t=e.defination,a=e.service,n=e.query;e.auth;t&&this.setState({defination:t,service:a,query:n?Object(l.a)(Object(l.a)({},n),{},{p:1}):{p:1},calendars:[{id:t.name,name:t.label,bgColor:t.color,borderColor:t.color}],records:[],loading:!1},this.loadData)}},{key:"loadData",value:function(){var e=this,t=this.props,a=(t.auth,t.cache),n=t.defination,r=t.apiCallRequest,i=t.cache_data,o=t.onLoadData,s=t.load_data;if(n)if(s)r(n.name,{uri:n.endpoint,type:"records",params:this.state.query,data:{},cache:i}).then((function(t){console.log("calendar data",t),Function.isFunction(o)&&o(t,e.state.query),e.prepareData(t)})).catch((function(t){console.log("calendar error",t),e.setState((function(e){return{records:[],load_error:t,loading:!1}}))}));else{var l=Array.isArray(a.data[n.name])?a.data[n.name]:[];Function.isFunction(o)&&o(l,this.state.query),this.prepareData(l)}else this.setState((function(e){return{records:[],load_error:{msg:"No Context defination or provided"},loading:!1}}))}},{key:"prepareData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=this.props,n=(a.auth,a.cache),r=a.defination,i=Array.isArray(t)?t:Array.isArray(n.data[r.name])?n.data[r.name]:[];r&&r.scope.columns;Function.isFunction(r.views.listing.calendarview.resolveData)&&r.views.listing.calendarview.resolveData(i,!0).then((function(t){e.setState((function(e){return{records:t,loading:!1}}))})).catch((function(t){e.setState((function(e){return{records:[],loading:!1}}))}))}},{key:"render",value:function(){var e=this.props.classes;return x.a.createElement(v.a,{className:e.root},this.state.defination&&x.a.createElement(b.a,{className:"p-0 m-0",xs:12},this.state.loading?x.a.createElement(v.a,{className:e.full_height,justify:"center",alignItems:"center"},x.a.createElement(b.a,{xs:1},x.a.createElement(ve.a,{size:24,thickness:4,className:e.progress,color:"secondary",disableShrink:!0}))):x.a.createElement(v.a,{className:"p-0 m-0"},this.state.load_error?x.a.createElement(v.a,null,x.a.createElement(b.a,{xs:12},x.a.createElement(y.a,{color:"error",variant:"h1",center:!0,fullWidth:!0},x.a.createElement(K.a,{fontSize:"large"},"error"))),x.a.createElement(b.a,{xs:12},x.a.createElement(y.a,{color:"error",variant:"body1",center:!0,fullWidth:!0},"An error occured.",x.a.createElement("br",null),"Status Code :"," ",this.state.load_error.code,x.a.createElement("br",null),this.state.load_error.msg))):x.a.createElement(v.a,{className:"p-0 m-0"},x.a.createElement(b.a,{className:"p-0 m-0",xs:12},Array.isArray(this.state.records)&&this.state.records.length>0?x.a.createElement(v.a,{className:"p-0 m-0"},x.a.createElement(b.a,{xs:12},x.a.createElement(ge,{icon:this.state.defination.icon,title:this.state.defination.label,title_color:this.state.defination.color,icon_color:this.state.defination.color,subtitle:"",calendars:this.state.calendars,view:"month",schedules:this.state.records,className:e.calendar,onClickEdit:this.handleEditItem,onClickDelete:this.handleDeleteItemConfirm}))):x.a.createElement(v.a,{className:"p-0 m-0",justify:"center",alignItems:"center"},x.a.createElement("img",{alt:"Empty list",className:e.emptyImage,src:H.a}),x.a.createElement(y.a,{className:e.emptyText,color:"grey",variant:"body2",center:!0,fullWidth:!0},"No"," ",this.state.defination.label?this.state.defination.label:"Records"," ","found")))))))}}]),a}(x.a.Component);we.defaultProps={calendarProps:{height:"900px",defaultView:"month",disableDblClick:!0,disableClick:!0,isReadOnly:!1,useDetailPopup:!0,useCreationPopup:!1,scheduleView:!0,taskView:!1},query:{p:1},cache_data:!0,load_data:!0};var xe=Object(ye.a)(C()(g()((function(e){return{root:{padding:"0"}}})),Object(E.b)((function(e){return{auth:e.auth,app:e.app}}),{apiCallRequest:be.gb,openDialog:be.sb,closeDialog:be.pb}))(we)),Ee=(a(1366),a(1380)),Oe=a(1329),Ce=a(1198),ke=a(1202),_e=a(1270),je=a(1274),De=a(1242),Ne=a(1303),qe=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e)).state={loading:!0,load_error:!1,raw_records:[],records:[]},n.handleDeleteItemConfirm=function(e){return function(t){var a=n.props.dispatch;Object(u.a)(n);a(be.sb({title:"Confirm Delete",body:"Are you sure you want delete entry? This action might be irreversible",actions:{cancel:{text:"Cancel",color:"default",onClick:function(){return a(be.pb())}},delete:{text:"Delete",color:"error",onClick:n.handleDeleteItem(e)}}}))}},n.handleDeleteItem=function(e){return function(e){var t=n.props.dispatch;t(be.sb({title:"Deleting safely",body:"Please wait. Executing safe delete...",actions:{close:{text:"Close",color:"default",onClick:function(){return t(be.pb())}}}}))}};e.defination;return n.handleDeleteItemConfirm=n.handleDeleteItemConfirm.bind(Object(u.a)(n)),n.handleDeleteItem=n.handleDeleteItem.bind(Object(u.a)(n)),n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.cache,a=e.defination;this.mounted=!0,this.loadContext(),this.prepareData(Array.isArray(t.data[a.name])?t.data[a.name]:[])}},{key:"getSnapshotBeforeUpdate",value:function(e){this.mounted=!1;var t=this.props;t.cache,t.defination;return{contextReloadRequired:!Object.areEqual(e.defination,this.props.defination),dataReloadRequired:!Object.areEqual(e.query,this.props.query),dataPreparationRequired:!1}}},{key:"componentDidUpdate",value:function(e,t,a){if(a.contextReloadRequired&&(this.loadContext(),this.prepareData()),a.dataReloadRequired){var n=this.props.query;this.setState({query:n?Object(l.a)(Object(l.a)({},n),{},{p:1}):{p:1}},this.loadData)}}},{key:"loadContext",value:function(){var e=this.props,t=e.defination,a=e.service,n=e.query;e.cache;t&&this.setState({defination:t,service:a,query:n?Object(l.a)(Object(l.a)({},n),{},{p:1}):{p:1},loading:!1},this.loadData)}},{key:"loadData",value:function(){var e=this,t=this.props,a=(t.auth,t.cache),n=t.defination,r=t.apiCallRequest,i=t.cache_data,o=t.onLoadData,s=t.load_data;if(n){if(s)r(n.name,{uri:n.endpoint,type:"records",params:this.state.query,data:{},cache:i}).then((function(t){Function.isFunction(o)&&o(t,e.state.query),e.prepareData(t)})).catch((function(t){e.setState((function(e){return{records:[],load_error:t,loading:!1}}))}));else if(i){var l=Array.isArray(a.data[n.name])?a.data[n.name]:[];Function.isFunction(o)&&o(l,this.state.query),this.prepareData(l)}}else this.setState((function(e){return{records:[],load_error:{msg:"No Context defination or provided"},loading:!1}}))}},{key:"prepareData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=this.props,n=a.auth,r=a.cache,i=a.defination,o=a.entryItemProps,s=Array.isArray(t)?t:Array.isArray(r.data[i.name])?r.data[i.name]:[];i&&i.scope.columns;Function.isFunction(i.views.listing.listview.resolveData)&&i.views.listing.listview.resolveData(s,n.user,o).then((function(a){e.setState((function(e){return{raw_records:t,records:a,loading:!1}}))})).catch((function(t){e.setState((function(e){return{records:[],raw_records:[],loading:!1}}))}))}},{key:"prepareForData",value:function(){var e=this.props,t=(e.classes,e.defination);e.auth,e.dispatch,t.scope.columns;this.state.records=[],this.state.loading=!1}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.defination,r=(t.service,t.onClickEntry);return x.a.createElement(v.a,{className:a.root},x.a.createElement(b.a,{className:"p-0 m-0",xs:12},this.state.loading?x.a.createElement(v.a,null,x.a.createElement(b.a,{md:12,className:"flex flex-row items-center relative p-0 px-4 my-4"},x.a.createElement(Ne.a,{variant:"circle",width:40,height:40}),x.a.createElement("div",{className:"flex-grow mx-2 flex flex-col"},x.a.createElement(Ne.a,{variant:"text",className:"w-3/12"}))),x.a.createElement(b.a,{md:12,className:"flex flex-row items-center relative p-0 px-4 my-4"},x.a.createElement(Ne.a,{variant:"circle",width:40,height:40}),x.a.createElement("div",{className:"flex-grow mx-2 flex flex-col"},x.a.createElement(Ne.a,{variant:"text",className:"w-8/12"}))),x.a.createElement(b.a,{md:12,className:"flex flex-row items-center relative p-0 px-4 my-4"},x.a.createElement(Ne.a,{variant:"circle",width:40,height:40}),x.a.createElement("div",{className:"flex-grow mx-2 flex flex-col"},x.a.createElement(Ne.a,{variant:"text",className:"w-4/12"}))),x.a.createElement(b.a,{md:12,className:"flex flex-row items-center relative p-0 px-4 my-4"},x.a.createElement(Ne.a,{variant:"circle",width:40,height:40}),x.a.createElement("div",{className:"flex-grow mx-2 flex flex-col"},x.a.createElement(Ne.a,{variant:"text",className:"w-3/12"}))),x.a.createElement(b.a,{md:12,className:"flex flex-row items-center relative p-0 px-4 my-4"},x.a.createElement(Ne.a,{variant:"circle",width:40,height:40}),x.a.createElement("div",{className:"flex-grow mx-2 flex flex-col"},x.a.createElement(Ne.a,{variant:"text",className:"w-5/12"}))),x.a.createElement(b.a,{md:12,className:"flex flex-row items-center relative p-0 px-4 my-4"},x.a.createElement(Ne.a,{variant:"circle",width:40,height:40}),x.a.createElement("div",{className:"flex-grow mx-2 flex flex-col"},x.a.createElement(Ne.a,{variant:"text",className:"w-9/12"}))),x.a.createElement(b.a,{md:12,className:"flex flex-row items-center relative p-0 px-4 my-4"},x.a.createElement(Ne.a,{variant:"circle",width:40,height:40}),x.a.createElement("div",{className:"flex-grow mx-2 flex flex-col"},x.a.createElement(Ne.a,{variant:"text",className:"w-4/12"}))),x.a.createElement(b.a,{md:12,className:"flex flex-row items-center relative p-0 px-4 my-4"},x.a.createElement(Ne.a,{variant:"circle",width:40,height:40}),x.a.createElement("div",{className:"flex-grow mx-2 flex flex-col"},x.a.createElement(Ne.a,{variant:"text",className:"w-3/12"}))),x.a.createElement(b.a,{md:12,className:"flex flex-row items-center relative p-0 px-4 my-4"},x.a.createElement(Ne.a,{variant:"circle",width:40,height:40}),x.a.createElement("div",{className:"flex-grow mx-2 flex flex-col"},x.a.createElement(Ne.a,{variant:"text",className:"w-4/12"})))):x.a.createElement(v.a,{className:"p-0 m-0"},this.state.load_error?x.a.createElement(v.a,null,x.a.createElement(b.a,{xs:12},x.a.createElement(y.a,{color:"error",variant:"h1",center:!0,fullWidth:!0},x.a.createElement(K.a,{fontSize:"large"},"error"))),x.a.createElement(b.a,{xs:12},x.a.createElement(y.a,{color:"error",variant:"body1",className:"w-full text-center",center:!0,fullWidth:!0},"An error occured.",x.a.createElement("br",null),"Status Code :"," ",this.state.load_error.code,x.a.createElement("br",null),this.state.load_error.msg))):x.a.createElement(v.a,{className:"p-0 m-0"},x.a.createElement(b.a,{className:"p-0 m-0",xs:12},Array.isArray(this.state.records)&&this.state.records.length>0?x.a.createElement(v.a,{className:"p-0 m-0"},x.a.createElement(b.a,{xs:12},x.a.createElement(Ce.a,{className:"p-0 transparent-bg"},this.state.records.map((function(t,i){return x.a.createElement("div",{key:n.name+"-"+i},x.a.createElement(ke.a,{button:!0,alignItems:"flex-start",onClick:function(){Function.isFunction(r)&&r(e.state.raw_records[i],i)},className:a.listItem},t.avatar&&x.a.createElement(_e.a,null," ",t.avatar," "),t.icon&&x.a.createElement(je.a,null," ",t.icon," "),x.a.createElement(De.a,{primary:t.title,secondary:t.body})),x.a.createElement(Oe.a,{component:"li"}))}))))):x.a.createElement(v.a,{className:"p-0 m-0",justify:"center",alignItems:"center"},x.a.createElement("img",{alt:"Empty list",className:a.emptyImage,src:H.a}),x.a.createElement(y.a,{className:a.emptyText,color:"grey",variant:"body2",center:!0,fullWidth:!0},"No"," ",n.label?n.label:"Records"," ","found")))))))}}]),a}(x.a.Component);qe.defaultProps={show_actions:!0,show_links:!0,query:{p:1},load_data:!0,cache_data:!0};var Se=C()(g()((function(e){return{root:{padding:"0"},listItem:{background:"transparent",transition:e.transitions.create("background",{easing:e.transitions.easing.sharp,duration:50}),"&:hover":{background:e.palette.action.hover}}}})),Object(E.b)((function(e,t){t.defination;return{auth:e.auth,cache:e.cache,api:e.api}}),{apiCallRequest:be.gb,openDialog:be.sb,closeDialog:be.pb}),ye.a)(qe),Re=a(1250),Ae=(a(1371),a(1204)),Pe=a(1427),Ie=a.n(Pe),Me=a(40),Fe=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e)).state={loading:!0,load_error:!1,defination:null,service:null,query:{p:1},dt_columns:[],records:[],raw_data:[],mouseX:null,mouseY:null,actionsView:"contextMenu",context:null},n.handleDeleteItemConfirm=function(e){return function(t){var a=n.props,r=a.openDialog,i=a.closeDialog;Object(u.a)(n);r({title:"Confirm Delete",body:"Are you sure you want delete entry? This action might be irreversible",actions:{cancel:{text:"Cancel",color:"default",onClick:function(){return i()}},delete:{text:"Delete",color:"error",onClick:n.handleDeleteItem(e)}}})}},n.handleDeleteItem=function(e){return function(t){var a=n.props,r=a.openDialog;(0,a.closeDialog)(),e._id&&(e=e._id),n.state.service.delete(e).then((function(t){n.setState((function(t){var a=t.records;return Array.isArray(a)&&(a=a.filter((function(t){if(t.entry){if(t.entry._id===e)return!1}else if(t._id===e)return!1;return!0}))),Array.isArray(a)||(a=[]),{records:a}}))})).catch((function(e){r({title:"Delete failed",body:e.msg,actions:{}})}))}},n.handleOnRowContextMenu=function(e){return function(t){t.preventDefault();var a=t.clientX-2,r=t.clientY-4;console.log("this.state.raw_data[index]",n.state.raw_data[e]),n.setState((function(t){return{mouseX:a,mouseY:r,context:t.raw_data[e]}}))}},n.handleOnRowContextMenuClose=function(e){e.preventDefault(),n.setState({mouseX:null,mouseY:null})};var r=e.defination,i=e.service,o=e.query,s=e.cache.data;return n.state.defination=r,n.state.service=i,n.state.query=o?Object(l.a)(Object(l.a)({},o),{},{p:1}):{p:1},n.state.records=Array.isArray(s[r.name])?s[r.name]:[],n.mounted=!1,n.handleDeleteItemConfirm=n.handleDeleteItemConfirm.bind(Object(u.a)(n)),n.handleDeleteItem=n.handleDeleteItem.bind(Object(u.a)(n)),n.handleOnRowContextMenu=n.handleOnRowContextMenu.bind(Object(u.a)(n)),n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.cache,a=e.defination;this.mounted=!0,this.loadContext(),this.prepareData(Array.isArray(t.data[a.name])?t.data[a.name]:[])}},{key:"getSnapshotBeforeUpdate",value:function(e){this.mounted=!1;var t=this.props;t.cache,t.defination;return{contextReloadRequired:!Object.areEqual(e.defination,this.props.defination),dataReloadRequired:!Object.areEqual(e.query,this.props.query),dataPreparationRequired:!1}}},{key:"componentDidUpdate",value:function(e,t,a){if(this.mounted=!0,a.contextReloadRequired&&(this.loadContext(),this.prepareData()),a.dataReloadRequired){var n=this.props.query;this.setState({query:n?Object(l.a)(Object(l.a)({},n),{},{p:1}):{p:1}},this.loadData)}}},{key:"loadContext",value:function(){var e=this,t=this.props,a=t.classes,n=t.defination,r=t.service,i=t.query,o=t.auth,c=t.actionsType;if(n){var d=n.scope.columns,u=[];if(!n.access.restricted(o.user)){u.push({name:"entry",label:String.isString(n.label)?n.label.singularize():"Action",options:{filter:!1,sort:!1,customBodyRender:function(t,r,i){if("inline"===c)return x.a.createElement(v.a,{spacing:2,className:a.data_actions_wrapper},Object.keys(n.access.actions).map((function(a,r){return!n.access.actions[a].restricted(o.user)&&x.a.createElement("div",{key:t+"_"+a+"_action"},"delete"===a?n.access.actions[a].link.inline.listing(t,"error_text",e.handleDeleteItemConfirm(t)):n.access.actions[a].link.inline.listing(t))})))}}});for(var p=0,m=Object.entries(d);p<m.length;p++){var h=Object(s.a)(m[p],2),f=h[0],g=h[1],b=!0;g.restricted&&"display"in g.restricted&&"function"===typeof g.restricted.display&&(b=!g.restricted.display(!1,o.user)),b&&(de.e.isOfType(this.state.defination.views.listing.tableview.resolveData,"function")?g.reference||g.possibilities?u.push({name:f,label:g.label,options:{filter:!!g.possibilities,sort:!0,customBodyRender:function(e,t,a){return Array.isArray(e)?x.a.createElement(v.a,{spacing:2},e.map((function(e,t){return x.a.createElement("div",{key:t}," ",e," ")}))):null!==e&&void 0!==e?e:""}}}):u.push({name:f,label:g.label,options:{filter:!!g.possibilities,sort:!0}}):g.reference&&"file"!==g.input.type?u.push({name:f,label:g.label,options:{filter:!!g.possibilities,sort:!0,customBodyRender:function(e,t,n){return Array.isArray(e)?x.a.createElement(v.a,{spacing:2},e.map((function(e,t){return x.a.createElement(Re.a,{className:a.valueChip,key:e.value,label:e.resolve})}))):null!==e&&void 0!==e?x.a.createElement(Re.a,{label:e.resolve}):""}}}):g.reference&&"file"===g.input.type?u.push({name:f,label:g.label,options:{filter:!!g.possibilities,sort:!0,customBodyRender:function(e,t,n){return Array.isArray(e)?x.a.createElement(v.a,{spacing:2},e.map((function(e,t){return x.a.createElement(Re.a,{className:a.valueChip,avatar:x.a.createElement(ne.a,{color:"#cfd8dc",textColor:"#000000",src:"image"===de.c.fileType(e.resolve)?Me.attachments.getAttachmentFileUrl(e.value):void 0},de.c.fileIcon(e.resolve)),label:e.resolve,onClick:function(t){t.preventDefault(),window.open(Me.attachments.getAttachmentFileUrl(e.value),"_blank").focus()},key:"file-"+e.value})}))):null!==e&&void 0!==e?x.a.createElement(Re.a,{avatar:x.a.createElement(ne.a,{color:"#cfd8dc",textColor:"#000000",src:"image"===de.c.fileType(e.resolve)?Me.attachments.getAttachmentFileUrl(e.value):void 0},de.c.fileIcon(e.resolve)),onClick:function(t){t.preventDefault(),window.open(Me.attachments.getAttachmentFileUrl(e.value),"_blank").focus()},label:e.resolve}):""}}}):u.push({name:f,label:g.label,options:{filter:!!g.possibilities,sort:!0}}))}}this.setState({defination:n,service:r,query:i?Object(l.a)(Object(l.a)({},i),{},{p:1}):{p:1},dt_columns:u,records:[],loading:!1},this.loadData)}}},{key:"parseData",value:function(e){var t=this.props,a=t.defination,n=t.auth,r=e,i=a.scope.columns;r.entry=e;for(var o=0,l=Object.entries(i);o<l.length;o++){var c=Object(s.a)(l[o],2),d=c[0],u=c[1];if("date"===u.input.type&&(e[d]?r[d]=new Date(e[d]).format(ce.b.dateformats.date):r[d]=""),"datetime"===u.input.type&&e[d]&&(e[d]?r[d]=new Date(e[d]).format(ce.b.dateformats.datetime):r[d]=""),"time"===u.input.type&&(e[d]?r[d]=new Date(e[d]).format(ce.b.dateformats.time):r[d]=""),"boolean"===u.type&&(e[d]?r[d]="Yes":r[d]="No"),JSON.isJSON(r[d])&&!u.reference&&(r[d]=JSON.stringify(r[d])),u.possibilities)if(JSON.isJSON(u.possibilities))e[d]in u.possibilities&&(r[d]=u.possibilities[e[d]]);else if(Function.isFunction(u.possibilities)){var p=u.possibilities(e,n.user);JSON.isJSON(p)&&e[d]in p&&(r[d]=p[e[d]])}}return r}},{key:"loadData",value:function(){var e=this,t=this.props,a=(t.auth,t.cache),n=t.defination,r=t.apiCallRequest,i=t.cache_data,o=t.onLoadData,s=t.load_data;if(n)if(s)this.setState({loading:!0,load_error:!1}),r(n.name,{uri:n.endpoint,type:"records",params:this.state.query,data:{},cache:i}).then((function(t){Function.isFunction(o)&&o(t,e.state.query),e.setState({loading:!1}),e.prepareData(t)})).catch((function(t){e.setState((function(e){return{records:[],load_error:t,loading:!1}}))}));else{var l=Array.isArray(a.data[n.name])?a.data[n.name]:[];Function.isFunction(o)&&o(l,this.state.query),this.prepareData(l)}else this.setState((function(e){return{records:[],load_error:{msg:"No Context defination or provided"},loading:!1}}))}},{key:"prepareData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=this.props,n=a.auth,r=a.cache,i=a.defination,o=Array.isArray(t)?t:Array.isArray(r.data[i.name])?r.data[i.name]:[],s=i?i.scope.columns:{},l=[];if(Function.isFunction(i.views.listing.tableview.resolveData))i.views.listing.tableview.resolveData(o,!0).then((function(t){e.mounted?e.setState((function(e){return{raw_data:o,records:t,loading:!1}})):(e.state.records=t,e.state.loading=!1)})).catch((function(t){e.mounted?e.setState((function(e){return{raw_data:[],records:[],loading:!1}})):(e.state.records=[],e.state.loading=!1)}));else{l=de.d.resolveReferenceColumnsDisplays(o,s,n.user);var c=this,d=l.map((function(e){return c.parseData(e)}));this.setState((function(e){return{records:d}}))}}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.defination,n=e.api,r=(e.cache,e.actionsType),i={filterType:"dropdown",filter:!0,downloadOptions:{filename:(a?a.label:"Records")+" - "+(new Date).format("d M Y H:i:s A")+".csv",separator:","},resizableColumns:!1,selectableRows:"none",responsive:"scroll",pagination:!1,rowHover:!0,customToolbarSelect:function(e,t,a){console.log("customToolbarSelect selectedRows",e),console.log("customToolbarSelect displayData",t)}};return x.a.createElement(v.a,{className:t.root},x.a.createElement(b.a,{className:"p-0 m-0",xs:12},this.state.loading&&x.a.createElement(v.a,{className:t.full_height,justify:"center",alignItems:"center"},x.a.createElement(b.a,{xs:12,className:"flex relative flex-row"},x.a.createElement("div",{className:"flex-grow"},x.a.createElement(Ne.a,{variant:"text",width:150})),x.a.createElement("div",{className:"flex"},x.a.createElement(Ne.a,{variant:"circle",width:32,height:32,className:"float-right mx-2"}),x.a.createElement(Ne.a,{variant:"circle",width:32,height:32,className:"float-right mx-2"}),x.a.createElement(Ne.a,{variant:"circle",width:32,height:32,className:"float-right mx-2"}),x.a.createElement(Ne.a,{variant:"circle",width:32,height:32,className:"float-right mx-2"}))),x.a.createElement(b.a,{xs:12},x.a.createElement(Ne.a,{variant:"rect",width:"100%",height:70,className:"mt-2"}),x.a.createElement(Ne.a,{variant:"rect",width:"100%",height:70,className:"mt-2"}),x.a.createElement(Ne.a,{variant:"rect",width:"100%",height:70,className:"mt-2"}),x.a.createElement(Ne.a,{variant:"rect",width:"100%",height:70,className:"mt-2"}))),!this.state.loading&&Array.isArray(this.state.records)&&x.a.createElement(v.a,{className:"p-0 m-0"},x.a.createElement(v.a,{className:"p-0 m-0"},x.a.createElement(b.a,{className:"p-0 m-0",xs:12},"context"===r&&x.a.createElement(Ae.a,{onContextMenu:this.handleOnRowContextMenuClose,onClickAway:this.handleOnRowContextMenuClose},x.a.createElement(N.a,{open:null!==this.state.mouseY,onClose:this.handleOnRowContextMenuClose,anchorReference:"anchorPosition",anchorPosition:null!==this.state.mouseY&&null!==this.state.mouseX?{top:this.state.mouseY,left:this.state.mouseX}:void 0},x.a.createElement(q.a,{onClick:this.handleOnRowContextMenuClose},"Copy"),x.a.createElement(q.a,{onClick:this.handleOnRowContextMenuClose},"Print"),x.a.createElement(q.a,{onClick:this.handleOnRowContextMenuClose},"Highlight"),x.a.createElement(q.a,{onClick:this.handleOnRowContextMenuClose},"Email"))),this.state.records.length>0?x.a.createElement(Ie.a,{title:(n.loading?"Loading ":"")+a.label+(n.loading?"...":""),data:this.state.records,columns:this.state.dt_columns,options:i}):x.a.createElement(v.a,{className:"p-0 m-0",justify:"center",alignItems:"center"},x.a.createElement("img",{alt:"Empty list",className:t.emptyImage,src:H.a}),x.a.createElement(y.a,{className:t.emptyText,color:"grey",variant:"body2",center:!0,fullWidth:!0},"No"," ",a.label?a.label:"Records"," ","found")))),!!n&&(n.busy&&n.error)&&x.a.createElement(v.a,null,x.a.createElement(b.a,{xs:12},x.a.createElement(y.a,{color:"error",variant:"body2",center:!0,fullWidth:!0},"An error occured. \n "+n.error.msg+" \n Displaying cached data."))))))}}]),a}(x.a.Component);Fe.defaultProps={show_actions:!0,show_links:!0,query:{p:1},cache_data:!0,load_data:!0,actionsType:"inline"};var Te=Object(ye.a)(C()(g()((function(e){return{root:{padding:"0"},data_actions_wrapper:{display:"inline-block",whiteSpace:"nowrap","& > *":{display:"inline-block",whiteSpace:"nowrap"}},valueChip:{margin:e.spacing(.5)},emptyImage:{maxWidth:200,width:"100%"},emptyText:{marginTop:e.spacing(3)}}})),Object(E.b)((function(e,t){return{auth:e.auth,cache:e.cache,api:e.api}}),{openDialog:be.sb,closeDialog:be.pb,apiCallRequest:be.gb}))(Fe));function Ve(e){var t=Object(V.a)(),a=e.count,n=e.page,r=e.rowsPerPage,i=e.onChangePage;return x.a.createElement("div",{className:"ml-2 flex-shrink-0"},x.a.createElement(B.a,{onClick:function(e){i(e,0)},disabled:0===n,"aria-label":"first page"},"rtl"===t.direction?x.a.createElement(T.a,null):x.a.createElement(R.a,null)),x.a.createElement(B.a,{onClick:function(e){i(e,n-1)},disabled:0===n,"aria-label":"previous page"},"rtl"===t.direction?x.a.createElement(M.a,null):x.a.createElement(P.a,null)),x.a.createElement(B.a,{onClick:function(e){i(e,n+1)},disabled:n>=Math.ceil(a/r)-1,"aria-label":"next page"},"rtl"===t.direction?x.a.createElement(P.a,null):x.a.createElement(M.a,null)),x.a.createElement(B.a,{onClick:function(e){i(e,Math.max(0,Math.ceil(a/r)-1))},disabled:n>=Math.ceil(a/r)-1,"aria-label":"last page"},"rtl"===t.direction?x.a.createElement(R.a,null):x.a.createElement(T.a,null)))}var Le=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e)).state={defination:null,service:null,view:"tableview",views:{},showViewOptions:!0,showAddBtn:!0,searchKeyword:"",query:{},pages:10,page:1,viewMenuAnchorEl:null,sortFields:[],filterAccordionExpanded:!1,filterableFields:{},filterContext:!1,filterMenuAnchor:null,filters:{values:{},labels:{}}},n.mounted=!1,n.searchkeywordRef=x.a.createRef(),n.handleViewItemClick=function(e){return function(t){n.mounted?n.setState({view:e,viewMenuAnchorEl:null}):(n.state.view=e,n.state.viewMenuAnchorEl=null)}},n.handleShowViewsMenu=function(e){var t=e.currentTarget;n.mounted?n.setState({viewMenuAnchorEl:t}):n.state.viewMenuAnchorEl=t},n.handleCloseViewsMenu=function(){n.mounted?n.setState({viewMenuAnchorEl:null}):n.state.viewMenuAnchorEl=null},n.handleOnPageChanged=function(e,t){n.setState((function(e){return{page:t+1,query:Object(l.a)(Object(l.a)({},e.query),{},{page:t+1}),viewMenuAnchorEl:null}}))},n.handleOnRecordsPerPageChanged=function(e){var t=Number.parseNumber(e.target.value,n.state.query.pagination);n.setState((function(e){return{page:1,query:Object(l.a)(Object(l.a)({},e.query),{},{pagination:t})}}))};var r=e.defination,i=e.service,o=e.query,d=(e.cache,e.app);n.state.defination=r,n.state.service=i,n.state.query=o?Object(l.a)(Object(l.a)({},o),{},{p:1,pagination:"rpp"in o?o.rpp:"pagination"in o?o.pagination:d.preferences.data.pagination,page:"pg"in o?o.pg:"page"in o?o.page:1}):{p:1,pagination:"rpp"in o?o.rpp:"pagination"in o?o.pagination:d.preferences.data.pagination,page:"pg"in o?o.pg:"page"in o?o.page:1};var p={},m=!1,h="";if(Object.entries(r.scope.columns).map((function(e,t){var a=Object(s.a)(e,2),n=a[0],r=a[1];["file","dynamic","textarea","password","wysiwyg","map","file","slider","multiselect"].includes(r.input.type)||(p[n]=r)})),JSON.isJSON(o)){var f=!1,g=Object.keys(p);Object.entries(o).map((function(e){var t=Object(s.a)(e,2),a=t[0],n=t[1];!f&&g.includes(a)&&(m=a,h=n,h=String.isString(n)?n:String(n),f=!0)}))}return m||!o.q&&!o.query?(n.state.searchKeyword=h,n.state.filterContext=m):o.q?n.state.searchKeyword=o.q:n.state.searchKeyword=o.query,n.handleViewItemClick=n.handleViewItemClick.bind(Object(u.a)(n)),n.handleOnPageChanged=n.handleOnPageChanged.bind(Object(u.a)(n)),n.handleOnRecordsPerPageChanged=n.handleOnRecordsPerPageChanged.bind(Object(u.a)(n)),n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.mounted=!0,this.prepareForRender()}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"getSnapshotBeforeUpdate",value:function(e){return this.mounted=!1,{prepareForRenderRequired:!Object.areEqual(e.query,this.props.query)}}},{key:"componentDidUpdate",value:function(e,t,a){this.mounted=!0,a.prepareForRenderRequired&&this.prepareForRender()}},{key:"prepareForRender",value:function(){var e=Object(o.a)(i.a.mark((function e(){var t,a,n,r,o,c,d,u,p,m,h,f,g,v,b,y,w,x,E,O,C;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,a=t.defination,n=t.service,r=t.query,o=t.view,c=t.showViewOptions,d=t.showAddBtn,u=t.app,a&&n){p={tableview:"Table View",listview:"List View",googlemapview:"Map View",vectormapview:"Vector Map View",calendarview:"Calendar View"},m={},h="tableview",a.views.listing.default in p&&(h=a.views.listing.default);for(f=0,g=Object.entries(p);f<g.length;f++)v=Object(s.a)(g[f],2),b=v[0],y=v[1],b in a.views.listing&&(m[b]=y);w={},x=!1,E="",Object.entries(a.scope.columns).map((function(e,t){var a=Object(s.a)(e,2),n=a[0],r=a[1];["file","dynamic","textarea","password","wysiwyg","map","file","slider","multiselect"].includes(r.input.type)||(w[n]=r)})),JSON.isJSON(r)&&(O=!1,C=Object.keys(w),Object.entries(r).map((function(e){var t=Object(s.a)(e,2),a=t[0],n=t[1];!O&&C.includes(a)&&(x=a,E=n,E=String.isString(n)?n:String(n),O=!0)}))),console.log("this.searchkeywordRef","this.searchkeywordRef"),this.mounted?this.setState((function(e){return{defination:a,service:n,query:r?Object(l.a)(Object(l.a)({},r),{},{p:1,pagination:"rpp"in r?r.rpp:"pagination"in r?r.pagination:u.preferences.data.pagination,page:"pg"in r?r.pg:"page"in r?r.page:1}):{p:1,pagination:"rpp"in r?r.rpp:"pagination"in r?r.pagination:u.preferences.data.pagination,page:"pg"in r?r.pg:"page"in r?r.page:1},views:m,view:o||h,showViewOptions:c,showAddBtn:d,filterableFields:w,searchKeyword:E,filterContext:x}})):this.state=Object(l.a)(Object(l.a)({},this.state),{},{defination:a,service:n,query:r?Object(l.a)(Object(l.a)({},r),{},{p:1,pagination:"rpp"in r?r.rpp:"pagination"in r?r.pagination:u.preferences.data.pagination,page:"pg"in r?r.pg:"page"in r?r.page:1}):{p:1,pagination:"rpp"in r?r.rpp:"pagination"in r?r.pagination:u.preferences.data.pagination,page:"pg"in r?r.pg:"page"in r?r.page:1},views:m,view:o||h,showViewOptions:c,showAddBtn:d,filterableFields:w,searchKeyword:E,filterContext:x})}case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,r=t.auth,i=(t.query,t.defination),o=(t.service,t.cache),c=(t.api,t.showPagination),d=t.showSorter,u=t.cache_data,p=t.onLoadData,m=t.load_data,f=t.onClickEntry,g=(t.sorterFormLayoutType,this.state.view);return x.a.createElement(v.a,{className:"p-0 m-0"},x.a.createElement(v.a,{className:"p-0 m-0"},this.state.showViewOptions&&x.a.createElement(b.a,{sm:12,md:8},Object.entries(this.state.views).map((function(t,a){var n=Object(s.a)(t,2),r=n[0],i=n[1];return x.a.createElement(h.a,{color:"primary",variant:r===g?"contained":"text",onClick:function(t){console.log(r),e.setState({view:r,viewMenuAnchorEl:null})},key:"btn-view-"+r},i)}))),this.state.showAddBtn&&i&&!i.access.actions.create.restricted(r.user)&&x.a.createElement(b.a,{sm:12,md:this.state.showViewOptions?4:12},i.access.actions.create.link.inline.default({className:"float-right"}))),x.a.createElement(v.a,{className:"p-1 m-0"},d&&"googlemapview"!==g&&x.a.createElement(b.a,{xs:12,className:"p-0 m-0 mb-2"},x.a.createElement(v.a,{className:"p-0 m-0"},x.a.createElement(b.a,{xs:12,className:"p-0"},x.a.createElement(_.a,{expanded:this.state.filterAccordionExpanded,className:"p-0",variant:"outlined"},x.a.createElement(D.a,{component:"form",elevation:0,className:a.searchRoot,onSubmit:function(t){t.preventDefault(),e.setState((function(e){return{query:e.filterContext?Object(l.a)(Object(l.a)({},e.query),{},Object(n.a)({},e.filterContext,e.searchKeyword)):Object(l.a)(Object(l.a)({},e.query),{},{q:e.searchKeyword})}})),console.log("Search submit searchKeyword",e.state.searchKeyword)}},!this.state.filterContext&&x.a.createElement(B.a,{className:a.filterIconButton,"aria-label":"Filter",onClick:function(t){t.preventDefault(),e.setState({filterMenuAnchor:t.currentTarget})}},x.a.createElement(z.a,null)),this.state.filterContext&&x.a.createElement(h.a,{"aria-label":"Filter",size:"small",color:"secondary",onClick:function(t){t.preventDefault(),e.setState({filterMenuAnchor:t.currentTarget})}},Function.isFunction(this.state.filterableFields[this.state.filterContext].label)?this.state.filterContext.humanize():this.state.filterableFields[this.state.filterContext].label),x.a.createElement(N.a,{id:"filter-fields-menu",anchorEl:this.state.filterMenuAnchor,keepMounted:!0,open:Boolean(this.state.filterMenuAnchor),onClose:function(){return e.setState({filterMenuAnchor:null})}},Object.entries(this.state.filterableFields).map((function(t,a){var n=Object(s.a)(t,2),r=n[0],i=n[1];return x.a.createElement(q.a,{onClick:function(){e.setState({filterContext:e.state.filterContext!==r&&r,filterMenuAnchor:null})}},Function.isFunction(i.label)?r.humanize():i.label)}))),x.a.createElement(L.m,{className:a.searchInput,placeholder:"Search...",inputProps:{"aria-label":"Search"},defaultValue:this.state.searchKeyword,onFocus:function(){e.state.filterAccordionExpanded||e.setState({filterAccordionExpanded:!0})},onChange:function(t){e.setState((function(e){var a={searchKeyword:t};if(e.query&&e.query.q){var n=JSON.fromJSON(e.query);delete n.q,a.query=n}return a}))},variant:"base",ref:function(t){return e.searchkeywordRef=t}}),x.a.createElement(B.a,{type:"submit",className:a.searchIconButton,"aria-label":"search"},x.a.createElement(J.a,null))),x.a.createElement(j.a,{className:"p-0"},Object.keys(this.state.filters.values).length>0&&x.a.createElement(v.a,{className:"m-0"},Object.entries(this.state.filters.labels).map((function(e,t){var a=Object(s.a)(e,2),n=a[0],r=a[1];return x.a.createElement(Re.a,{className:"mx-1 my-1 max-w-xs",color:"secondary",label:(String.isString(i.scope.columns[n].label)?i.scope.columns[n].label+" : ":"")+r,variant:"outlined",style:{maxWidth:180},key:"filter-chip-"+t})})))))))),x.a.createElement(b.a,{xs:12,className:"p-0 m-0"},"tableview"==g&&x.a.createElement(Te,{defination:i,service:this.state.service,query:this.state.query,cache_data:u,load_data:m,onLoadData:p,onClickEntry:f}),"googlemapview"===g&&x.a.createElement(Ee.default,{context:i.name,service:this.state.service,query:this.state.query,cache_data:u,load_data:m,onLoadData:p,onClickEntry:f}),"calendarview"===g&&x.a.createElement(xe,{defination:i,service:this.state.service,query:this.state.query,cache_data:u,load_data:m,onLoadData:p,onClickEntry:f}),"listview"===g&&x.a.createElement(Se,{defination:i,service:this.state.service,query:this.state.query,cache_data:u,load_data:m,onLoadData:p,onClickEntry:f}))),c&&"googlemapview"!=g&&x.a.createElement(v.a,{className:"p-0 m-0 mb-4"},x.a.createElement(b.a,{xs:12,className:"p-2 flex items-center justify-center"},x.a.createElement(k.a,{count:i.name in o.res?o.res[i.name].count:1,page:i.name in o.res?o.res[i.name].page-1:this.state.page-1,rowsPerPage:this.state.query.pagination,onChangePage:this.handleOnPageChanged,labelRowsPerPage:"Records per page",rowsPerPageOptions:[5,10,25,50,100,{value:-1,label:"All"}],onChangeRowsPerPage:this.handleOnRecordsPerPageChanged,ActionsComponent:Ve,SelectProps:{label:"Records per page",variant:"outlined"},classes:{toolbar:"flex-col-reverse px-2"}}))))}}]),a}(x.a.Component);Le.defaultProps={show_actions:!0,show_links:!0,showViewOptions:!0,showAddBtn:!0,showPagination:!0,showSorter:!0,sorterFormLayoutType:"inline",query:{},load_data:!0,cache_data:!0};t.a=C()(g()((function(e){return{root:{padding:e.spacing(),backgroundColor:e.palette.background.paper},calendar:{borderRight:"1px solid rgba("+ae.b.rgb.grey+", 0.5) !important",borderLeft:"1px solid rgba("+ae.b.rgb.grey+", 0.5) !important"},activeVieBtn:{background:ae.b.hex.primary,color:ae.b.hex.inverse,border:"1px solid"+ae.b.hex.primary},viewBtnGroup:{position:"absolute !important",right:e.spacing()},searchRoot:{padding:"2px 4px",display:"flex",alignItems:"center",width:"100%",margin:0},searchInput:{marginLeft:e.spacing(1),flex:1},searchIconButton:{padding:10},searchDivider:{height:28,margin:4}}})),Object(E.b)((function(e){return{auth:e.auth,cache:e.cache,api:e.api,app:e.app}}),{}),ye.a)(Le)},1380:function(e,t,a){"use strict";a.r(t);var n=a(23),r=a(12),i=a(9),o=a.n(i),s=a(6),l=a(2),c=a(21),d=a(14),u=a(26),p=a(27),m=a(18),h=a(17),f=a(109),g=a(28),v=a.n(g),b=a(41),y=a.n(b),w=a(1344),x=a(1198),E=a(1202),O=a(1242),C=a(1270),k=a(259),_=a.n(k),j=a(219),D=(a(3),a(43)),N=a(434),q=a(687),S=a(435),R=a(436),A=a(22),P=a(16),I=a(20),M=a(1926),F=a(1927),T=a(602),V=a(1426),L=a.n(V),B=a(0),U=a.n(B),z=a(35),W=a(11),J=a(72),K=a(64),Y=a.n(K),H=a(263),Z=(a(1366),a(1370)),X=a(59),G=a(50),Q=a(452),$=a.n(Q),ee=a(453),te=a.n(ee),ae=!1,ne=function(e){Object(m.a)(a,e);var t=Object(h.a)(a);function a(e){var n;Object(d.a)(this,a),(n=t.call(this,e)).state={definations:{},services:{},defination:null,service:null,drawerOpen:!0,show_client_positions:!0,clients_positions:{},context:"commissions",context_entry:null,defaultZoom:10,multicontexts:!0,rendered_contexts:[],contexts_props:{},zoom:15,query:{},records:[],markers:[],circles:[],polylines:[]},n.toggleDrawer=function(e){return function(t){(!t||"keydown"!==t.type||"Tab"!==t.key&&"Shift"!==t.key)&&e!==n.state.drawerOpen&&n.setState((function(t){return{drawerOpen:e}}))}},n.handleOnDrawerNavigationValueChange=function(e,t){var a=n.props,r=a.definations,i=a.services,o=a.cache;n.setState((function(e){return{context:t,context_entry:null,context_entries:["commissions","tracks"].includes(t)&&Array.isArray(o.data[t])?o.data[t]:[],defination:["commissions","tracks"].includes(t)?r[t]:e.defination,service:["commissions","tracks"].includes(t)?i[t]:e.service}}))},n.handleClientListItemClick=function(e,t){return function(e){console.log("handleClientListItemClick client",t,"googleMap",ae),ae&&(ae.panTo({lat:t.position.latitude,lng:t.position.longitude}),ae.context.__SECRET_MAP_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.setZoom(15))}},n.handleToggleContextRender=function(e,t){var a=n.props,r=a.definations,i=(a.cache,a.apiCallRequest),d=a.app;n.setState((function(t){var a=t.rendered_contexts.indexOf(e);return{rendered_contexts:t.rendered_contexts.includes(e)?t.rendered_contexts.removeAtIndex(a):t.rendered_contexts.concat([e])}}),Object(c.a)(o.a.mark((function a(){return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:r[e]&&t?i(r[e].name,{uri:r[e].endpoint,type:"records",params:JSON.isJSON(n.state.contexts_props[e])?n.state.contexts_props[e].query:{page:1,pagination:d.preferences.data.pagination,populate:1},data:{},cache:!0}).then((function(t){r[e]&&Function.isFunction(r[e].views.listing.googlemapview.resolveData)&&Array.isArray(t)&&r[e].views.listing.googlemapview.resolveData(t,!0).then((function(a){n.isMounted()?n.setState((function(n){return{context_entry_type:r[e].views.listing.googlemapview.type,context_entry:t.length>0?0:void 0,contexts_props:Object(l.a)(Object(l.a)({},n.contexts_props),{},Object(s.a)({},e,Object(l.a)(Object(l.a)({},n.contexts_props[e]),{},{elements:a,element:r[e].views.listing.googlemapview.type,loaded:!0})))}})):(n.state.context_entry_type=r[e].views.listing.googlemapview.type,n.state.context_entry=t.length>0?0:void 0,n.state.contexts_props=Object(l.a)(Object(l.a)({},n.state.contexts_props),{},Object(s.a)({},e,Object(l.a)(Object(l.a)({},n.state.contexts_props[e]),{},{elements:a,element:r[e].views.listing.googlemapview.type,loaded:!0}))))}))})).catch((function(e){})):r[e]&&(n.isMounted()?n.setState((function(t){return{context_entry_type:void 0,context_entry:void 0,contexts_props:Object(l.a)(Object(l.a)({},t.contexts_props),{},Object(s.a)({},e,Object(l.a)(Object(l.a)({},t.contexts_props[e]),{},{elements:[],element:r[e].views.listing.googlemapview.type,loaded:!1})))}})):(n.state.context_entry_type=void 0,n.state.context_entry=void 0,n.state.contexts_props=Object(l.a)(Object(l.a)({},n.state.contexts_props),{},Object(s.a)({},e,Object(l.a)(Object(l.a)({},n.state.contexts_props[e]),{},{elements:[],element:r[e].views.listing.googlemapview.type,loaded:!1})))));case 1:case"end":return a.stop()}}),a)}))))},n.handleContextEntryClick=function(e,t){n.setState({context_entry:t})};var r=n.props,i=(r.device,r.cache),u=r.context,m=r.contexts,h=(r.definations,r.app);return n.elementRef=U.a.createRef(),n.prepareForView(),n.toggleDrawer=n.toggleDrawer.bind(Object(p.a)(n)),n.handleOnLoadMap=n.handleOnLoadMap.bind(Object(p.a)(n)),n.handleClientListItemClick=n.handleClientListItemClick.bind(Object(p.a)(n)),n.handleOnToggleShowClients=n.handleOnToggleShowClients.bind(Object(p.a)(n)),n.handleOnClientsPositionsLoaded=n.handleOnClientsPositionsLoaded.bind(Object(p.a)(n)),n.handleOnClientPositionAvailable=n.handleOnClientPositionAvailable.bind(Object(p.a)(n)),n.handleOnClientPositionUnavailable=n.handleOnClientPositionUnavailable.bind(Object(p.a)(n)),n.handleOnClientPositionChanged=n.handleOnClientPositionChanged.bind(Object(p.a)(n)),n.handleOnDrawerNavigationValueChange=n.handleOnDrawerNavigationValueChange.bind(Object(p.a)(n)),n.handleContextEntryClick=n.handleContextEntryClick.bind(Object(p.a)(n)),n.handleToggleContextRender=n.handleToggleContextRender.bind(Object(p.a)(n)),n.state=Object(l.a)(Object(l.a)({},n.state),{},{context:u||n.state.context,defaultZoom:h.preferences.data.defaultMapZoom,multicontexts:!!Array.isArray(m)&&m.length>1,rendered_contexts:u?[u]:[],contexts_props:u?Object(s.a)({},u,{query:{page:1,pagination:h.preferences.data.pagination,populate:1},element:"marker",records:[]}):{},context_entries:Array.isArray(i.data[n.state.defination.name])?i.data[n.state.defination.name]:[],drawerOpen:!1}),n}return Object(u.a)(a,[{key:"isMounted",value:function(){return null!=this.elementRef.current}},{key:"componentDidMount",value:function(){}},{key:"prepareForView",value:function(){for(var e=this.props,t=e.auth,a=e.definations,n=e.services,i=e.app,o=null,s=null,l={},c={},d=this.state.contexts_props,u=0,p=Object.entries(a);u<p.length;u++){var m=Object(r.a)(p[u],2),h=m[0],f=m[1];f.access.restricted(t.user)||f.views.listing.googlemapview&&Function.isFunction(f.views.listing.googlemapview.resolveData)&&(l[h]=f,c[h]=n[h],d[h]={query:{page:1,pagination:i.preferences.data.pagination,populate:1},element:f.views.listing.googlemapview.type,elements:[],loaded:!1},null===o&&(o=f,s=n[h]))}this.state.contexts_props=d,this.state.definations=l,this.state.services=c,this.state.defination=o,this.state.service=s}},{key:"handleOnToggleShowClients",value:function(e){this.setState((function(e){return{show_client_positions:!e.show_client_positions}}))}},{key:"handleOnLoadMap",value:function(e,t){ae=e}},{key:"handleOnClientsPositionsLoaded",value:function(e){this.setState((function(t){return{clients_positions:e}}))}},{key:"handleOnClientPositionAvailable",value:function(e,t){this.setState((function(a){return{clients_positions:Object(l.a)(Object(l.a)({},a.clients_positions),{},Object(s.a)({},e,t))}}))}},{key:"handleOnClientPositionUnavailable",value:function(e,t){var a=JSON.fromJSON(this.state.clients_positions);delete a[e],this.setState((function(e){return{clients_positions:a}}))}},{key:"handleOnClientPositionChanged",value:function(e,t){this.state.drawerOpen&&this.setState((function(a){return{clients_positions:Object(l.a)(Object(l.a)({},a.clients_positions),{},Object(s.a)({},e,t))}}))}},{key:"render",value:function(){var e,t=this,a=this.props,i=a.theme,o=a.classes,c=(a.showAll,a.device),d=(a.sockets,a.definations),u=a.services,p=a.contexts,m=a.actions,h=this.state,g=h.context,b=h.clients_positions,y=(h.show_client_positions,h.rendered_contexts),k=h.contexts_props,T=[],V=[],B=[];return y.map((function(e){d[e]&&e in k&&("marker"===k[e].element&&Array.isArray(k[e].elements)?V=V.concat(k[e].elements):"circle"===k[e].element&&Array.isArray(k[e].elements)?T=T.concat(k[e].elements):"polyline"===k[e].element&&Array.isArray(k[e].elements)&&(B=B.concat(k[e].elements)))})),U.a.createElement(N.a,{elevation:0,outlineColor:i.palette.text.primary,style:{backgroundColor:i.palette.background.paper},ref:this.elementRef},U.a.createElement(R.a,{avatar:U.a.createElement(D.a,{style:{backgroundColor:"rgba(0,0,0,0.05)",color:i.palette.text.primary}},U.a.createElement(L.a,null)),title:this.props.context?d[this.props.context]?d[this.props.context].label+" Map":"Map":"Map Overview",subheader:"Click on any context marker, route or polyline in the map for more infomation on the context ",action:U.a.createElement("div",null,Array.isArray(m)&&m.map((function(e,t){var a=e.onClick,r=e.icon,i=Object(n.a)(e,["onClick","icon"]);return U.a.createElement(f.a,Object.assign({"aria-label":"Action",className:"mx-1 inverse-text translucent ",onClick:a,style:{backgroundColor:"rgba(0,0,0,0.05)"},key:"action-button-"+t},i),r)})),U.a.createElement(f.a,{"aria-label":"menu",color:"inherit",className:"mx-1 inverse-text ",onClick:this.toggleDrawer(!this.state.drawerOpen),style:{backgroundColor:"rgba(0,0,0,0.05)"}},U.a.createElement(_.a,{path:j.f,title:"Map Overview Drawer Menu",rotate:this.state.drawerOpen?0:180,size:.8,color:i.palette.text.primary})))}),U.a.createElement(S.a,{className:"p-0 m-0 overflow-x-hidden"},U.a.createElement(A.a,{className:"p-0 m-0"},U.a.createElement(P.a,{xs:12,className:o.wrapper},U.a.createElement("div",{className:v()(o.content,(e={},Object(s.a)(e,o.contentDrawerMargin,c.window_size.width>=1280),Object(s.a)(e,o.contentShift,this.state.drawerOpen&&c.window_size.width>=1280),e)),style:{minHeight:c.window_size.height,backgroundColor:i.palette.background.paper}},U.a.createElement(H.a,{mapHeight:c.window_size.height,showClientsPositions:y.includes("clients_positions"),showCurrentPosition:!0,onLoadClientsPositions:this.handleOnClientsPositionsLoaded,onClientPositionAvailable:this.handleOnClientPositionAvailable,onClientPositionUnavailable:this.handleOnClientPositionUnavailable,onClientPositionChanged:this.handleOnClientPositionChanged,selectedEntry:this.state.context_entry,selectedEntryType:this.state.context_entry_type?this.state.context_entry_type:"clients_position",defaultZoom:this.state.defaultZoom,zoom:this.state.zoom,onMapLoad:this.handleOnLoadMap,polylines:B,markers:V,circles:T})),U.a.createElement(w.a,{className:o.drawer,variant:c.window_size.width>=1280?"persistent":"temporary",anchor:"right",open:this.state.drawerOpen,onClose:this.toggleDrawer(!1),onOpen:this.toggleDrawer(!0),classes:{paper:c.window_size.width>=1280?o.drawerPaper:o.temporaryDrawerPaper}},this.state.multicontexts&&U.a.createElement(M.a,{value:g,onChange:this.handleOnDrawerNavigationValueChange,showLabels:!0,className:"w-full"},U.a.createElement(F.a,{value:"clients_positions",label:"Users",icon:U.a.createElement(_.a,{path:j.a,title:"Clients Postions Users",size:1})}),Object.entries(this.state.definations).map((function(e,t){var a=Object(r.a)(e,2),n=a[0],i=a[1];return U.a.createElement(F.a,{value:n,label:i.label,icon:i.icon,key:"googlemapview-btn-"+n+"-option"})}))),"clients_positions"===g&&0===Object.size(b)&&U.a.createElement(A.a,null,U.a.createElement(P.a,{xs:12,className:"flex items-center justify-center p-2"},U.a.createElement(_.a,{path:j.d,title:"No Records available yet.",color:"#CCCCCC",size:5})),U.a.createElement(P.a,{xs:12,className:"flex items-center justify-center p-2"},U.a.createElement(I.a,null,"No Records available yet."))),"clients_positions"===g&&U.a.createElement(x.a,{className:o.root},Object.entries(b).map((function(e,a){var n=Object(r.a)(e,2),i=n[0],o=n[1],s=!0;if(a>0?o.user._id===b[Object.keys(b)[a-1]].user._id&&(s=!1):ae&&(ae.panTo({lat:o.position.latitude,lng:o.position.longitude}),ae.context.__SECRET_MAP_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.setZoom(15)),o.user&&s)return U.a.createElement(E.a,{className:"cursor-pointer hover:bg-gray-400",onClick:t.handleClientListItemClick(i,o),key:"client-"+i},U.a.createElement(C.a,null,U.a.createElement(D.a,{src:String.isString(o.user.gender)&&"female"===o.user.gender.trim().toLowerCase()?$.a:te.a})),U.a.createElement(O.a,{primary:o.user.first_name+" "+o.user.last_name,secondary:String.isString(o.user.role)?o.user.role.humanize():""}))}))),"commissions"===g&&U.a.createElement(Z.a,{defination:d.commissions,service:u.commissions,query:{},showViewOptions:!1,showAddBtn:!1,showSorter:!0,sorterFormLayoutType:"normal",view:"listview",onLoadData:function(e,a){d[g]&&Function.isFunction(d[g].views.listing.googlemapview.resolveData)&&Array.isArray(e)&&d[g].views.listing.googlemapview.resolveData(e,!0).then((function(n){t.setState((function(t){return{contexts_props:Object(l.a)(Object(l.a)({},t.contexts_props),{},Object(s.a)({},g,Object(l.a)(Object(l.a)({},t.contexts_props[g]),{},{query:a,elements:n,loaded:!0}))),records:e}}))})).catch((function(a){t.setState((function(t){return{contexts_props:Object(l.a)(Object(l.a)({},t.contexts_props),{},Object(s.a)({},g,Object(l.a)(Object(l.a)({},t.contexts_props[g]),{},{elements:[],loaded:!0}))),records:e}}))}))},onClickEntry:this.handleContextEntryClick}),"tracks"===g&&U.a.createElement(Z.a,{defination:d.tracks,service:u.tracks,showViewOptions:!1,showAddBtn:!1,showSorter:!0,showPagination:!0,sorterFormLayoutType:"normal",view:"listview",onLoadData:function(e,a){d[g]&&Function.isFunction(d[g].views.listing.googlemapview.resolveData)&&Array.isArray(e)&&d[g].views.listing.googlemapview.resolveData(e,!0).then((function(n){t.setState((function(t){return{contexts_props:Object(l.a)(Object(l.a)({},t.contexts_props),{},Object(s.a)({},g,Object(l.a)(Object(l.a)({},t.contexts_props[g]),{},{query:a,elements:n,loaded:!0}))),records:e}}))})).catch((function(n){t.setState((function(t){return{contexts_props:Object(l.a)(Object(l.a)({},t.contexts_props),{},Object(s.a)({},g,Object(l.a)(Object(l.a)({},t.contexts_props[g]),{},{query:a,elements:[],loaded:!0}))),records:e}}))}))},onClickEntry:this.handleContextEntryClick}))))),U.a.createElement(q.a,null,U.a.createElement(A.a,{className:"p-0 m-0"},Array.isArray(p)&&p.map((function(e,a){return U.a.createElement(P.a,{xs:12,md:Math.round(12/p.length),className:"flex items-center justify-center",key:"context_entry_switch-"+a},U.a.createElement(X.l,{label:"clients_positions"===e?"Users":d[e]?d[e].label:e,value:t.state.rendered_contexts.includes(e),onChange:function(a){t.handleToggleContextRender(e,a)}}))})),U.a.createElement(P.a,{xs:12},U.a.createElement(I.a,{variant:"body2"},this.props.context&&d[this.props.context]?d[this.props.context].label+" Map from a glance":"Map from a glance")))))}}]),a}(U.a.Component);ne.defaultProps={contexts:["clients_positions","commissions","tracks"],context:"clients_positions",actions:[]};t.default=Object(J.c)(Y()(y()((function(e){return{root:{padding:"0"},wrapper:{display:"flex",margin:0,padding:0},drawer:{width:e.appDrawer.width,flexShrink:0},drawerPaper:{width:e.appDrawer.width,position:"absolute",zIndex:e.zIndex.appBar/2,backgroundColor:e.palette.background.paper},temporaryDrawerPaper:{width:e.appDrawer.width,background:e.palette.background.default},content:{flexGrow:1,padding:0,transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},contentDrawerMargin:{marginRight:-e.appDrawer.width},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginRight:0}}})),Object(z.b)((function(e){return{app:e.app,auth:e.auth,cache:e.cache,device:e.device}}),{apiCallRequest:W.gb,closeDialog:W.pb,openDialog:W.sb}),T.a,G.a)(ne))},1382:function(e,t,a){"use strict";var n=a(47);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(0)),i=(0,n(a(61)).default)(r.default.createElement("path",{d:"M4.47 21h15.06c1.54 0 2.5-1.67 1.73-3L13.73 4.99c-.77-1.33-2.69-1.33-3.46 0L2.74 18c-.77 1.33.19 3 1.73 3zM12 14c-.55 0-1-.45-1-1v-2c0-.55.45-1 1-1s1 .45 1 1v2c0 .55-.45 1-1 1zm1 4h-2v-2h2v2z"}),"WarningRounded");t.default=i},1924:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a(12),i=a(14),o=a(26),s=a(18),l=a(17),c=a(41),d=a.n(c),u=a(1382),p=a.n(u),m=a(3),h=a(25),f=a(22),g=a(16),v=a(20),b=a(29),y=a(0),w=a.n(y),x=a(35),E=a(10),O=a(64),C=a.n(O),k=a(40),_=a(439),j=a(50),D=a(438),N=a(1370),q=function(e){Object(s.a)(a,e);var t=Object(l.a)(a);function a(e){var o;Object(i.a)(this,a),(o=t.call(this,e)).defination=null,o.service=null,o.state={query:{}};var s=e.componentProps;o.context=s.context,o.defination=b[s.context],o.service=k[s.context];var l=(window.location.search.match(new RegExp("([^?=&]+)(=([^&]*))?","g"))||[]).reduce((function(e,t,a,n){var i=decodeURI(t).split("="),o=Object(r.a)(i,2),s=o[0],l=o[1];return e[s]=l,e}),{});return console.log("window.location.search",decodeURI(window.location.search)),console.log("urlQuery",l),o.state.query=Object(n.a)(Object(n.a)({},o.state.query),l),o}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.auth,a=e.location,n=e.appendNavHistory;n&&a&&n({name:this.defination.name,uri:a.pathname,title:"function"===typeof this.defination.label?this.defination.label(t.user):this.defination.label,view:null,state:this.state,color:this.defination.color?this.defination.color:m.b.hex.primary,scrollTop:0})}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.auth;return w.a.createElement(f.a,{className:t.root},w.a.createElement(g.a,{xs:12},this.defination.access.restricted(a.user)&&w.a.createElement(f.a,{className:t.fullPageHeight,direction:"column",justify:"center",alignItems:"center"},w.a.createElement(g.a,{xs:12},w.a.createElement(v.a,{color:"error",variant:"h1",center:!0,fullWidth:!0},w.a.createElement(p.a,{className:t.errorIcon}))),w.a.createElement(g.a,{xs:12},w.a.createElement(v.a,{color:"grey",variant:"h3",center:!0,fullWidth:!0},"Access Denied!")),w.a.createElement(g.a,{xs:12},w.a.createElement(v.a,{color:"default",variant:"body1",center:!0,fullWidth:!0},"Sorry! Access to this resource has been denied since you lack required priviledges."," ",w.a.createElement("br",null)," Please contact the system administrator for further details.")),w.a.createElement(g.a,{xs:12},w.a.createElement(v.a,{color:"error",variant:"body1",center:!0,fullWidth:!0},w.a.createElement(E.b,{to:"home".toUriWithDashboardPrefix()}," ",w.a.createElement(h.a,{variant:"text",color:"default",simple:!0}," ","Home"," ")," ")))),!this.defination.access.restricted(a.user)&&w.a.createElement(N.a,{defination:this.defination,service:this.service,query:this.state.query})))}}]),a}(w.a.Component);t.default=Object(j.a)(C()(d()(D.a),Object(x.b)((function(e){return{auth:e.auth}}),{appendNavHistory:_.a}))(q))}}]);
//# sourceMappingURL=15.334a8aff.chunk.js.map