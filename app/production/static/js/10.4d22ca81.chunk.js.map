{"version":3,"sources":["assets/img/empty-state-table.svg","components/Calendar/index.jsx","views/widgets/Listings/CalendarView/index.jsx","views/widgets/Listings/CalendarView/styles.jsx","views/widgets/Listings/ListView/index.jsx","views/widgets/Listings/ListView/styles.jsx","views/widgets/Listings/TableView/index.jsx","views/widgets/Listings/TableView/styles.jsx","views/widgets/Listings/index.jsx","views/widgets/Listings/styles.jsx","views/widgets/Listings/GoogleMapView/index.jsx","views/widgets/Listings/GoogleMapView/styles.jsx","views/widgets/RecordView/CardView/index.jsx","views/widgets/RecordView/index.jsx","views/widgets/RecordView/styles.jsx","views/widgets/Overview/GoogleMapOverview/index.jsx","views/widgets/Overview/GoogleMapOverview/styles.jsx","../node_modules/@material-ui/lab/esm/Skeleton/Skeleton.js","../node_modules/@material-ui/icons/ArrowBack.js","../node_modules/@material-ui/icons/People.js","components/ViewPortSensor/index.jsx","../node_modules/@material-ui/icons/AudiotrackOutlined.js","../node_modules/@material-ui/icons/MovieOutlined.js","../node_modules/@material-ui/icons/AttachFile.js","../node_modules/@material-ui/icons/Person.js","../node_modules/@material-ui/icons/Contacts.js","../node_modules/@material-ui/icons/Block.js","../node_modules/@material-ui/icons/Done.js","../node_modules/@material-ui/icons/DoneAll.js","../node_modules/@material-ui/icons/Refresh.js","../node_modules/@material-ui/icons/ChatBubbleOutline.js","../node_modules/@material-ui/icons/DeleteOutlined.js","views/apps/Dashboard/Chat/index.jsx","views/apps/Dashboard/Chat/styles.jsx","views/pages/Dashboard/Messages/index.jsx"],"names":["module","exports","AntTabs","withStyles","indicator","backgroundColor","colors","hex","accent","Tabs","AntTab","theme","root","textTransform","minWidth","fontWeight","typography","fontWeightRegular","marginRight","spacing","color","opacity","fontWeightMedium","selected","props","Tab","CustomCalendar","calendarRef","React","createRef","state","view","view_title","Date","format","formats","dateformats","month","calendars","tasks","schedules","handleChangeCalendarView","event","current","rendered_date","getInstance","getDate","toDate","setState","date","week","handleClickPrevButton","calendarInstance","prev","handleClickNextButton","next","handleOnEditEntryClick","handleOnDeleteEntryClick","show_actions","icon","title","subtitle","icon_color","title_color","subtitle_color","calendarProps","bind","this","initCalendarEvents","prevProps","refreshRequired","Object","areEqual","prevState","snapshot","onSelect","onClickEntry","onClickEdit","onClickDelete","calendar","on","clickSchedule","e","UtilitiesHelper","isOfType","schedule","beforeCreateSchedule","beforeUpdateSchedule","beforeDeleteSchedule","classes","height","defaultView","disableDblClick","disableClick","isReadOnly","useDetailPopup","useCreationPopup","scheduleView","taskView","calProps","Card","elevation","outlineColor","CardHeader","avatar","Avatar","aria-label","style","background","subheader","CardContent","className","GridContainer","GridItem","sm","md","value","onChange","indicatorColor","textColor","variant","label","Typography","center","IconButton","onClick","xs","ref","CardActions","display","gutterBottom","map","index","Status","bgColor","secondary","text","name","key","Component","defaultProps","rgb","grey","primary","primarydark","withRoot","styles","CalendarView","loading","load_error","records","handleDeleteItem","item_id","openDialog","closeDialog","body","actions","service","then","res","loadData","console","log","defination","query","app","p","handleEditItem","handleDeleteItemConfirm","loadContext","contextReloadRequired","dataReloadRequired","auth","access","update","restricted","user","window","location","href","uri","id","cancel","delete","borderColor","cache","apiCallRequest","cache_data","onLoadData","load_data","endpoint","type","params","data","Function","isFunction","prepareData","Array","isArray","msg","target_data","scope","columns","views","listing","calendarview","resolveData","resolve","err","full_height","justify","alignItems","ProgressIndicator","size","thickness","progress","disableShrink","fullWidth","Icon","fontSize","code","length","Calendar","alt","emptyImage","src","EmptyStateImage","emptyText","withErrorHandler","compose","padding","connect","ListView","raw_records","dispatch","Actions","close","mounted","dataPreparationRequired","entryItemProps","listview","Skeleton","width","List","entry","ListItem","button","listItem","ListItemAvatar","ListItemIcon","ListItemText","Divider","component","show_links","transition","transitions","create","easing","sharp","duration","palette","action","hover","ownProps","api","tableIcons","Add","forwardRef","Check","Clear","Delete","DetailPanel","Edit","Export","Filter","FirstPage","LastPage","NextPage","PreviousPage","ResetSearch","Search","SortArrow","ThirdStateCheck","ViewColumn","TableView","dt_columns","raw_data","raw_data_mutated","mouseX","mouseY","actionsView","context","handleSocketsOnCreate","sockets","model","new_raw_data","unshift","result","_id","new_records","filter","record","handleOnRowContextMenu","preventDefault","clientX","clientY","handleOnRowContextMenuClose","cachedData","off","actionsType","push","String","isString","singularize","field","display_field","tableview","reference","possibilities","render","rowData","cursor","tableProps","input","isAttachment","Chip","valueChip","Boolean","FilesHelper","fileType","AttachmentsService","getAttachmentFileUrl","undefined","fileIcon","open","focus","entries","parsed_data","field_name","datetime","time","JSON","isJSON","stringify","possibilities_obj","resolved_data","ServiceDataHelper","resolveReferenceColumnsDisplays","that","all_records","parseData","toCSV","history","ClickAwayListener","onContextMenu","onClickAway","Menu","onClose","anchorReference","anchorPosition","top","left","MenuItem","icons","options","search","exportButton","exportCsv","tableColumns","tableData","csvDataColumns","column","forEach","row","paging","onRowClick","toUriWithDashboardPrefix","busy","error","data_actions_wrapper","whiteSpace","margin","maxWidth","marginTop","withGlobals","withRouter","TablePaginationActions","useTheme","count","page","rowsPerPage","onChangePage","disabled","direction","Math","ceil","max","ListingView","showViewOptions","showAddBtn","searchKeyword","pages","viewMenuAnchorEl","sortFields","filterAccordionExpanded","filterableFields","filterContext","filterMenuAnchor","filters","values","labels","searchkeywordRef","handleViewItemClick","handleShowViewsMenu","currentTarget","handleCloseViewsMenu","handleOnPageChanged","handleOnRecordsPerPageChanged","pagination","Number","parseNumber","target","preferences","column_name","column_props","includes","filterContextMatched","filterableColumns","keys","queryColumn","queryValue","q","prepareForRender","prepareForRenderRequired","all_views","googlemapview","vectormapview","default_view","showPagination","showSorter","sorterFormLayoutType","Button","link","inline","Accordion","expanded","Paper","searchRoot","onSubmit","filterIconButton","humanize","anchorEl","keepMounted","filterableField","filterableFieldProps","searchInput","placeholder","inputProps","defaultValue","onFocus","newKeyword","newState","newQuery","fromJSON","searchIconButton","AccordionDetails","filter_name","filter_label","GoogleMapOverview","TablePagination","labelRowsPerPage","rowsPerPageOptions","onChangeRowsPerPage","ActionsComponent","SelectProps","toolbar","paper","borderRight","borderLeft","activeVieBtn","inverse","border","viewBtnGroup","position","right","marginLeft","flex","searchDivider","GoogleMapView","googleMapProps","GoogleMap","defaultZoom","zoom","polylines","markers","circles","showCurrentPosition","complete","mapHeight","showClientsPositions","useState","resolvedRefRecord","resolveDisplayValue","Fragment","paragraph","single","cardview","resolver","resolveAvatar","primaries","identity","i","resolveTitle","secondaries","resolveSubTitle","resolveValue","TabPanel","children","other","role","hidden","aria-labelledby","Box","RecordView","handleViewMenuItemClick","prepareForView","handleExpandClick","handleRelatedTabValueChange","relatedTab","dependants","definations","viewSelectBtn","clsx","expand","expandOpen","aria-expanded","relationsSectionTitle","Collapse","in","timeout","AppBar","dependant","properties","services","bottom","transform","shortest","lineHeight","verticalAlign","googleMap","drawerOpen","show_client_positions","clients_positions","context_entry","multicontexts","rendered_contexts","contexts_props","toggleDrawer","handleOnDrawerNavigationValueChange","newValue","context_entries","handleClientListItemClick","socketId","client","panTo","lat","latitude","lng","longitude","__SECRET_MAP_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","setZoom","handleToggleContextRender","renderContext","renderedContextIndex","indexOf","removeAtIndex","concat","a","populate","isMounted","context_entry_type","elements","element","loaded","handleContextEntryClick","device","contexts","elementRef","handleOnLoadMap","handleOnToggleShowClients","handleOnClientsPositionsLoaded","handleOnClientPositionAvailable","handleOnClientPositionUnavailable","handleOnClientPositionChanged","defaultMapZoom","current_defination","current_service","possible_definations","possible_services","google","clientId","newclientspositions","showAll","rendered_context","rest","path","mdiForwardburger","rotate","wrapper","classNames","content","contentDrawerMargin","window_size","contentShift","minHeight","onLoadClientsPositions","onClientPositionAvailable","onClientPositionUnavailable","onClientPositionChanged","selectedEntry","selectedEntryType","onMapLoad","SwipeableDrawer","drawer","anchor","onOpen","drawerPaper","temporaryDrawerPaper","BottomNavigation","showLabels","BottomNavigationAction","mdiAccountCircleOutline","mdiFolderOutline","show_entry","gender","trim","toLowerCase","client_user_female_icon","client_user_male_icon","first_name","last_name","Listings","commissions","loadedData","tracks","context_entry_name","round","new_value","appDrawer","flexShrink","zIndex","appBar","flexGrow","leavingScreen","easeOut","enteringScreen","withTheme","_props$animation","animation","_props$component","_props$variant","_objectWithoutProperties","hasChildren","_extends","withChildren","fitContent","heightAuto","fade","marginBottom","transformOrigin","borderRadius","shape","rect","circle","pulse","wave","overflow","visibility","_interopRequireDefault","require","defineProperty","_react","_default","createElement","d","ViewPortSensor","offset","onViewportVisibilityChange","placeholderType","useRef","rootMargin","isIntersecting","setIntersecting","useEffect","observer","IntersectionObserver","observe","unobserve","useOnScreen","fill","Alert","AlwaysScrollToBottom","useGlobals","scrollIntoView","useCallback","Chat","messaging","layout","communication","activeConversation","setMessagingCache","textInputRef","clearMessagingCache","messagesWrapperRef","useLocation","useHistory","conversations","unread_count","unread_ids","active_conversation","contacts","drafts","active_conversation_messages","chats","setChats","desc","contactsQuery","setContactsQuery","loadingConversations","setLoadingConversations","setLoadingContacts","draft","setDraft","setIndividualConversationsRecipients","setError","setContacts","contactsDrawerOpen","setContactsDrawerOpen","attachmentDialOpen","setAttachmentDialOpen","contextMenu","setContextMenu","setLoadingActiveChatMessages","locationHasWith","setLocationHasWith","firstLoad","setFirstLoad","attachmentActions","main","warning","info","loadConversations","errorMsg","handleContextOpen","handleContextClose","handleNewChat","recipients","recipients_ids","recipient","isEmpty","existsAtIndex","chat","owner_id","owner","recipient_id","updatedChats","existingChat","parse","remove","getConversationMessages","is_reply","sender","reply_for","conversation","newChat","participants","started_by","emit","handlePresenceChanged","presence","currentContacts","newContacts","user_id","contact","currentChats","newChats","chat_owner_id","handleOnUserStartedTypingMessage","chat_id","typing_users_arr","typing","exists","chat_typing_user","currentActiveChat","newCurrentActiveChat","handleOnUserStoppedTypingMessage","handleOnConversationMessages","messages","handleSocketActionError","handleOnMessageDeletedForUser","message","currentActiveChatMessages","newActiveChatMessages","activeChatMessage","handleOnMessageDeletedForAll","handleOnMessageStateChangedBySocketAction","withRecipient","URLSearchParams","get","email_address","newIndividualConversationsRecipients","mainAppBar","Toolbar","pathname","edge","group_avatar","group_name","ScrollBars","bodyWrapper","users","loadedQuery","square","list","primaryText","chatUser","last_message_content","last_message_deleted","last_message_sender_name","total","last_message","participant","Badge","badgeContent","anchorOrigin","vertical","horizontal","dot","contactAvatar","iconAvatar","divider","incoming_unread","ListItemSecondaryAction","chatsAppBar","Fab","fabButton","grow","chatPaperWrapper","chatScrollWrapper","scrollToBottomOnChildChange","message_deleted","show_message","chatBubbleLocal","chatBubbleExternal","inViewport","attachments","attachment","LazyImage","created_on","toLocaleString","typing_loader","chatInputsWrapper","currentDraft","newDraft","filesLimit","acceptedFiles","multiline","rows","onBlur","inputRef","onKeyDown","newMessageValue","messageToSend","newMessage","merge","handleOnSendMessage","Snackbar","autoHideDuration","severity","firstView","maxHeight","flexDirection","overflowX","paddingBottom","overflowY","scrollWrapper","boxShadow","paddingTop","light","borderBottomRightRadius","borderBottomLeftRadius","borderTopRightRadius","borderTopLeftRadius","chatBubbleLocalSequential","active","webkitAnimation","mozAnimation","Page","appendNavHistory","scrollTop"],"mappings":"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","file":"static/js/10.4d22ca81.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/empty-state-table.cdb06dd9.svg\";","/** @format */\n\nimport IconButton from \"@material-ui/core/IconButton\";\nimport withStyles from \"@material-ui/core/styles/withStyles\";\nimport Tab from \"@material-ui/core/Tab\";\n//\nimport Tabs from \"@material-ui/core/Tabs\";\nimport {\n\tArrowBack as PrevIcon,\n\tArrowForward as NextIcon,\n\tEventOutlined as CalendarIcon,\n} from \"@material-ui/icons\";\nimport Calendar from \"@toast-ui/react-calendar\";\nimport { colors } from \"assets/jss/app-theme\";\nimport Avatar from \"components/Avatar\";\nimport Card from \"components/Card\";\nimport CardActions from \"components/Card/CardActions\";\nimport CardContent from \"components/Card/CardContent\";\nimport CardHeader from \"components/Card/CardHeader\";\nimport GridContainer from \"components/Grid/GridContainer\";\nimport GridItem from \"components/Grid/GridItem\";\nimport Status from \"components/Status\";\nimport Typography from \"components/Typography\";\nimport { formats } from \"config/data\";\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\nimport { UtilitiesHelper } from \"hoc/Helpers\";\nimport withRoot from \"hoc/withRoot\";\nimport styles from \"views/pages/styles\";\n\nconst AntTabs = withStyles({\n\tindicator: {\n\t\tbackgroundColor: colors.hex.accent,\n\t},\n})(Tabs);\n\nconst AntTab = withStyles(theme => ({\n\troot: {\n\t\ttextTransform: \"none\",\n\t\tminWidth: 50,\n\t\tfontWeight: theme.typography.fontWeightRegular,\n\t\tmarginRight: theme.spacing(),\n\t\t\"&:hover\": {\n\t\t\tcolor: colors.hex.default,\n\t\t\topacity: 1,\n\t\t},\n\t\t\"&$selected\": {\n\t\t\tcolor: colors.hex.accent,\n\t\t\tfontWeight: theme.typography.fontWeightMedium,\n\t\t},\n\t\t\"&:focus\": {\n\t\t\tcolor: colors.hex.accent,\n\t\t},\n\t},\n\tselected: {},\n}))(props => <Tab {...props} />);\n\nclass CustomCalendar extends React.Component {\n\tcalendarRef = React.createRef();\n\tstate = {\n\t\tview: \"month\",\n\t\tview_title: new Date().format(formats.dateformats.month),\n\t\tcalendars: [],\n\t\ttasks: [],\n\t\tschedules: [],\n\t};\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tconst {\n\t\t\ttheme,\n\t\t\tview,\n\t\t\tcalendars,\n\t\t\ttasks,\n\t\t\tschedules,\n\t\t\tshow_actions,\n\t\t\ticon,\n\t\t\ttitle,\n\t\t\tsubtitle,\n\t\t\ticon_color,\n\t\t\ttitle_color,\n\t\t\tsubtitle_color,\n\t\t\tcalendarProps,\n\t\t} = props;\n\t\tthis.state = {\n\t\t\t...this.state,\n\t\t\ttheme: theme,\n\t\t\tview: view,\n\t\t\tview_title:\n\t\t\t\tview === \"day\"\n\t\t\t\t\t? new Date().format(formats.dateformats.date)\n\t\t\t\t\t: view === \"week\"\n\t\t\t\t\t? new Date().format(formats.dateformats.week)\n\t\t\t\t\t: new Date().format(formats.dateformats.month),\n\t\t\tcalendars: calendars,\n\t\t\ttasks: tasks,\n\t\t\tschedules: schedules,\n\t\t\tshow_actions: show_actions,\n\t\t\ticon: icon,\n\t\t\ttitle: title,\n\t\t\tsubtitle: subtitle,\n\t\t\ticon_color: icon_color,\n\t\t\ttitle_color: title_color,\n\t\t\tsubtitle_color: subtitle_color,\n\t\t\tcalendarProps: calendarProps,\n\t\t};\n\t\tthis.handleChangeCalendarView = this.handleChangeCalendarView.bind(\n\t\t\tthis\n\t\t);\n\t\tthis.handleClickPrevButton = this.handleClickPrevButton.bind(this);\n\t\tthis.handleClickNextButton = this.handleClickNextButton.bind(this);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.initCalendarEvents();\n\t}\n\n\tgetSnapshotBeforeUpdate(prevProps) {\n\t\treturn { refreshRequired: !Object.areEqual(prevProps, this.props) };\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\n\t\tconst {\n\t\t\ttheme,\n\t\t\tview,\n\t\t\tcalendars,\n\t\t\ttasks,\n\t\t\tschedules,\n\t\t\tshow_actions,\n\t\t\ticon,\n\t\t\ttitle,\n\t\t\tsubtitle,\n\t\t\ticon_color,\n\t\t\ttitle_color,\n\t\t\tsubtitle_color,\n\t\t\tcalendarProps,\n\t\t} = this.props;\n\t\tif (snapshot.refreshRequired) {\n\t\t\tthis.setState(\n\t\t\t\t{\n\t\t\t\t\ttheme: theme,\n\t\t\t\t\tview: view,\n\t\t\t\t\tview_title:\n\t\t\t\t\t\tview === \"day\"\n\t\t\t\t\t\t\t? new Date().format(formats.dateformats.date)\n\t\t\t\t\t\t\t: view === \"week\"\n\t\t\t\t\t\t\t? new Date().format(formats.dateformats.week)\n\t\t\t\t\t\t\t: new Date().format(formats.dateformats.month),\n\t\t\t\t\tcalendars: calendars,\n\t\t\t\t\ttasks: tasks,\n\t\t\t\t\tschedules: schedules,\n\t\t\t\t\tshow_actions: show_actions,\n\t\t\t\t\ticon: icon,\n\t\t\t\t\ttitle: title,\n\t\t\t\t\tsubtitle: subtitle,\n\t\t\t\t\ticon_color: icon_color,\n\t\t\t\t\ttitle_color: title_color,\n\t\t\t\t\tsubtitle_color: subtitle_color,\n\t\t\t\t\tcalendarProps: calendarProps,\n\t\t\t\t},\n\t\t\t\tthis.initCalendarEvents\n\t\t\t);\n\t\t}\n\t}\n\n\tinitCalendarEvents() {\n\t\tconst {\n\t\t\tonSelect,\n\t\t\tonClickEntry,\n\t\t\tonClickEdit,\n\t\t\tonClickDelete,\n\t\t} = this.props;\n\t\tconst calendar = this.calendarRef.current.getInstance();\n\t\tif (calendar) {\n\t\t\tcalendar.on({\n\t\t\t\tclickSchedule: function(e) {\n\t\t\t\t\tif (UtilitiesHelper.isOfType(onClickEntry, \"function\")) {\n\t\t\t\t\t\tonClickEntry(e.schedule);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tbeforeCreateSchedule: function(e) {\n\t\t\t\t\tif (UtilitiesHelper.isOfType(onSelect, \"function\")) {\n\t\t\t\t\t\tonSelect(e);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tbeforeUpdateSchedule: function(e) {\n\t\t\t\t\tif (UtilitiesHelper.isOfType(onClickEdit, \"function\")) {\n\t\t\t\t\t\tonClickEdit(e);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tbeforeDeleteSchedule: function(e) {\n\t\t\t\t\tif (UtilitiesHelper.isOfType(onClickDelete, \"function\")) {\n\t\t\t\t\t\tonClickDelete(e);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t}\n\n\thandleChangeCalendarView = (event, view) => {\n\t\tif (this.calendarRef.current) {\n\t\t\tconst calendarInstance = this.calendarRef.current.getInstance();\n\t\t\tconst rendered_date = calendarInstance.getDate().toDate();\n\t\t\tthis.setState(state => ({\n\t\t\t\tview: view,\n\t\t\t\tview_title:\n\t\t\t\t\tview === \"day\"\n\t\t\t\t\t\t? rendered_date.format(formats.dateformats.date)\n\t\t\t\t\t\t: view === \"week\"\n\t\t\t\t\t\t? rendered_date.format(formats.dateformats.week)\n\t\t\t\t\t\t: rendered_date.format(formats.dateformats.month),\n\t\t\t}));\n\t\t} else {\n\t\t\tthis.setState(state => ({ view: view }));\n\t\t}\n\t};\n\n\thandleClickPrevButton = () => {\n\t\tif (this.calendarRef.current) {\n\t\t\tconst calendarInstance = this.calendarRef.current.getInstance();\n\t\t\tcalendarInstance.prev();\n\t\t\tconst rendered_date = calendarInstance.getDate().toDate();\n\t\t\tthis.setState(state => ({\n\t\t\t\tview_title:\n\t\t\t\t\tstate.view === \"day\"\n\t\t\t\t\t\t? rendered_date.format(formats.dateformats.date)\n\t\t\t\t\t\t: state.view === \"week\"\n\t\t\t\t\t\t? rendered_date.format(formats.dateformats.week)\n\t\t\t\t\t\t: rendered_date.format(formats.dateformats.month),\n\t\t\t}));\n\t\t}\n\t};\n\n\thandleClickNextButton = () => {\n\t\tif (this.calendarRef.current) {\n\t\t\tconst calendarInstance = this.calendarRef.current.getInstance();\n\t\t\tcalendarInstance.next();\n\t\t\tconst rendered_date = calendarInstance.getDate().toDate();\n\t\t\tthis.setState(state => ({\n\t\t\t\tview_title:\n\t\t\t\t\tstate.view === \"day\"\n\t\t\t\t\t\t? rendered_date.format(formats.dateformats.date)\n\t\t\t\t\t\t: state.view === \"week\"\n\t\t\t\t\t\t? rendered_date.format(formats.dateformats.week)\n\t\t\t\t\t\t: rendered_date.format(formats.dateformats.month),\n\t\t\t}));\n\t\t}\n\t};\n\n\thandleOnEditEntryClick = event => {\n\t\tif (this.calendarRef.current) {\n\t\t}\n\t};\n\n\thandleOnDeleteEntryClick = event => {\n\t\tif (this.calendarRef.current) {\n\t\t}\n\t};\n\n\trender() {\n\t\tconst {\n\t\t\tclasses,\n\t\t\theight,\n\t\t\tdefaultView,\n\t\t\tdisableDblClick,\n\t\t\tdisableClick,\n\t\t\tisReadOnly,\n\t\t\tuseDetailPopup,\n\t\t\tuseCreationPopup,\n\t\t\tscheduleView,\n\t\t\ttaskView,\n\t\t} = this.props;\n\t\tconst {\n\t\t\ttheme,\n\t\t\tview,\n\t\t\tview_title,\n\t\t\tcalendars,\n\t\t\ttasks,\n\t\t\tschedules,\n\t\t\tshow_actions,\n\t\t\ticon,\n\t\t\ttitle,\n\t\t\tsubtitle,\n\t\t\ticon_color,\n\t\t\ttitle_color,\n\t\t\tsubtitle_color,\n\t\t\tcalendarProps,\n\t\t} = this.state;\n\t\tconst calProps = {\n\t\t\theight: height + \"px\",\n\t\t\tdefaultView: defaultView,\n\t\t\tdisableDblClick: disableDblClick,\n\t\t\tdisableClick: disableClick,\n\t\t\tisReadOnly: isReadOnly,\n\t\t\tuseDetailPopup: useDetailPopup,\n\t\t\tuseCreationPopup: useCreationPopup,\n\t\t\tscheduleView: scheduleView,\n\t\t\ttaskView: taskView,\n\t\t\t...calendarProps,\n\t\t};\n\n\t\treturn (\n\t\t\t<Card elevation={0} outlineColor=\"#cfd8dc\">\n\t\t\t\t<CardHeader\n\t\t\t\t\tavatar={\n\t\t\t\t\t\t<Avatar\n\t\t\t\t\t\t\taria-label={title}\n\t\t\t\t\t\t\tstyle={{ background: icon_color }}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{icon}\n\t\t\t\t\t\t</Avatar>\n\t\t\t\t\t}\n\t\t\t\t\ttitle={title}\n\t\t\t\t\tsubheader={subtitle}\n\t\t\t\t></CardHeader>\n\t\t\t\t<CardContent className=\"p-0 m-0\">\n\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t<GridItem sm={6} md={4}>\n\t\t\t\t\t\t\t\t<AntTabs\n\t\t\t\t\t\t\t\t\tvalue={view}\n\t\t\t\t\t\t\t\t\tonChange={this.handleChangeCalendarView}\n\t\t\t\t\t\t\t\t\tindicatorColor=\"primary\"\n\t\t\t\t\t\t\t\t\ttextColor=\"primary\"\n\t\t\t\t\t\t\t\t\tvariant=\"fullWidth\"\n\t\t\t\t\t\t\t\t\taria-label=\"view change tabs\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<AntTab value=\"month\" label=\"Month\" />\n\t\t\t\t\t\t\t\t\t<AntTab value=\"week\" label=\"Week\" />\n\t\t\t\t\t\t\t\t\t<AntTab value=\"day\" label=\"Day\" />\n\t\t\t\t\t\t\t\t</AntTabs>\n\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t<GridItem sm={6} md={4}>\n\t\t\t\t\t\t\t\t<Typography variant=\"h3\" center>\n\t\t\t\t\t\t\t\t\t{\" \"}\n\t\t\t\t\t\t\t\t\t{view_title}{\" \"}\n\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t<GridItem sm={12} md={4}>\n\t\t\t\t\t\t\t\t<div className=\"float-right\">\n\t\t\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\t\t\tonClick={this.handleClickPrevButton}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<PrevIcon />\n\t\t\t\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\t\t\tonClick={this.handleClickNextButton}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<NextIcon />\n\t\t\t\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t</GridContainer>\n\n\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t\t<Calendar\n\t\t\t\t\t\t\t\t\ttheme={theme}\n\t\t\t\t\t\t\t\t\tview={view}\n\t\t\t\t\t\t\t\t\tclassName={classes.calendar}\n\t\t\t\t\t\t\t\t\tcalendars={calendars}\n\t\t\t\t\t\t\t\t\ttasks={tasks}\n\t\t\t\t\t\t\t\t\tschedules={schedules}\n\t\t\t\t\t\t\t\t\tref={this.calendarRef}\n\t\t\t\t\t\t\t\t\t{...calProps}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t</GridContainer>\n\t\t\t\t</CardContent>\n\t\t\t\t<CardActions>\n\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\tvariant=\"subtitle2\"\n\t\t\t\t\t\t\t\tdisplay=\"block\"\n\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\tgutterBottom\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{\" \"}\n\t\t\t\t\t\t\t\tCalendar index{\" \"}\n\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t{calendars.map((calendar, index) => (\n\t\t\t\t\t\t\t\t<Status\n\t\t\t\t\t\t\t\t\tcolor={\n\t\t\t\t\t\t\t\t\t\tcalendar.bgColor\n\t\t\t\t\t\t\t\t\t\t\t? calendar.bgColor\n\t\t\t\t\t\t\t\t\t\t\t: colors.hex.secondary\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\ttext={calendar.name}\n\t\t\t\t\t\t\t\t\tkey={\"calendar-\" + index}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t</GridContainer>\n\t\t\t\t</CardActions>\n\t\t\t</Card>\n\t\t);\n\t}\n}\n\nCustomCalendar.propTypes = {\n\tclasses: PropTypes.object.isRequired,\n\tclassName: PropTypes.string,\n\tcalendars: PropTypes.array,\n\tview: PropTypes.string,\n\ttasks: PropTypes.array,\n\tschedules: PropTypes.array,\n\tshow_actions: PropTypes.bool,\n\ttheme: PropTypes.object,\n\tcalendarProps: PropTypes.object,\n\tstartDate: PropTypes.string,\n\ticon: PropTypes.node,\n\ttitle: PropTypes.string,\n\tsubtitle: PropTypes.string,\n\ticon_color: PropTypes.string,\n\ttitle_color: PropTypes.string,\n\tsubtitle_color: PropTypes.string,\n\theight: PropTypes.number,\n\tdefaultView: PropTypes.string,\n\tdisableDblClick: PropTypes.bool,\n\tdisableClick: PropTypes.bool,\n\tisReadOnly: PropTypes.bool,\n\tuseDetailPopup: PropTypes.bool,\n\tuseCreationPopup: PropTypes.bool,\n\tscheduleView: PropTypes.bool,\n\ttaskView: PropTypes.bool,\n\tonSelect: PropTypes.func,\n\tonClickEntry: PropTypes.func,\n\tonClickEdit: PropTypes.func,\n\tonClickDelete: PropTypes.func,\n};\n\nCustomCalendar.defaultProps = {\n\tcalendars: [],\n\ttasks: [],\n\tschedules: [],\n\tview: \"month\",\n\ttheme: {\n\t\t\"common.border\": \"1px solid rgba(\" + colors.rgb.grey + \", 0.5)\",\n\t\t\"common.backgroundColor\": \"#fcfcfc\",\n\t\t\"common.holiday.color\": colors.hex.grey,\n\t\t\"common.saturday.color\": colors.hex.grey,\n\t\t\"common.dayname.color\": colors.hex.default,\n\t\t\"common.today.color\": colors.hex.primary,\n\t\t\"week.currentTime.color\": colors.hex.primarydark,\n\t},\n\tshow_actions: true,\n\ticon: <CalendarIcon />,\n\ttitle: \"My\",\n\tsubtitle: \"Calendar\",\n\ticon_color: colors.hex.primary,\n\ttitle_color: colors.hex.primary,\n\tsubtitle_color: colors.hex.grey,\n\tcalendarProps: {},\n\theight: 900,\n\tdefaultView: \"month\",\n\tdisableDblClick: true,\n\tdisableClick: false,\n\tisReadOnly: false,\n\tuseDetailPopup: true,\n\tuseCreationPopup: false,\n\tscheduleView: true,\n\ttaskView: true,\n};\n\nexport default withRoot(withStyles(styles)(CustomCalendar));\n","/** @format */\n\nimport { Icon } from \"@material-ui/core\";\nimport withStyles from \"@material-ui/core/styles/withStyles\";\nimport EmptyStateImage from \"assets/img/empty-state-table.svg\";\n//\nimport Calendar from \"components/Calendar\";\nimport GridContainer from \"components/Grid/GridContainer\";\nimport GridItem from \"components/Grid/GridItem\";\nimport ProgressIndicator from \"components/ProgressIndicator\";\nimport Typography from \"components/Typography\";\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\n//Redux imports\nimport { connect } from \"react-redux\";\nimport compose from \"recompose/compose\";\nimport { apiCallRequest, closeDialog, openDialog } from \"state/actions\";\n//\nimport { withErrorHandler } from \"hoc/ErrorHandler\";\nimport styles from \"./styles\";\n\nclass CalendarView extends React.Component {\n\tcalendarRef = React.createRef();\n\tstate = {\n\t\tloading: true,\n\t\tload_error: false,\n\t\trecords: [],\n\t};\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tconst { defination, service, query, app } = props;\n\n\t\tthis.state.defination = defination;\n\t\tthis.state.service = service;\n\t\tthis.state.query = query ? { ...query, p: 1 } : { p: 1 };\n\n\t\tthis.handleEditItem = this.handleEditItem.bind(this);\n\t\tthis.handleDeleteItemConfirm = this.handleDeleteItemConfirm.bind(this);\n\t\tthis.handleDeleteItem = this.handleDeleteItem.bind(this);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.loadContext();\n\t}\n\n\tgetSnapshotBeforeUpdate(prevProps) {\n\t\treturn {\n\t\t\tcontextReloadRequired:\n\t\t\t\t!Object.areEqual(prevProps.defination, this.props.defination) &&\n\t\t\t\t!Object.areEqual(prevProps.service, this.props.service),\n\t\t\tdataReloadRequired: !Object.areEqual(\n\t\t\t\tprevProps.query,\n\t\t\t\tthis.props.query\n\t\t\t),\n\t\t};\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\n\t\tif (snapshot.contextReloadRequired) {\n\t\t\tthis.loadContext();\n\t\t}\n\t\tif (snapshot.dataReloadRequired) {\n\t\t\tconst { query } = this.props;\n\t\t\tthis.setState(\n\t\t\t\t{ query: query ? { ...query, p: 1 } : { p: 1 } },\n\t\t\t\tthis.loadData\n\t\t\t);\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\tconst { openDialog, closeDialog } = this.props;\n\t\tcloseDialog();\n\t}\n\n\thandleEditItem(event) {\n\t\tconst { auth } = this.props;\n\n\t\tif (\n\t\t\t!this.state.defination.access.actions.update.restricted(auth.user)\n\t\t) {\n\t\t\twindow.location.href =\n\t\t\t\t\"/\" +\n\t\t\t\tthis.state.defination.access.actions.update.uri(\n\t\t\t\t\tevent.schedule.id\n\t\t\t\t);\n\t\t}\n\t}\n\n\thandleDeleteItemConfirm(event) {\n\t\tconst { openDialog, closeDialog } = this.props;\n\t\tlet that = this;\n\t\topenDialog({\n\t\t\ttitle: \"Confirm Delete\",\n\t\t\tbody:\n\t\t\t\t\"Are you sure you want delete \" +\n\t\t\t\tevent.schedule.title +\n\t\t\t\t\"? This action might be irreversible\",\n\t\t\tactions: {\n\t\t\t\tcancel: {\n\t\t\t\t\ttext: \"Cancel\",\n\t\t\t\t\tcolor: \"default\",\n\t\t\t\t\tonClick: () => closeDialog(),\n\t\t\t\t},\n\t\t\t\tdelete: {\n\t\t\t\t\ttext: \"Delete\",\n\t\t\t\t\tcolor: \"error\",\n\t\t\t\t\tonClick: this.handleDeleteItem(event.schedule.id),\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\thandleDeleteItem = item_id => event => {\n\t\tconst { openDialog, closeDialog } = this.props;\n\n\t\topenDialog({\n\t\t\ttitle: \"Deleting safely\",\n\t\t\tbody: \"Please wait. Executing safe delete...\",\n\t\t\tactions: {},\n\t\t});\n\n\t\tthis.state.service\n\t\t\t.delete(item_id)\n\t\t\t.then(res => {\n\t\t\t\tcloseDialog();\n\t\t\t\tthis.loadData();\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tconsole.log(\"CalendarView delete error\", e);\n\t\t\t\tcloseDialog();\n\t\t\t});\n\t};\n\n\tloadContext() {\n\t\tconst { defination, service, query, auth } = this.props;\n\t\tif (defination) {\n\t\t\tthis.setState(\n\t\t\t\t{\n\t\t\t\t\tdefination: defination,\n\t\t\t\t\tservice: service,\n\t\t\t\t\tquery: query ? { ...query, p: 1 } : { p: 1 },\n\t\t\t\t\tcalendars: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: defination.name,\n\t\t\t\t\t\t\tname: defination.label,\n\t\t\t\t\t\t\tbgColor: defination.color,\n\t\t\t\t\t\t\tborderColor: defination.color,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\trecords: [],\n\t\t\t\t\tloading: false,\n\t\t\t\t},\n\t\t\t\tthis.loadData\n\t\t\t);\n\t\t}\n\t}\n\n\tloadData() {\n\t\tconst { auth, cache, defination, apiCallRequest, cache_data, onLoadData, load_data } = this.props;\n\t\tif (defination ) {\n\t\t\tif (load_data) {\n\t\t\t\tapiCallRequest( defination.name,\n\t\t\t\t\t{\n\t\t\t\t\t\turi: defination.endpoint,\n\t\t\t\t\t\ttype: \"records\",\n\t\t\t\t\t\tparams: this.state.query,\n\t\t\t\t\t\tdata: {},\n\t\t\t\t\t\tcache: cache_data,\n\t\t\t\t\t}\n\t\t\t\t).then(data => {\n\t\t\t\t\tconsole.log(\"calendar data\", data);\n\t\t\t\t\tif (Function.isFunction(onLoadData)) {\n\t\t\t\t\t\tonLoadData(data, this.state.query);\n\t\t\t\t\t}\n\t\t\t\t\tthis.prepareData(data);\n\t\t\t\t}).catch(e => {\n\t\t\t\t\tconsole.log(\"calendar error\", e);\n\t\t\t\t\tthis.setState(state => ({\n\t\t\t\t\t\trecords: [],\n\t\t\t\t\t\tload_error: e,\n\t\t\t\t\t\tloading: false,\n\t\t\t\t\t}));\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet data = Array.isArray(cache.data[defination.name])? cache.data[defination.name] : [];\n\t\t\t\tif (Function.isFunction(onLoadData)) {\n\t\t\t\t\tonLoadData(data, this.state.query);\n\t\t\t\t}\n\t\t\t\tthis.prepareData(data);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.setState(state => ({\n\t\t\t\trecords: [],\n\t\t\t\tload_error: { msg: \"No Context defination or provided\" },\n\t\t\t\tloading: false,\n\t\t\t}));\n\t\t}\n\t}\n\n\tprepareData(data=null) {\n\t\tconst { auth, cache, defination } = this.props;\n\t\tlet target_data = Array.isArray(data)? data : (Array.isArray(cache.data[defination.name]) ? cache.data[defination.name] : []);\n\t\tlet columns = defination ? defination.scope.columns : {};\n\t\tlet resolved_data = [];\n\n\t\tif ( Function.isFunction( defination.views.listing.calendarview.resolveData ) ) {\n\t\t\tdefination.views.listing.calendarview.resolveData(target_data, true).then(resolve => {\n\t\t\t\t\tthis.setState(state => ({\n\t\t\t\t\t\trecords: resolve,\n\t\t\t\t\t\tloading: false,\n\t\t\t\t\t}));\n\t\t\t}).catch(err => {\t\t\t\t\t\n\t\t\t\tthis.setState(state => ({ records: [], loading: false }));\n\t\t\t});\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { classes } = this.props;\n\n\t\treturn (\n\t\t\t<GridContainer className={classes.root}>\n\t\t\t\t{this.state.defination && (\n\t\t\t\t\t<GridItem className=\"p-0 m-0\" xs={12}>\n\t\t\t\t\t\t{this.state.loading ? (\n\t\t\t\t\t\t\t<GridContainer\n\t\t\t\t\t\t\t\tclassName={classes.full_height}\n\t\t\t\t\t\t\t\tjustify=\"center\"\n\t\t\t\t\t\t\t\talignItems=\"center\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<GridItem xs={1}>\n\t\t\t\t\t\t\t\t\t<ProgressIndicator\n\t\t\t\t\t\t\t\t\t\tsize={24}\n\t\t\t\t\t\t\t\t\t\tthickness={4}\n\t\t\t\t\t\t\t\t\t\tclassName={classes.progress}\n\t\t\t\t\t\t\t\t\t\tcolor=\"secondary\"\n\t\t\t\t\t\t\t\t\t\tdisableShrink\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t\t{this.state.load_error ? (\n\t\t\t\t\t\t\t\t\t<GridContainer>\n\t\t\t\t\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"error\"\n\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"h1\"\n\t\t\t\t\t\t\t\t\t\t\t\tcenter\n\t\t\t\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<Icon fontSize=\"large\">\n\t\t\t\t\t\t\t\t\t\t\t\t\terror\n\t\t\t\t\t\t\t\t\t\t\t\t</Icon>\n\t\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"error\"\n\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"body1\"\n\t\t\t\t\t\t\t\t\t\t\t\tcenter\n\t\t\t\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\tAn error occured.\n\t\t\t\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t\t\t\t\tStatus Code :{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t{this.state.load_error.code}\n\t\t\t\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t\t\t\t\t{this.state.load_error.msg}\n\t\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t\t\t\t<GridItem className=\"p-0 m-0\" xs={12}>\n\t\t\t\t\t\t\t\t\t\t\t{Array.isArray(\n\t\t\t\t\t\t\t\t\t\t\t\tthis.state.records\n\t\t\t\t\t\t\t\t\t\t\t) &&\n\t\t\t\t\t\t\t\t\t\t\tthis.state.records.length > 0 ? (\n\t\t\t\t\t\t\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Calendar\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.defination\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.icon\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.defination\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.label\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle_color={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.defination\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.color\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon_color={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.defination\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.color\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsubtitle=\"\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcalendars={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state.calendars\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tview=\"month\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tschedules={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.records\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclasses.calendar\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClickEdit={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.handleEditItem\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClickDelete={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.handleDeleteItemConfirm\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t<GridContainer\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"p-0 m-0\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tjustify=\"center\"\n\t\t\t\t\t\t\t\t\t\t\t\t\talignItems=\"center\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"Empty list\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclasses.emptyImage\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={EmptyStateImage}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclasses.emptyText\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"grey\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"body2\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcenter\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tNo{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{this.state.defination\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.label\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? this.state\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.defination\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.label\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"Records\"}{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfound\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</GridItem>\n\t\t\t\t)}\n\t\t\t</GridContainer>\n\t\t);\n\t}\n}\nCalendarView.propTypes = {\n\tclassName: PropTypes.string,\n\tclasses: PropTypes.object.isRequired,\n\tdefination: PropTypes.object.isRequired,\n\tservice: PropTypes.any.isRequired,\n\tcalendarProps: PropTypes.object,\n\tquery: PropTypes.object,\n\tcache_data: PropTypes.bool,\n\tload_data: PropTypes.bool,\n\tonLoadData: PropTypes.func,\n};\n\nCalendarView.defaultProps = {\n\tcalendarProps: {\n\t\theight: \"900px\",\n\t\tdefaultView: \"month\",\n\t\tdisableDblClick: true,\n\t\tdisableClick: true,\n\t\tisReadOnly: false,\n\t\tuseDetailPopup: true,\n\t\tuseCreationPopup: false,\n\t\tscheduleView: true,\n\t\ttaskView: false,\n\t},\n\tquery: { p: 1 },\n\tcache_data: true,\n\tload_data: true,\n};\n\nconst mapStateToProps = state => ({\n\tauth: state.auth,\n\tapp: state.app,\n});\n\nexport default withErrorHandler(\n\tcompose(\n\t\twithStyles(styles),\n\t\tconnect(mapStateToProps, { apiCallRequest, openDialog, closeDialog })\n\t)(CalendarView)\n);\n","/** @format */\n\nexport default theme => ({\n\troot: {\n\t\tpadding: \"0\",\n\t},\n});\n","/** @format */\n\nimport { Icon } from \"@material-ui/core\";\nimport Divider from \"@material-ui/core/Divider\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemAvatar from \"@material-ui/core/ListItemAvatar\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport withStyles from \"@material-ui/core/styles/withStyles\";\n//\nimport EmptyStateImage from \"assets/img/empty-state-table.svg\";\nimport GridContainer from \"components/Grid/GridContainer\";\nimport GridItem from \"components/Grid/GridItem\";\nimport ProgressIndicator from \"components/ProgressIndicator\";\nimport Typography from \"components/Typography\";\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\nimport { connect } from \"react-redux\";\nimport compose from \"recompose/compose\";\nimport * as Actions from \"state/actions\";\nimport Skeleton from '@material-ui/lab/Skeleton';\nimport { apiCallRequest, closeDialog, openDialog } from \"state/actions\";\n//\nimport { UtilitiesHelper } from \"hoc/Helpers\";\nimport { withErrorHandler } from \"hoc/ErrorHandler\";\nimport styles from \"./styles\";\n\nclass ListView extends React.Component {\n\t\n\tstate = {\n\t\tloading: true,\n\t\tload_error: false,\n\t\traw_records: [],\n\t\trecords: [],\n\t};\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tconst { defination } = props;\n\n\t\tthis.handleDeleteItemConfirm = this.handleDeleteItemConfirm.bind(this);\n\t\tthis.handleDeleteItem = this.handleDeleteItem.bind(this);\n\t}\n\n\tcomponentDidMount() {\n\t\tconst { cache, defination } = this.props;\n\t\tthis.mounted = true;\n\t\tthis.loadContext();\n\t\tthis.prepareData((Array.isArray(cache.data[defination.name])? cache.data[defination.name] : []));\n\t}\n\n\tgetSnapshotBeforeUpdate(prevProps) {\n\t\tthis.mounted = false;\n\t\tconst { cache, defination } = this.props;\n\t\treturn {\n\t\t\tcontextReloadRequired: !Object.areEqual(prevProps.defination, this.props.defination),\n\t\t\tdataReloadRequired: !Object.areEqual(prevProps.query,this.props.query),\n\t\t\t/*dataPreparationRequired: Array.isArray(cache.data[defination.name])? !cache.data[prevProps.defination.name].equals(prevProps.cache.data[defination.name]) : (Array.isArray(prevProps.cache.data[defination.name])? !prevProps.cache.data[prevProps.defination.name].equals(cache.data[defination.name]) : false),*/\n\t\t\tdataPreparationRequired: false,\n\t\t};\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\n\t\tif (snapshot.contextReloadRequired) {\n\t\t\tthis.loadContext();\n\t\t\tthis.prepareData();\n\t\t}\n\t\tif (snapshot.dataReloadRequired) {\n\t\t\tconst { query } = this.props;\n\t\t\tthis.setState(\n\t\t\t\t{ query: query ? { ...query, p: 1 } : { p: 1 } },\n\t\t\t\tthis.loadData\n\t\t\t);\n\t\t}\n\t\t\n\t}\n\n\n\thandleDeleteItemConfirm = item_id => event => {\n\t\tconst { dispatch } = this.props;\n\t\tlet that = this;\n\t\tdispatch(\n\t\t\tActions.openDialog({\n\t\t\t\ttitle: \"Confirm Delete\",\n\t\t\t\tbody:\n\t\t\t\t\t\"Are you sure you want delete entry? This action might be irreversible\",\n\t\t\t\tactions: {\n\t\t\t\t\tcancel: {\n\t\t\t\t\t\ttext: \"Cancel\",\n\t\t\t\t\t\tcolor: \"default\",\n\t\t\t\t\t\tonClick: () => dispatch(Actions.closeDialog()),\n\t\t\t\t\t},\n\t\t\t\t\tdelete: {\n\t\t\t\t\t\ttext: \"Delete\",\n\t\t\t\t\t\tcolor: \"error\",\n\t\t\t\t\t\tonClick: this.handleDeleteItem(item_id),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t})\n\t\t);\n\t};\n\n\thandleDeleteItem = item_id => event => {\n\t\tconst { dispatch } = this.props;\n\n\t\tdispatch(\n\t\t\tActions.openDialog({\n\t\t\t\ttitle: \"Deleting safely\",\n\t\t\t\tbody: \"Please wait. Executing safe delete...\",\n\t\t\t\tactions: {\n\t\t\t\t\tclose: {\n\t\t\t\t\t\ttext: \"Close\",\n\t\t\t\t\t\tcolor: \"default\",\n\t\t\t\t\t\tonClick: () => dispatch(Actions.closeDialog()),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t})\n\t\t);\n\t};\n\n\tloadContext() {\n\t\tconst { defination, service, query, cache } = this.props;\n\t\tif (defination) {\n\t\t\tthis.setState(\n\t\t\t\t{\n\t\t\t\t\tdefination: defination,\n\t\t\t\t\tservice: service,\n\t\t\t\t\tquery: query ? { ...query, p: 1 } : { p: 1 },\n\t\t\t\t\tloading: false,\n\t\t\t\t},\n\t\t\t\tthis.loadData\n\t\t\t);\n\t\t}\n\t}\n\n\tloadData() {\n\t\tconst { auth, cache, defination, apiCallRequest, cache_data, onLoadData, load_data } = this.props;\n\t\tif (defination ) {\n\t\t\tif (load_data) {\n\t\t\t\tapiCallRequest( defination.name,\n\t\t\t\t\t{\n\t\t\t\t\t\turi: defination.endpoint,\n\t\t\t\t\t\ttype: \"records\",\n\t\t\t\t\t\tparams: this.state.query,\n\t\t\t\t\t\tdata: {},\n\t\t\t\t\t\tcache: cache_data,\n\t\t\t\t\t}\n\t\t\t\t).then(data => {\n\t\t\t\t\tif (Function.isFunction(onLoadData)) {\n\t\t\t\t\t\tonLoadData(data, this.state.query);\n\t\t\t\t\t}\n\t\t\t\t\tthis.prepareData(data);\n\t\t\t\t}).catch(e => {\n\t\t\t\t\tthis.setState(state => ({\n\t\t\t\t\t\trecords: [],\n\t\t\t\t\t\tload_error: e,\n\t\t\t\t\t\tloading: false,\n\t\t\t\t\t}));\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (cache_data){\n\t\t\t\tlet data = Array.isArray(cache.data[defination.name])? cache.data[defination.name] : [];\n\t\t\t\tif (Function.isFunction(onLoadData)) {\n\t\t\t\t\tonLoadData(data, this.state.query);\n\t\t\t\t}\n\t\t\t\tthis.prepareData(data);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.setState(state => ({\n\t\t\t\trecords: [],\n\t\t\t\tload_error: { msg: \"No Context defination or provided\" },\n\t\t\t\tloading: false,\n\t\t\t}));\n\t\t}\n\t}\n\n\t\n\n\tprepareData(data=null) {\n\t\tconst { auth, cache, defination, entryItemProps } = this.props;\n\t\tlet target_data = Array.isArray(data)? data : (Array.isArray(cache.data[defination.name]) ? cache.data[defination.name] : []);\n\t\tlet columns = defination ? defination.scope.columns : {};\n\t\tlet resolved_data = [];\n\n\t\tif ( Function.isFunction( defination.views.listing.listview.resolveData ) ) {\n\t\t\tdefination.views.listing.listview.resolveData(target_data, auth.user, entryItemProps)\n\t\t\t\t.then(resolve => {\n\t\t\t\t\tthis.setState(state => ({\n\t\t\t\t\t\traw_records: data,\n\t\t\t\t\t\trecords: resolve,\n\t\t\t\t\t\tloading: false,\n\t\t\t\t\t}));\n\t\t\t\t})\n\t\t\t\t.catch(err => {\t\t\t\t\t\n\t\t\t\t\tthis.setState(state => ({ records: [], raw_records: [], loading: false }));\n\t\t\t\t});\n\t\t}\n\t}\n\n\tprepareForData() {\n\t\tconst { classes, defination, auth, dispatch } = this.props;\n\n\t\tlet columns = defination.scope.columns;\n\n\t\tthis.state.records = [];\n\t\tthis.state.loading = false;\n\t}\n\n\t\n\trender() {\n\t\tconst { classes, defination, service, onClickEntry } = this.props;\n\t\treturn (\n\t\t\t<GridContainer className={classes.root}>\n\t\t\t\t<GridItem className=\"p-0 m-0\" xs={12}>\n\t\t\t\t\t{this.state.loading ? (\n\t\t\t\t\t\t<GridContainer>\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-3/12\"/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-8/12\"/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-4/12\"/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-3/12\"/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-5/12\"/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-9/12\"/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-4/12\"/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-3/12\"/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-4/12\"/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t{this.state.load_error ? (\n\t\t\t\t\t\t\t\t<GridContainer>\n\t\t\t\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\t\t\tcolor=\"error\"\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"h1\"\n\t\t\t\t\t\t\t\t\t\t\tcenter\n\t\t\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<Icon fontSize=\"large\">error</Icon>\n\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\t\t\tcolor=\"error\"\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"body1\"\n\t\t\t\t\t\t\t\t\t\t\tclassName={\"w-full text-center\"}\n\t\t\t\t\t\t\t\t\t\t\tcenter\n\t\t\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\tAn error occured.\n\t\t\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t\t\t\tStatus Code :{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t{this.state.load_error.code}\n\t\t\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t\t\t\t{this.state.load_error.msg}\n\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t\t\t<GridItem className=\"p-0 m-0\" xs={12}>\n\t\t\t\t\t\t\t\t\t\t{Array.isArray(this.state.records) &&\n\t\t\t\t\t\t\t\t\t\tthis.state.records.length > 0 ? (\n\t\t\t\t\t\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<List\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={\"p-0 transparent-bg\"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{this.state.records.map(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(entry, index) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefination.name +\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"-\" +\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tindex\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ListItem \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbutton \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talignItems=\"flex-start\" \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={()=>{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (Function.isFunction(onClickEntry)) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClickEntry(this.state.raw_records[index], index);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={classes.listItem}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{entry.avatar && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ListItemAvatar>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tentry.avatar\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ListItemAvatar>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{entry.icon && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ListItemIcon>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tentry.icon\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ListItemIcon>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ListItemText\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tprimary={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tentry.title\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecondary={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tentry.body\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ListItem>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Divider\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcomponent=\"li\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</List>\n\t\t\t\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t<GridContainer\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"p-0 m-0\"\n\t\t\t\t\t\t\t\t\t\t\t\tjustify=\"center\"\n\t\t\t\t\t\t\t\t\t\t\t\talignItems=\"center\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"Empty list\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclasses.emptyImage\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={EmptyStateImage}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclasses.emptyText\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"grey\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"body2\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tcenter\n\t\t\t\t\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\tNo{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t{defination.label\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? defination.label\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"Records\"}{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\tfound\n\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t)}\n\t\t\t\t</GridItem>\n\t\t\t</GridContainer>\n\t\t);\n\t}\n}\nListView.propTypes = {\n\tclassName: PropTypes.string,\n\tclasses: PropTypes.object.isRequired,\n\tdefination: PropTypes.object.isRequired,\n\tservice: PropTypes.any.isRequired,\n\tshow_actions: PropTypes.bool,\n\tquery: PropTypes.object,\n\tcache_data: PropTypes.bool,\n\tload_data: PropTypes.bool,\n\tonLoadData: PropTypes.func,\n\tonClickEntry: PropTypes.func,\n};\n\nListView.defaultProps = {\n\tshow_actions: true,\n\tshow_links: true,\n\tquery: { p: 1 },\n\tload_data: true,\n\tcache_data: true,\n};\n\nconst mapStateToProps = (state, ownProps) => {\n\tconst { defination } = ownProps;\n\treturn {\n\t\tauth: state.auth,\n\t\tcache: state.cache,\n\t\tapi: state.api,\n\t};\n};\nexport default compose(\n\twithStyles(styles),\n\tconnect(mapStateToProps, { apiCallRequest, openDialog, closeDialog }),\n\twithErrorHandler\n)(ListView);\n","/** @format */\n\nexport default theme => ({\n\troot: {\n\t\tpadding: \"0\",\n\t},\n\tlistItem: {\n\t\tbackground: \"transparent\",\n\t\ttransition: theme.transitions.create(\"background\", {\n\t\t\teasing: theme.transitions.easing.sharp,\n\t\t\tduration: 50,\n\t\t}),\n\t\t\"&:hover\": {\n\t\t\tbackground: theme.palette.action.hover,\n\t\t},\n\t},\n});\n","/** @format */\r\n\r\n//\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport Menu from \"@material-ui/core/Menu\";\r\nimport ClickAwayListener from \"@material-ui/core/ClickAwayListener\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport EmptyStateImage from \"assets/img/empty-state-table.svg\";\r\nimport Avatar from \"components/Avatar\";\r\nimport GridContainer from \"components/Grid/GridContainer\";\r\nimport GridItem from \"components/Grid/GridItem\";\r\nimport Typography from \"components/Typography\";\r\nimport Skeleton from \"@material-ui/lab/Skeleton\";\r\nimport { formats } from \"config/data\";\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport PropTypes from \"prop-types\";\r\nimport React, {forwardRef, useEffect, useState} from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport compose from \"recompose/compose\";\r\nimport RecordView from \"views/widgets/RecordView\";\r\n\r\n\r\nimport AddBox from '@material-ui/icons/AddBox';\r\nimport ArrowDownward from '@material-ui/icons/ArrowDownward';\r\nimport Check from '@material-ui/icons/Check';\r\nimport ChevronLeft from '@material-ui/icons/ChevronLeft';\r\nimport ChevronRight from '@material-ui/icons/ChevronRight';\r\nimport Clear from '@material-ui/icons/Clear';\r\nimport DeleteOutline from '@material-ui/icons/DeleteOutline';\r\nimport Edit from '@material-ui/icons/Edit';\r\nimport FilterList from '@material-ui/icons/FilterList';\r\nimport FirstPage from '@material-ui/icons/FirstPage';\r\nimport LastPage from '@material-ui/icons/LastPage';\r\nimport Remove from '@material-ui/icons/Remove';\r\nimport SaveAlt from '@material-ui/icons/SaveAlt';\r\nimport Search from '@material-ui/icons/Search';\r\nimport ViewColumn from '@material-ui/icons/ViewColumn';\r\n\r\nimport MaterialTable from \"material-table\";\r\n\r\nimport { withRouter } from \"react-router\";\r\nimport { attachments as AttachmentsService } from \"services\";\r\nimport { apiCallRequest, closeDialog, openDialog } from \"state/actions\";\r\n//\r\nimport { FilesHelper, ServiceDataHelper, UtilitiesHelper } from \"hoc/Helpers\";\r\nimport { withErrorHandler } from \"hoc/ErrorHandler\";\r\nimport { withGlobals } from \"contexts/Globals\";\r\nimport styles from \"./styles\";\r\n\r\n\r\nconst tableIcons = {\r\n\tAdd: forwardRef((props, ref) => <AddBox {...props} ref={ref} />),\r\n\tCheck: forwardRef((props, ref) => <Check {...props} ref={ref} />),\r\n\tClear: forwardRef((props, ref) => <Clear {...props} ref={ref} />),\r\n\tDelete: forwardRef((props, ref) => <DeleteOutline {...props} ref={ref} />),\r\n\tDetailPanel: forwardRef((props, ref) => <ChevronRight {...props} ref={ref} />),\r\n\tEdit: forwardRef((props, ref) => <Edit {...props} ref={ref} />),\r\n\tExport: forwardRef((props, ref) => <SaveAlt {...props} ref={ref} />),\r\n\tFilter: forwardRef((props, ref) => <FilterList {...props} ref={ref} />),\r\n\tFirstPage: forwardRef((props, ref) => <FirstPage {...props} ref={ref} />),\r\n\tLastPage: forwardRef((props, ref) => <LastPage {...props} ref={ref} />),\r\n\tNextPage: forwardRef((props, ref) => <ChevronRight {...props} ref={ref} />),\r\n\tPreviousPage: forwardRef((props, ref) => <ChevronLeft {...props} ref={ref} />),\r\n\tResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref} />),\r\n\tSearch: forwardRef((props, ref) => <Search {...props} ref={ref} />),\r\n\tSortArrow: forwardRef((props, ref) => <ArrowDownward {...props} ref={ref} />),\r\n\tThirdStateCheck: forwardRef((props, ref) => <Remove {...props} ref={ref} />),\r\n\tViewColumn: forwardRef((props, ref) => <ViewColumn {...props} ref={ref} />)\r\n};\r\n\r\nclass TableView extends React.Component {\r\n\tstate = {\r\n\t\tloading: true,\r\n\t\tload_error: false,\r\n\t\tdefination: null,\r\n\t\tservice: null,\r\n\t\tquery: { p: 1 },\r\n\t\tdt_columns: [],\r\n\t\trecords: [],\r\n\t\traw_data: [],\r\n\t\traw_data_mutated: false,\r\n\t\tmouseX: null,\r\n\t\tmouseY: null,\r\n\t\tactionsView: \"contextMenu\",\r\n\r\n\t\tcontext: null,\r\n\t};\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tconst { defination, service, query, cache: { data: cachedData } } = props;\r\n\t\tthis.state.defination = defination;\r\n\t\tthis.state.service = service;\r\n\t\tthis.state.query = query ? { ...query, p: 1 } : { p: 1 };\r\n\t\tthis.state.records = Array.isArray(cachedData[defination.name])? cachedData[defination.name] : [];\r\n\t\tthis.mounted = false;\r\n\t\tthis.handleDeleteItemConfirm = this.handleDeleteItemConfirm.bind(this);\r\n\t\tthis.handleDeleteItem = this.handleDeleteItem.bind(this);\r\n\t\tthis.handleOnRowContextMenu = this.handleOnRowContextMenu.bind(this);\r\n\t\tthis.handleSocketsOnCreate = this.handleSocketsOnCreate.bind(this);\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tconst { cache, defination, sockets } = this.props;\r\n\t\tif (sockets) {\r\n\t\t\tif (sockets.default) {\r\n\t\t\t\tsockets.default.on(\"create\", this.handleSocketsOnCreate);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.mounted = true;\r\n\t\tthis.loadContext();\r\n\t\tthis.prepareData((Array.isArray(cache.data[defination.name])? cache.data[defination.name] : []));\r\n\t}\r\n\r\n\tgetSnapshotBeforeUpdate(prevProps) {\r\n\t\tthis.mounted = false;\r\n\t\tconst { cache, defination } = this.props;\r\n\t\treturn {\r\n\t\t\tcontextReloadRequired: !Object.areEqual(prevProps.defination, this.props.defination),\r\n\t\t\tdataReloadRequired: !Object.areEqual(prevProps.query,this.props.query),\r\n\t\t\t/*dataPreparationRequired: Array.isArray(cache.data[defination.name])? !cache.data[prevProps.defination.name].equals(prevProps.cache.data[defination.name]) : (Array.isArray(prevProps.cache.data[defination.name])? !prevProps.cache.data[prevProps.defination.name].equals(cache.data[defination.name]) : false),*/\r\n\t\t\tdataPreparationRequired: false,\r\n\t\t};\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\r\n\t\tthis.mounted = true;\r\n\t\tif (snapshot.contextReloadRequired) {\r\n\t\t\tthis.loadContext();\r\n\t\t\tthis.prepareData();\r\n\t\t}\r\n\t\tif (snapshot.dataReloadRequired) {\r\n\t\t\tconst { query } = this.props;\r\n\t\t\tthis.setState(\r\n\t\t\t\t{ query: query ? { ...query, p: 1 } : { p: 1 } },\r\n\t\t\t\t() => {\r\n\t\t\t\t\tthis.loadData(query ? { ...query, p: 1 } : { p: 1 })\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t\tif (this.state.raw_data_mutated) {\r\n\t\t\tthis.setState({ raw_data_mutated: false }, this.prepareData(this.state.raw_data));\r\n\t\t}\r\n\t}\r\n\tcomponentWillUnmount() {\r\n\t\tconst { sockets } = this.props;\r\n\t\tif (sockets) {\r\n\t\t\tif (sockets.default) {\r\n\t\t\t\tsockets.default.off(\"create\", this.handleSocketsOnCreate);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\thandleSocketsOnCreate = (event) => {\r\n\t\tconst { defination, sockets } = this.props;\r\n\t\tconst { context, action } = event;\r\n\t\tconst { raw_data } = this.state;\r\n\t\tif (defination.model === context) {\r\n\t\t\tthis.setState(prevState => {\r\n\t\t\t\tconst { raw_data } = prevState;\r\n\t\t\t\tconsole.log(\"handleSocketsOnCreate context\", context);\r\n\t\t\t\tconsole.log(\"handleSocketsOnCreate action\", action);\r\n\t\t\t\tlet new_raw_data = Array.isArray(raw_data)? raw_data : [];\r\n\t\t\t\tnew_raw_data.unshift(action.result);\r\n\t\t\t\tconsole.log(\"handleSocketsOnCreate new_raw_data\", new_raw_data);\r\n\t\t\t\treturn {\r\n\t\t\t\t\traw_data: new_raw_data,\r\n\t\t\t\t\traw_data_mutated: true,\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t\t\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\thandleDeleteItemConfirm = item_id => event => {\r\n\t\tconst { openDialog, closeDialog } = this.props;\r\n\t\tlet that = this;\r\n\t\topenDialog({\r\n\t\t\ttitle: \"Confirm Delete\",\r\n\t\t\tbody:\r\n\t\t\t\t\"Are you sure you want delete entry? This action might be irreversible\",\r\n\t\t\tactions: {\r\n\t\t\t\tcancel: {\r\n\t\t\t\t\ttext: \"Cancel\",\r\n\t\t\t\t\tcolor: \"default\",\r\n\t\t\t\t\tonClick: () => closeDialog(),\r\n\t\t\t\t},\r\n\t\t\t\tdelete: {\r\n\t\t\t\t\ttext: \"Delete\",\r\n\t\t\t\t\tcolor: \"error\",\r\n\t\t\t\t\tonClick: this.handleDeleteItem(item_id),\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t});\r\n\t};\r\n\r\n\thandleDeleteItem = item_id => event => {\r\n\t\tconst { openDialog, closeDialog } = this.props;\r\n\t\tcloseDialog();\r\n\t\tif (item_id._id) {\r\n\t\t\titem_id = item_id._id;\r\n\t\t}\r\n\t\tthis.state.service\r\n\t\t\t.delete(item_id)\r\n\t\t\t.then(res => {\r\n\t\t\t\tthis.setState(prevState => {\r\n\t\t\t\t\tlet new_records = prevState.records;\r\n\t\t\t\t\tif (Array.isArray(new_records)) {\r\n\t\t\t\t\t\tnew_records = new_records.filter((record)=>{\r\n\t\t\t\t\t\t\tif (record.entry) {\r\n\t\t\t\t\t\t\t\tif (record.entry._id === item_id ) {\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (record._id === item_id) {\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (!Array.isArray(new_records)) {\r\n\t\t\t\t\t\tnew_records = [];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\trecords: new_records,\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}).catch(e => {\r\n\t\t\t\topenDialog({\r\n\t\t\t\t\ttitle: \"Delete failed\",\r\n\t\t\t\t\tbody: e.msg,\r\n\t\t\t\t\tactions: {},\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t};\r\n\r\n\thandleOnRowContextMenu = index => event => {\r\n\t\tevent.preventDefault();\r\n\t\tconst mouseX = event.clientX - 2;\r\n\t\tconst mouseY = event.clientY - 4;\r\n\r\n\t\tconsole.log(\"this.state.raw_data[index]\", this.state.raw_data[index]);\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tmouseX: mouseX,\r\n\t\t\tmouseY: mouseY,\r\n\t\t\tcontext: prevState.raw_data[index],\r\n\t\t}));\r\n\t};\r\n\r\n\thandleOnRowContextMenuClose = event => {\r\n\t\tevent.preventDefault();\r\n\r\n\t\tthis.setState({\r\n\t\t\tmouseX: null,\r\n\t\t\tmouseY: null,\r\n\t\t});\r\n\t};\r\n\r\n\tloadContext() {\r\n\t\tconst { classes, defination, service, query, auth, actionsType } = this.props;\r\n\t\tif (defination) {\r\n\t\t\tlet columns = defination.scope.columns;\r\n\t\t\tlet dt_columns = [];\r\n\t\t\tif (!defination.access.restricted(auth.user)) {\r\n\t\t\t\tdt_columns.push({\r\n\t\t\t\t\ttitle: String.isString(defination.label)? defination.label.singularize() : (\"ID\"),\r\n\t\t\t\t\tfield: '_id',\r\n\t\t\t\t});\r\n\r\n\t\t\t\tfor (let [name, field] of Object.entries(columns)) {\r\n\t\t\t\t\tlet display_field = true;\r\n\t\t\t\t\tif (field.restricted && \"display\" in field.restricted) {\r\n\t\t\t\t\t\tif (typeof field.restricted.display === \"function\") {\r\n\t\t\t\t\t\t\tdisplay_field = !field.restricted.display(\r\n\t\t\t\t\t\t\t\tfalse,\r\n\t\t\t\t\t\t\t\tauth.user\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (display_field) {\r\n\t\t\t\t\t\tif (Function.isFunction(this.state.defination.views.listing.tableview.resolveData)) {\r\n\t\t\t\t\t\t\tif (field.reference || field.possibilities) {\r\n\r\n\t\t\t\t\t\t\t\tdt_columns.push({\r\n\t\t\t\t\t\t\t\t\tfield: name,\r\n\t\t\t\t\t\t\t\t\ttitle: field.label,\r\n\t\t\t\t\t\t\t\t\trender: rowData => {\r\n\t\t\t\t\t\t\t\t\t\tif (Array.isArray(rowData[name])) {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<GridContainer spacing={2}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{rowData[name].map((entry, cursor) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div key={cursor} >{entry} </div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</GridContainer>\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn rowData? rowData : \"\";\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t...field.tableProps\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tdt_columns.push({\r\n\t\t\t\t\t\t\t\t\tfield: name,\r\n\t\t\t\t\t\t\t\t\ttitle: field.label,\r\n\t\t\t\t\t\t\t\t\t...field.tableProps\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} \r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tif (field.reference && field.input.type !== \"file\" && !field.isAttachment ) {\r\n\t\t\t\t\t\t\t\tdt_columns.push({\r\n\t\t\t\t\t\t\t\t\tfield: name,\r\n\t\t\t\t\t\t\t\t\ttitle: field.label,\r\n\t\t\t\t\t\t\t\t\trender: rowData => {\r\n\t\t\t\t\t\t\t\t\t\tif (Array.isArray(rowData[name])) {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<GridContainer spacing={2}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{rowData[name].map((entry, cursor) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Chip className={classes.valueChip} key={entry.value} label={entry.resolve}/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</GridContainer>\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn Boolean(rowData[name])? ( <Chip label={rowData[name].resolve} /> ) : ( \"\" );\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t...field.tableProps\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\telse if (field.reference && (field.input.type === \"file\" || field.isAttachment)) {\r\n\t\t\t\t\t\t\t\tdt_columns.push({\r\n\t\t\t\t\t\t\t\t\tfield: name,\r\n\t\t\t\t\t\t\t\t\ttitle: field.label,\r\n\t\t\t\t\t\t\t\t\trender: rowData => {\r\n\t\t\t\t\t\t\t\t\t\tif (Array.isArray(rowData[name])) {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<GridContainer spacing={2}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{rowData[name].map(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(entry, cursor) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Chip\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={classes.valueChip}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tavatar={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar color=\"#cfd8dc\" textColor=\"#000000\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tFilesHelper.fileType(entry.resolve) ===\"image\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? AttachmentsService.getAttachmentFileUrl(entry.value): undefined\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{FilesHelper.fileIcon(entry.resolve)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Avatar>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tentry.resolve\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet win = window.open(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tAttachmentsService.getAttachmentFileUrl(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tentry.value\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"_blank\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twin.focus();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"file-\" +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tentry.value\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</GridContainer>\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn Boolean(rowData[name])? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Chip\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tavatar={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#cfd8dc\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttextColor=\"#000000\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tFilesHelper.fileType(rowData[name].resolve) ===\"image\"? AttachmentsService.getAttachmentFileUrl(rowData[name].value): undefined\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{FilesHelper.fileIcon(rowData[name].resolve)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Avatar>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet win = window.open(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tAttachmentsService.getAttachmentFileUrl(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trowData[name].value\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"_blank\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twin.focus();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={rowData[name].resolve}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t...field.tableProps\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tdt_columns.push({\r\n\t\t\t\t\t\t\t\t\tfield: name,\r\n\t\t\t\t\t\t\t\t\ttitle: field.label,\r\n\t\t\t\t\t\t\t\t\t...field.tableProps\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t/*this.state.dt_columns = dt_columns;\r\n\t\t\tthis.state.records = [];\r\n\t\t\tthis.state.loading = false;*/\r\n\r\n\t\t\tthis.setState(\r\n\t\t\t\t{\r\n\t\t\t\t\tdefination: defination,\r\n\t\t\t\t\tservice: service,\r\n\t\t\t\t\tquery: query ? { ...query, p: 1 } : { p: 1 },\r\n\t\t\t\t\tdt_columns: dt_columns,\r\n\t\t\t\t\trecords: [],\r\n\t\t\t\t\tloading: false,\r\n\t\t\t\t}, () => {\r\n\t\t\t\t\tthis.loadData(query ? { ...query, p: 1 } : { p: 1 })\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tparseData(entry) {\r\n\t\tconst { defination, auth } = this.props;\r\n\t\tlet parsed_data = entry;\r\n\t\tlet columns = defination.scope.columns;\r\n\t\t//parsed_data[\"entry\"] = entry;\r\n\t\tfor (let [field_name, field] of Object.entries(columns)) {\r\n\t\t\tif (field.input.type === \"date\") {\r\n\t\t\t\tif (entry[field_name]) {\r\n\t\t\t\t\tparsed_data[field_name] = new Date(\r\n\t\t\t\t\t\tentry[field_name]\r\n\t\t\t\t\t).format(formats.dateformats.date);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tparsed_data[field_name] = \"\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (field.input.type === \"datetime\" && entry[field_name]) {\r\n\t\t\t\tif (entry[field_name]) {\r\n\t\t\t\t\tparsed_data[field_name] = new Date(\r\n\t\t\t\t\t\tentry[field_name]\r\n\t\t\t\t\t).format(formats.dateformats.datetime);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tparsed_data[field_name] = \"\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (field.input.type === \"time\") {\r\n\t\t\t\tif (entry[field_name]) {\r\n\t\t\t\t\tparsed_data[field_name] = new Date(\r\n\t\t\t\t\t\tentry[field_name]\r\n\t\t\t\t\t).format(formats.dateformats.time);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tparsed_data[field_name] = \"\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (field.type === \"boolean\") {\r\n\t\t\t\tif (entry[field_name]) {\r\n\t\t\t\t\tparsed_data[field_name] = \"Yes\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\tparsed_data[field_name] = \"No\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (JSON.isJSON(parsed_data[field_name]) && !field.reference) {\r\n\t\t\t\tparsed_data[field_name] = JSON.stringify(\r\n\t\t\t\t\tparsed_data[field_name]\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tif (field.possibilities) {\r\n\t\t\t\tif (JSON.isJSON(field.possibilities)) {\r\n\t\t\t\t\tif (entry[field_name] in field.possibilities) {\r\n\t\t\t\t\t\tparsed_data[field_name] =\r\n\t\t\t\t\t\t\tfield.possibilities[entry[field_name]];\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (Function.isFunction(field.possibilities)) {\r\n\t\t\t\t\tlet possibilities_obj = field.possibilities(\r\n\t\t\t\t\t\tentry,\r\n\t\t\t\t\t\tauth.user\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif (JSON.isJSON(possibilities_obj)) {\r\n\t\t\t\t\t\tif (entry[field_name] in possibilities_obj) {\r\n\t\t\t\t\t\t\tparsed_data[field_name] =\r\n\t\t\t\t\t\t\t\tpossibilities_obj[entry[field_name]];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn parsed_data;\r\n\t}\r\n\r\n\tloadData(query={}) {\r\n\t\tconst { auth, cache, defination, apiCallRequest, cache_data, onLoadData, load_data } = this.props;\r\n\t\tif (defination ) {\r\n\t\t\tif (load_data) {\r\n\t\t\t\tthis.setState({loading: true, load_error: false});\r\n\t\t\t\tapiCallRequest( defination.name,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\turi: defination.endpoint,\r\n\t\t\t\t\t\ttype: \"records\",\r\n\t\t\t\t\t\tparams: query,\r\n\t\t\t\t\t\tdata: {},\r\n\t\t\t\t\t\tcache: cache_data,\r\n\t\t\t\t\t}\r\n\t\t\t\t).then(data => {\r\n\t\t\t\t\tif (Function.isFunction(onLoadData)) {\r\n\t\t\t\t\t\tonLoadData(data, query);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.setState({loading: false});\r\n\t\t\t\t\tthis.prepareData(data);\r\n\t\t\t\t}).catch(e => {\r\n\t\t\t\t\tthis.setState(state => ({\r\n\t\t\t\t\t\trecords: [],\r\n\t\t\t\t\t\tload_error: e,\r\n\t\t\t\t\t\tloading: false,\r\n\t\t\t\t\t}));\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlet data = Array.isArray(cache.data[defination.name])? cache.data[defination.name] : [];\t\t\t\t\r\n\t\t\t\tthis.prepareData(data);\r\n\t\t\t\tif (Function.isFunction(onLoadData)) {\r\n\t\t\t\t\tonLoadData(data, query);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.setState(state => ({\r\n\t\t\t\trecords: [],\r\n\t\t\t\tload_error: { msg: \"No Context defination or provided\" },\r\n\t\t\t\tloading: false,\r\n\t\t\t}));\r\n\t\t}\r\n\t}\r\n\r\n\tprepareData(data=null) {\r\n\t\tconst { auth, cache, defination } = this.props;\r\n\t\tlet target_data = Array.isArray(data)? data : (Array.isArray(cache.data[defination.name]) ? cache.data[defination.name] : []);\r\n\t\tlet columns = defination ? defination.scope.columns : {};\r\n\t\tlet resolved_data = [];\r\n\r\n\r\n\r\n\t\tresolved_data = ServiceDataHelper.resolveReferenceColumnsDisplays(target_data, columns, auth.user);\r\n\t\t\tlet that = this;\r\n\t\t\tlet all_records = resolved_data.map(entry => {\r\n\t\t\t\treturn that.parseData(entry);\r\n\t\t\t});\r\n\t\t\tthis.setState(state => ({ records: all_records }));\r\n\t}\r\n\r\n\tdownloadCSV(data) {\r\n\t\tdata.toCSV();\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { classes, defination, api, cache, actionsType, history, location } = this.props;\r\n\t\t\r\n\r\n\t\treturn (\r\n\t\t\t<GridContainer className={classes.root}>\r\n\t\t\t\t<GridItem className=\"p-0 m-0\" xs={12}>\r\n\t\t\t\t\t{ this.state.loading && <GridContainer className={classes.full_height} justify=\"center\" alignItems=\"center\">\r\n\t\t\t\t\t\t\t\t<GridItem xs={12} className=\"flex relative flex-row\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" width={150}/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={32} height={32} className=\"float-right mx-2\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={32} height={32} className=\"float-right mx-2\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={32} height={32} className=\"float-right mx-2\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={32} height={32} className=\"float-right mx-2\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<GridItem xs={12}>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"rect\" width={\"100%\"} height={70} className=\"mt-2\"/>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"rect\" width={\"100%\"} height={70} className=\"mt-2\"/>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"rect\" width={\"100%\"} height={70} className=\"mt-2\"/>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"rect\" width={\"100%\"} height={70} className=\"mt-2\"/>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t</GridContainer> }\r\n\r\n\t\t\t\t\t{(!this.state.loading && Array.isArray(this.state.records)) && <GridContainer className=\"p-0 m-0\">\r\n\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\r\n\t\t\t\t\t\t\t<GridItem className=\"p-0 m-0\" xs={12}>\r\n\t\t\t\t\t\t\t\t{actionsType === \"context\" && <ClickAwayListener onContextMenu={this.handleOnRowContextMenuClose} onClickAway={this.handleOnRowContextMenuClose}>\r\n\t\t\t\t\t\t\t\t\t\t<Menu\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\topen={this.state.mouseY !== null}\r\n\t\t\t\t\t\t\t\t\t\t\tonClose={this.handleOnRowContextMenuClose}\r\n\t\t\t\t\t\t\t\t\t\t\tanchorReference=\"anchorPosition\"\r\n\t\t\t\t\t\t\t\t\t\t\tanchorPosition={ this.state.mouseY !== null && this.state.mouseX !== null? { top: this.state.mouseY, left: this.state.mouseX } : undefined }\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<MenuItem onClick={ this.handleOnRowContextMenuClose }>Copy</MenuItem>\r\n\t\t\t\t\t\t\t\t\t\t\t<MenuItem onClick={ this.handleOnRowContextMenuClose }>Print</MenuItem>\r\n\t\t\t\t\t\t\t\t\t\t\t<MenuItem onClick={ this.handleOnRowContextMenuClose }>Highlight</MenuItem>\r\n\t\t\t\t\t\t\t\t\t\t\t<MenuItem onClick={ this.handleOnRowContextMenuClose }>Email</MenuItem>\r\n\t\t\t\t\t\t\t\t\t\t</Menu>\r\n\t\t\t\t\t\t\t\t\t</ClickAwayListener>}\r\n\r\n\t\t\t\t\t\t\t\t{this.state.records.length > 0 ? (\r\n\t\t\t\t\t\t\t\t\t<MaterialTable\r\n\t\t\t\t\t\t\t\t\t\ticons={tableIcons}\r\n\t\t\t\t\t\t\t\t\t\tcolumns={this.state.dt_columns}\r\n\t\t\t\t\t\t\t\t\t\tdata={this.state.records}\r\n\t\t\t\t\t\t\t\t\t\toptions={{\r\n\t\t\t\t\t\t\t\t\t\t\tsearch: false,\r\n\t\t\t\t\t\t\t\t\t\t\texportButton: true,\r\n\t\t\t\t\t\t\t\t\t\t\texportCsv: (tableColumns, tableData) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet csvDataColumns = {};\r\n\t\t\t\t\t\t\t\t\t\t\t\ttableColumns.map(column => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcsvDataColumns[column.field] = column.title;\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\ttableData.unshift(csvDataColumns);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\ttableData.forEach(row => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tObject.entries(row).map(([column, value]) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (JSON.isJSON(value)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trow[column] = value.resolve;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\ttableData.toCSV(((defination ? defination.label : \"Records\") +\" - \" + new Date().format(\"d M Y H:i:s A\") + \".csv\"));\r\n\t\t\t\t\t\t\t\t\t        },\r\n\t\t\t\t\t\t\t\t\t        paging: false,\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\ttitle={(api.loading ? \"Loading \" : \"\") + defination.label + (api.loading ? \"...\" : \"\")}\r\n\t\t\t\t\t\t\t\t\t\tonRowClick={(event, rowData) => {\r\n\t\t\t\t\t\t\t\t\t\t\t//console.log(\"onRowClick rowData\", rowData);\r\n\t\t\t\t\t\t\t\t\t\t\thistory.push(('/'+defination.name+'/view/'+rowData._id).toUriWithDashboardPrefix());\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t<GridContainer\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"p-0 m-0\"\r\n\t\t\t\t\t\t\t\t\t\tjustify=\"center\"\r\n\t\t\t\t\t\t\t\t\t\talignItems=\"center\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\t\t\talt=\"Empty list\"\r\n\t\t\t\t\t\t\t\t\t\t\tclassName={classes.emptyImage}\r\n\t\t\t\t\t\t\t\t\t\t\tsrc={EmptyStateImage}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t<Typography\r\n\t\t\t\t\t\t\t\t\t\t\tclassName={classes.emptyText}\r\n\t\t\t\t\t\t\t\t\t\t\tcolor=\"grey\"\r\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"body2\"\r\n\t\t\t\t\t\t\t\t\t\t\tcenter\r\n\t\t\t\t\t\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\tNo{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\t{defination.label\r\n\t\t\t\t\t\t\t\t\t\t\t\t? defination.label\r\n\t\t\t\t\t\t\t\t\t\t\t\t: \"Records\"}{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\tfound\r\n\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t</GridContainer>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t</GridContainer>\r\n\t\t\t\t\t\t{(api ? api.busy && api.error : false) && (\r\n\t\t\t\t\t\t\t<GridContainer>\r\n\t\t\t\t\t\t\t\t<GridItem xs={12}>\r\n\t\t\t\t\t\t\t\t\t<Typography\r\n\t\t\t\t\t\t\t\t\t\tcolor=\"error\"\r\n\t\t\t\t\t\t\t\t\t\tvariant=\"body2\"\r\n\t\t\t\t\t\t\t\t\t\tcenter\r\n\t\t\t\t\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{\"An error occured. \\n \" + api.error.msg +\" \\n Displaying cached data.\"}\r\n\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t\t</GridContainer>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</GridContainer> }\r\n\r\n\t\t\t\t</GridItem>\r\n\t\t\t</GridContainer>\r\n\t\t);\r\n\t}\r\n}\r\nTableView.propTypes = {\r\n\tclassName: PropTypes.string,\r\n\tclasses: PropTypes.object.isRequired,\r\n\tdefination: PropTypes.object.isRequired,\r\n\tservice: PropTypes.any.isRequired,\r\n\tshow_actions: PropTypes.bool,\r\n\tshow_links: PropTypes.bool,\r\n\tquery: PropTypes.object,\r\n\tcache_data: PropTypes.bool,\r\n\tload_data: PropTypes.bool,\r\n\tonLoadData: PropTypes.func,\r\n\t\r\n};\r\n\r\nTableView.defaultProps = {\r\n\tshow_actions: true,\r\n\tshow_links: true,\r\n\tquery: { p: 1 },\r\n\tcache_data: true,\r\n\tload_data: true,\r\n\tactionsType: \"inline\",\r\n};\r\n\r\nconst mapStateToProps = (state, ownProps) => ({\r\n\tauth: state.auth,\r\n\tcache: state.cache,\r\n\tapi:state.api,\r\n});\r\n\r\nexport default \r\n\tcompose(\r\n\t\twithStyles(styles),\r\n\t\twithGlobals,\r\n\t\twithRouter,\r\n\t\tconnect(mapStateToProps, { openDialog, closeDialog, apiCallRequest })\r\n\t)(TableView);\r\n","/** @format */\n\nexport default theme => ({\n\troot: {\n\t\tpadding: \"0\",\n\t},\n\tdata_actions_wrapper: {\n\t\tdisplay: \"inline-block\",\n\t\twhiteSpace: \"nowrap\",\n\t\t\"& > *\": {\n\t\t\tdisplay: \"inline-block\",\n\t\t\twhiteSpace: \"nowrap\",\n\t\t},\n\t},\n\tvalueChip: {\n\t\tmargin: theme.spacing(0.5),\n\t},\n\temptyImage: {\n\t\tmaxWidth: 200,\n\t\twidth: \"100%\",\n\t},\n\temptyText: {\n\t\tmarginTop: theme.spacing(3),\n\t},\n});\n","/** @format */\r\n\r\nimport Button from \"@material-ui/core/Button\";\r\nimport ButtonGroup from \"@material-ui/core/ButtonGroup\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\n//\r\nimport GridContainer from \"components/Grid/GridContainer\";\r\nimport GridItem from \"components/Grid/GridItem\";\r\nimport Typography from \"components/Typography\";\r\nimport PropTypes from \"prop-types\";\r\nimport React, {useEffect} from \"react\";\r\n//Redux imports\r\nimport { connect } from \"react-redux\";\r\nimport compose from \"recompose/compose\";\r\nimport Pagination from '@material-ui/lab/Pagination';\r\nimport TablePagination from '@material-ui/core/TablePagination';\r\nimport Accordion from '@material-ui/core/Accordion';\r\nimport AccordionDetails from '@material-ui/core/AccordionDetails';\r\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\r\nimport AccordionActions from '@material-ui/core/AccordionActions';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport FirstPageIcon from '@material-ui/icons/FirstPage';\r\nimport KeyboardArrowLeft from '@material-ui/icons/KeyboardArrowLeft';\r\nimport KeyboardArrowRight from '@material-ui/icons/KeyboardArrowRight';\r\nimport LastPageIcon from '@material-ui/icons/LastPage';\r\nimport { useTheme } from '@material-ui/core/styles';\r\nimport {\r\n\tTextInput\r\n} from \"components/FormInputs\";\r\nimport InputBase from '@material-ui/core/InputBase';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport ExpandLessIcon from '@material-ui/icons/ExpandLess';\r\nimport FilterListIcon from '@material-ui/icons/FilterList';\r\nimport CalendarView from \"./CalendarView\";\r\nimport GoogleMapView from \"./GoogleMapView\";\r\nimport GoogleMapOverview from \"views/widgets/Overview/GoogleMapOverview\";\r\nimport ListView from \"./ListView\";\r\nimport Chip from '@material-ui/core/Chip';\r\nimport ContextDataForm from \"views/forms/BaseForm\";\r\nimport { withErrorHandler } from \"hoc/ErrorHandler\";\r\n//\r\nimport styles from \"./styles\";\r\n//\r\nimport TableView from \"./TableView\";\r\n\r\nfunction TablePaginationActions(props) {\r\n\tconst theme = useTheme();\r\n\tconst { count, page, rowsPerPage, onChangePage } = props;\r\n\r\n\t\r\n\tconst handleFirstPageButtonClick = (event) => {\r\n\t\tonChangePage(event, 0);\r\n\t};\r\n\r\n\tconst handleBackButtonClick = (event) => {\r\n\t\tonChangePage(event, page - 1);\r\n\t};\r\n\r\n\tconst handleNextButtonClick = (event) => {\r\n\t\tonChangePage(event, page + 1);\r\n\t};\r\n\r\n\tconst handleLastPageButtonClick = (event) => {\r\n\t\tonChangePage(event, Math.max(0, Math.ceil(count / rowsPerPage) - 1));\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className={\"ml-2 flex-shrink-0\"}>\r\n\t\t\t<IconButton\r\n\t\t\t\tonClick={handleFirstPageButtonClick}\r\n\t\t\t\tdisabled={page === 0}\r\n\t\t\t\taria-label=\"first page\"\r\n\t\t\t>\r\n\t\t\t\t{theme.direction === 'rtl' ? <LastPageIcon /> : <FirstPageIcon />}\r\n\t\t\t</IconButton>\r\n\t\t\t<IconButton onClick={handleBackButtonClick} disabled={page === 0} aria-label=\"previous page\">\r\n\t\t\t\t{theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\r\n\t\t\t</IconButton>\r\n\t\t\t<IconButton\r\n\t\t\t\tonClick={handleNextButtonClick}\r\n\t\t\t\tdisabled={page >= Math.ceil(count / rowsPerPage) - 1}\r\n\t\t\t\taria-label=\"next page\"\r\n\t\t\t>\r\n\t\t\t\t{theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\r\n\t\t\t</IconButton>\r\n\t\t\t<IconButton\r\n\t\t\t\tonClick={handleLastPageButtonClick}\r\n\t\t\t\tdisabled={page >= Math.ceil(count / rowsPerPage) - 1}\r\n\t\t\t\taria-label=\"last page\"\r\n\t\t\t>\r\n\t\t\t\t{theme.direction === 'rtl' ? <FirstPageIcon /> : <LastPageIcon />}\r\n\t\t\t</IconButton>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nTablePaginationActions.propTypes = {\r\n\tcount: PropTypes.number.isRequired,\r\n\tonChangePage: PropTypes.func.isRequired,\r\n\tpage: PropTypes.number.isRequired,\r\n\trowsPerPage: PropTypes.number.isRequired,\r\n};\r\n\r\n\r\nclass ListingView extends React.Component {\r\n\tstate = {\r\n\t\tdefination: null,\r\n\t\tservice: null,\r\n\t\tview: \"tableview\",\r\n\t\tviews: {},\r\n\t\tshowViewOptions: true,\r\n\t\tshowAddBtn: true,\r\n\t\tsearchKeyword: \"\",\r\n\t\tquery: {},\r\n\t\tpages: 10,\r\n\t\tpage: 1,\r\n\t\tviewMenuAnchorEl: null,\r\n\t\tsortFields: [],\r\n\t\tfilterAccordionExpanded: false,\r\n\t\tfilterableFields: {},\r\n\t\tfilterContext: false,\r\n\t\tfilterMenuAnchor: null,\r\n\t\tfilters: {\r\n\t\t\tvalues: {},\r\n\t\t\tlabels: {},\r\n\t\t}\r\n\t};\r\n\tmounted = false;\r\n\tsearchkeywordRef = React.createRef();\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tconst { defination, service, query, cache, app } = props;\r\n\t\tthis.state.defination = defination;\r\n\t\tthis.state.service = service;\r\n\t\tthis.state.query = query ? { \r\n\t\t\t...query, \r\n\t\t\tp: 1, \r\n\t\t\tpagination: ('rpp' in query? query['rpp'] : ('pagination' in query? query['pagination'] : app.preferences.data.pagination)), \r\n\t\t\tpage: ('pg' in query? query['pg'] : ('page' in query? query['page'] : 1)), \r\n\t\t} : { \r\n\t\t\tp: 1, \r\n\t\t\tpagination: ('rpp' in query? query['rpp'] : ('pagination' in query? query['pagination'] : app.preferences.data.pagination)), \r\n\t\t\tpage: ('pg' in query? query['pg'] : ('page' in query? query['page'] : 1)), \r\n\t\t};\r\n\r\n\t\tlet filterableFields = {};\r\n\t\t\tlet filterContext = false;\r\n\t\t\tlet searchKeyword = \"\";\r\n\t\t\tObject.entries(defination.scope.columns).map(([column_name, column_props], cursor) => {\r\n\t\t\t\tif (![\"file\", \"dynamic\", \"textarea\", \"password\", \"wysiwyg\", \"map\", \"file\", \"slider\", \"multiselect\"].includes(column_props.input.type)) {\r\n\t\t\t\t\tfilterableFields[column_name] = column_props;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (JSON.isJSON(query)) {\r\n\t\t\t\tlet filterContextMatched = false;\r\n\t\t\t\tlet filterableColumns = Object.keys(filterableFields);\r\n\t\t\t\tObject.entries(query).map(([queryColumn, queryValue]) => {\r\n\t\t\t\t\tif (!filterContextMatched && filterableColumns.includes(queryColumn)) {\r\n\t\t\t\t\t\tfilterContext = queryColumn;\r\n\t\t\t\t\t\tsearchKeyword = queryValue;\r\n\t\t\t\t\t\tif (String.isString(queryValue)) {\r\n\t\t\t\t\t\t\tsearchKeyword = queryValue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tsearchKeyword = String(queryValue);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfilterContextMatched = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t}\r\n\t\t\r\n\t\tif (!filterContext && (query.q || query.query)) {\r\n\t\t\tif (query.q) {\r\n\t\t\t\tthis.state.searchKeyword = query.q;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.state.searchKeyword = query.query;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.state.searchKeyword = searchKeyword;\r\n\t\t\tthis.state.filterContext = filterContext;\r\n\t\t}\r\n\r\n\r\n\t\tthis.handleViewItemClick = this.handleViewItemClick.bind(this);\r\n\t\tthis.handleOnPageChanged = this.handleOnPageChanged.bind(this);\r\n\r\n\t\tthis.handleOnRecordsPerPageChanged = this.handleOnRecordsPerPageChanged.bind(this);\r\n\t}\r\n\r\n\t\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.mounted = true;\r\n\t\tthis.prepareForRender();\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tthis.mounted = false;\r\n\t}\r\n\r\n\tgetSnapshotBeforeUpdate(prevProps) {\r\n\t\tthis.mounted = false;\r\n\t\treturn {\r\n\t\t\tprepareForRenderRequired: !Object.areEqual(prevProps.query, this.props.query),\r\n\t\t};\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\r\n\t\tthis.mounted = true;\r\n\t\tif (snapshot.prepareForRenderRequired) {\r\n\t\t\tthis.prepareForRender();\r\n\t\t}\r\n\t}\r\n\r\n\thandleViewItemClick = name => event => {\r\n\t\tif (this.mounted) {\r\n\t\t\tthis.setState({ view: name, viewMenuAnchorEl: null });\r\n\t\t} else {\r\n\t\t\tthis.state.view = name;\r\n\t\t\tthis.state.viewMenuAnchorEl = null;\r\n\t\t}\r\n\t};\r\n\r\n\thandleShowViewsMenu = event => {\r\n\t\tconst viewMenuAnchorEl = event.currentTarget;\r\n\t\tif (this.mounted) {\r\n\t\t\tthis.setState({ viewMenuAnchorEl: viewMenuAnchorEl });\r\n\t\t} else {\r\n\t\t\tthis.state.viewMenuAnchorEl = viewMenuAnchorEl;\r\n\t\t}\r\n\t};\r\n\r\n\thandleCloseViewsMenu = () => {\r\n\t\tif (this.mounted) {\r\n\t\t\tthis.setState({ viewMenuAnchorEl: null });\r\n\t\t} else {\r\n\t\t\tthis.state.viewMenuAnchorEl = null;\r\n\t\t}\r\n\t};\r\n\r\n\thandleOnPageChanged = (event, page) => {\r\n\t\tthis.setState(prevState => ({ \r\n\t\t\t\tpage: page+1,\r\n\t\t\t\tquery: {\r\n\t\t\t\t\t...prevState.query,\r\n\t\t\t\t\tpage: page+1\r\n\t\t\t\t},\r\n\t\t\t\tviewMenuAnchorEl: null\r\n\t\t\t}));\r\n\t};\r\n\r\n\thandleOnRecordsPerPageChanged = (event) => {\r\n\t\tconst pagination = Number.parseNumber(event.target.value, this.state.query.pagination);\r\n\t\tthis.setState(prevState => ({ \r\n\t\t\t\tpage: 1,\r\n\t\t\t\tquery: {\r\n\t\t\t\t\t...prevState.query,\r\n\t\t\t\t\tpagination: pagination\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t};\r\n\r\n\r\n\tasync prepareForRender() {\r\n\t\tconst { defination, service, query, view, showViewOptions, showAddBtn, app } = this.props;\r\n\t\tif (defination && service) {\r\n\t\t\tlet all_views = {\r\n\t\t\t\ttableview: \"Table View\",\r\n\t\t\t\tlistview: \"List View\",\r\n\t\t\t\tgooglemapview: \"Map View\",\r\n\t\t\t\tvectormapview: \"Vector Map View\",\r\n\t\t\t\tcalendarview: \"Calendar View\",\r\n\t\t\t};\r\n\t\t\tlet views = {};\r\n\t\t\tlet default_view = \"tableview\";\r\n\t\t\tif (defination.views.listing.default in all_views) {\r\n\t\t\t\tdefault_view = defination.views.listing.default;\r\n\t\t\t}\r\n\t\t\tfor (let [name, label] of Object.entries(all_views)) {\r\n\t\t\t\tif (name in defination.views.listing) {\r\n\t\t\t\t\tviews[name] = label;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet filterableFields = {};\r\n\t\t\tlet filterContext = false;\r\n\t\t\tlet searchKeyword = \"\";\r\n\t\t\tObject.entries(defination.scope.columns).map(([column_name, column_props], cursor) => {\r\n\t\t\t\tif (![\"file\", \"dynamic\", \"textarea\", \"password\", \"wysiwyg\", \"map\", \"file\", \"slider\", \"multiselect\"].includes(column_props.input.type)) {\r\n\t\t\t\t\tfilterableFields[column_name] = column_props;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (JSON.isJSON(query)) {\r\n\t\t\t\tlet filterContextMatched = false;\r\n\t\t\t\tlet filterableColumns = Object.keys(filterableFields);\r\n\t\t\t\tObject.entries(query).map(([queryColumn, queryValue]) => {\r\n\t\t\t\t\tif (!filterContextMatched && filterableColumns.includes(queryColumn)) {\r\n\t\t\t\t\t\tfilterContext = queryColumn;\r\n\t\t\t\t\t\tsearchKeyword = queryValue;\r\n\t\t\t\t\t\tif (String.isString(queryValue)) {\r\n\t\t\t\t\t\t\tsearchKeyword = queryValue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tsearchKeyword = String(queryValue);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfilterContextMatched = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t}\r\n\t\t\tconsole.log(\"this.searchkeywordRef\", \"this.searchkeywordRef\")\r\n\t\t\tif (this.mounted) {\r\n\t\t\t\tthis.setState(state => ({\r\n\t\t\t\t\tdefination: defination,\r\n\t\t\t\t\tservice: service,\r\n\t\t\t\t\tquery: query ? { \r\n\t\t\t\t\t\t...query, \r\n\t\t\t\t\t\tp: 1,\r\n\t\t\t\t\t\tpagination: ('rpp' in query? query['rpp'] : ('pagination' in query? query['pagination'] : app.preferences.data.pagination)), \r\n\t\t\t\t\t\tpage: ('pg' in query? query['pg'] : ('page' in query? query['page'] : 1)), \r\n\t\t\t\t\t} : { \r\n\t\t\t\t\t\tp: 1,\r\n\t\t\t\t\t\tpagination: ('rpp' in query? query['rpp'] : ('pagination' in query? query['pagination'] : app.preferences.data.pagination)), \r\n\t\t\t\t\t\tpage: ('pg' in query? query['pg'] : ('page' in query? query['page'] : 1)), \r\n\t\t\t\t\t},\r\n\t\t\t\t\tviews: views,\r\n\t\t\t\t\tview: view ? view : default_view,\r\n\t\t\t\t\tshowViewOptions: showViewOptions,\r\n\t\t\t\t\tshowAddBtn: showAddBtn,\r\n\t\t\t\t\tfilterableFields: filterableFields,\r\n\t\t\t\t\tsearchKeyword: searchKeyword,\r\n\t\t\t\t\tfilterContext: filterContext,\r\n\r\n\t\t\t\t}));\r\n\t\t\t} else {\r\n\t\t\t\tthis.state = {\r\n\t\t\t\t\t...this.state,\r\n\t\t\t\t\tdefination: defination,\r\n\t\t\t\t\tservice: service,\r\n\t\t\t\t\tquery: query ? { \r\n\t\t\t\t\t\t...query, \r\n\t\t\t\t\t\tp: 1,\r\n\t\t\t\t\t\tpagination: ('rpp' in query? query['rpp'] : ('pagination' in query? query['pagination'] : app.preferences.data.pagination)), \r\n\t\t\t\t\t\tpage: ('pg' in query? query['pg'] : ('page' in query? query['page'] : 1)), \r\n\t\t\t\t\t} : { \r\n\t\t\t\t\t\tp: 1,\r\n\t\t\t\t\t\tpagination: ('rpp' in query? query['rpp'] : ('pagination' in query? query['pagination'] : app.preferences.data.pagination)), \r\n\t\t\t\t\t\tpage: ('pg' in query? query['pg'] : ('page' in query? query['page'] : 1)), \r\n\t\t\t\t\t},\r\n\t\t\t\t\tviews: views,\r\n\t\t\t\t\tview: view ? view : default_view,\r\n\t\t\t\t\tshowViewOptions: showViewOptions,\r\n\t\t\t\t\tshowAddBtn: showAddBtn,\r\n\t\t\t\t\tfilterableFields: filterableFields,\r\n\t\t\t\t\tsearchKeyword: searchKeyword,\r\n\t\t\t\t\tfilterContext: filterContext,\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { classes, auth, query, defination, service, cache, api, showPagination, showSorter, cache_data, onLoadData, load_data, onClickEntry, sorterFormLayoutType } = this.props;\r\n\t\tconst { view } = this.state;\r\n\t\treturn (\r\n\t\t\t<GridContainer className=\"p-0 m-0\">\r\n\t\t\t\t<GridContainer className=\"p-0 m-0\">\r\n\t\t\t\t\t{this.state.showViewOptions && (\r\n\t\t\t\t\t\t<GridItem sm={12} md={8}>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t{Object.entries(this.state.views).map(\r\n\t\t\t\t\t\t\t\t\t([name, label], index) => (\r\n\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\tcolor={\"primary\"}\r\n\t\t\t\t\t\t\t\t\t\t\tvariant={name === view? \"contained\" : \"text\"}\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={(event) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(name);\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({ view: name, viewMenuAnchorEl: null });\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\tkey={\"btn-view-\"+name}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{label}\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t{this.state.showAddBtn &&\r\n\t\t\t\t\t\tdefination &&\r\n\t\t\t\t\t\t!defination.access.actions.create.restricted(\r\n\t\t\t\t\t\t\tauth.user\r\n\t\t\t\t\t\t) && (\r\n\t\t\t\t\t\t\t<GridItem\r\n\t\t\t\t\t\t\t\tsm={12}\r\n\t\t\t\t\t\t\t\tmd={this.state.showViewOptions ? 4 : 12}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{defination.access.actions.create.link.inline.default(\r\n\t\t\t\t\t\t\t\t\t{ className: \"float-right\" }\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t</GridContainer>\r\n\r\n\t\t\t\t<GridContainer className=\"p-1 m-0\">\r\n\t\t\t\t\t{ (showSorter && view !== \"googlemapview\") && <GridItem xs={12} className=\"p-0 m-0 mb-2\" >\r\n\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\r\n\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t<GridItem xs={12} className={\"p-0\"}>\r\n\t\t\t\t\t\t\t\t<Accordion \r\n\t\t\t\t\t\t\t\t\texpanded={this.state.filterAccordionExpanded}\r\n\t\t\t\t\t\t\t\t\tclassName=\"p-0\"\r\n\t\t\t\t\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{/*<AccordionSummary\r\n\t\t\t\t\t\t\t\t\t\texpandIcon={this.state.filterAccordionExpanded? <ExpandLessIcon /> : <FilterListIcon />}\r\n\t\t\t\t\t\t\t\t\t\taria-controls=\"filter-panel1c-content\"\r\n\t\t\t\t\t\t\t\t\t\tid=\"filter-panel1c-header\"\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"flex m-0 p-0 flex-grow\"\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t>*/}\r\n\t\t\t\t\t\t\t\t\t<Paper \r\n\t\t\t\t\t\t\t\t\t\tcomponent=\"form\" \r\n\t\t\t\t\t\t\t\t\t\televation={0}\r\n\t\t\t\t\t\t\t\t\t\tclassName={classes.searchRoot} \r\n\t\t\t\t\t\t\t\t\t\tonSubmit={event => {\r\n\t\t\t\t\t\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\tquery: prevState.filterContext? {...prevState.query, [prevState.filterContext]: prevState.searchKeyword} : {...prevState.query, q: prevState.searchKeyword}\r\n\t\t\t\t\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"Search submit searchKeyword\", this.state.searchKeyword)\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{!this.state.filterContext && <IconButton \r\n\t\t\t\t\t\t\t\t\t\t\tclassName={classes.filterIconButton} \r\n\t\t\t\t\t\t\t\t\t\t\taria-label=\"Filter\"\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={(event)=>{\r\n\t\t\t\t\t\t\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({filterMenuAnchor: event.currentTarget});\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<MenuIcon />\r\n\t\t\t\t\t\t\t\t\t\t</IconButton>}\r\n\t\t\t\t\t\t\t\t\t\t{(this.state.filterContext && this.state.filterableFields[this.state.filterContext])&& <Button  \r\n\t\t\t\t\t\t\t\t\t\t\taria-label=\"Filter\"\r\n\t\t\t\t\t\t\t\t\t\t\tsize={\"small\"}\r\n\t\t\t\t\t\t\t\t\t\t\tcolor=\"secondary\"\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={(event)=>{\r\n\t\t\t\t\t\t\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({filterMenuAnchor: event.currentTarget});\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{Function.isFunction(this.state.filterableFields[this.state.filterContext].label)? this.state.filterContext.humanize() : this.state.filterableFields[this.state.filterContext].label}\r\n\t\t\t\t\t\t\t\t\t\t</Button>}\r\n\t\t\t\t\t\t\t\t\t\t<Menu\r\n\t\t\t\t\t\t\t\t\t        id=\"filter-fields-menu\"\r\n\t\t\t\t\t\t\t\t\t        anchorEl={this.state.filterMenuAnchor}\r\n\t\t\t\t\t\t\t\t\t        keepMounted\r\n\t\t\t\t\t\t\t\t\t        open={Boolean(this.state.filterMenuAnchor)}\r\n\t\t\t\t\t\t\t\t\t        onClose={() => this.setState({filterMenuAnchor: null})}\r\n\t\t\t\t\t\t\t\t\t    >\r\n\t\t\t\t\t\t\t\t\t    \t\r\n\r\n\t\t\t\t\t\t\t\t\t        {Object.entries(this.state.filterableFields).map(([filterableField, filterableFieldProps], cursor) => (\r\n\t\t\t\t\t\t\t\t\t        \t<MenuItem \r\n\t\t\t\t\t\t\t\t\t        \t\tonClick={()=> {\r\n\t\t\t\t\t\t\t\t\t        \t\t\tthis.setState({filterContext: (this.state.filterContext === filterableField? false : filterableField), filterMenuAnchor: null});\t\t\t\t\t\t\t\t\t        \t\t\t\r\n\t\t\t\t\t\t\t\t\t        \t\t}}\r\n\t\t\t\t\t\t\t\t\t        \t>\r\n\t\t\t\t\t\t\t\t\t        \t\t{Function.isFunction(filterableFieldProps.label)? filterableField.humanize() : filterableFieldProps.label}\r\n\t\t\t\t\t\t\t\t\t        \t</MenuItem>\r\n\t\t\t\t\t\t\t\t\t        ))}\r\n\t\t\t\t\t\t\t\t\t    </Menu>\r\n\t\t\t\t\t\t\t\t\t\t<TextInput\r\n\t\t\t\t\t\t\t\t\t\t\tclassName={classes.searchInput}\r\n\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Search...\"\r\n\t\t\t\t\t\t\t\t\t\t\tinputProps={{ 'aria-label': 'Search' }}\r\n\t\t\t\t\t\t\t\t\t\t\tdefaultValue={this.state.searchKeyword}\r\n\t\t\t\t\t\t\t\t\t\t\tonFocus={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (!this.state.filterAccordionExpanded) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({ filterAccordionExpanded: true });\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\tonChange={newKeyword => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.setState(prevState=>{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet newState = { searchKeyword: newKeyword };\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (prevState.query) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (prevState.query.q) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet newQuery = JSON.fromJSON(prevState.query);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdelete newQuery[\"q\"];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnewState.query = newQuery;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn newState;\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\tvariant={\"base\"}\r\n\t\t\t\t\t\t\t\t\t\t\tref={ref => (this.searchkeywordRef = ref)}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t<IconButton \r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"submit\" className={classes.searchIconButton} aria-label=\"search\">\r\n\t\t\t\t\t\t\t\t\t\t\t<SearchIcon />\r\n\t\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t\t</Paper>\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t{/*</AccordionSummary>*/}\r\n\t\t\t\t\t\t\t\t\t<AccordionDetails className={\"p-0\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t{ Object.keys(this.state.filters.values).length > 0 && <GridContainer className=\"m-0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{Object.entries(this.state.filters.labels).map(([filter_name, filter_label], cursor) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Chip \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"mx-1 my-1 max-w-xs\" \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"secondary\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={(String.isString(defination.scope.columns[filter_name].label)? (defination.scope.columns[filter_name].label+\" : \") : \"\")+filter_label} \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outlined\" \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{maxWidth: 180}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={\"filter-chip-\"+cursor}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t</GridContainer>}\r\n\t\t\t\t\t\t\t\t\t</AccordionDetails>\r\n\t\t\t\t\t\t\t\t</Accordion>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t</GridContainer>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</GridItem>}\r\n\t\t\t\t\t\r\n\t\t\t\t\t<GridItem xs={12} className=\"p-0 m-0\">\r\n\t\t\t\t\t\t{view == \"tableview\" && <TableView\r\n\t\t\t\t\t\t\t\tdefination={defination}\r\n\t\t\t\t\t\t\t\tservice={this.state.service}\r\n\t\t\t\t\t\t\t\tquery={this.state.query}\r\n\t\t\t\t\t\t\t\tcache_data={cache_data}\r\n\t\t\t\t\t\t\t\tload_data={load_data}\r\n\t\t\t\t\t\t\t\tonLoadData={onLoadData}\r\n\t\t\t\t\t\t\t\tonClickEntry={onClickEntry}\r\n\t\t\t\t\t\t/>}\r\n\r\n\t\t\t\t\t\t{view === \"googlemapview\" && (\r\n\t\t\t\t\t\t\t<GoogleMapOverview\r\n\t\t\t\t\t\t\t\tcontext={defination.name}\r\n\t\t\t\t\t\t\t\tservice={this.state.service}\r\n\t\t\t\t\t\t\t\tquery={this.state.query}\r\n\t\t\t\t\t\t\t\tcache_data={cache_data}\r\n\t\t\t\t\t\t\t\tload_data={load_data}\r\n\t\t\t\t\t\t\t\tonLoadData={onLoadData}\r\n\t\t\t\t\t\t\t\tonClickEntry={onClickEntry}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t{view === \"calendarview\" && (\r\n\t\t\t\t\t\t\t<CalendarView\r\n\t\t\t\t\t\t\t\tdefination={defination}\r\n\t\t\t\t\t\t\t\tservice={this.state.service}\r\n\t\t\t\t\t\t\t\tquery={this.state.query}\r\n\t\t\t\t\t\t\t\tcache_data={cache_data}\r\n\t\t\t\t\t\t\t\tload_data={load_data}\r\n\t\t\t\t\t\t\t\tonLoadData={onLoadData}\r\n\t\t\t\t\t\t\t\tonClickEntry={onClickEntry}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t{view === \"listview\" && (\r\n\t\t\t\t\t\t\t<ListView\r\n\t\t\t\t\t\t\t\tdefination={defination}\r\n\t\t\t\t\t\t\t\tservice={this.state.service}\r\n\t\t\t\t\t\t\t\tquery={this.state.query}\r\n\t\t\t\t\t\t\t\tcache_data={cache_data}\r\n\t\t\t\t\t\t\t\tload_data={load_data}\r\n\t\t\t\t\t\t\t\tonLoadData={onLoadData}\r\n\t\t\t\t\t\t\t\tonClickEntry={onClickEntry}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</GridItem>\r\n\r\n\t\t\t\t</GridContainer>\r\n\r\n\t\t\t\t{ (showPagination && view != \"googlemapview\") && <GridContainer className=\"p-0 m-0 mb-4\">\r\n\t\t\t\t\t<GridItem xs={12} className=\"p-2 flex items-center justify-center\">\r\n\t\t\t\t\t\t<TablePagination \r\n\t\t\t\t\t\t\tcount={defination.name in cache.res? cache.res[defination.name].count : 1}\r\n\t\t\t\t\t\t\tpage={defination.name in cache.res? cache.res[defination.name].page-1 : this.state.page-1}\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\trowsPerPage={this.state.query.pagination}\r\n\t\t\t\t\t\t\tonChangePage={this.handleOnPageChanged}\r\n\t\t\t\t\t\t\tlabelRowsPerPage={\"Records per page\"}\r\n\t\t\t\t\t\t\trowsPerPageOptions={[5, 10, 25, 50, 100, { value: -1, label: 'All' }]}\r\n\t\t\t\t\t\t\tonChangeRowsPerPage={this.handleOnRecordsPerPageChanged}\r\n\t\t\t\t\t\t\tActionsComponent={TablePaginationActions}\r\n\t\t\t\t\t\t\tSelectProps={{\r\n\t\t\t\t\t\t\t\tlabel: \"Records per page\",\r\n\t\t\t\t\t\t\t\tvariant: \"outlined\",\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tclasses={{\r\n\t\t\t\t\t\t\t\ttoolbar: \"flex-col-reverse px-2\",\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</GridItem>\r\n\t\t\t\t</GridContainer> }\r\n\t\t\t</GridContainer>\r\n\t\t);\r\n\t}\r\n}\r\nListingView.propTypes = {\r\n\tclassName: PropTypes.string,\r\n\tclasses: PropTypes.object.isRequired,\r\n\tdefination: PropTypes.object.isRequired,\r\n\tservice: PropTypes.any.isRequired,\r\n\tview: PropTypes.string,\r\n\tquery: PropTypes.object,\r\n\tshowViewOptions: PropTypes.bool,\r\n\tshow_actions: PropTypes.bool,\r\n\tshow_links: PropTypes.bool,\r\n\tshowAddBtn: PropTypes.bool,\r\n\tshowSorter: PropTypes.bool,\r\n\tsorterFormLayoutType: PropTypes.string,\r\n\tshowPagination: PropTypes.bool,\r\n\tcache_data: PropTypes.bool,\r\n\tload_data: PropTypes.bool,\r\n\tonLoadData: PropTypes.func,\r\n\tonClickEntry: PropTypes.func,\r\n};\r\n\r\nListingView.defaultProps = {\r\n\tshow_actions: true,\r\n\tshow_links: true,\r\n\tshowViewOptions: true,\r\n\tshowAddBtn: true,\r\n\tshowPagination: true,\r\n\tshowSorter: true,\r\n\tsorterFormLayoutType: \"inline\",\r\n\tquery: {},\r\n\tload_data: true,\r\n\tcache_data: true,\r\n};\r\n\r\nconst mapStateToProps = state => ({\r\n\tauth: state.auth,\r\n\tcache: state.cache,\r\n\tapi: state.api,\r\n\tapp: state.app,\r\n});\r\n\r\nexport default compose(\r\n\twithStyles(styles),\r\n\tconnect(mapStateToProps, {}),\r\n\twithErrorHandler\r\n)(ListingView);\r\n","/** @format */\r\n\r\nimport { colors } from \"assets/jss/app-theme\";\r\n\r\nexport default theme => ({\r\n\troot: {\r\n\t\tpadding: theme.spacing(),\r\n\t\tbackgroundColor: theme.palette.background.paper,\r\n\t},\r\n\tcalendar: {\r\n\t\tborderRight: \"1px solid rgba(\" + colors.rgb.grey + \", 0.5) !important\",\r\n\t\tborderLeft: \"1px solid rgba(\" + colors.rgb.grey + \", 0.5) !important\",\r\n\t},\r\n\tactiveVieBtn: {\r\n\t\tbackground: colors.hex.primary,\r\n\t\tcolor: colors.hex.inverse,\r\n\t\tborder: \"1px solid\" + colors.hex.primary,\r\n\t},\r\n\tviewBtnGroup: {\r\n\t\tposition: \"absolute !important\",\r\n\t\tright: theme.spacing(),\r\n\t},\r\n\tsearchRoot: {\r\n\t\tpadding: '2px 4px',\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\twidth: \"100%\",\r\n\t\tmargin: 0,\r\n\t},\r\n\tsearchInput: {\r\n\t\tmarginLeft: theme.spacing(1),\r\n\t\tflex: 1,\r\n\t},\r\n\tsearchIconButton: {\r\n\t\tpadding: 10,\r\n\t},\r\n\tsearchDivider: {\r\n\t\theight: 28,\r\n\t\tmargin: 4,\r\n\t},\r\n});\r\n","/** @format */\n\nimport withStyles from \"@material-ui/core/styles/withStyles\";\nimport EmptyStateImage from \"assets/img/empty-state-table.svg\";\nimport GoogleMap from \"components/GoogleMap\";\nimport GridContainer from \"components/Grid/GridContainer\";\nimport GridItem from \"components/Grid/GridItem\";\nimport Typography from \"components/Typography\";\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\nimport { connect } from \"react-redux\";\nimport compose from \"recompose/compose\";\nimport { apiCallRequest, closeDialog, openDialog } from \"state/actions\";\nimport { withErrorHandler } from \"hoc/ErrorHandler\";\nimport styles from \"./styles\";\n\n\n\nclass GoogleMapView extends React.Component {\n\tstate = {\n\t\tloading: true,\n\t\tload_error: false,\n\t\tdefination: null,\n\t\tservice: null,\n\t\tquery: { p: 1 },\n\t\trecords: [],\n\t};\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tconst { defination, service, query } = props;\n\n\t\tthis.state.defination = defination;\n\t\tthis.state.service = service;\n\t\tthis.state.query = query ? { ...query, p: 1 } : { p: 1 };\n\n\t\tthis.handleDeleteItemConfirm = this.handleDeleteItemConfirm.bind(this);\n\t\tthis.handleDeleteItem = this.handleDeleteItem.bind(this);\n\t}\n\n\tcomponentDidMount() {\n\t\tconst { cache, defination } = this.props;\n\t\tthis.mounted = true;\n\t\tthis.loadContext();\n\t\tthis.prepareData((Array.isArray(cache.data[defination.name])? cache.data[defination.name] : []));\n\t}\n\n\tgetSnapshotBeforeUpdate(prevProps) {\n\t\tthis.mounted = false;\n\t\tconst { cache, defination } = this.props;\n\t\treturn {\n\t\t\tcontextReloadRequired: !Object.areEqual(prevProps.defination, this.props.defination),\n\t\t\tdataReloadRequired: !Object.areEqual(prevProps.query,this.props.query),\n\t\t\t/*dataPreparationRequired: Array.isArray(cache.data[defination.name])? !cache.data[prevProps.defination.name].equals(prevProps.cache.data[defination.name]) : (Array.isArray(prevProps.cache.data[defination.name])? !prevProps.cache.data[prevProps.defination.name].equals(cache.data[defination.name]) : false),*/\n\t\t\tdataPreparationRequired: false,\n\t\t};\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\n\t\tif (snapshot.contextReloadRequired) {\n\t\t\tthis.loadContext();\n\t\t\tthis.prepareData();\n\t\t}\n\t\tif (snapshot.dataReloadRequired) {\n\t\t\tconst { query } = this.props;\n\t\t\tthis.setState(\n\t\t\t\t{ query: query ? { ...query, p: 1 } : { p: 1 } },\n\t\t\t\tthis.loadData\n\t\t\t);\n\t\t}\n\t\t\n\t}\n\n\thandleDeleteItemConfirm = item_id => event => {\n\t\tconst { openDialog, closeDialog } = this.props;\n\t\tlet that = this;\n\t\topenDialog({\n\t\t\ttitle: \"Confirm Delete\",\n\t\t\tbody:\n\t\t\t\t\"Are you sure you want delete entry? This action might be irreversible\",\n\t\t\tactions: {\n\t\t\t\tcancel: {\n\t\t\t\t\ttext: \"Cancel\",\n\t\t\t\t\tcolor: \"default\",\n\t\t\t\t\tonClick: () => closeDialog(),\n\t\t\t\t},\n\t\t\t\tdelete: {\n\t\t\t\t\ttext: \"Delete\",\n\t\t\t\t\tcolor: \"error\",\n\t\t\t\t\tonClick: event => {\n\t\t\t\t\t\tcloseDialog();\n\t\t\t\t\t\tthis.handleDeleteItem(item_id);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t};\n\n\thandleDeleteItem = item_id => event => {\n\t\tconst { openDialog, closeDialog } = this.props;\n\t\topenDialog({\n\t\t\ttitle: \"Deleting safely\",\n\t\t\tbody: \"Please wait. Executing safe delete...\",\n\t\t\tactions: {\n\t\t\t\tclose: {\n\t\t\t\t\ttext: \"Close\",\n\t\t\t\t\tcolor: \"default\",\n\t\t\t\t\tonClick: () => closeDialog(),\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t};\n\n\tloadContext() {\n\t\tconst { defination, service, query, cache } = this.props;\n\t\tif (defination) {\n\t\t\tthis.setState(\n\t\t\t\t{\n\t\t\t\t\tdefination: defination,\n\t\t\t\t\tservice: service,\n\t\t\t\t\tquery: query ? { ...query, p: 1 } : { p: 1 },\n\t\t\t\t\tloading: false,\n\t\t\t\t},\n\t\t\t\tthis.loadData\n\t\t\t);\n\t\t}\n\t}\n\n\t\n\tloadData() {\n\t\tconst { auth, cache, defination, apiCallRequest, cache_data, onLoadData, load_data } = this.props;\n\t\tif (defination ) {\n\t\t\tif (load_data) {\n\t\t\t\tapiCallRequest( defination.name,\n\t\t\t\t\t{\n\t\t\t\t\t\turi: defination.endpoint,\n\t\t\t\t\t\ttype: \"records\",\n\t\t\t\t\t\tparams: this.state.query,\n\t\t\t\t\t\tdata: {},\n\t\t\t\t\t\tcache: cache_data,\n\t\t\t\t\t}\n\t\t\t\t).then(data => {\n\t\t\t\t\tif (Function.isFunction(onLoadData)) {\n\t\t\t\t\t\tonLoadData(data);\n\t\t\t\t\t}\n\t\t\t\t\tthis.prepareData(data);\n\t\t\t\t}).catch(e => {\n\t\t\t\t\tthis.setState(state => ({\n\t\t\t\t\t\trecords: [],\n\t\t\t\t\t\tload_error: e,\n\t\t\t\t\t\tloading: false,\n\t\t\t\t\t}));\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet data = Array.isArray(cache.data[defination.name])? cache.data[defination.name] : [];\n\t\t\t\tif (Function.isFunction(onLoadData)) {\n\t\t\t\t\tonLoadData(data);\n\t\t\t\t}\n\t\t\t\tthis.prepareData(data);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.setState(state => ({\n\t\t\t\trecords: [],\n\t\t\t\tload_error: { msg: \"No Context defination or provided\" },\n\t\t\t\tloading: false,\n\t\t\t}));\n\t\t}\n\t}\n\n\t\n\n\tprepareData(data=null) {\n\t\tconst { auth, cache, defination } = this.props;\n\t\tlet target_data = Array.isArray(data)? data : (Array.isArray(cache.data[defination.name]) ? cache.data[defination.name] : []);\n\t\tlet columns = defination ? defination.scope.columns : {};\n\t\tlet resolved_data = [];\n\n\t\tif ( Function.isFunction( defination.views.listing.googlemapview.resolveData ) ) {\n\t\t\tdefination.views.listing.googlemapview.resolveData(target_data, true).then(resolve => {\n\t\t\t\t\tthis.setState(state => ({\n\t\t\t\t\t\trecords: resolve,\n\t\t\t\t\t\tloading: false,\n\t\t\t\t\t}));\n\t\t\t}).catch(err => {\t\t\t\t\t\n\t\t\t\tthis.setState(state => ({ records: [], loading: false }));\n\t\t\t});\n\t\t}\n\t}\n\trender() {\n\t\tconst { classes, googleMapProps, api, defination } = this.props;\n\t\treturn (\n\t\t\t<GridContainer className={classes.root}>\n\t\t\t\t<GridItem className=\"p-0 m-0\" xs={12}>\n\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t<GridItem className=\"p-0 m-0\" xs={12}>\n\t\t\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t\t\t\t<GridItem xs={12} className=\"p-0 m-0\">\n\t\t\t\t\t\t\t\t\t\t\t<GoogleMap\n\t\t\t\t\t\t\t\t\t\t\t\tdefaultZoom={12}\n\t\t\t\t\t\t\t\t\t\t\t\tzoom={12}\n\t\t\t\t\t\t\t\t\t\t\t\t{...googleMapProps}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\tpolylines={\n\t\t\t\t\t\t\t\t\t\t\t\t\tdefination &&\n\t\t\t\t\t\t\t\t\t\t\t\t\tdefination.views.listing\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.googlemapview.type ===\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"polyline\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? this.state.records\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: []\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tmarkers={\n\t\t\t\t\t\t\t\t\t\t\t\t\tdefination.views.listing\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.googlemapview.type ===\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"marker\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? this.state.records\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: []\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tcircles={\n\t\t\t\t\t\t\t\t\t\t\t\t\tdefination.views.listing\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.googlemapview.type ===\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"circle\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? this.state.records\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: []\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tshowCurrentPosition={true}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t{(api ? api.complete && api.error : false) && (\n\t\t\t\t\t\t\t<GridContainer>\n\t\t\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\t\tcolor=\"error\"\n\t\t\t\t\t\t\t\t\t\tvariant=\"body2\"\n\t\t\t\t\t\t\t\t\t\tcenter\n\t\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{\"An error occured. \\n \" +\n\t\t\t\t\t\t\t\t\t\t\tapi.error.msg}\n\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</GridContainer>\n\t\t\t\t</GridItem>\n\t\t\t</GridContainer>\n\t\t);\n\t}\n}\nGoogleMapView.propTypes = {\n\tclassName: PropTypes.string,\n\tclasses: PropTypes.object.isRequired,\n\tdefination: PropTypes.object.isRequired,\n\tservice: PropTypes.any.isRequired,\n\tshow_actions: PropTypes.bool,\n\tshow_links: PropTypes.bool,\n\tgoogleMapProps: PropTypes.object,\n\tquery: PropTypes.object,\n\tcache_data: PropTypes.bool,\n\tload_data: PropTypes.bool,\n\tonLoadData: PropTypes.func,\n};\n\nGoogleMapView.defaultProps = {\n\tgoogleMapProps: {\n\t\tmapHeight: 900,\n\t\tshowClientsPositions: true,\n\t\tshowCurrentPosition: true,\n\t},\n\tquery: {},\n\tload_data: true,\n\tcache_data: true,\n};\n\nconst mapStateToProps = (state, ownProps) => {\n\tconst { defination } = ownProps;\n\treturn {\n\t\tauth: state.auth,\n\t\tcache: state.cache,\n\t\tapi: state.api,\n\t};\n};\n\nexport default compose(\n\twithStyles(styles),\n\tconnect(mapStateToProps, { apiCallRequest, openDialog, closeDialog }),\n\twithErrorHandler\n)(GoogleMapView);\n","/** @format */\n\nexport default theme => ({\n\troot: {\n\t\tpadding: \"0\",\n\t},\n});\n","/**\n * /* eslint-disable no-mixed-spaces-and-tabs\n *\n * @format\n */\n\nimport Card from \"components/Card\";\nimport CardActions from \"components/Card/CardActions\";\nimport CardContent from \"components/Card/CardContent\";\nimport CardHeader from \"components/Card/CardHeader\";\nimport GridContainer from \"components/Grid/GridContainer\";\nimport GridItem from \"components/Grid/GridItem\";\nimport Typography from \"components/Typography\";\nimport { formats } from \"config/data\";\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\nimport { connect } from \"react-redux\";\nimport { ServiceDataHelper } from \"hoc/Helpers\";\nimport { withErrorHandler } from \"hoc/ErrorHandler\";\n\n\n\nfunction CardView({ ...props }) {\n\tconst [expanded, setExpanded] = React.useState(true);\n\tconst { record, defination, auth } = props;\n\n\tlet resolvedRefRecord = {};\n\n\tif (typeof defination.views.single.cardview.resolveData === \"function\") {\n\t\tresolvedRefRecord = defination.views.single.cardview.resolveData(\n\t\t\trecord,\n\t\t\tauth.user,\n\t\t\ttrue\n\t\t);\n\t\tif (!JSON.isJSON(resolvedRefRecord)) {\n\t\t\tresolvedRefRecord = {};\n\t\t}\n\t\tresolvedRefRecord.resolver = \"defination\";\n\t} else {\n\t\tresolvedRefRecord = ServiceDataHelper.resolveReferenceColumnsDisplays(\n\t\t\t[record],\n\t\t\tdefination.scope.columns,\n\t\t\tauth.user\n\t\t)[0];\n\t\tif (!JSON.isJSON(resolvedRefRecord)) {\n\t\t\tresolvedRefRecord = {};\n\t\t}\n\n\t\tresolvedRefRecord.resolver = \"helper\";\n\t}\n\n\tfunction handleExpandClick() {\n\t\tsetExpanded(!expanded);\n\t}\n\n\tfunction resolveAvatar() {\n\t\tlet avatar = null;\n\t\tif (resolvedRefRecord.resolver === \"defination\") {\n\t\t\tavatar = resolvedRefRecord.avatar;\n\t\t}\n\t\t/* else if (resolvedRefRecord.resolver === \"helper\") {\n\t\t} */\n\n\t\treturn avatar;\n\t}\n\n\tfunction resolveTitle() {\n\t\tlet title = \"\";\n\t\tif (resolvedRefRecord.resolver === \"defination\") {\n\t\t\ttitle = resolvedRefRecord.title;\n\t\t} else if (resolvedRefRecord.resolver === \"helper\") {\n\t\t\tlet primaries = defination.scope.identity.primary;\n\t\t\tfor (var i = 0; i < primaries.length; i++) {\n\t\t\t\ttitle +=\n\t\t\t\t\tdefination.scope.columns[primaries[i]].reference &&\n\t\t\t\t\tresolvedRefRecord[primaries[i]]\n\t\t\t\t\t\t? resolvedRefRecord[primaries[i]].resolve\n\t\t\t\t\t\t: resolvedRefRecord[primaries[i]];\n\t\t\t}\n\t\t}\n\n\t\treturn title;\n\t}\n\n\tfunction resolveSubTitle() {\n\t\tlet subtitle = \"\";\n\t\tif (resolvedRefRecord.resolver === \"defination\") {\n\t\t\tsubtitle = resolvedRefRecord.subtitle;\n\t\t} else if (resolvedRefRecord.resolver === \"helper\") {\n\t\t\tlet secondaries = defination.scope.identity.secondary;\n\t\t\tfor (var i = 0; i < secondaries.length; i++) {\n\t\t\t\tsubtitle += defination.scope.columns[secondaries[i]].reference &&\n\t\t\t\t\tresolvedRefRecord[secondaries[i]]\n\t\t\t\t\t\t? resolvedRefRecord[secondaries[i]].resolve\n\t\t\t\t\t\t: resolvedRefRecord[secondaries[i]];\n\t\t\t}\n\t\t}\n\n\t\treturn subtitle;\n\t}\n\n\tfunction resolveDisplayValue(name) {\n\t\tif (\n\t\t\tdefination.scope.columns[name].reference &&\n\t\t\tresolvedRefRecord[name]\n\t\t) {\n\t\t\tif (Array.isArray(resolvedRefRecord[name])) {\n\t\t\t\treturn (\n\t\t\t\t\t<React.Fragment>\n\t\t\t\t\t\t{resolvedRefRecord[name].map((entry, index) => (\n\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\tparagraph\n\t\t\t\t\t\t\t\tkey={name + \"-\" + index}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{entry.resolve}\n\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</React.Fragment>\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\treturn (\n\t\t\t\t\t<Typography color=\"default\" paragraph>\n\t\t\t\t\t\t{resolvedRefRecord[name].resolve}\n\t\t\t\t\t</Typography>\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\tif (Array.isArray(resolvedRefRecord[name])) {\n\t\t\t\treturn (\n\t\t\t\t\t<React.Fragment>\n\t\t\t\t\t\t{resolvedRefRecord[name].map((entry, index) => (\n\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\tparagraph\n\t\t\t\t\t\t\t\tkey={name + \"-\" + index}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{entry}\n\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</React.Fragment>\n\t\t\t\t);\n\t\t\t} else if (!JSON.isJSON(resolvedRefRecord[name])) {\n\t\t\t\tif (\n\t\t\t\t\tdefination.scope.columns[name].input.type === \"date\" ||\n\t\t\t\t\tdefination.scope.columns[name].input.type === \"datetime\"\n\t\t\t\t) {\n\t\t\t\t\tif (defination.scope.columns[name].input.type === \"date\") {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<Typography color=\"default\" paragraph>\n\t\t\t\t\t\t\t\t{resolvedRefRecord[name]\n\t\t\t\t\t\t\t\t\t? new Date(resolvedRefRecord[name]).format(\n\t\t\t\t\t\t\t\t\t\t\tformats.dateformats.date\n\t\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t\t: \"\"}\n\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<Typography color=\"default\" paragraph>\n\t\t\t\t\t\t\t\t{resolvedRefRecord[name]\n\t\t\t\t\t\t\t\t\t? new Date(resolvedRefRecord[name]).format(\n\t\t\t\t\t\t\t\t\t\t\tformats.dateformats.datetime\n\t\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t\t: \"\"}\n\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t} else if (defination.scope.columns[name].type === \"boolean\") {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<Typography color=\"default\" paragraph>\n\t\t\t\t\t\t\t{resolvedRefRecord[name] ? \"Yes\" : \"No\"}\n\t\t\t\t\t\t</Typography>\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<Typography color=\"default\" paragraph>\n\t\t\t\t\t\t\t{resolvedRefRecord[name]\n\t\t\t\t\t\t\t\t? resolvedRefRecord[name]\n\t\t\t\t\t\t\t\t: \"\"}\n\t\t\t\t\t\t</Typography>\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn (\n\t\t\t\t\t<Typography color=\"default\" paragraph>\n\t\t\t\t\t\t{JSON.stringify(resolvedRefRecord[name])}\n\t\t\t\t\t</Typography>\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction resolveValue() {\n\t\tlet body = \"\";\n\t\tif (resolvedRefRecord.resolver === \"defination\") {\n\t\t\tbody = resolvedRefRecord.body;\n\t\t} else if (resolvedRefRecord.resolver === \"helper\") {\n\t\t\tbody = (\n\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t{Object.entries(defination.scope.columns).map(\n\t\t\t\t\t\t([name, column], index) =>\n\t\t\t\t\t\t\tcolumn.restricted && Function.isFunction() ? (\n\t\t\t\t\t\t\t\t!column.restricted.display(\n\t\t\t\t\t\t\t\t\trecord,\n\t\t\t\t\t\t\t\t\tauth.user\n\t\t\t\t\t\t\t\t) && (\n\t\t\t\t\t\t\t\t\t<GridContainer\n\t\t\t\t\t\t\t\t\t\tclassName=\"p-0 m-0\"\n\t\t\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<GridItem xs={5}>\n\t\t\t\t\t\t\t\t\t\t\t<Typography color=\"grey\" paragraph>\n\t\t\t\t\t\t\t\t\t\t\t\t{column.label}\n\t\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t\t\t\t<GridItem xs={7}>\n\t\t\t\t\t\t\t\t\t\t\t{resolveDisplayValue(name)}\n\t\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\" key={index}>\n\t\t\t\t\t\t\t\t\t<GridItem xs={5}>\n\t\t\t\t\t\t\t\t\t\t<Typography color=\"grey\" paragraph>\n\t\t\t\t\t\t\t\t\t\t\t{column.label}\n\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t\t\t<GridItem xs={7}>\n\t\t\t\t\t\t\t\t\t\t{resolveDisplayValue(name)}\n\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t)}\n\t\t\t\t</GridContainer>\n\t\t\t);\n\t\t}\n\n\t\treturn body;\n\t}\n\n\treturn defination && record ? (\n\t\t<Card elevation={0} outlineColor=\"#CCCCCC\">\n\t\t\t<CardHeader\n\t\t\t\tavatar={resolveAvatar()}\n\t\t\t\ttitle={resolveTitle()}\n\t\t\t\tsubheader={resolveSubTitle()}\n\t\t\t/>\n\n\t\t\t<CardContent className=\"p-0 m-0\">{resolveValue()}</CardContent>\n\t\t\t<CardActions></CardActions>\n\t\t</Card>\n\t) : (\n\t\t<GridContainer />\n\t);\n} /**/\n\nCardView.propTypes = {\n\tclassName: PropTypes.string,\n\trecord: PropTypes.object.isRequired,\n\tdefination: PropTypes.object.isRequired,\n};\n\nconst mapStateToProps = state => ({\n\tauth: state.auth,\n});\n\nexport default connect(mapStateToProps, {})(withErrorHandler(CardView));\n","/** @format */\n\nimport Button from \"@material-ui/core/Button\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport withStyles from \"@material-ui/core/styles/withStyles\";\n//\nimport clsx from \"clsx\";\nimport Collapse from \"@material-ui/core/Collapse\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\nimport Typography from \"components/Typography\";\nimport ListingView from \"views/widgets/Listings\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Tabs from \"@material-ui/core/Tabs\";\nimport Tab from \"@material-ui/core/Tab\";\nimport Box from \"@material-ui/core/Box\";\n//\nimport GridContainer from \"components/Grid/GridContainer\";\nimport GridItem from \"components/Grid/GridItem\";\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\n//Redux imports\nimport { connect } from \"react-redux\";\nimport compose from \"recompose/compose\";\nimport { withErrorHandler } from \"hoc/ErrorHandler\";\n//\nimport CardView from \"./CardView\";\nimport * as definations from \"definations\";\nimport * as services from \"services\";\n//\nimport styles from \"./styles\";\n\nfunction TabPanel(props) {\n\tconst { children, value, index, ...other } = props;\n\n\treturn (\n\t\t<Typography\n\t\t\tcomponent=\"div\"\n\t\t\trole=\"tabpanel\"\n\t\t\thidden={value !== index}\n\t\t\tid={`scrollable-force-tabpanel-${index}`}\n\t\t\taria-labelledby={`scrollable-force-tab-${index}`}\n\t\t\t{...other}\n\t\t>\n\t\t\t<Box className=\"p-0\">{children}</Box>\n\t\t</Typography>\n\t);\n}\n\nTabPanel.propTypes = {\n\tchildren: PropTypes.node,\n\tindex: PropTypes.any.isRequired,\n\tvalue: PropTypes.any.isRequired,\n};\n\nfunction a11yProps(index) {\n\treturn {\n\t\tid: `scrollable-force-tab-${index}`,\n\t\t\"aria-controls\": `scrollable-force-tabpanel-${index}`,\n\t};\n}\n\nclass RecordView extends React.Component {\n\tstate = {\n\t\tview: \"cardview\",\n\t\tviews: {},\n\t\tviewMenuAnchorEl: null,\n\t\texpanded: true,\n\t};\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.prepareForView();\n\t\tthis.handleExpandClick = this.handleExpandClick.bind(this);\n\t\tthis.handleViewMenuItemClick = this.handleViewMenuItemClick.bind(this);\n\t\tthis.handleRelatedTabValueChange = this.handleRelatedTabValueChange.bind(\n\t\t\tthis\n\t\t);\n\t\tthis.handleCloseViewsMenu = this.handleCloseViewsMenu.bind(this);\n\t}\n\n\tcomponentDidMount() {}\n\n\thandleViewMenuItemClick = name => event => {\n\t\tthis.setState({ view: name, viewMenuAnchorEl: null });\n\t};\n\n\thandleRelatedTabValueChange(event, value) {\n\t\tthis.setState({ relatedTab: value });\n\t}\n\n\thandleShowViewsMenu = event => {\n\t\tthis.setState({ viewMenuAnchorEl: event.currentTarget });\n\t};\n\n\thandleCloseViewsMenu = () => {\n\t\tthis.setState({ viewMenuAnchorEl: null });\n\t};\n\n\thandleExpandClick() {\n\t\tthis.setState(prevState => ({ expanded: !prevState.expanded }));\n\t}\n\n\tprepareForView() {\n\t\tconst { defination, auth } = this.props;\n\t\tlet all_views = {\n\t\t\tcardview: \"Card View\",\n\t\t\tgooglemapview: \"Google Map View\",\n\t\t\tvectormapview: \"Vector Map View\",\n\t\t\tcalendarview: \"Calendar View\",\n\t\t};\n\t\tlet views = {};\n\t\tlet view = \"cardview\";\n\t\tif (defination.views.single.default in all_views) {\n\t\t\tview = defination.views.single.default;\n\t\t}\n\t\tfor (let [name, label] of Object.entries(all_views)) {\n\t\t\tif (name in defination.views.single) {\n\t\t\t\tviews[name] = label;\n\t\t\t}\n\t\t}\n\t\tlet relatedTab = null;\n\t\tif (JSON.isJSON(defination.scope.dependants)) {\n\t\t\tfor (let [key, value] of Object.entries(\n\t\t\t\tdefination.scope.dependants\n\t\t\t)) {\n\t\t\t\tif (definations[key].name !== defination.name) {\n\t\t\t\t\tif (!String.isString(relatedTab)) {\n\t\t\t\t\t\tif (!definations[key].access.restricted(auth.user)) {\n\t\t\t\t\t\t\trelatedTab = definations[key].name;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.state.views = views;\n\t\tthis.state.view = view;\n\t\tthis.state.relatedTab = relatedTab;\n\t}\n\n\trender() {\n\t\tconst { classes, auth, defination, record, service } = this.props;\n\t\treturn (\n\t\t\t<GridContainer className={classes.root}>\n\t\t\t\t<GridContainer>\n\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName={classes.viewSelectBtn}\n\t\t\t\t\t\t\tonClick={this.handleShowViewsMenu}\n\t\t\t\t\t\t\taria-label=\"view-select\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{this.state.views[this.state.view]}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Menu\n\t\t\t\t\t\t\tid=\"lock-menu\"\n\t\t\t\t\t\t\tanchorEl={this.state.viewMenuAnchorEl}\n\t\t\t\t\t\t\tkeepMounted\n\t\t\t\t\t\t\topen={Boolean(this.state.viewMenuAnchorEl)}\n\t\t\t\t\t\t\tonClose={this.handleCloseViewsMenu}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{Object.entries(this.state.views).map(\n\t\t\t\t\t\t\t\t([name, label], index) => (\n\t\t\t\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\t\t\t\tkey={name}\n\t\t\t\t\t\t\t\t\t\tselected={name === this.state.view}\n\t\t\t\t\t\t\t\t\t\tonClick={this.handleViewMenuItemClick(\n\t\t\t\t\t\t\t\t\t\t\tname\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{label}\n\t\t\t\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Menu>\n\t\t\t\t\t</GridItem>\n\t\t\t\t</GridContainer>\n\n\t\t\t\t<GridContainer>\n\t\t\t\t\t{this.state.view === \"cardview\" && (\n\t\t\t\t\t\t<CardView\n\t\t\t\t\t\t\tdefination={defination}\n\t\t\t\t\t\t\tservice={service}\n\t\t\t\t\t\t\trecord={record}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</GridContainer>\n\t\t\t\t<GridContainer className=\"p-0\">\n\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t<GridContainer>\n\t\t\t\t\t\t\t<GridItem xs={2} md={1}>\n\t\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\t\tclassName={clsx(classes.expand, {\n\t\t\t\t\t\t\t\t\t\t[classes.expandOpen]: this.state\n\t\t\t\t\t\t\t\t\t\t\t.expanded,\n\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\tonClick={this.handleExpandClick}\n\t\t\t\t\t\t\t\t\taria-expanded={this.state.expanded}\n\t\t\t\t\t\t\t\t\taria-label=\"show more\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<ExpandMoreIcon />\n\t\t\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t<GridItem xs={10} md={11}>\n\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\tclassName={classes.relationsSectionTitle}\n\t\t\t\t\t\t\t\t\tcolor={\n\t\t\t\t\t\t\t\t\t\tthis.state.expanded ? \"default\" : \"grey\"\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tvariant=\"body2\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{\" \"}\n\t\t\t\t\t\t\t\t\tRelated to this{\" \"}\n\t\t\t\t\t\t\t\t\t{defination.label.singularize()}{\" \"}\n\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t</GridItem>\n\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t<Collapse in={this.state.expanded} timeout=\"auto\">\n\t\t\t\t\t\t\t{JSON.isJSON(defination.scope.dependants) ? (\n\t\t\t\t\t\t\t\t<AppBar\n\t\t\t\t\t\t\t\t\tposition=\"static\"\n\t\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\t\televation={0}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Tabs\n\t\t\t\t\t\t\t\t\t\tvalue={this.state.relatedTab}\n\t\t\t\t\t\t\t\t\t\tonChange={\n\t\t\t\t\t\t\t\t\t\t\tthis.handleRelatedTabValueChange\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tindicatorColor=\"primary\"\n\t\t\t\t\t\t\t\t\t\ttextColor=\"primary\"\n\t\t\t\t\t\t\t\t\t\tvariant=\"fullWidth\"\n\t\t\t\t\t\t\t\t\t\taria-label=\"related data tabs\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{Object.entries(\n\t\t\t\t\t\t\t\t\t\t\tdefination.scope.dependants\n\t\t\t\t\t\t\t\t\t\t).map(\n\t\t\t\t\t\t\t\t\t\t\t([dependant, properties], cursor) =>\n\t\t\t\t\t\t\t\t\t\t\t\t!definations[\n\t\t\t\t\t\t\t\t\t\t\t\t\tdependant\n\t\t\t\t\t\t\t\t\t\t\t\t].access.restricted(\n\t\t\t\t\t\t\t\t\t\t\t\t\tauth.user\n\t\t\t\t\t\t\t\t\t\t\t\t) && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Tab\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={dependant}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefinations[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdependant\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t].label\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefinations[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdependant\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t].icon\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={cursor + \"_tab\"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...a11yProps(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdependant\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</Tabs>\n\t\t\t\t\t\t\t\t</AppBar>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<Typography color=\"grey\" paragraph>\n\t\t\t\t\t\t\t\t\t{\" \"}\n\t\t\t\t\t\t\t\t\tNo Related data{\" \"}\n\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t{JSON.isJSON(defination.scope.dependants) &&\n\t\t\t\t\t\t\t\tObject.entries(defination.scope.dependants).map(\n\t\t\t\t\t\t\t\t\t([dependant, properties], cursor) =>\n\t\t\t\t\t\t\t\t\t\t!definations[\n\t\t\t\t\t\t\t\t\t\t\tdependant\n\t\t\t\t\t\t\t\t\t\t].access.restricted(auth.user) && (\n\t\t\t\t\t\t\t\t\t\t\t<TabPanel\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"p-0\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={this.state.relatedTab}\n\t\t\t\t\t\t\t\t\t\t\t\tindex={dependant}\n\t\t\t\t\t\t\t\t\t\t\t\tkey={\"tab-\" + cursor}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<ListingView\n\t\t\t\t\t\t\t\t\t\t\t\t\tdefination={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefinations[dependant]\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\tservice={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tservices[dependant]\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\tquery={{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t...properties.query,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t[properties.column]:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trecord._id,\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\tshow_actions={false}\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowAddBtn={false}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t</TabPanel>\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Collapse>\n\t\t\t\t\t</GridItem>\n\t\t\t\t</GridContainer>\n\t\t\t</GridContainer>\n\t\t);\n\t}\n}\nRecordView.propTypes = {\n\tclassName: PropTypes.string,\n\tclasses: PropTypes.object.isRequired,\n\tdefination: PropTypes.object.isRequired,\n\tservice: PropTypes.any.isRequired,\n\trecord: PropTypes.object.isRequired,\n\tshowRelated: PropTypes.bool,\n};\n\nRecordView.defaultProps = {};\n\nconst mapStateToProps = state => ({\n\tauth: state.auth,\n});\n\nexport default compose(\n\twithStyles(styles),\n\tconnect(mapStateToProps, {}),\n\twithErrorHandler\n)(RecordView);\n","/** @format */\n\nexport default theme => ({\n\troot: {\n\t\tpadding: theme.spacing(),\n\t},\n\tviewSelectBtn: {\n\t\tposition: \"absolute !important\",\n\t\tright: theme.spacing(),\n\t\tbottom: theme.spacing(),\n\t},\n\texpand: {\n\t\ttransform: \"rotate(0deg)\",\n\t\tmarginLeft: \"auto\",\n\t\ttransition: theme.transitions.create(\"transform\", {\n\t\t\tduration: theme.transitions.duration.shortest,\n\t\t}),\n\t},\n\texpandOpen: {\n\t\ttransform: \"rotate(180deg)\",\n\t},\n\trelationsSectionTitle: {\n\t\theight: \"100%\",\n\t\tlineHeight: \"48px\",\n\t\tverticalAlign: \"middle\",\n\t},\n});\n","/** @format */\r\n\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport classNames from \"classnames\";\r\nimport Menu from \"@material-ui/core/Menu\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\n\r\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer';\r\nimport List from '@material-ui/core/List';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\r\nimport Icon from '@mdi/react'\r\nimport { mdiMapMarkerMultiple, mdiMapMarkerMultipleOutline, mdiMapMarkerOff, mdiForwardburger, mdiTooltipAccount as clientPositionMarkerPath, mdiAccountCircleOutline, mdiFolderOutline } from '@mdi/js';\r\nimport MenuOpenIcon from '@material-ui/icons/MenuOpen';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport ImageIcon from '@material-ui/icons/Image';\r\nimport { colors } from \"assets/jss/app-theme\";\r\nimport Avatar from \"components/Avatar\";\r\nimport Card from \"components/Card\";\r\nimport CardActions from \"components/Card/CardActions\";\r\nimport CardContent from \"components/Card/CardContent\";\r\nimport CardHeader from \"components/Card/CardHeader\";\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport GridContainer from \"components/Grid/GridContainer\";\r\nimport GridItem from \"components/Grid/GridItem\";\r\nimport Typography from \"components/Typography\";\r\nimport BottomNavigation from '@material-ui/core/BottomNavigation';\r\nimport BottomNavigationAction from '@material-ui/core/BottomNavigationAction';\r\nimport { withTheme } from '@material-ui/core/styles';\r\nimport MapOutlinedIcon from '@material-ui/icons/MapOutlined';\r\nimport PeopleIcon from '@material-ui/icons/People';\r\nimport PersonOutlinedIcon from \"@material-ui/icons/PersonOutlined\";\r\nimport React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { apiCallRequest, closeDialog, openDialog } from \"state/actions\";\r\nimport {withGlobals} from \"contexts/Globals\";\r\nimport Pagination from '@material-ui/lab/Pagination';\r\nimport compose from \"recompose/compose\";\r\nimport GoogleMap from \"components/GoogleMap\";\r\nimport GoogleMapView from \"views/widgets/Listings/GoogleMapView\";\r\nimport Listings from \"views/widgets/Listings\";\r\nimport { SwitchInput } from \"components/FormInputs\";\r\nimport {withErrorHandler} from \"hoc/ErrorHandler\";\r\nimport client_user_female_icon from \"assets/img/maps/marker-person-female.png\";\r\nimport client_user_male_icon from \"assets/img/maps/marker-person-male.png\";\r\nimport PropTypes from \"prop-types\";\r\nimport styles from \"./styles\";\r\n\r\n\r\nlet googleMap = false;\r\n\r\nlet commission_status_colors = {\r\n\tscheduled: \"#880e4f\",\r\n\tongoing: \"#e65100\",\r\n\tcomplete: \"#4caf50\",\r\n\tcancelled: \"#b71c1c\",\r\n};\r\n\r\nlet track_timetype_colors = {\r\n\tlive: \"#4caf50\",\r\n\tpast: \"#b71c1c\",\r\n};\r\n\r\nclass GoogleMapOverview extends React.Component {\r\n\tstate = {\r\n\t\tdefinations: {},\r\n\t\tservices: {},\r\n\t\tdefination: null,\r\n\t\tservice: null,\r\n\t\tdrawerOpen: true,\r\n\t\tshow_client_positions: true,\r\n\t\tclients_positions: {},\r\n\t\tcontext: \"commissions\",\r\n\t\tcontext_entry: null,\r\n\t\tdefaultZoom: 10,\r\n\t\tmulticontexts: true,\r\n\t\trendered_contexts: [],\r\n\t\tcontexts_props: {},\r\n\t\tzoom: 15,\r\n\t\tquery: {},\r\n\t\trecords: [],\r\n\t\tmarkers: [],\r\n\t\tcircles: [],\r\n\t\tpolylines: [],\r\n\t};\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tconst { device, cache, context, contexts, definations, app } = this.props;\r\n\t\tthis.elementRef = React.createRef();\r\n\t\tthis.prepareForView();\r\n\t\tthis.toggleDrawer = this.toggleDrawer.bind(this);\r\n\t\t\r\n\t\tthis.handleOnLoadMap = this.handleOnLoadMap.bind(this);\r\n\t\tthis.handleClientListItemClick = this.handleClientListItemClick.bind(this);\r\n\t\tthis.handleOnToggleShowClients = this.handleOnToggleShowClients.bind(this);\r\n\t\tthis.handleOnClientsPositionsLoaded = this.handleOnClientsPositionsLoaded.bind(this);\r\n\t\tthis.handleOnClientPositionAvailable = this.handleOnClientPositionAvailable.bind(this);\r\n\t\tthis.handleOnClientPositionUnavailable = this.handleOnClientPositionUnavailable.bind(this);\r\n\t\tthis.handleOnClientPositionChanged = this.handleOnClientPositionChanged.bind(this);\r\n\t\tthis.handleOnDrawerNavigationValueChange = this.handleOnDrawerNavigationValueChange.bind(this);\r\n\t\tthis.handleContextEntryClick = this.handleContextEntryClick.bind(this);\r\n\t\tthis.handleToggleContextRender = this.handleToggleContextRender.bind(this);\r\n\t\t\r\n\t\tthis.state = { \r\n\t\t\t...this.state, \r\n\t\t\t//context: Object.keys(this.state.definations)[0],\r\n\t\t\tcontext: context? context: this.state.context,\r\n\t\t\tdefaultZoom: app.preferences.data.defaultMapZoom,\r\n\t\t\tmulticontexts: Array.isArray(contexts)? contexts.length > 1 : false,\r\n\t\t\trendered_contexts: context? [context]: [],\r\n\t\t\tcontexts_props: context? {\r\n\t\t\t\t[context]: {\r\n\t\t\t\t\tquery: {page: 1, pagination: app.preferences.data.pagination, populate: 1},\r\n\t\t\t\t\telement: \"marker\",\r\n\t\t\t\t\trecords: [],\r\n\t\t\t\t}\r\n\t\t\t}: {},\r\n\t\t\tcontext_entries: Array.isArray(cache.data[this.state.defination.name])? cache.data[this.state.defination.name] : [],\r\n\t\t\t//drawerOpen: device.window_size.width >= 1280,\r\n\t\t\tdrawerOpen: false,\r\n\t\t};\r\n\t}\r\n\r\n\tisMounted() {\r\n\t\treturn this.elementRef.current != null;\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\t//throw new Error('This is a withErrorHandler test.');\r\n\r\n\r\n\t\t\r\n\t}\r\n\r\n\tprepareForView() {\r\n\t\tconst { auth, definations, services, app } = this.props;\r\n\t\tlet current_defination = null;\r\n\t\tlet current_service = null;\r\n\t\tlet possible_definations = {};\r\n\t\tlet possible_services = {};\r\n\t\tlet contexts_props = this.state.contexts_props;\r\n\t\tfor (let [name, defination] of Object.entries(definations)) {\r\n\t\t\tif (!defination.access.restricted(auth.user)) {\r\n\t\t\t\tif (defination.views.listing.googlemapview && Function.isFunction( defination.views.listing.googlemapview.resolveData )) {\r\n\t\t\t\t\tpossible_definations[name] = defination;\r\n\t\t\t\t\tpossible_services[name] = services[name];\r\n\t\t\t\t\tcontexts_props[name] = {\r\n\t\t\t\t\t\tquery: {page: 1, pagination: app.preferences.data.pagination, populate: 1},\r\n\t\t\t\t\t\telement: defination.views.listing.googlemapview.type,\r\n\t\t\t\t\t\telements: [],\r\n\t\t\t\t\t\tloaded: false,\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (current_defination === null) {\r\n\t\t\t\t\t\tcurrent_defination = defination;\r\n\t\t\t\t\t\tcurrent_service = services[name];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.state.contexts_props = contexts_props;\r\n\t\tthis.state.definations = possible_definations;\r\n\t\tthis.state.services = possible_services;\r\n\t\tthis.state.defination = current_defination;\r\n\t\tthis.state.service = current_service;\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\r\n\r\n\ttoggleDrawer= (open) => (event) => {\r\n\t\tif (event && event.type === 'keydown' && (event.key === 'Tab' || event.key === 'Shift')) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (open !== this.state.drawerOpen) {\r\n\t\t\tthis.setState(state => ({ drawerOpen: open }));\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\thandleOnToggleShowClients(event) {\r\n\t\tthis.setState(state => ({ show_client_positions: !state.show_client_positions }));\r\n\t}\r\n\r\n\thandleOnLoadMap(map, google) {\r\n\t\tgoogleMap = map;\r\n\t\t\r\n\t}\r\n\r\n\r\n\thandleOnClientsPositionsLoaded(clients_positions) {\r\n\t\tthis.setState(state => ({ clients_positions: clients_positions }));\r\n\t}\r\n\r\n\thandleOnClientPositionAvailable(clientId, client) {\r\n\t\tthis.setState(prevState => ({ clients_positions: {...prevState.clients_positions, [clientId]: client } }));\r\n\t\t\r\n\t}\r\n\r\n\thandleOnClientPositionUnavailable(socketId, client) {\t\t\r\n\t\tthis.setState(prevState => {\r\n\t\t\tlet newclientspositions = prevState.clients_positions;\r\n\t\t\t\r\n\t\t\tdelete newclientspositions[socketId];\r\n\r\n\t\t\treturn { clients_positions: newclientspositions }\r\n\t\t});\r\n\t}\r\n\r\n\thandleOnClientPositionChanged(socketId, client) {\r\n\t\t\tthis.setState(state => {\r\n\t\t\t\treturn { clients_positions: state.drawerOpen? {...state.clients_positions, [socketId]: client } : state.clients_positions }\r\n\t\t\t});\r\n\t\t\t\t\r\n\t}\r\n\r\n\r\n\t\r\n\r\n\thandleOnDrawerNavigationValueChange = (event, newValue) => {\r\n\t\tconst { definations, services, cache } = this.props;\r\n\t\t\r\n\t\tthis.setState(state => ({\r\n\t\t\tcontext : newValue,\r\n\t\t\tcontext_entry: null,\r\n\t\t\tcontext_entries: [\"commissions\", \"tracks\"].includes(newValue)? (Array.isArray(cache.data[newValue])? cache.data[newValue] : []) : [],\r\n\t\t\tdefination: [\"commissions\", \"tracks\"].includes(newValue)? definations[newValue] : state.defination,\r\n\t\t\tservice: [\"commissions\", \"tracks\"].includes(newValue)? services[newValue] : state.service,\r\n\t\t}));\r\n\t};\r\n\r\n\thandleClientListItemClick = (socketId, client) => event => {\r\n\t\tconsole.log(\"handleClientListItemClick client\", client, \"googleMap\", googleMap);\r\n\t\tif (googleMap) {\t\t\r\n\t\t\t\t\tgoogleMap.panTo({ lat: client.position.latitude, lng: client.position.longitude });\r\n\t\t\t\t\tgoogleMap.context.__SECRET_MAP_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.setZoom(15);\r\n\t\t}\r\n\t\t\t\r\n\t\t\t\r\n\t\t\r\n\t};\r\n\r\n\thandleToggleContextRender = (context, renderContext) => {\r\n\t\tconst { definations, cache, apiCallRequest, app } = this.props;\r\n\t\tthis.setState((prevState)=>{\r\n\t\t\tlet renderedContextIndex = prevState.rendered_contexts.indexOf(context);\r\n\t\t\treturn {\r\n\t\t\t\trendered_contexts: prevState.rendered_contexts.includes(context)? prevState.rendered_contexts.removeAtIndex(renderedContextIndex) : prevState.rendered_contexts.concat([context]),\r\n\t\t\t}\r\n\t\t}, async ()=>{\r\n\t\t\tif (definations[context] && renderContext) {\r\n\t\t\t\t\r\n\t\t\t\tapiCallRequest( definations[context].name, {\r\n\t\t\t\t\turi: definations[context].endpoint,\r\n\t\t\t\t\ttype: \"records\",\r\n\t\t\t\t\tparams: JSON.isJSON(this.state.contexts_props[context])? this.state.contexts_props[context].query : {page: 1, pagination: app.preferences.data.pagination, populate: 1},\r\n\t\t\t\t\tdata: {},\r\n\t\t\t\t\tcache: true,\r\n\t\t\t\t}).then(data => {\r\n\t\t\t\t\tif (definations[context] && Function.isFunction( definations[context].views.listing.googlemapview.resolveData ) && Array.isArray(data)) {\r\n\t\t\t\t\t\tdefinations[context].views.listing.googlemapview.resolveData(data, true).then(resolve => {\r\n\t\t\t\t\t\t\tif (this.isMounted()) {\r\n\t\t\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\t\t\tcontext_entry_type : definations[context].views.listing.googlemapview.type,\r\n\t\t\t\t\t\t\t\t\tcontext_entry: data.length> 0? 0 : undefined,\r\n\t\t\t\t\t\t\t\t\tcontexts_props: {\r\n\t\t\t\t\t\t\t\t\t...prevState.contexts_props, \r\n\t\t\t\t\t\t\t\t\t\t[context]: { \r\n\t\t\t\t\t\t\t\t\t\t\t...prevState.contexts_props[context], \r\n\t\t\t\t\t\t\t\t\t\t\telements: resolve,\r\n\t\t\t\t\t\t\t\t\t\t\telement: definations[context].views.listing.googlemapview.type,\r\n\t\t\t\t\t\t\t\t\t\t\tloaded: true,\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tthis.state.context_entry_type = definations[context].views.listing.googlemapview.type;\r\n\t\t\t\t\t\t\t\tthis.state.context_entry = data.length> 0? 0 : undefined;\r\n\t\t\t\t\t\t\t\tthis.state.contexts_props = {\r\n\t\t\t\t\t\t\t\t\t...this.state.contexts_props, \r\n\t\t\t\t\t\t\t\t\t\t[context]: { \r\n\t\t\t\t\t\t\t\t\t\t\t...this.state.contexts_props[context], \r\n\t\t\t\t\t\t\t\t\t\t\telements: resolve,\r\n\t\t\t\t\t\t\t\t\t\t\telement: definations[context].views.listing.googlemapview.type,\r\n\t\t\t\t\t\t\t\t\t\t\tloaded: true,\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t}).catch(e => {\r\n\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse if (definations[context]) {\r\n\t\t\t\tif (this.isMounted()) {\r\n\t\t\t\t\t\t\t\tthis.setState(prevState => ({ \r\n\t\t\t\t\t\t\t\t\tcontext_entry_type : undefined,\r\n\t\t\t\t\t\t\t\t\tcontext_entry: undefined,\r\n\t\t\t\t\t\t\t\t\tcontexts_props: {\r\n\t\t\t\t\t\t\t\t\t...prevState.contexts_props, \r\n\t\t\t\t\t\t\t\t\t\t[context]: { \r\n\t\t\t\t\t\t\t\t\t\t\t...prevState.contexts_props[context], \r\n\t\t\t\t\t\t\t\t\t\t\telements: [],\r\n\t\t\t\t\t\t\t\t\t\t\telement: definations[context].views.listing.googlemapview.type,\r\n\t\t\t\t\t\t\t\t\t\t\tloaded: false,\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tthis.state.context_entry_type = undefined;\r\n\t\t\t\t\t\t\t\tthis.state.context_entry = undefined;\r\n\t\t\t\t\t\t\t\tthis.state.contexts_props = {\r\n\t\t\t\t\t\t\t\t\t...this.state.contexts_props, \r\n\t\t\t\t\t\t\t\t\t\t[context]: { \r\n\t\t\t\t\t\t\t\t\t\t\t...this.state.contexts_props[context], \r\n\t\t\t\t\t\t\t\t\t\t\telements: [],\r\n\t\t\t\t\t\t\t\t\t\t\telement: definations[context].views.listing.googlemapview.type,\r\n\t\t\t\t\t\t\t\t\t\t\tloaded: false,\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t});\r\n\t\t\t\t\t\t\r\n\t\t\t\r\n\t\t\r\n\t};\r\n\r\n\thandleContextEntryClick = (entry, index) => {\r\n\t\t//console.log(\"handleContextEntryClick index\", index);\r\n\r\n\t\tthis.setState({ context_entry: index });\r\n\t\t/*if (googleMap) {\r\n\t\t\tif (this.state.context === \"commissions\") {\r\n\t\t\t\tgoogleMap.panTo(entry.focus_center);\r\n\t\t\t}\r\n\t\t\tif (this.state.context === \"tracks\") {\r\n\t\t\t\tif (entry.positions) {\r\n\t\t\t\t\tif (Array.isArray(entry.positions)) {\r\n\t\t\t\t\t\tif (JSON.isJSON(entry.positions[0])) {\r\n\t\t\t\t\t\t\tgoogleMap.panTo({ lat: entry.positions[0].latitude, lng: entry.positions[0].longitude });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\t\t\t\t\r\n\t\t\t}\t\t\t\t\r\n\t\t}*/\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { theme, classes, showAll, device, sockets, definations, services, contexts, actions } = this.props;\r\n\t\tconst { context, clients_positions, show_client_positions, rendered_contexts, contexts_props } = this.state;\r\n\t\tlet circles = [];\r\n\t\tlet markers = [];\r\n\t\tlet polylines = [];\r\n\t\t//console.log(\"rendered_contexts\", rendered_contexts);\r\n\t\trendered_contexts.map(rendered_context => {\r\n\t\t\tif (definations[rendered_context] && rendered_context in contexts_props ) {\r\n\r\n\t\t\t\tif (contexts_props[rendered_context].element === \"marker\" && Array.isArray(contexts_props[rendered_context].elements)) {\r\n\t\t\t\t\tmarkers = markers.concat(contexts_props[rendered_context].elements);\r\n\t\t\t\t}\r\n\t\t\t\telse if (contexts_props[rendered_context].element === \"circle\" && Array.isArray(contexts_props[rendered_context].elements)) {\r\n\t\t\t\t\tcircles = circles.concat(contexts_props[rendered_context].elements);\r\n\t\t\t\t}\r\n\t\t\t\telse if (contexts_props[rendered_context].element === \"polyline\" && Array.isArray(contexts_props[rendered_context].elements)) {\r\n\t\t\t\t\tpolylines = polylines.concat(contexts_props[rendered_context].elements);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t//console.log(\"circles\", circles);\r\n\t\t\r\n\r\n\t\treturn (\r\n\t\t\t<Card elevation={0} outlineColor={theme.palette.text.primary} style={{backgroundColor: theme.palette.background.paper }}  ref={this.elementRef}>\r\n\t\t\t\t<CardHeader\r\n\t\t\t\t\tavatar={\r\n\t\t\t\t\t\t<Avatar style={{backgroundColor: \"rgba(0,0,0,0.05)\", color:theme.palette.text.primary}}>\r\n\t\t\t\t\t\t\t<MapOutlinedIcon />\r\n\t\t\t\t\t\t</Avatar>\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttitle={this.props.context? (definations[this.props.context]? (definations[this.props.context].label+\" Map\"): \"Map\") : \"Map Overview\"}\r\n\t\t\t\t\tsubheader=\"Click on any context marker, route or polyline in the map for more infomation on the context \"\r\n\t\t\t\t\taction={\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t{/*<IconButton\r\n\t\t\t\t\t\t\t\taria-label=\"Clients Locations Button\"\r\n\t\t\t\t\t\t\t\tclassName={\"mx-1 inverse-text translucent \"}\r\n\t\t\t\t\t\t\t\tonClick={this.handleOnToggleShowClients}\r\n\t\t\t\t\t\t\t\tstyle={{backgroundColor: \"rgba(0,0,0,0.05)\"}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<Icon \r\n\t\t\t\t\t\t\t\t\tpath={show_client_positions? mdiMapMarkerMultiple : mdiMapMarkerMultipleOutline}\r\n\t\t\t\t\t\t\t\t\ttitle=\"Clients Locations\"\r\n\t\t\t\t\t\t\t\t\tsize={0.8}   \r\n\t\t\t\t\t\t\t\t\tcolor={theme.palette.text.primary}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</IconButton>*/}\r\n\r\n\t\t\t\t\t\t\t{Array.isArray(actions) && actions.map(({onClick, icon, ...rest}, cursor)=> (\r\n\t\t\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\t\t\taria-label=\"Action\"\r\n\t\t\t\t\t\t\t\t\tclassName={\"mx-1 inverse-text translucent \"}\r\n\t\t\t\t\t\t\t\t\tonClick={onClick}\r\n\t\t\t\t\t\t\t\t\tstyle={{backgroundColor: \"rgba(0,0,0,0.05)\"}}\r\n\t\t\t\t\t\t\t\t\tkey={\"action-button-\"+cursor}\r\n\t\t\t\t\t\t\t\t\t{...rest}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{icon}\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t))}\r\n\r\n\t\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\t\taria-label=\"menu\"\r\n\t\t\t\t\t\t\t\tcolor={\"inherit\"}\r\n\t\t\t\t\t\t\t\tclassName={\"mx-1 inverse-text \"}\r\n\t\t\t\t\t\t\t\tonClick={this.toggleDrawer(!this.state.drawerOpen)}\r\n\t\t\t\t\t\t\t\tstyle={{backgroundColor: \"rgba(0,0,0,0.05)\"}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<Icon \r\n\t\t\t\t\t\t\t\t\tpath={mdiForwardburger}\r\n\t\t\t\t\t\t\t\t\ttitle=\"Map Overview Drawer Menu\"\r\n\t\t\t\t\t\t\t\t\trotate={this.state.drawerOpen? 0 : 180}\t    \r\n\t\t\t\t\t\t\t\t\tsize={0.8}\r\n\t\t\t\t\t\t\t\t\tcolor={theme.palette.text.primary}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t/>\r\n\t\t\t\t<CardContent className=\"p-0 m-0 overflow-x-hidden\">\r\n\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\r\n\t\t\t\t\t\t<GridItem xs={12} className={classes.wrapper}>\r\n\t\t\t\t\t\t\t<div className={classNames(classes.content, { [classes.contentDrawerMargin]: device.window_size.width >= 1280,  [classes.contentShift]: this.state.drawerOpen && device.window_size.width >= 1280})} style={{minHeight: device.window_size.height, backgroundColor: theme.palette.background.paper }}>\r\n\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t<GoogleMap\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tmapHeight={device.window_size.height}\r\n\t\t\t\t\t\t\t\t\tshowClientsPositions={rendered_contexts.includes(\"clients_positions\")}\r\n\t\t\t\t\t\t\t\t\tshowCurrentPosition={true}\r\n\t\t\t\t\t\t\t\t\tonLoadClientsPositions={this.handleOnClientsPositionsLoaded}\r\n\t\t\t\t\t\t\t\t\tonClientPositionAvailable={this.handleOnClientPositionAvailable}\r\n\t\t\t\t\t\t\t\t\tonClientPositionUnavailable={this.handleOnClientPositionUnavailable}\r\n\t\t\t\t\t\t\t\t\tonClientPositionChanged={this.handleOnClientPositionChanged}\r\n\t\t\t\t\t\t\t\t\tselectedEntry={this.state.context_entry} \r\n\t\t\t\t\t\t\t\t\tselectedEntryType={this.state.context_entry_type? this.state.context_entry_type : \"clients_position\"}\r\n\t\t\t\t\t\t\t\t\tdefaultZoom={this.state.defaultZoom}\r\n\t\t\t\t\t\t\t\t\tzoom={this.state.zoom}\r\n\t\t\t\t\t\t\t\t\tonMapLoad={this.handleOnLoadMap}\r\n\t\t\t\t\t\t\t\t\tpolylines={polylines}\r\n\t\t\t\t\t\t\t\t\tmarkers={markers}\r\n\t\t\t\t\t\t\t\t\tcircles={circles}\t\t\t\t\t\t\t\t\t  \r\n\t\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<SwipeableDrawer\r\n\t\t\t\t\t\t\t\tclassName={classes.drawer}\r\n\t\t\t\t\t\t\t\tvariant={device.window_size.width >= 1280? \"persistent\" : \"temporary\" }\r\n\t\t\t\t\t\t\t\tanchor=\"right\"\r\n\t\t\t\t\t\t\t\topen={this.state.drawerOpen}\r\n\t\t\t\t\t\t\t\tonClose={this.toggleDrawer(false)}\r\n            \t\t\t\t\tonOpen={this.toggleDrawer(true)}\r\n\t\t\t\t\t\t\t\tclasses={{\r\n\t\t\t\t\t\t\t\t\tpaper: device.window_size.width >= 1280? classes.drawerPaper : classes.temporaryDrawerPaper,\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{this.state.multicontexts && <BottomNavigation\r\n\t\t\t\t\t\t\t\t\tvalue={context}\r\n\t\t\t\t\t\t\t\t\tonChange={this.handleOnDrawerNavigationValueChange}\r\n\t\t\t\t\t\t\t\t\tshowLabels\r\n\t\t\t\t\t\t\t\t\tclassName={\"w-full\"}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<BottomNavigationAction \r\n\t\t\t\t\t\t\t\t\t\tvalue=\"clients_positions\"\r\n\t\t\t\t\t\t\t\t\t\tlabel=\"Users\" \r\n\t\t\t\t\t\t\t\t\t\ticon={\r\n\t\t\t\t\t\t\t\t\t\t\t<Icon \r\n\t\t\t\t\t\t\t\t\t\t\t\tpath={mdiAccountCircleOutline}\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"Clients Postions Users\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tsize={1}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t{Object.entries(this.state.definations).map(([name, defination], index) => (\r\n\t\t\t\t\t\t\t\t\t\t<BottomNavigationAction \r\n\t\t\t\t\t\t\t\t\t\t\tvalue={name}\r\n\t\t\t\t\t\t\t\t\t\t\tlabel={defination.label} \r\n\t\t\t\t\t\t\t\t\t\t\ticon={defination.icon} \r\n\t\t\t\t\t\t\t\t\t\t\tkey={\"googlemapview-btn-\"+name+\"-option\"}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t</BottomNavigation>}\r\n\r\n\t\t\t\t\t\t\t\t{(context === \"clients_positions\" && Object.size(clients_positions) === 0) && <GridContainer>\r\n\t\t\t\t\t\t\t\t\t<GridItem xs={12} className=\"flex items-center justify-center p-2\">\r\n\t\t\t\t\t\t\t\t\t\t<Icon \r\n\t\t\t\t\t\t\t\t\t\t\tpath={mdiFolderOutline}\r\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"No Records available yet.\"\r\n\t\t\t\t\t\t\t\t\t\t\tcolor=\"#CCCCCC\"\r\n\t\t\t\t\t\t\t\t\t\t\tsize={5}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</GridItem>\r\n\r\n\t\t\t\t\t\t\t\t\t<GridItem xs={12} className=\"flex items-center justify-center p-2\">\r\n\t\t\t\t\t\t\t\t\t\t<Typography>\r\n\t\t\t\t\t\t\t\t\t\tNo Records available yet.\r\n\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t\t\t</GridContainer>}\r\n\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t{context === \"clients_positions\" && <List className={classes.root}>\r\n\t\t\t\t\t\t\t\t\t\t{Object.entries(clients_positions).map(([socketId, client], index) => {\r\n\t\t\t\t\t\t\t\t\t\t\tlet show_entry = true;\r\n\t\t\t\t\t\t\t\t\t\t\tif (index > 0) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (client.user._id === clients_positions[(Object.keys(clients_positions)[(index-1)])].user._id) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshow_entry = false;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\t\t\t/*if (googleMap) {\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tgoogleMap.panTo({ lat: client.position.latitude, lng: client.position.longitude });\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tgoogleMap.context.__SECRET_MAP_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.setZoom(15);\r\n\t\t\t\t\t\t\t\t\t\t\t\t}*/\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tif (client.user && show_entry) {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ListItem className={\"cursor-pointer hover:bg-gray-400\"} onClick={this.handleClientListItemClick(socketId, client)} key={\"client-\"+socketId}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ListItemAvatar>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar src={(String.isString(client.user.gender)? (client.user.gender.trim().toLowerCase()===\"female\"? client_user_female_icon : client_user_male_icon) : client_user_male_icon)} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ListItemAvatar>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ListItemText primary={ client.user.first_name+\" \"+client.user.last_name } secondary={String.isString(client.user.role)? client.user.role.humanize() : \"\"} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t</List>}\r\n\r\n\t\t\t\t\t\t\t\t\t{context === \"commissions\" && <Listings \r\n\t\t\t\t\t\t\t\t\t\tdefination={definations.commissions} \r\n\t\t\t\t\t\t\t\t\t\tservice={services.commissions}\r\n\t\t\t\t\t\t\t\t\t\tquery={{}}\r\n\t\t\t\t\t\t\t\t\t\tshowViewOptions={false}\r\n\t\t\t\t\t\t\t\t\t\tshowAddBtn={false}\r\n\t\t\t\t\t\t\t\t\t\tshowSorter={true}\r\n\t\t\t\t\t\t\t\t\t\tsorterFormLayoutType={\"normal\"}\r\n\t\t\t\t\t\t\t\t\t\tview={\"listview\"}\r\n\t\t\t\t\t\t\t\t\t\tonLoadData={(loadedData, query)=>{\r\n\t\t\t\t\t\t\t\t\t\t\tif (definations[context] && Function.isFunction( definations[context].views.listing.googlemapview.resolveData ) && Array.isArray(loadedData)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tdefinations[context].views.listing.googlemapview.resolveData(loadedData, true).then(resolve => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontexts_props: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prevState.contexts_props,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t[context]: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prevState.contexts_props[context],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tquery: query,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\telements: resolve,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tloaded: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trecords: loadedData,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t}).catch(err => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontexts_props: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prevState.contexts_props,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t[context]: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prevState.contexts_props[context],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\telements: [],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tloaded: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\trecords: loadedData,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\tonClickEntry={this.handleContextEntryClick}\r\n\t\t\t\t\t\t\t\t\t/>}\r\n\r\n\t\t\t\t\t\t\t\t\t{context === \"tracks\" && <Listings \r\n\t\t\t\t\t\t\t\t\t\tdefination={definations.tracks} \r\n\t\t\t\t\t\t\t\t\t\tservice={services.tracks}\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tshowViewOptions={false}\r\n\t\t\t\t\t\t\t\t\t\tshowAddBtn={false}\r\n\t\t\t\t\t\t\t\t\t\tshowSorter={true}\r\n\t\t\t\t\t\t\t\t\t\tshowPagination={true}\r\n\t\t\t\t\t\t\t\t\t\tsorterFormLayoutType={\"normal\"}\r\n\t\t\t\t\t\t\t\t\t\tview={\"listview\"}\r\n\t\t\t\t\t\t\t\t\t\tonLoadData={(loadedData, query)=>{\r\n\t\t\t\t\t\t\t\t\t\t\tif (definations[context] && Function.isFunction( definations[context].views.listing.googlemapview.resolveData ) && Array.isArray(loadedData)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tdefinations[context].views.listing.googlemapview.resolveData(loadedData, true).then(resolve => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontexts_props: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prevState.contexts_props,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t[context]: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prevState.contexts_props[context],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tquery: query,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\telements: resolve,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tloaded: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trecords: loadedData,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t}).catch(err => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontexts_props: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prevState.contexts_props,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t[context]: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prevState.contexts_props[context],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tquery: query,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\telements: [],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tloaded: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\trecords: loadedData,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\tonClickEntry={this.handleContextEntryClick}\r\n\t\t\t\t\t\t\t\t\t/>}\r\n\r\n\t\t\t\t\t\t\t</SwipeableDrawer>\r\n\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t</GridContainer>\r\n\t\t\t\t</CardContent>\r\n\t\t\t\t<CardActions>\r\n\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\r\n\t\t\t\t\t\t{Array.isArray(contexts) && contexts.map((context_entry_name, cursor) => (\r\n\t\t\t\t\t\t\t<GridItem xs={12} md={Math.round((12 / contexts.length))} className={\"flex items-center justify-center\"} key={\"context_entry_switch-\"+cursor}>\r\n\t\t\t\t\t\t\t\t\t<SwitchInput \r\n\t\t\t\t\t\t\t\t\t\tlabel={context_entry_name === \"clients_positions\"? \"Users\" : (definations[context_entry_name]? definations[context_entry_name].label : context_entry_name) }\r\n\t\t\t\t\t\t\t\t\t\tvalue={this.state.rendered_contexts.includes(context_entry_name)}\r\n\t\t\t\t\t\t\t\t\t\tonChange={(new_value)=>{\r\n\t\t\t\t\t\t\t\t\t\t\tthis.handleToggleContextRender(context_entry_name, new_value);\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t<GridItem xs={12}>\r\n\t\t\t\t\t\t\t<Typography variant=\"body2\">\r\n\t\t\t\t\t\t\t\t{this.props.context? (definations[this.props.context]? (definations[this.props.context].label+\" Map from a glance\"): \"Map from a glance\") : \"Map from a glance\"}\r\n\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t</GridContainer>\r\n\t\t\t\t</CardActions>\r\n\t\t\t</Card>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nGoogleMapOverview.propTypes = {\r\n\tclassName: PropTypes.string,\r\n\tclasses: PropTypes.object,\r\n\tcontexts: PropTypes.array,\r\n\tcontext: PropTypes.string.isRequired,\r\n\tactions: PropTypes.array,\r\n};\r\n\r\nGoogleMapOverview.defaultProps = {\r\n\tcontexts: [\"clients_positions\", \"commissions\", \"tracks\"],\r\n\tcontext: \"clients_positions\",\r\n\tactions: [],\r\n};\r\n\r\nconst mapStateToProps = state => ({\r\n\tapp: state.app,\r\n\tauth: state.auth,\r\n\tcache: state.cache,\r\n\tdevice: state.device,\r\n});\r\n\r\nexport default withGlobals(compose(\r\n\twithStyles(styles),\r\n\tconnect(mapStateToProps, {apiCallRequest, closeDialog, openDialog}),\r\n\twithTheme,\r\n\twithErrorHandler\r\n)(GoogleMapOverview));\r\n","/** @format */\n\n\nexport default theme => ({\n\troot: {\n\t\tpadding: \"0\",\n\t},\n\twrapper: {\n\t\tdisplay: 'flex',\n\t\tmargin: 0,\n\t\tpadding: 0,\n\t},\n\tdrawer: {\n\t\twidth: theme.appDrawer.width,\n\t\tflexShrink: 0,\n\t},\n  \tdrawerPaper: {\n\t\twidth: theme.appDrawer.width,\n\t\tposition: \"absolute\",\n\t\tzIndex: theme.zIndex.appBar/2,\n\t\tbackgroundColor: theme.palette.background.paper,\n  \t},\n  \ttemporaryDrawerPaper: {\n\t\twidth: theme.appDrawer.width,\n\t\tbackground: theme.palette.background.default,\n  \t},\n  \tcontent: {\n\t\tflexGrow: 1,\n\t\tpadding: 0,\n\t\ttransition: theme.transitions.create('margin', {\n\t\t\teasing: theme.transitions.easing.sharp,\n\t\t\tduration: theme.transitions.duration.leavingScreen,\n\t\t}),\n\t},\n\n\tcontentDrawerMargin: {\n\t\tmarginRight: -theme.appDrawer.width,\n\t},\n\n\tcontentShift: {\n\t\ttransition: theme.transitions.create('margin', {\n\t\t\teasing: theme.transitions.easing.easeOut,\n\t\t\tduration: theme.transitions.duration.enteringScreen,\n\t\t}),\n\t\tmarginRight: 0,\n\t},\n});\n","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport PropTypes from 'prop-types';\nimport { fade, withStyles } from '@material-ui/core/styles';\nexport var styles = function styles(theme) {\n  return {\n    /* Styles applied to the root element. */\n    root: {\n      display: 'block',\n      // Create a \"on paper\" color with sufficient contrast retaining the color\n      backgroundColor: fade(theme.palette.text.primary, theme.palette.type === 'light' ? 0.11 : 0.13),\n      height: '1.2em'\n    },\n\n    /* Styles applied to the root element if `variant=\"text\"`. */\n    text: {\n      marginTop: 0,\n      marginBottom: 0,\n      height: 'auto',\n      transformOrigin: '0 60%',\n      transform: 'scale(1, 0.60)',\n      borderRadius: theme.shape.borderRadius,\n      '&:empty:before': {\n        content: '\"\\\\00a0\"'\n      }\n    },\n\n    /* Styles applied to the root element if `variant=\"rect\"`. */\n    rect: {},\n\n    /* Styles applied to the root element if `variant=\"circle\"`. */\n    circle: {\n      borderRadius: '50%'\n    },\n\n    /* Styles applied to the root element if `animation=\"pulse\"`. */\n    pulse: {\n      animation: '$pulse 1.5s ease-in-out 0.5s infinite'\n    },\n    '@keyframes pulse': {\n      '0%': {\n        opacity: 1\n      },\n      '50%': {\n        opacity: 0.4\n      },\n      '100%': {\n        opacity: 1\n      }\n    },\n\n    /* Styles applied to the root element if `animation=\"wave\"`. */\n    wave: {\n      position: 'relative',\n      overflow: 'hidden',\n      '&::after': {\n        animation: '$wave 1.6s linear 0.5s infinite',\n        background: \"linear-gradient(90deg, transparent, \".concat(theme.palette.action.hover, \", transparent)\"),\n        content: '\"\"',\n        position: 'absolute',\n        transform: 'translateX(-100%)',\n        // Avoid flash during server-side hydration\n        bottom: 0,\n        left: 0,\n        right: 0,\n        top: 0\n      }\n    },\n    '@keyframes wave': {\n      '0%': {\n        transform: 'translateX(-100%)'\n      },\n      '60%': {\n        // +0.5s of delay between each loop\n        transform: 'translateX(100%)'\n      },\n      '100%': {\n        transform: 'translateX(100%)'\n      }\n    },\n\n    /* Styles applied when the component is passed children. */\n    withChildren: {\n      '& > *': {\n        visibility: 'hidden'\n      }\n    },\n\n    /* Styles applied when the component is passed children and no width. */\n    fitContent: {\n      maxWidth: 'fit-content'\n    },\n\n    /* Styles applied when the component is passed children and no height. */\n    heightAuto: {\n      height: 'auto'\n    }\n  };\n};\nvar Skeleton = /*#__PURE__*/React.forwardRef(function Skeleton(props, ref) {\n  var _props$animation = props.animation,\n      animation = _props$animation === void 0 ? 'pulse' : _props$animation,\n      classes = props.classes,\n      className = props.className,\n      _props$component = props.component,\n      Component = _props$component === void 0 ? 'span' : _props$component,\n      height = props.height,\n      _props$variant = props.variant,\n      variant = _props$variant === void 0 ? 'text' : _props$variant,\n      width = props.width,\n      other = _objectWithoutProperties(props, [\"animation\", \"classes\", \"className\", \"component\", \"height\", \"variant\", \"width\"]);\n\n  var hasChildren = Boolean(other.children);\n  return /*#__PURE__*/React.createElement(Component, _extends({\n    ref: ref,\n    className: clsx(classes.root, classes[variant], className, hasChildren && [classes.withChildren, !width && classes.fitContent, !height && classes.heightAuto], animation !== false && classes[animation])\n  }, other, {\n    style: _extends({\n      width: width,\n      height: height\n    }, other.style)\n  }));\n});\nprocess.env.NODE_ENV !== \"production\" ? Skeleton.propTypes = {\n  /**\n   * The animation.\n   * If `false` the animation effect is disabled.\n   */\n  animation: PropTypes.oneOf(['pulse', 'wave', false]),\n\n  /**\n   * Optional children to infer width and height from.\n   */\n  children: PropTypes.node,\n\n  /**\n   * Override or extend the styles applied to the component.\n   * See [CSS API](#css) below for more details.\n   */\n  classes: PropTypes.object.isRequired,\n\n  /**\n   * @ignore\n   */\n  className: PropTypes.string,\n\n  /**\n   * The component used for the root node.\n   * Either a string to use a HTML element or a component.\n   */\n  component: PropTypes\n  /* @typescript-to-proptypes-ignore */\n  .elementType,\n\n  /**\n   * Height of the skeleton.\n   * Useful when you don't want to adapt the skeleton to a text element but for instance a card.\n   */\n  height: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n\n  /**\n   * The type of content that will be rendered.\n   */\n  variant: PropTypes.oneOf(['text', 'rect', 'circle']),\n\n  /**\n   * Width of the skeleton.\n   * Useful when the skeleton is inside an inline element with no width of its own.\n   */\n  width: PropTypes.oneOfType([PropTypes.number, PropTypes.string])\n} : void 0;\nexport default withStyles(styles, {\n  name: 'MuiSkeleton'\n})(Skeleton);","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z\"\n}), 'ArrowBack');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z\"\n}), 'People');\n\nexports.default = _default;","import React, { useState, useEffect, useRef } from \"react\";\n\nimport PropTypes from \"prop-types\";\n\nfunction ViewPortSensor(props) {\n\n\tlet {\n\t\tclassName,\n\t\tchildren,\n\t\toffset,\n\t\tonViewportVisibilityChange,\n\t\tplaceholder,\n\t\tplaceholderType\n\t} = props;\n\t// Ref for the element that we want to detect whether on screen\n\tconst ref = useRef();\n\t// Call the hook passing in ref and root margin\n\t// In this case it would only be considered onScreen if more ...\n\t// ... than 300px of element is visible.\n\tlet rootMargin = 0 - Number.parseNumber(offset, 0) + \"px\";\n\tconst onScreen = useOnScreen(ref, rootMargin);\n\t// Hook\n\tfunction useOnScreen(\n\t\tref,\n\t\trootMargin = \"0px\",\n\t\tonEnterViewPort,\n\t\tonExitViewPort\n\t) {\n\t\t// State and setter for storing whether element is visible\n\t\tconst [isIntersecting, setIntersecting] = useState(false);\n\n\t\tuseEffect(() => {\n\t\t\tconst observer = new IntersectionObserver(\n\t\t\t\t([entry]) => {\n\t\t\t\t\t// Update our state when observer callback fires\n\t\t\t\t\tsetIntersecting(entry.isIntersecting);\n\t\t\t\t\tif (Function.isFunction(onViewportVisibilityChange)) {\n\t\t\t\t\t\tonViewportVisibilityChange(entry.isIntersecting);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{ rootMargin }\n\t\t\t);\n\t\t\tif (ref.current) {\n\t\t\t\tobserver.observe(ref.current);\n\t\t\t}\n\t\t\treturn () => {\n\t\t\t\tobserver.unobserve(ref.current);\n\t\t\t};\n\t\t}, []); // Empty array ensures that effect is only run on mount and unmount\n\n\t\treturn isIntersecting;\n\t}\n\n\treturn (\n\t\t<div className={className ? className : \"w-full \"} ref={ref}>\n\t\t\t{children}\n\t\t</div>\n\t);\n}\n\nViewPortSensor.propTypes = {\n\tplaceholderType: PropTypes.string,\n\tplaceholder: PropTypes.oneOfType([\n\t\tPropTypes.node,\n\t\tPropTypes.object,\n\t\tPropTypes.array,\n\t\tPropTypes.string\n\t]),\n\tonViewportVisibilityChange: PropTypes.func,\n\toffset: PropTypes.number\n};\nViewPortSensor.defaultProps = {\n\tplaceholderType: \"skeleton\",\n\tplaceholder: {\n\t\tvariant: \"rect\",\n\t\twidth: \"100%\",\n\t\theight: 200,\n\t\tanimation: \"wave\"\n\t},\n\toffset: 0\n};\n\nexport default ViewPortSensor;\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6zm-2 16c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z\"\n}), 'AudiotrackOutlined');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M4 6.47L5.76 10H20v8H4V6.47M22 4h-4l2 4h-3l-2-4h-2l2 4h-3l-2-4H8l2 4H7L5 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4z\"\n}), 'MovieOutlined');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z\"\n}), 'AttachFile');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z\"\n}), 'Person');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(_react.default.Fragment, null, _react.default.createElement(\"path\", {\n  fill: \"none\",\n  d: \"\"\n}), _react.default.createElement(\"path\", {\n  d: \"M20 0H4v2h16V0zM4 24h16v-2H4v2zM20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-8 2.75c1.24 0 2.25 1.01 2.25 2.25s-1.01 2.25-2.25 2.25S9.75 10.24 9.75 9 10.76 6.75 12 6.75zM17 17H7v-1.5c0-1.67 3.33-2.5 5-2.5s5 .83 5 2.5V17z\"\n})), 'Contacts');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM4 12c0-4.42 3.58-8 8-8 1.85 0 3.55.63 4.9 1.69L5.69 16.9C4.63 15.55 4 13.85 4 12zm8 8c-1.85 0-3.55-.63-4.9-1.69L18.31 7.1C19.37 8.45 20 10.15 20 12c0 4.42-3.58 8-8 8z\"\n}), 'Block');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z\"\n}), 'Done');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z\"\n}), 'DoneAll');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z\"\n}), 'Refresh');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z\"\n}), 'ChatBubbleOutline');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M16 9v10H8V9h8m-1.5-6h-5l-1 1H5v2h14V4h-3.5l-1-1zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7z\"\n}), 'DeleteOutlined');\n\nexports.default = _default;","/** @format */\r\n\r\nimport React, {memo, useState, useEffect, useCallback, useRef} from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport classNames from \"classnames\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Badge from \"@material-ui/core/Badge\";\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Button from '@material-ui/core/Button';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\nimport MoreIcon from '@material-ui/icons/MoreVert';\r\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\r\nimport PersonIcon from '@material-ui/icons/Person';\r\nimport PeopleIcon from '@material-ui/icons/People';\r\nimport ContactsIcon from '@material-ui/icons/Contacts';\r\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\r\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\r\nimport SendIcon from '@material-ui/icons/Send';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport MuiAlert from '@material-ui/lab/Alert';\r\n\r\nimport Backdrop from '@material-ui/core/Backdrop';\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\r\nimport SpeedDial from '@material-ui/lab/SpeedDial';\r\nimport SpeedDialIcon from '@material-ui/lab/SpeedDialIcon';\r\nimport SpeedDialAction from '@material-ui/lab/SpeedDialAction';\r\n\r\nimport ChatBubbleOutlineIcon from '@material-ui/icons/ChatBubbleOutline';\r\nimport ForumOutlinedIcon from '@material-ui/icons/ForumOutlined';\r\nimport ForumIcon from '@material-ui/icons/Forum';\r\nimport RefreshIcon from '@material-ui/icons/Refresh';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport AttachFileIcon from '@material-ui/icons/AttachFile';\r\nimport ImageOutlinedIcon from '@material-ui/icons/ImageOutlined';\r\nimport MovieOutlinedIcon from '@material-ui/icons/MovieOutlined';\r\nimport AudiotrackOutlinedIcon from '@material-ui/icons/AudiotrackOutlined';\r\nimport DeleteOutlinedIcon from '@material-ui/icons/DeleteOutlined';\r\nimport BlockIcon from '@material-ui/icons/Block';\r\nimport DoneIcon from '@material-ui/icons/Done';\r\nimport DoneAllIcon from '@material-ui/icons/DoneAll';\r\n\r\nimport List from '@material-ui/core/List';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer';\r\nimport Fab from '@material-ui/core/Fab';\r\nimport Card from \"components/Card\";\r\nimport CardActions from \"components/Card/CardActions\";\r\nimport CardContent from \"components/Card/CardContent\";\r\nimport CardHeader from \"components/Card/CardHeader\";\r\nimport GridContainer from \"components/Grid/GridContainer\";\r\nimport GridItem from \"components/Grid/GridItem\";\r\nimport Skeleton from '@material-ui/lab/Skeleton';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\r\nimport ScrollBars from \"components/ScrollBars\";\r\nimport LazyImage from \"components/LazyImage\";\r\nimport ViewPortSensor from \"components/ViewPortSensor\";\r\nimport Listings from \"views/widgets/Listings\";\r\nimport {\r\n\tFileInput,\r\n\tTextInput,\r\n} from \"components/FormInputs\";\r\n\r\nimport { useGlobals } from \"contexts/Globals\";\r\nimport { app } from \"assets/jss/app-theme.jsx\";\r\nimport { useLocation, useHistory } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport { withTheme } from '@material-ui/core/styles';\r\nimport compose from \"recompose/compose\";\r\nimport { apiCallRequest, setMessagingCache, clearMessagingCache } from \"state/actions\";\r\n\r\nimport { attachments as AttachmentsService } from \"services\";\r\n\r\nimport styles from \"./styles\";\r\n\r\nconst contactsDrawerWidth = 240;\r\n\r\nfunction Alert(props) {\r\n\treturn <MuiAlert elevation={6} variant=\"filled\" {...props} />;\r\n}\r\n\r\n\r\nconst AlwaysScrollToBottom = () => {\r\n\tconst elementRef = useRef();\r\n\tconst { sockets } = useGlobals();\r\n\r\n\tconst scrollIntoView = useCallback(()=> {\r\n\t\tif (elementRef.current) {\r\n\t\t\telementRef.current.scrollIntoView()\r\n\t\t}\r\n\t}, [elementRef.current]);\r\n\t\r\n\tuseEffect(() => {\r\n\t\tsockets.default.on(\"message-sent\", scrollIntoView);\r\n\t\tsockets.default.on(\"new-message\", scrollIntoView);\r\n\t\tscrollIntoView();\r\n\t\treturn () => {\r\n\t\t\tsockets.default.off(\"message-sent\", scrollIntoView);\r\n\t\t\tsockets.default.off(\"new-message\", scrollIntoView);\r\n\t\t}\r\n\t}, []);\r\n\treturn <div ref={elementRef} />;\r\n};\r\n\r\nfunction Chat(props) {\r\n\tconst { classes, className, layout, communication:{ messaging }, activeConversation, auth, device: {window_size}, apiCallRequest, theme, setMessagingCache, clearMessagingCache, ...rest } = props;\r\n\tlet textInputRef = React.createRef();\r\n\tlet messagesWrapperRef = React.createRef();\r\n\tlet location = useLocation();\r\n\tlet history = useHistory();\r\n\r\n\t\r\n\t\r\n\r\n\tconst { definations, services, sockets } = useGlobals();\r\n\tconst { unread_count, unread_ids, conversations, contacts: cacheContacts, drafts, active_conversation, active_conversation_messages } = messaging;\r\n\r\n\tconst [chats, setChats] = useState(Array.isArray(conversations)? conversations : []);\r\n\tconst [activeChat, setActiveChat] = useState(active_conversation);\r\n\tconst [activeChatMessages, setActiveChatMessages] = useState(active_conversation_messages);\r\n\tconst [query, setQuery] = useState({desc: \"created_on\"});\r\n\tconst [contactsQuery, setContactsQuery] = useState({desc: \"created_on\"});\r\n\tconst [loadingConversations, setLoadingConversations] = useState(true);\r\n\tconst [loadingContacts, setLoadingContacts] = useState(true);\r\n\tconst [draft, setDraft] = useState({});\r\n\tconst [individualConversationsRecipients, setIndividualConversationsRecipients] = useState([]);\r\n\tconst [error, setError] = useState(false);\r\n\tconst [contacts, setContacts] = useState([]);\r\n\tconst [contactsDrawerOpen, setContactsDrawerOpen] = useState(false);\r\n\tconst [attachmentDialOpen, setAttachmentDialOpen] = useState(false);\r\n\tconst [contextMenu, setContextMenu] = useState({ mouseX: null, mouseY: null,});\r\n\tconst [loadingActiveChatMessages, setLoadingActiveChatMessages] = useState(false);\r\n\tconst [locationHasWith, setLocationHasWith] = useState(false);\r\n\tconst [firstLoad, setFirstLoad] = useState(true);\r\n\tconst [searchKeyword, setSearchKeyword] = useState(false);\r\n\r\n\t\r\n\r\n\r\n\tconst attachmentActions = [\r\n\t\t{ icon: <ImageOutlinedIcon />, name: 'image', label: 'Image', color: theme.palette.error.main },\r\n\t\t{ icon: <AudiotrackOutlinedIcon />, name: 'audio', label: 'Audio', color: theme.palette.accent.main },\t\t\t\r\n\t\t{ icon: <MovieOutlinedIcon />, name: 'video', label: 'Video', color: theme.palette.warning.main },\r\n\t\t{ icon: <AttachFileIcon />, name: 'file', label: 'File', color: theme.palette.info.main },\t\t\r\n\t];\r\n\t\r\n\r\n\tconst gotoLastMessage = () => {\r\n\t   let element = document.getElementById(\"chatLastChild\");\r\n\t   if (element) {\r\n\r\n\t\t\t//element.scrollIntoView({behavior: \"smooth\"});\r\n\t   }\r\n\t   \r\n\t}\r\n\r\n\r\n\tconst loadConversations = () => {\r\n\t\tif (definations) {\r\n\t\t\tsetLoadingConversations(true);\r\n\t\t\tapiCallRequest( definations.conversations.name,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\turi: \"/inbox\",\r\n\t\t\t\t\t\ttype: \"records\",\r\n\t\t\t\t\t\tparams: {...query, p: \"1\"},\r\n\t\t\t\t\t\tdata: {},\r\n\t\t\t\t\t\tcache: false,\r\n\t\t\t\t\t}\r\n\t\t\t).then(data => {\r\n\t\t\t\tif (Array.isArray(data)) {\r\n\t\t\t\t\tsetMessagingCache(\"conversations\", data);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tsetError(false);\r\n\t\t\t\tsetLoadingConversations(false);\t\t\t\t\t\r\n\t\t\t}).catch(e => {\r\n\t\t\t\tconsole.log(\"conversations e\", e);\r\n\t\t\t\tlet errorMsg = e;\r\n\t\t\t\tif (JSON.isJSON(e)) {\r\n\t\t\t\t\tif (\"msg\" in e) {\r\n\t\t\t\t\t\terrorMsg = e.msg;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\terrorMsg = JSON.stringify(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tsetError(errorMsg);\r\n\t\t\t\tsetLoadingConversations(false);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tconst loadContacts = () => {\r\n\t\tif (definations) {\r\n\t\t\tsetLoadingContacts(true);\r\n\t\t\tapiCallRequest( \"contacts\",\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\turi: \"/contacts\",\r\n\t\t\t\t\t\ttype: \"records\",\r\n\t\t\t\t\t\tparams: {p: \"1\"},\r\n\t\t\t\t\t\tdata: {},\r\n\t\t\t\t\t\tcache: false,\r\n\t\t\t\t\t}\r\n\t\t\t).then(data => {\r\n\t\t\t\tif (Array.isArray(data)) {\r\n\t\t\t\t\tsetMessagingCache(\"contacts\", data);\r\n\t\t\t\t\tsetContacts(data);\r\n\t\t\t\t}\r\n\t\t\t\tsetError(false);\r\n\t\t\t\tsetLoadingContacts(false);\t\t\t\t\t\r\n\t\t\t}).catch(e => {\r\n\t\t\t\tconsole.log(\"contacts e\", e);\r\n\t\t\t\tlet errorMsg = e;\r\n\t\t\t\tif (JSON.isJSON(e)) {\r\n\t\t\t\t\tif (\"msg\" in e) {\r\n\t\t\t\t\t\terrorMsg = e.msg;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\terrorMsg = JSON.stringify(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tsetError(errorMsg);\r\n\t\t\t\tsetLoadingContacts(false);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t\r\n\r\n\tconst handleContextOpen = (type, entry) => event => {\r\n\t\tevent.preventDefault();\r\n\t\tsetContextMenu({\r\n\t\t  type : type, \r\n\t\t  entry: entry,\r\n\t\t  mouseX: event.clientX - 2,\r\n\t\t  mouseY: event.clientY - 4,\r\n\t\t});\r\n\t};\r\n\r\n\tconst handleContextClose = () => {\r\n\t\tsetContextMenu({ mouseX: null, mouseY: null,});\r\n\t};\r\n\r\n\tconst handleArchiveConversation = (conversation) => {\r\n\t\tsetMessagingCache(\"conversations\", currentChats => {\r\n\t\t\ttry {\r\n\t\t\t\tlet newChats = JSON.parse(JSON.stringify(currentChats));\r\n\r\n\t\t\t\tnewChats = newChats.filter(chat =>{\r\n\t\t\t\t\tif (conversation) {\r\n\t\t\t\t\t\tif (JSON.isJSON(conversation)) {\r\n\t\t\t\t\t\t\treturn chat._id !== conversation._id;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn chat._id !== conversation;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\t \r\n\t\t\t\t});\r\n\r\n\t\t\t\treturn newChats;\r\n\t\t\t} catch(err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\treturn currentChats;\r\n\t\t\t}\r\n\t\t});\r\n\t\tsockets.default.emit(\"archive-conversation\", {conversation: conversation, user: auth.user});\r\n\r\n\t};\r\n\r\n\tconst handleDeleteConversation = (conversation) => {\r\n\t\tsetMessagingCache(\"conversations\", currentChats => {\r\n\t\t\ttry {\r\n\t\t\t\tlet newChats = JSON.parse(JSON.stringify(currentChats));\r\n\r\n\t\t\t\tnewChats = newChats.filter(chat =>{\r\n\t\t\t\t\tif (conversation) {\r\n\t\t\t\t\t\tif (JSON.isJSON(conversation)) {\r\n\t\t\t\t\t\t\treturn chat._id !== conversation._id;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn chat._id !== conversation;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\t \r\n\t\t\t\t});\r\n\r\n\t\t\t\treturn newChats;\r\n\t\t\t} catch(err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\treturn currentChats;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tsockets.default.emit(\"delete-conversation-for-user\", {conversation: conversation, user: auth.user});\t\r\n\r\n\t};\r\n\r\n\r\n\r\n\tconst handleNewChat = (recipients) => {\r\n\t\tif (recipients) {\r\n\t\t\tlet recipients_ids = [];\r\n\t\t\trecipients = Array.isArray(recipients)? recipients : [recipients];\r\n\r\n\t\t\trecipients.map(recipient => {\r\n\t\t\t\tif (JSON.isJSON(recipient) && \"_id\" in recipient) {\r\n\t\t\t\t\trecipients_ids.push(recipient._id);\r\n\t\t\t\t}\r\n\t\t\t\telse if (!String.isEmpty(recipient)) {\r\n\t\t\t\t\trecipients_ids.push(recipient);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\r\n\t\t\tsetContactsDrawerOpen(false);\r\n\t\t\tlet existsAtIndex = -1;\r\n\t\t\tconversations.map((chat, index) => {\r\n\t\t\t\tif (existsAtIndex === -1 && chat.type === \"individual\") {\r\n\t\t\t\t\tlet owner_id = chat.owner;\r\n\t\t\t\t\tlet recipient_id = chat.recipients[0];\r\n\t\t\t\t\tif (JSON.isJSON(chat.owner) && \"_id\" in chat.owner) {\r\n\t\t\t\t\t\towner_id = chat.owner._id;\r\n\t\t\t\t\t}\r\n\t\t\t\t\towner_id = owner_id;\r\n\t\t\t\t\tif (JSON.isJSON(chat.recipients[0]) && \"_id\" in chat.recipients[0]) {\r\n\t\t\t\t\t\trecipient_id = chat.recipients[0]._id;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\trecipient_id = chat.recipients[0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ((owner_id == auth.user._id && recipients_ids.includes(recipient_id)) || (recipient_id === auth.user._id && recipients_ids.includes(owner_id))) {\r\n\t\t\t\t\t\texistsAtIndex = index;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\r\n\t\t\tif (existsAtIndex !== -1) {\r\n\t\t\t\tlet updatedChats = conversations;\r\n\t\t\t\tlet existingChat = JSON.parse(JSON.stringify(updatedChats[existsAtIndex]));\r\n\t\t\t\tupdatedChats.remove(existsAtIndex);\r\n\t\t\t\tupdatedChats.unshift(existingChat);\r\n\t\t\t\tgetConversationMessages(existingChat);\r\n\t\t\t\tsetMessagingCache(\"conversations\", updatedChats);\r\n\t\t\t\tsetMessagingCache(\"active_conversation_messages\", []);\t\r\n\t\t\t\tsetMessagingCache(\"active_conversation\", existingChat);\t\r\n\r\n\r\n\t\t\t\tsetDraft({\r\n\t\t\t\t\t\tis_reply: false,\r\n\t\t\t\t\t\tsender: auth.user,\r\n\t\t\t\t\t\treply_for: null,\r\n\t\t\t\t\t\ttype: \"text\",\r\n\t\t\t\t\t\tcontent: \"\",\r\n\t\t\t\t\t\tconversation: existingChat._id,\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlet newChat = {\r\n\t\t\t\t\trecipients: recipients_ids,\r\n\t\t\t\t\tparticipants: recipients,\r\n\t\t\t\t\tstate: {\r\n\t\t\t\t\t\t\"total\": 0,\r\n\t\t\t\t\t\t\"unread\": 0,\r\n\t\t\t\t\t\t\"read\": 0,\r\n\t\t\t\t\t\t\"last_message\" : {\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\towner: auth.user._id,\r\n\t\t\t\t\tstarted_by: auth.user,\r\n\t\t\t\t\ttype: Array.isArray(recipients)? (recipients.length > 1? \"group\" : \"individual\") : \"individual\",\r\n\t\t\t\t};\r\n\r\n\t\t\t\tsetMessagingCache(\"active_conversation_messages\", []);\r\n\r\n\t\t\t\tif (sockets.default) {\r\n\t\t\t\t\tsockets.default.emit(\"create-conversation\", newChat);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleRefresh = () => {\r\n\t\tloadConversations();\r\n\t\tloadContacts();\t\r\n\t}\r\n\r\n\tconst handlePresenceChanged = ({user, presence}) => {\t\t\r\n\t\tsetContacts(currentContacts => {\r\n\t\t\ttry {\r\n\t\t\t\tlet newContacts = JSON.parse(JSON.stringify(currentContacts));\r\n\t\t\t\tlet user_id = user;\r\n\t\t\t\tif (JSON.isJSON(user)) {\r\n\t\t\t\t\tuser_id = user._id;\r\n\t\t\t\t}\r\n\t\t\t\tnewContacts.forEach(function(contact) {\r\n\t\t\t\t\tif (user_id === contact._id) {\r\n\t\t\t\t\t\tcontact.presence = presence;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\treturn newContacts;\r\n\t\t\t} catch(err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\treturn currentContacts;\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t});\r\n\t\tsetMessagingCache(\"conversations\", currentChats => {\r\n\t\t\ttry {\r\n\t\t\t\tlet newChats = JSON.parse(JSON.stringify(currentChats));\r\n\t\t\t\tlet user_id = user;\r\n\t\t\t\tif (JSON.isJSON(user)) {\r\n\t\t\t\t\tuser_id = user._id;\r\n\t\t\t\t}\r\n\t\t\t\tnewChats.forEach(function(chat) {\r\n\t\t\t\t\tif (chat.type === \"individual\") {\r\n\t\t\t\t\t\tlet chat_owner_id = chat.owner;\r\n\t\t\t\t\t\tif (JSON.isJSON(chat.owner)) {\r\n\t\t\t\t\t\t\tchat_owner_id = chat.owner._id;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (chat_owner_id === user_id) {\r\n\t\t\t\t\t\t\tif (JSON.isJSON(chat.owner)) {\r\n\t\t\t\t\t\t\t\tchat.owner.presence = presence;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tif (Array.isArray(chat.recipients) && chat.recipients.length > 0) {\r\n\t\t\t\t\t\t\t\tif (JSON.isJSON(chat.recipients[0])) {\r\n\t\t\t\t\t\t\t\t\tchat.recipients[0].presence = presence;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\treturn newChats;\r\n\t\t\t} catch(err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\treturn currentChats;\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t});\r\n\t}\r\n\r\n\tconst handleOnUserStartedTypingMessage = ({conversation, user}) => {\r\n\t\tsetMessagingCache(\"conversations\", currentChats => {\r\n\t\t\ttry {\r\n\t\t\t\tlet newChats = JSON.parse(JSON.stringify(currentChats));\r\n\t\t\t\tlet user_id = user; \r\n\t\t\t\tif (JSON.isJSON(user)) {\r\n\t\t\t\t\tuser_id = user._id;\r\n\t\t\t\t}\r\n\t\t\t\tlet chat_id = conversation;\r\n\t\t\t\tif (JSON.isJSON(conversation)) {\r\n\t\t\t\t\tchat_id = conversation._id;\r\n\t\t\t\t}\r\n\t\t\t\tnewChats.forEach(function(chat) {\r\n\r\n\t\t\t\t\tif (chat._id === chat_id) {\r\n\t\t\t\t\t\tlet typing_users_arr = Array.isArray(chat.typing)? chat.typing : [];\r\n\t\t\t\t\t\tlet exists = false;\r\n\t\t\t\t\t\ttyping_users_arr.map(chat_typing_user => {\r\n\t\t\t\t\t\t\tif (!exists && chat_typing_user._id === user_id) {\r\n\t\t\t\t\t\t\t\texists = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (!exists  && user_id !== auth.user._id) {\r\n\t\t\t\t\t\t\tchat.typing = typing_users_arr.concat([user]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\treturn newChats;\r\n\t\t\t} catch(err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\treturn currentChats;\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t});\r\n\r\n\t\tsetMessagingCache(\"active_conversation\", currentActiveChat => {\r\n\t\t\tif (currentActiveChat) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tlet newCurrentActiveChat = JSON.parse(JSON.stringify(currentActiveChat));\r\n\t\t\t\t\tlet user_id = user; \r\n\t\t\t\t\tif (JSON.isJSON(user)) {\r\n\t\t\t\t\t\tuser_id = user._id;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (Array.isArray(newCurrentActiveChat.typing)) {\r\n\t\t\t\t\t\tlet typing_users_arr = Array.isArray(newCurrentActiveChat.typing)? newCurrentActiveChat.typing : [];\r\n\t\t\t\t\t\tlet exists = false;\r\n\t\t\t\t\t\ttyping_users_arr.map(chat_typing_user => {\r\n\t\t\t\t\t\t\tif (!exists && chat_typing_user._id === user_id) {\r\n\t\t\t\t\t\t\t\texists = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (!exists && user_id !== auth.user._id) {\r\n\t\t\t\t\t\t\tnewCurrentActiveChat.typing = typing_users_arr.concat([user]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (user_id !== auth.user._id) {\r\n\t\t\t\t\t\tnewCurrentActiveChat.typing = [user];\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn newCurrentActiveChat;\r\n\t\t\t\t} catch(err) {\r\n\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t\treturn currentActiveChat;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t});\r\n\t}\r\n\t\r\n\r\n\tconst handleOnUserStoppedTypingMessage = ({conversation, user}) => {\r\n\t\tsetMessagingCache(\"conversations\", currentChats => {\r\n\t\t\ttry {\r\n\t\t\t\tlet newChats = JSON.parse(JSON.stringify(currentChats));\r\n\t\t\t\tlet user_id = user; \r\n\t\t\t\tif (JSON.isJSON(user)) {\r\n\t\t\t\t\tuser_id = user._id;\r\n\t\t\t\t}\r\n\t\t\t\tlet chat_id = conversation;\r\n\t\t\t\tif (JSON.isJSON(conversation)) {\r\n\t\t\t\t\tchat_id = conversation._id;\r\n\t\t\t\t}\r\n\t\t\t\tnewChats.forEach(function(chat) {\r\n\t\t\t\t\tif (chat._id === chat_id) {\r\n\t\t\t\t\t\tlet typing_users_arr = Array.isArray(chat.typing)? chat.typing : [];\r\n\t\t\t\t\t\tchat.typing = typing_users_arr.filter(chat_typing_user => {\r\n\t\t\t\t\t\t\treturn chat_typing_user._id !== user_id\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (!Array.isArray(chat.typing)) {\r\n\t\t\t\t\t\t\tchat.typing = []\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\treturn newChats;\r\n\t\t\t} catch(err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\treturn currentChats;\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t});\r\n\t\tsetMessagingCache(\"active_conversation\", currentActiveChat => {\r\n\t\t\tif (currentActiveChat) {\r\n\t\t\t\tlet user_id = user; \r\n\t\t\t\tif (JSON.isJSON(user)) {\r\n\t\t\t\t\tuser_id = user._id;\r\n\t\t\t\t}\r\n\t\t\t\tlet chat_id = conversation;\r\n\t\t\t\tif (JSON.isJSON(conversation)) {\r\n\t\t\t\t\tchat_id = conversation._id;\r\n\t\t\t\t}\r\n\t\t\t\tif (chat_id === currentActiveChat._id) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tlet newCurrentActiveChat = JSON.parse(JSON.stringify(currentActiveChat));\r\n\r\n\t\t\t\t\t\tlet typing_users_arr = Array.isArray(newCurrentActiveChat.typing)? newCurrentActiveChat.typing : [];\r\n\t\t\t\t\t\tnewCurrentActiveChat.typing = typing_users_arr.filter(chat_typing_user => {\r\n\t\t\t\t\t\t\treturn chat_typing_user._id !== user_id\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (!Array.isArray(newCurrentActiveChat.typing)) {\r\n\t\t\t\t\t\t\tnewCurrentActiveChat.typing = []\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\treturn newCurrentActiveChat;\r\n\t\t\t\t\t} catch(err) {\r\n\t\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t\t\treturn currentActiveChat;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn currentActiveChat;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t\t\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t});\r\n\t}\r\n\r\n\t\r\n\r\n\t\r\n\t\r\n\r\n\r\n\r\n\r\n\t/*const handleOnNewMessage = ({conversation, message, user}) => {\t\r\n\t\tconsole.log(\"handleOnNewMessage\", message)\t\r\n\t\tsetActiveChatMessages(currentChatMessages => {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tlet newChatMessages = JSON.parse(JSON.stringify(currentChatMessages));\r\n\r\n\t\t\t\t\t\t\tnewChatMessages.push(message);\r\n\t\t\t\t\t\t\treturn newChatMessages;\r\n\t\t\t\t\t\t} catch(err) {\r\n\t\t\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t\t\t\treturn currentChatMessages;\r\n\t\t\t\t\t\t}\r\n\t\t});\r\n\t\tsetMessagingCache(\"active_conversation\", currentActiveChat => {\r\n\t\t\tif (currentActiveChat) {\r\n\t\t\t\tlet conversation_id = conversation;\r\n\t\t\t\tif (JSON.isJSON(conversation)) {\r\n\t\t\t\t\tconversation_id = conversation._id;\r\n\t\t\t\t}\r\n\t\t\t\tif (conversation_id === currentActiveChat._id) {\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn currentActiveChat;\r\n\t\t});\t\r\n\t\t\t\t\r\n\t}\r\n\r\n\tconst handleOnMessageSent = ({conversation, message, user}) => {\t\r\n\t\tconsole.log(\"handleOnMessageSent\", message)\t\r\n\t\tsetMessagingCache(\"active_conversation\", currentActiveChat => {\r\n\t\t\tif (currentActiveChat) {\r\n\t\t\t\tlet conversation_id = conversation;\r\n\t\t\t\tif (JSON.isJSON(conversation)) {\r\n\t\t\t\t\tconversation_id = conversation._id;\r\n\t\t\t\t}\r\n\t\t\t\tlet message_id = message;\r\n\t\t\t\tif (JSON.isJSON(message)) {\r\n\t\t\t\t\tmessage_id = message._id;\r\n\t\t\t\t}\r\n\t\t\t\tif (conversation_id === currentActiveChat._id) {\r\n\t\t\t\t\tsetActiveChatMessages(currentChatMessages => {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tlet newChatMessages = JSON.parse(JSON.stringify(currentChatMessages));\r\n\r\n\t\t\t\t\t\t\tnewChatMessages.push(message);\r\n\t\t\t\t\t\t\treturn newChatMessages;\r\n\t\t\t\t\t\t} catch(err) {\r\n\t\t\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t\t\t\treturn currentChatMessages;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn currentActiveChat;\r\n\t\t});\r\n\t\t\r\n\t}*/\r\n\r\n\tconst handleOnChangeDraftType= (type) => {\r\n\t\tsetDraft(currentDraft => {\r\n\t\t\ttry {\r\n\t\t\t\tlet newDraft = JSON.parse(JSON.stringify(currentDraft));\r\n\t\t\t\tnewDraft.type = type;\t\t\t\t\t\r\n\t\t\t\treturn newDraft;\r\n\t\t\t} catch(err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\treturn currentDraft;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tconst handleOnConversationMessages = ({conversation, messages}) => {\r\n\t\tsetLoadingActiveChatMessages(false);\r\n\t\tsetMessagingCache(\"active_conversation_messages\", messages);\r\n\t}\r\n\r\n\tconst handleOnConversationCreated = (conversation) => {\r\n\t\t\r\n\t}\r\n\r\n\t\r\n\r\n\tconst getConversationMessages = (conversation) => {\r\n\t\tif (conversation) {\r\n\t\t\tsetLoadingActiveChatMessages(true);\r\n\t\t\tsetMessagingCache(\"active_conversation_messages\", []);\t\r\n\t\t\tif (sockets.default) {\r\n\t\t\t\tsockets.default.emit(\"get-conversation-messages\", {conversation: conversation._id, user: auth.user});\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tsetLoadingActiveChatMessages(false);\r\n\t\t}\t\t\t\t\r\n\t}\r\n\r\n\tconst handleOnSendMessage = (messageToSend) => {\r\n\t\tif (active_conversation) {\r\n\t\t\tlet newMessage = { ...draft, sender: auth.user, created_on: new Date()};\r\n\t\t\tif (messageToSend) {\t\t\t\r\n\t\t\t\tif (JSON.isJSON(messageToSend)) {\r\n\t\t\t\t\tnewMessage = JSON.merge(messageToSend, newMessage);\r\n\t\t\t\t}\r\n\t\t\t\telse if (String.isString(messageToSend)) {\r\n\t\t\t\t\tnewMessage.content = messageToSend.trim();\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!String.isEmpty(newMessage.content) || ([\"audio\", \"file\", \"video\", \"image\"].includes(newMessage.type) && (Array.isArray(newMessage.attachments)? (newMessage.attachments.length > 0) : false))) {\r\n\t\t\t\t\tsockets.default.emit(\"send-message\", {message: newMessage, conversation: active_conversation, user: auth.user});\r\n\t\t\t\t\tif (textInputRef.current) {\r\n\t\t\t\t\t\ttextInputRef.current.value = \"\";\r\n\t\t\t\t\t\ttextInputRef.current.focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\tsetDraft({\r\n\t\t\t\t\tis_reply: false,\r\n\t\t\t\t\tsender: auth.user,\r\n\t\t\t\t\treply_for: null,\r\n\t\t\t\t\ttype: \"text\",\r\n\t\t\t\t\tcontent: \"\",\r\n\t\t\t\t\tconversation: active_conversation._id,\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleMessageInputKeyDown = (event) => {\r\n\t\tif (event.key === 'Enter') {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tlet newMessageValue = event.target.value;\r\n\t\t\tif (String.isString(newMessageValue)) {\r\n\t\t\t\tnewMessageValue = newMessageValue.trim();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnewMessageValue = \"\";\r\n\t\t\t}\r\n\t\t\tif (!String.isEmpty(newMessageValue)) {\r\n\t\t\t\tsockets.default.emit(\"stopped-typing-message\", {conversation: active_conversation._id, user: auth.user});\r\n\t\t\t\thandleOnSendMessage(newMessageValue);\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleSocketActionError = (error) => {\r\n\t\tsetError(error);\r\n\t}\r\n\r\n\tconst handleOnMessageDeletedForUser = ({ message, user }) => {\r\n\t\tsetMessagingCache(\"active_conversation_messages\", currentActiveChatMessages =>{\r\n\t\t\ttry {\r\n\t\t\t\tlet newActiveChatMessages = JSON.parse(JSON.stringify(currentActiveChatMessages));\r\n\t\t\t\tif (Array.isArray(newActiveChatMessages)) {\r\n\t\t\t\t\tnewActiveChatMessages.forEach(activeChatMessage => {\r\n\t\t\t\t\t\tif (activeChatMessage._id === message._id) {\r\n\t\t\t\t\t\t\tactiveChatMessage.state = message.state;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\treturn newActiveChatMessages;\r\n\t\t\t} catch(err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\treturn currentActiveChatMessages;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tconst handleOnMessageDeletedForAll = ({ message, user }) => {\r\n\t\tsetMessagingCache(\"active_conversation_messages\", currentActiveChatMessages =>{\r\n\t\t\ttry {\r\n\t\t\t\tlet newActiveChatMessages = JSON.parse(JSON.stringify(currentActiveChatMessages));\r\n\t\t\t\tif (Array.isArray(newActiveChatMessages)) {\r\n\t\t\t\t\tnewActiveChatMessages.forEach(activeChatMessage => {\r\n\t\t\t\t\t\tif (activeChatMessage._id === message._id) {\r\n\t\t\t\t\t\t\tactiveChatMessage.state = message.state;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\treturn newActiveChatMessages;\r\n\t\t\t} catch(err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\treturn currentActiveChatMessages;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tconst handleOnMessageStateChangedBySocketAction = ({ message, user }) => {\r\n\t\tsetMessagingCache(\"active_conversation_messages\", currentActiveChatMessages =>{\r\n\t\t\ttry {\r\n\t\t\t\tlet newActiveChatMessages = JSON.parse(JSON.stringify(currentActiveChatMessages));\r\n\t\t\t\tif (Array.isArray(newActiveChatMessages)) {\r\n\t\t\t\t\tnewActiveChatMessages.forEach(activeChatMessage => {\r\n\t\t\t\t\t\tif (activeChatMessage._id === message._id) {\r\n\t\t\t\t\t\t\tactiveChatMessage.state = message.state;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t\treturn newActiveChatMessages;\r\n\t\t\t} catch(err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\treturn currentActiveChatMessages;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\r\n\r\n\tuseEffect(() => {\r\n\t\tsetChats(conversations);\r\n\t}, [conversations]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (active_conversation && firstLoad) {\r\n\t\t\tgetConversationMessages(active_conversation);\r\n\t\t\tsetFirstLoad(false);\t\t\t\r\n\t\t}\r\n\r\n\t\t\t\r\n\t}, [active_conversation, firstLoad]);\r\n\r\n\t/*useEffect(() => {\r\n\r\n\t\treturn () => {\r\n\t\t\tif (!activeChat) {\r\n\t\t\t\tsetMessagingCache(\"active_conversation\", false);\t\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tlet newActiveChat = JSON.parse(JSON.stringify(activeChat));\r\n\t\t\t\t\tnewActiveChat.typing = [];\r\n\t\t\t\t\tsetMessagingCache(\"active_conversation\", newActiveChat);\r\n\t\t\t\t} catch(err) {\r\n\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t}, [activeChat]);*/\r\n\r\n\r\n\tuseEffect(()=>{\r\n\t\tif (location && !locationHasWith) {\r\n\t\t\tlet params = new URLSearchParams(location.search);\r\n\t\t\tconst withRecipient = params.get('with');\r\n\t\t\tconsole.log(\"location withRecipient\", withRecipient);\t\r\n\t\t\tif (!String.isEmpty(withRecipient)) {\r\n\t\t\t\tif (withRecipient.indexOf(\"@\") !== -1) {\r\n\t\t\t\t\tsetContactsQuery({email_address: withRecipient.trim()});\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tsetContactsQuery({_id: withRecipient.trim()});\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t\tsetLocationHasWith(true);\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t}, [location, locationHasWith]);\r\n\r\n\tuseEffect(() => {\t\t\t\r\n\t\tconsole.log(\"contactsQuery\", contactsQuery);\r\n\t}, [contactsQuery]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (Array.isArray(conversations)) {\r\n\t\t\tlet newIndividualConversationsRecipients = [];\r\n\t\t\tconversations.map(chat => {\r\n\t\t\t\tif (chat.type === \"individual\") {\r\n\t\t\t\t\tlet chat_owner_id = chat.owner;\r\n\t\t\t\t\tif (JSON.isJSON(chat.owner)) {\r\n\t\t\t\t\t\tchat_owner_id = chat.owner._id;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (chat_owner_id !== auth.user._id) {\r\n\t\t\t\t\t\tnewIndividualConversationsRecipients.push(chat_owner_id);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif (Array.isArray(chat.recipients) && chat.recipients.length > 0) {\r\n\t\t\t\t\t\t\tif (JSON.isJSON(chat.recipients[0])) {\r\n\t\t\t\t\t\t\t\tnewIndividualConversationsRecipients.push(chat.recipients[0]._id);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tnewIndividualConversationsRecipients.push(chat.recipients[0]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tsetIndividualConversationsRecipients(newIndividualConversationsRecipients);\r\n\t\t}\t\t\t\r\n\t}, [conversations]);\r\n\r\n\tuseEffect(() => {\r\n\t\t//loadContacts();\r\n\t\tloadConversations();\r\n\t}, [definations, query]);\r\n\r\n\r\n\r\n\tuseEffect(() => {\r\n\t\tif (sockets.default) {\r\n\t\t\tsockets.default.on(\"presence-changed\", handlePresenceChanged);\r\n\t\t\tsockets.default.on(\"user-changed-presence\", handlePresenceChanged);\r\n\t\t\tsockets.default.on(\"message-typing-started\", handleOnUserStartedTypingMessage);\r\n\t\t\tsockets.default.on(\"message-typing-stopped\", handleOnUserStoppedTypingMessage);\r\n\t\t\tsockets.default.on(\"conversation-messages\", handleOnConversationMessages);\r\n\t\t\t/*sockets.default.on(\"new-message\", handleOnNewMessage);\r\n\t\t\tsockets.default.on(\"message-sent\", handleOnMessageSent);*/\r\n\t\t\tsockets.default.on(\"messages-deleted-for-user\", handleOnMessageDeletedForUser);\r\n\t\t\tsockets.default.on(\"messages-deleted-for-all\", handleOnMessageDeletedForAll);\r\n\t\t\tsockets.default.on(\"message-marked-as-received\", handleOnMessageStateChangedBySocketAction);\r\n\t\t\tsockets.default.on(\"message-received\", handleOnMessageStateChangedBySocketAction);\r\n\t\t\tsockets.default.on(\"message-marked-as-read\", handleOnMessageStateChangedBySocketAction);\r\n\t\t\tsockets.default.on(\"message-read\", handleOnMessageStateChangedBySocketAction);\r\n\t\t\tsockets.default.on(\"delete-conversation-for-user-error\", handleSocketActionError);\r\n\t\t\tsockets.default.on(\"delete-message-for-user-error\", handleSocketActionError);\r\n\t\t\tsockets.default.on(\"delete-message-for-all-error\", handleSocketActionError);\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\r\n\t\t\treturn ()=>{\r\n\t\t\t\tsockets.default.off(\"presence-changed\", handlePresenceChanged);\r\n\t\t\t\tsockets.default.off(\"user-changed-presence\", handlePresenceChanged);\r\n\t\t\t\tsockets.default.off(\"message-typing-started\", handleOnUserStartedTypingMessage);\r\n\t\t\t\tsockets.default.off(\"message-typing-stopped\", handleOnUserStoppedTypingMessage);\r\n\t\t\t\tsockets.default.off(\"conversation-messages\", handleOnConversationMessages);\r\n\t\t\t\t/*sockets.default.off(\"new-message\", handleOnNewMessage);\r\n\t\t\t\tsockets.default.off(\"message-sent\", handleOnMessageSent);*/\r\n\t\t\t\tsockets.default.off(\"messages-deleted-for-user\", handleOnMessageDeletedForUser);\r\n\t\t\t\tsockets.default.off(\"messages-deleted-for-all\", handleOnMessageDeletedForAll);\r\n\t\t\t\tsockets.default.off(\"delete-conversation-for-user-error\", handleSocketActionError);\r\n\t\t\t\tsockets.default.off(\"message-marked-as-received\", handleOnMessageStateChangedBySocketAction);\r\n\t\t\t\tsockets.default.off(\"message-received\", handleOnMessageStateChangedBySocketAction);\r\n\t\t\t\tsockets.default.off(\"message-marked-as-read\", handleOnMessageStateChangedBySocketAction);\r\n\t\t\t\tsockets.default.off(\"message-read\", handleOnMessageStateChangedBySocketAction);\r\n\t\t\t\tsockets.default.off(\"delete-message-for-user-error\", handleSocketActionError);\r\n\t\t\t\tsockets.default.off(\"delete-message-for-all-error\", handleSocketActionError);\r\n\t\t\t\tsockets.default.off(\"create-conversation-error\", handleSocketActionError);\r\n\t\t\t}\r\n\t\t}\r\n\t}, [sockets]);\r\n\r\n\r\n\t\r\n\treturn (\r\n\t\t<Paper className={classNames({\"p-0 m-0 relative\": true, [classes.root] : true, [className]: true})} >\r\n\t\t\t<AppBar position=\"absolute\" color=\"transparent\" className={classes.mainAppBar}>\r\n\t\t\t\t<Toolbar>\r\n\t\t\t\t\t{active_conversation && <IconButton \r\n\t\t\t\t\t\tonClick={()=>{\r\n\t\t\t\t\t\t\tif (history && locationHasWith) {\r\n\t\t\t\t\t\t\t\thistory.push(history.location.pathname);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tsetMessagingCache(\"active_conversation_messages\", []);\r\n\t\t\t\t\t\t\tsetMessagingCache(\"active_conversation\", false);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tclassName={\"mr-2\"}\r\n\t\t\t\t\t\tedge=\"start\" \r\n\t\t\t\t\t\tcolor=\"inherit\" \r\n\t\t\t\t\t\taria-label=\"back-to-conversations\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<ArrowBackIcon />\r\n\t\t\t\t\t</IconButton>}\r\n\t\t\t\t\t{active_conversation && (active_conversation.type == \"individual\"? ((auth.user._id === active_conversation.owner._id || auth.user._id === active_conversation.owner) && active_conversation.participants[0].avatar? (<Avatar className={\"mr-6 w-6 h-6\"} src={AttachmentsService.getAttachmentFileUrl(active_conversation.participants[0].avatar)} />) : (active_conversation.started_by.avatar? (<Avatar className={\"mr-6 w-6 h-6\"} src={AttachmentsService.getAttachmentFileUrl(active_conversation.started_by.avatar)} />) : (<Avatar className={\"mr-2 w-6 h-6 bg-transparent accent-text\"}><PersonIcon /></Avatar>))) : (active_conversation.group_avatar? (<Avatar className={\"mr-6\"} src={AttachmentsService.getAttachmentFileUrl(active_conversation.group_avatar)} />) : (<Avatar className={\"mr-6 w-6 h-6 bg-transparent accent-text\"}> {active_conversation.type === \"group\"? <PeopleIcon /> : <PersonIcon />}</Avatar>)))}\r\n\t\t\t\t\t{active_conversation && <Typography variant=\"h6\" className={\"capitalize flex-grow\"}>\r\n\t\t\t\t\t\t{active_conversation.type == \"individual\"? ((auth.user._id === active_conversation.owner._id || auth.user._id === active_conversation.owner)? (active_conversation.participants[0].first_name +\" \"+active_conversation.participants[0].last_name) : (active_conversation.started_by.first_name +\" \"+active_conversation.started_by.last_name)) : (active_conversation.type == \"group\"? active_conversation.group_name : \"Realfield\")}\r\n\t\t\t\t\t</Typography>}\r\n\r\n\t\t\t\t\t{!active_conversation && <Typography variant=\"h6\" className={\"capitalize flex-grow\"}>\r\n\t\t\t\t\t\tConversations\r\n\t\t\t\t\t</Typography>}\r\n\r\n\r\n\t\t\t\t\t{(!active_conversation && !contactsDrawerOpen) && <IconButton \r\n\t\t\t\t\t\tonClick={()=>setContactsDrawerOpen(true)}\r\n\t\t\t\t\t\tclassName={\"mr-2\"}\r\n\t\t\t\t\t\tedge=\"end\" \r\n\t\t\t\t\t\tcolor=\"inherit\" \r\n\t\t\t\t\t\taria-label=\"Contacts\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<ContactsIcon />\r\n\t\t\t\t\t</IconButton>}\r\n\t\t\t\t</Toolbar>\r\n\t\t\t</AppBar>\r\n\t\t\t<SwipeableDrawer\r\n\t\t\t\tclassName={classNames({[classes.drawer]: true/*, \"hidden\": !contactsDrawerOpen*/})}\r\n\t\t\t\tvariant={window_size.width >= 768? \"persistent\" : \"temporary\" }\r\n\t\t\t\tanchor=\"right\"\r\n\t\t\t\topen={contactsDrawerOpen}\r\n\t\t\t\tonClose={()=>setContactsDrawerOpen(false)}\r\n\t\t\t\tonOpen={()=>setContactsDrawerOpen(true)}\r\n\t\t\t\tclasses={{\r\n\t\t\t\t\tpaper: window_size.width >= 768? classes.drawerPaper : classes.temporaryDrawerPaper,\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<div className={\"w-full flex flex-row items-center h-16 secondary\"}>\r\n\t\t\t\t\t<IconButton className={\"mx-2\"} color=\"inherit\">\r\n\t\t\t\t\t\t<ContactsIcon />\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t<Typography variant=\"h6\" className={\"capitalize flex-grow\"}>\r\n\t\t\t\t\t\tContacts\r\n\t\t\t\t\t</Typography>\r\n\t\t\t\t\t{/*<TextInput\r\n\t\t\t\t\t\t\t\tvariant={\"outlined\"}\r\n\t\t\t\t\t\t\t\tdefaultValue={active_conversation._id === draft.conversation? draft.content : undefined}\r\n\t\t\t\t\t\t\t\tonChange={(new_value)=>{\r\n\t\t\t\t\t\t\t\t\tif (!String.isEmpty(new_value)) {\r\n\t\t\t\t\t\t\t\t\t\tsetSearchKeyword(new_value);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\tsetSearchKeyword(false);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tplaceholder=\"Search...\"\r\n\t\t\t\t\t\t\t\tlabel=\"Search\"\r\n\t\t\t\t\t\t\t/>*/}\r\n\r\n\t\t\t\t\t<IconButton className={\"mx-2\"} color=\"inherit\" onClick={()=>setContactsDrawerOpen(false)}>\r\n\t\t\t\t\t\t{theme.direction === 'ltr' ?  <ChevronRightIcon /> : <ChevronLeftIcon />}\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t</div>\r\n\t\t\t\t<Divider />\r\n\r\n\t\t\t\t<ScrollBars className={classes.bodyWrapper}>\r\n\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t{definations && <Listings\r\n\t\t\t\t\t\t\t\tshow_actions={false}\r\n\t\t\t\t\t\t\t\tshow_links={false}\r\n\t\t\t\t\t\t\t\tshowViewOptions={false}\r\n\t\t\t\t\t\t\t\tshowAddBtn={false}\r\n\t\t\t\t\t\t\t\tcache_data={false}\r\n\t\t\t\t\t\t\t\tshowPagination\r\n\t\t\t\t\t\t\t\tshowSorter\r\n\t\t\t\t\t\t\t\tdefination={definations.users}\r\n\t\t\t\t\t\t\t\tservice={services.users}\r\n\t\t\t\t\t\t\t\tquery={contactsQuery}\r\n\t\t\t\t\t\t\t\tview={\"listview\"}\r\n\t\t\t\t\t\t\t\tonClickEntry={(contact) => handleNewChat(contact)}\r\n\t\t\t\t\t\t\t\tonLoadData={(loadedData, loadedQuery) => {\r\n\t\t\t\t\t\t\t\t\tif (locationHasWith && Array.isArray(loadedData)) {\r\n\t\t\t\t\t\t\t\t\t\tloadedData.map(entry => {\r\n\t\t\t\t\t\t\t\t\t\t\tif (entry._id === loadedQuery._id || entry.email_address === loadedQuery.email_address) {\r\n\t\t\t\t\t\t\t\t\t\t\t\thandleNewChat(entry);\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"onLoadData\", loadedData, loadedQuery);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>}\r\n\r\n\r\n\t\t\t\t</ScrollBars>\r\n\t\t\t</SwipeableDrawer>\r\n\t\t\t{!active_conversation && <GridItem md={12} className={\"flex flex-col relative min-h-full p-0\"}>\t\t\t\t\t\r\n\t\t\t\t\t\t<Paper square className={classes.paper}>\r\n\t\t\t\t\t\t\t<ScrollBars className={classes.bodyWrapper} >\r\n\t\t\t\t\t\t\t{(loadingConversations && (!Array.isArray(conversations) || (Array.isArray(conversations) && conversations.length === 0))) && <GridContainer>\r\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" width={80} className=\"mb-1\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-3/6\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\r\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" width={110} className=\"mb-1\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-8/12\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\r\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" width={80} className=\"mb-1\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-4/12\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\r\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" width={90} className=\"mb-1\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-3/6\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\r\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" width={70} className=\"mb-1\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-10/12\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\r\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" width={80} className=\"mb-1\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-9/12\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\r\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" width={120} className=\"mb-1\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-4/5\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\r\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" width={100} className=\"mb-1\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-3/6\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\r\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" width={80} className=\"mb-1\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-11/12\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t\t</GridContainer>}\r\n\r\n\t\t\t\t\t\t\t{(!loadingConversations && (!Array.isArray(conversations) || (Array.isArray(conversations) && chats.length === 0))) && <GridContainer>\r\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-col items-center relative p-0 px-4 my-4\"}>\r\n\t\t\t\t\t\t\t\t\t<Typography variant=\"subtitle1\" color=\"textSecondary\" className=\"mx-0 my-12 h-20 w-20 md:w-40  md:h-40 rounded-full text-4xl md:text-6xl flex flex-row items-center justify-center\" style={{color: theme.palette.text.disabled, background: theme.palette.background.default}}>\r\n\t\t\t\t\t\t\t\t\t\t<ForumOutlinedIcon fontSize=\"inherit\"/>\r\n\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t<Typography variant=\"body2\" color=\"textSecondary\" className=\"mx-0\" style={{color: theme.palette.text.disabled}}>\r\n\t\t\t\t\t\t\t\t\t\tYou don't have any active conversations yet\r\n\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t\t</GridContainer>}\r\n\r\n\t\t\t\t\t\t\t{(Array.isArray(conversations) && !loadingConversations) && <List className={classes.list}>\r\n\t\t\t\t\t\t\t{conversations.map((chat, index)=> {\r\n\r\n\t\t\t\t\t\t\t\tif (index === 0 || (index > 0 && conversations[index-1]._id !== conversations[index]._id )) {\r\n\t\t\t\t\t\t\t\t\tlet primaryText = \"\";\r\n\t\t\t\t\t\t\t\t\tlet chatUser = false;\r\n\t\t\t\t\t\t\t\t\tlet avatar = false;\r\n\t\t\t\t\t\t\t\t\tlet last_message_content = false;\r\n\t\t\t\t\t\t\t\t\tlet last_message_deleted = false;\r\n\t\t\t\t\t\t\t\t\tlet last_message_sender_name = false;\r\n\t\t\t\t\t\t\t\t\tif (chat.state.total > 0 && chat.state.last_message) {\r\n\t\t\t\t\t\t\t\t\t\tlast_message_content = chat.state.last_message.content;\r\n\t\t\t\t\t\t\t\t\t\tif (chat.state.last_message.sender === auth.user._id) {\r\n\t\t\t\t\t\t\t\t\t\t\tlast_message_sender_name = \"You\";\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse if (chat.owner === chat.state.last_message.sender) {\r\n\t\t\t\t\t\t\t\t\t\t\tlast_message_sender_name = chat.started_by.first_name;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\t\tif (Array.isArray(chat.participants)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tchat.participants.map(participant => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (participant._id === chat.state.last_message.sender) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlast_message_sender_name = participant.first_name;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tif ((chat.state.last_message.state === \"deleted-for-sender\" && (chat.state.last_message.sender._id === auth.user._id || chat.state.last_message.sender === auth.user._id)) || chat.state.last_message.state === \"deleted-for-all\") {\r\n\t\t\t\t\t\t\t\t\t\t\tlast_message_deleted = true;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (chat.type == \"individual\") {\r\n\t\t\t\t\t\t\t\t\t\tlet chat_owner_id = chat.owner;\r\n\t\t\t\t\t\t\t\t\t\tif (JSON.isJSON(chat.owner)) {\r\n\t\t\t\t\t\t\t\t\t\t\tchat_owner_id = chat.owner._id;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tif (auth.user._id === chat_owner_id) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (Array.isArray(chat.participants)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (chat.participants.length > 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tchatUser = chat.participants[0];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tprimaryText = chat.participants[0].first_name +\" \"+chat.participants[0].last_name\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tavatar = chat.participants[0].avatar;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse{\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tchatUser = chat.started_by;\r\n\t\t\t\t\t\t\t\t\t\t\tprimaryText = chat.started_by.first_name +\" \"+chat.started_by.last_name;\r\n\t\t\t\t\t\t\t\t\t\t\tavatar = chat.started_by.avatar;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\t\t\telse if (chat.type == \"group\") {\r\n\t\t\t\t\t\t\t\t\t\tprimaryText = chat.group_name;\r\n\t\t\t\t\t\t\t\t\t\tavatar = chat.group_avatar;\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<ListItem \r\n\t\t\t\t\t\t\t\t\t\t\tclassName={\"px-8 content-between\"} \r\n\t\t\t\t\t\t\t\t\t\t\tonClick={(event)=> {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetMessagingCache(\"active_conversation_messages\", []);\t\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetMessagingCache(\"active_conversation\", chat);\t\r\n\t\t\t\t\t\t\t\t\t\t\t\tgetConversationMessages(chat);\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t}}\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\tonContextMenu={handleContextOpen(\"conversation\", chat)}\r\n\t\t\t\t\t\t\t\t\t\t\tkey={\"chat-\"+index}\r\n\t\t\t\t\t\t\t\t\t\t\tstyle={{background: (contextMenu.type===\"conversation\"? (contextMenu.entry._id===chat._id? theme.palette.background.default : \"transparent\") : \"transparent\")}}\r\n\t\t\t\t\t\t\t\t\t\t\tbutton\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{chatUser && <ListItemAvatar>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Badge \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"dot\" \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbadgeContent=\" \"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tanchorOrigin={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvertical: 'bottom',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thorizontal: 'right',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclasses={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdot: chatUser.presence === \"online\"? \"bg-green-600\" : (chatUser.presence == \"away\"? \"bg-orange-500\" : \"bg-gray-500\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{ chatUser.avatar && <Avatar className={classes.contactAvatar} src={AttachmentsService.getAttachmentFileUrl(chatUser.avatar)} />}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{!chatUser.avatar && <Avatar className={classes.contactAvatar}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<PersonIcon />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Avatar>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Badge>\r\n\t\t\t\t\t\t\t\t\t\t\t</ListItemAvatar>}\r\n\t\t\t\t\t\t\t\t\t\t\t{!chatUser && <ListItemAvatar>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{ avatar && <Avatar src={AttachmentsService.getAttachmentFileUrl(avatar)} />}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{!avatar && <Avatar className={classes.iconAvatar}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{chat.type === \"group\"? <PeopleIcon /> : <PersonIcon />}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Avatar>}\r\n\t\t\t\t\t\t\t\t\t\t\t</ListItemAvatar>}\r\n\t\t\t\t\t\t\t\t\t\t\t<ListItemText \r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex flex-col justify-center\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tprimary={(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography variant=\"body1\" color=\"textPrimary\" className={\"capitalize font-bold\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{primaryText}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)} \r\n\t\t\t\t\t\t\t\t\t\t\t\tsecondary={(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-full flex flex-row\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{Array.isArray(chat.typing) && <Typography variant=\"body2\" color=\"primary\" className=\"mx-0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{chat.typing.length > 1? (chat.typing.length+\" people are typing...\") : (chat.typing.length === 1? (chat.typing[0].first_name+\" is typing...\") : \"\")}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(!Array.isArray(chat.typing) || chat.typing.length ===0) && <div className=\"flex flex-row items-center flex-grow\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography variant=\"body2\" color=\"textPrimary\" className=\"font-bold mr-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{last_message_sender_name? last_message_sender_name: \"\"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography variant=\"body2\" color=\"textSecondary\" className=\"flex-grow truncate mr-2 font-normal\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{last_message_content? last_message_content : \"No messages yet\"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{last_message_deleted && <div className={\"flex flex-row items-center w-full\"} style={{color: theme.palette.divider}}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography variant=\"body1\" color=\"inherit\" className={\"flex-grow\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tMessage deleted\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<BlockIcon className={\"mx-2 text-xs\"} fontSize=\"small\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{!last_message_deleted && <div className={\"flex flex-row items-center w-full\"} style={{color: theme.palette.text.disabled}}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(chat.state.last_message.state === \"sent\" && chat.state.last_message.sender === auth.user._id) && <DoneIcon className={\"mx-1 text-xs\"} fontSize=\"small\"/>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{((chat.state.last_message.state === \"partially-received\" || chat.state.last_message.state === \"received\") && chat.state.last_message.sender === auth.user._id) && <DoneAllIcon className={\"mx-1 text-xs\"} fontSize=\"small\"/>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{((chat.state.last_message.state === \"partially-read\" || chat.state.last_message.state === \"read\") && chat.state.last_message.sender === auth.user._id) && <DoneAllIcon className={\"mx-1 text-xs\"} color={\"secondary\"} fontSize=\"small\"/>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(!Array.isArray(chat.typing) || chat.typing.length ===0) && <Typography variant=\"body2\" color=\"secondary\" className=\"mx-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/*<DoneAllIcon fontSize=\"inherit\" />*/}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t{chat.state.incoming_unread > 0 && <ListItemSecondaryAction>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Avatar className={\"bg-transparent primary-text h-4 w-4 text-xs\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{chat.state.incoming_unread}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Avatar>\r\n\t\t\t\t\t\t\t\t\t\t\t</ListItemSecondaryAction>}\r\n\t\t\t\t\t\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t</List>}\r\n\t\t\t\t\t\t\t</ScrollBars>\r\n\t\t\t\t\t\t</Paper>\r\n\t\t\t\t\t\t<AppBar position=\"absolute\" color=\"secondary\" className={classes.chatsAppBar}>\r\n\t\t\t\t\t\t\t<Toolbar>\r\n\t\t\t\t\t\t\t\t<IconButton \r\n\t\t\t\t\t\t\t\t\tedge=\"start\" \r\n\t\t\t\t\t\t\t\t\tcolor=\"inherit\" \r\n\t\t\t\t\t\t\t\t\taria-label=\"Refresh\"\r\n\t\t\t\t\t\t\t\t\tonClick={handleRefresh}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<RefreshIcon />\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t</IconButton>\r\n\r\n\t\t\t\t\t\t\t\t<Fab \r\n\t\t\t\t\t\t\t\t\tcolor=\"primary\" \r\n\t\t\t\t\t\t\t\t\taria-label=\"add\" \r\n\t\t\t\t\t\t\t\t\tclassName={classes.fabButton}\r\n\t\t\t\t\t\t\t\t\tonClick={()=>setContactsDrawerOpen(!contactsDrawerOpen)}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{!contactsDrawerOpen && <ChatBubbleOutlineIcon />}\r\n\t\t\t\t\t\t\t\t\t{contactsDrawerOpen && <CloseIcon />}\r\n\t\t\t\t\t\t\t\t</Fab>\r\n\r\n\t\t\t\t\t\t\t\t<div className={classes.grow} />\r\n\r\n\t\t\t\t\t\t\t\t{/*<IconButton edge=\"end\" color=\"inherit\">\r\n\t\t\t\t\t\t\t\t\t<MoreIcon />\r\n\t\t\t\t\t\t\t\t</IconButton>*/}\r\n\r\n\t\t\t\t\t\t\t\t{/*<IconButton \r\n\t\t\t\t\t\t\t\t\tcolor=\"inherit\" \r\n\t\t\t\t\t\t\t\t\taria-label=\"Search\"\r\n\t\t\t\t\t\t\t\t\tedge=\"end\"\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<SearchIcon />\r\n\t\t\t\t\t\t\t\t</IconButton>*/}\r\n\t\t\t\t\t\t\t</Toolbar>\r\n\t\t\t\t\t\t</AppBar>\r\n\t\t\t</GridItem>}\r\n\r\n\t\t\t{active_conversation && <Paper square elevation={0} className={classes.chatPaperWrapper}>\r\n\t\t\t\t<GridItem md={12} className=\"h-full p-0 flex flex-col relative\">\r\n\t\t\t\t\t{![\"audio\", \"file\", \"video\", \"image\"].includes(draft.type) && <ScrollBars \r\n\t\t\t\t\t\tclassName={\"flex-grow \"+classes.chatScrollWrapper} \r\n\t\t\t\t\t\tstyle={{flex: 10, backgroundColor: theme.palette.background.default}}\r\n\t\t\t\t\t\tscrollToBottomOnChildChange={false}\r\n\t\t\t\t\t\tref={messagesWrapperRef}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<GridContainer className=\"px-4\">\r\n\t\t\t\t\t\t\t{active_conversation_messages.map((activeChatMessage, cursor) =>{\r\n\t\t\t\t\t\t\t\tlet message_deleted = false;\r\n\t\t\t\t\t\t\t\tlet show_message = true;\r\n\t\t\t\t\t\t\t\tif (cursor > 0) {\r\n\t\t\t\t\t\t\t\t\tif (active_conversation_messages[cursor]._id === active_conversation_messages[(cursor - 1)]._id || (activeChatMessage.conversation._id !== active_conversation._id && activeChatMessage.conversation !== active_conversation._id)) {\r\n\t\t\t\t\t\t\t\t\t\tshow_message = false;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t/*if (cursor === (active_conversation_messages.length - 1)) {\r\n\t\t\t\t\t\t\t\t\tconsole.log(\"activeChatMessage\", activeChatMessage);\r\n\t\t\t\t\t\t\t\t}*/\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif (activeChatMessage && show_message) {\r\n\t\t\t\t\t\t\t\t\tif ((activeChatMessage.state === \"deleted-for-sender\" && activeChatMessage.sender._id === auth.user._id) || activeChatMessage.state === \"deleted-for-all\") {\r\n\t\t\t\t\t\t\t\t\t\tmessage_deleted = true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<GridItem \r\n\t\t\t\t\t\t\t\t\t\t\txs={12} \r\n\t\t\t\t\t\t\t\t\t\t\tclassName={\"flex p-0 py-1 \"+(activeChatMessage.sender._id === auth.user._id || activeChatMessage.sender === auth.user._id? \"flex-row-reverse\" : \"flex-row\")}\r\n\t\t\t\t\t\t\t\t\t\t\tid={\"message-\"+activeChatMessage._id}\r\n\t\t\t\t\t\t\t\t\t\t\tkey={\"conversation-\"+active_conversation._id+\"-message-\"+cursor}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{/* activeChatMessage.sender.avatar && <Avatar className={classes.contactAvatar} src={AttachmentsService.getAttachmentFileUrl(activeChatMessage.sender.avatar)} />}\r\n\t\t\t\t\t\t\t\t\t\t\t{!activeChatMessage.sender.avatar && <Avatar className={classes.contactAvatar}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<PersonIcon />\r\n\t\t\t\t\t\t\t\t\t\t\t</Avatar> */}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<ViewPortSensor  \r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={\"p-2 mx-4  flex flex-col px-4 \"+(activeChatMessage.sender._id === auth.user._id || activeChatMessage.sender === auth.user._id? (\"bg-green-200 \"+classes.chatBubbleLocal) : (\"bg-white \"+classes.chatBubbleExternal))}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonViewportVisibilityChange={(inViewport) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (inViewport && sockets.default) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (activeChatMessage.sender._id !== auth.user._id && activeChatMessage.sender !== auth.user._id) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (activeChatMessage.state === \"sent\") {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsockets.default.emit(\"mark-message-as-received\", {message: activeChatMessage, user: auth.user});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\telse if ((activeChatMessage.state === \"received\" || activeChatMessage.state === \"partially-received\")) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsockets.default.emit(\"mark-message-as-read\", {message: activeChatMessage, user: auth.user});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{!message_deleted && <div className={active_conversation.type !== \"individual\"? \"flex flex-row w-full items-center\" : \"flex flex-row-reverse w-full items-center\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{ (active_conversation.type !== \"individual\" && JSON.isJSON(activeChatMessage.sender)) && <Typography variant=\"body1\" className={\"flex-grow text-gray-500 font-bold\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{activeChatMessage.sender.first_name+\" \"+activeChatMessage.sender.last_name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<IconButton aria-label=\"Toggle Menu\" onClick={handleContextOpen(\"message\", activeChatMessage)} className={\"\"} size=\"small\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ExpandMoreIcon fontSize=\"inherit\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{(!message_deleted && [\"audio\", \"file\", \"video\", \"image\"].includes(activeChatMessage.type) && Array.isArray(activeChatMessage.attachments)) && <div className={\"flex flex-col items-center cursor-pointer mb-2\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{activeChatMessage.attachments.map(attachment => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className={\"p-2 w-11/12 border border-gray-400 rounded\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{activeChatMessage.type === \"image\" && <LazyImage \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={\"w-full h-auto\"} \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={AttachmentsService.getAttachmentFileUrl(attachment)} \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt={attachment.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet win = window.open(AttachmentsService.getAttachmentFileUrl(attachment), \"_blank\");\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twin.focus();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{activeChatMessage.type === \"audio\" && <div \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={\"w-full h-auto flex flex-row items-center\"} \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet win = window.open(AttachmentsService.getAttachmentFileUrl(attachment), \"_blank\");\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twin.focus();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AudiotrackOutlinedIcon className={\"text-2xl\"}/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography variant=\"body1\" color=\"textPrimary\" className={\"flex-grow truncate\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{attachment.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{activeChatMessage.type === \"video\" && <div \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={\"w-full h-auto flex flex-row items-center\"} \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet win = window.open(AttachmentsService.getAttachmentFileUrl(attachment), \"_blank\");\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twin.focus();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<MovieOutlinedIcon className={\"text-2xl\"}/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography variant=\"body1\" color=\"textPrimary\" className={\"flex-grow truncate\"} >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{attachment.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{activeChatMessage.type === \"file\" && <div \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={\"w-full h-auto flex flex-row items-center\"} \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet win = window.open(AttachmentsService.getAttachmentFileUrl(attachment), \"_blank\");\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twin.focus();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AttachFileIcon className={\"text-2xl\"}/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography variant=\"body1\" color=\"textPrimary\" className={\"flex-grow truncate\"} >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{attachment.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{!message_deleted && <Typography variant=\"body1\" color=\"textPrimary\" className={\"flex-grow\"} paragraph>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{activeChatMessage.content}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Typography>}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t{message_deleted && <div className={\"flex flex-row items-center w-full\"} style={{color: theme.palette.divider}}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography variant=\"body1\" color=\"inherit\" className={\"flex-grow\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tMessage deleted\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<BlockIcon className={\"mx-2\"} fontSize=\"small\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t{!message_deleted && <div className={\"flex flex-row items-center w-full\"} style={{color: theme.palette.text.disabled}}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{activeChatMessage.created_on && <Typography variant=\"body2\" className={\"text-xs flex-grow\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{activeChatMessage.created_on instanceof Date? activeChatMessage.created_on.toLocaleString() : new Date(activeChatMessage.created_on).toLocaleString()}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{(activeChatMessage.state === \"sent\" && (activeChatMessage.sender._id === auth.user._id || activeChatMessage.sender === auth.user._id)) && <DoneIcon className={\"mx-2\"} fontSize=\"small\"/>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{((activeChatMessage.state === \"partially-received\" || activeChatMessage.state === \"received\") && (activeChatMessage.sender._id === auth.user._id || activeChatMessage.sender === auth.user._id)) && <DoneAllIcon className={\"mx-2\"} fontSize=\"small\"/>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{((activeChatMessage.state === \"partially-read\" || activeChatMessage.state === \"read\") && (activeChatMessage.sender._id === auth.user._id || activeChatMessage.sender === auth.user._id)) && <DoneAllIcon className={\"mx-2\"} color={\"secondary\"} fontSize=\"small\"/>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t\t\t\t\t\t</ViewPortSensor>\r\n\t\t\t\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t})}\r\n\r\n\t\t\t\t\t\t\t{(Array.isArray(active_conversation.typing)? (active_conversation.typing.length > 0) : false) && <GridItem xs={12} className={\"flex p-0 py-1 flex-row\"} >\r\n\t\t\t\t\t\t\t\t\t<div  className={classes.avatar}> </div>\r\n\t\t\t\t\t\t\t\t\t<div  className={\"p-2 mx-4  flex flex-col px-4  rounded-full\"}>\r\n\t\t\t\t\t\t\t\t\t\t<div  className={classes.typing_loader}></div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</GridItem>}\r\n\t\t\t\t\t\t\t<AlwaysScrollToBottom />\r\n\t\t\t\t\t\t</GridContainer>\r\n\t\t\t\t\t</ScrollBars>}\r\n\r\n\t\t\t\t\t\r\n\r\n\t\t\t\t\t<GridContainer \r\n\t\t\t\t\t\tclassName={[\"audio\", \"file\", \"video\", \"image\"].includes(draft.type)? \"flex-grow flex flex-col\" : classes.chatInputsWrapper} \r\n\t\t\t\t\t\tstyle={{ backgroundColor: theme.palette.background.paper, top: [\"audio\", \"file\", \"video\", \"image\"].includes(draft.type)? 0 : \"auto\"}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{draft.reply_for && <GridItem xs={12} className={\"flex flex-row items-center bg-green-200\"}>\r\n\t\t\t\t\t\t\t<div className={\"p-2 mx-4\"}>\r\n\t\t\t\t\t\t\t\t\t\t<Typography variant=\"body1\" color=\"textPrimary\" className={\"font-bold\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t{draft.reply_for.sender.first_name+\" \"+draft.reply_for.sender.last_name}\r\n\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t<Typography variant=\"body1\" color=\"textPrimary\" className={\"\"} >\r\n\t\t\t\t\t\t\t\t\t\t\t{draft.reply_for.content}\r\n\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</GridItem>}\r\n\r\n\t\t\t\t\t\t{[\"audio\", \"file\", \"video\", \"image\"].includes(draft.type) && <GridItem xs={12} className={\"flex flex-grow flex-row items-center bg-grey-200\"}>\r\n\t\t\t\t\t\t\t<FileInput\r\n\t\t\t\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\t\t\t\tvalue={([\"audio\", \"file\", \"video\", \"image\"].includes(draft.type) && (Array.isArray(draft.attachments)? (draft.attachments > 0) : false))? draft.attachments[0] : undefined}\r\n\t\t\t\t\t\t\t\tonChange={(newValue)=>{\r\n\t\t\t\t\t\t\t\t\tsetDraft(currentDraft => {\r\n\t\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\t\tlet newDraft = JSON.parse(JSON.stringify(currentDraft));\r\n\t\t\t\t\t\t\t\t\t\t\tif (newValue) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tnewDraft.attachments = [newValue];\r\n\t\t\t\t\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\t\t\tdelete newDraft.attachments;\r\n\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\treturn newDraft;\r\n\t\t\t\t\t\t\t\t\t\t} catch(err) {\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t\t\t\t\t\t\t\treturn currentDraft;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\tconsole.log(\"FileInput newValue \", newValue);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tfilesLimit={1}\r\n\t\t\t\t\t\t\t\tacceptedFiles={draft.type === \"file\"? [\"image/*\", \"video/*\", \"audio/*\", \"application/*\"] : [(draft.type+\"/*\")]}\r\n\t\t\t\t\t\t\t/>\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</GridItem>}\r\n\r\n\t\t\t\t\t\t{attachmentDialOpen && <GridItem xs={12} className={\"flex flex-row items-center justify-evenly bg-grey-200\"}>\r\n\t\t\t\t\t\t\t{attachmentActions.map((action) => (\r\n\t\t\t\t\t\t\t\t\t<Fab\r\n\t\t\t\t\t\t\t\t\t\tkey={action.name}\r\n\t\t\t\t\t\t\t\t\t\tcolor={action.color}\r\n\t\t\t\t\t\t\t\t\t\taria-label={\"Attach \"+action.label}\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tonClick={()=>{\r\n\t\t\t\t\t\t\t\t\t\t\tsetAttachmentDialOpen(false);\r\n\t\t\t\t\t\t\t\t\t\t\thandleOnChangeDraftType(action.name);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\tstyle={{background: action.color, color: theme.palette.background.paper}}\r\n\t\t\t\t\t\t\t\t\t\tclassName={\"mx-2\"}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{action.icon}\r\n\t\t\t\t\t\t\t\t\t</Fab>\r\n\t\t\t\t\t\t\t))}\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</GridItem>}\r\n\r\n\t\t\t\t\t\t<GridItem xs={12} className={\"flex flex-row items-center\"}>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<IconButton \r\n\t\t\t\t\t\t\t\tonClick={(event)=>{\r\n\t\t\t\t\t\t\t\t\tsetAttachmentDialOpen(!attachmentDialOpen)\r\n\t\t\t\t\t\t\t\t}} \r\n\t\t\t\t\t\t\t\taria-label={attachmentDialOpen? (([\"audio\", \"file\", \"video\", \"image\"].includes(draft.type) && (Array.isArray(draft.attachments)? (draft.attachments > 0) : false))? \"Remove Attachments\" : \"Dismiss File Attachment\") : \"Close File Attachment\"} \r\n\t\t\t\t\t\t\t\tclassName={\"mx-2\"} \r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{!attachmentDialOpen? <AttachFileIcon color=\"inherit\" /> : (([\"audio\", \"file\", \"video\", \"image\"].includes(draft.type) && (Array.isArray(draft.attachments)? (draft.attachments > 0) : false))? <DeleteOutlinedIcon color=\"inherit\" /> : <CloseIcon  color=\"inherit\" />)}\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t<div className={\"flex-grow rounded-full mx-8\"}>\r\n\t\t\t\t\t\t\t<TextInput\r\n\t\t\t\t\t\t\t\tvariant={[\"audio\", \"file\", \"video\", \"image\"].includes(draft.type)? \"standard\" : \"outlined\"}\r\n\t\t\t\t\t\t\t\tmultiline\r\n\t\t\t\t\t\t\t\trows={2}\r\n\t\t\t\t\t\t\t\tonBlur={(new_value, event)=>{\r\n\t\t\t\t\t\t\t\t\tif (active_conversation._id && !String.isEmpty(new_value)) {\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tsetDraft(currentDraft => {\r\n\t\t\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet newDraft = {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent: new_value,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconversation: active_conversation._id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (JSON.isJSON(currentDraft)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tnewDraft = JSON.parse(JSON.stringify(currentDraft));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tnewDraft.content = new_value;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tnewDraft.conversation = active_conversation._id;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn newDraft;\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t} catch(err) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn currentDraft;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (active_conversation._id && sockets.default) {\r\n\t\t\t\t\t\t\t\t\t\tsockets.default.emit(\"stopped-typing-message\", {conversation: active_conversation._id, user: auth.user});\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tonFocus={()=>{\r\n\t\t\t\t\t\t\t\t\tif (active_conversation._id && sockets.default) {\r\n\t\t\t\t\t\t\t\t\t\tsockets.default.emit(\"started-typing-message\", {conversation: active_conversation._id, user: auth.user});\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tdefaultValue={active_conversation._id === draft.conversation? draft.content : undefined}\r\n\t\t\t\t\t\t\t\tonChange={(new_value)=>{\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tplaceholder=\"Type your message here...\"\r\n\t\t\t\t\t\t\t\tinputRef={textInputRef}\r\n\t\t\t\t\t\t\t\tinputProps={{\r\n\t\t\t\t\t\t\t\t\tonKeyDown: handleMessageInputKeyDown,\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/*<IconButton onClick={(event)=>handleOnSendMessage()} aria-label=\"send\" className={\"primary-text\"} >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<SendIcon color=\"inherit\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</IconButton>*/}\r\n\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t</GridContainer>\r\n\r\n\t\t\t\t</GridItem>\r\n\t\t\t</Paper>}\r\n\r\n\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tkeepMounted\r\n\t\t\t\t\topen={contextMenu.mouseY !== null}\r\n\t\t\t\t\tonClose={handleContextClose}\r\n\t\t\t\t\tanchorReference=\"anchorPosition\"\r\n\t\t\t\t\tanchorPosition={\r\n\t\t\t\t\t  contextMenu.mouseY !== null && contextMenu.mouseX !== null\r\n\t\t\t\t\t\t? { top: contextMenu.mouseY, left: contextMenu.mouseX }\r\n\t\t\t\t\t\t: undefined\r\n\t\t\t\t\t}\r\n\t\t\t\t  >\r\n\t\t\t\t\t{contextMenu.type === \"conversation\" && <MenuItem onClick={(event)=>{\r\n\t\t\t\t\t\tsetMessagingCache(\"active_conversation\", contextMenu.entry);\r\n\t\t\t\t\t\thandleContextClose(event);\r\n\t\t\t\t\t}}>Open Conversation</MenuItem>}\r\n\t\t\t\t\t{contextMenu.type === \"conversation\" && <MenuItem \r\n\t\t\t\t\t\tonClick={(event)=>{\r\n\t\t\t\t\t\t\thandleArchiveConversation(contextMenu.entry);\r\n\t\t\t\t\t\t\thandleContextClose(event);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tArchive Conversation\r\n\t\t\t\t\t</MenuItem>}\r\n\t\t\t\t\t{contextMenu.type === \"conversation\" && <MenuItem \r\n\t\t\t\t\t\tonClick={(event)=>{\r\n\t\t\t\t\t\t\thandleDeleteConversation(contextMenu.entry);\r\n\t\t\t\t\t\t\thandleContextClose(event);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tDelete Conversation\r\n\t\t\t\t\t</MenuItem>}\r\n\r\n\t\t\t\t\t{(contextMenu.type === \"message\" && (contextMenu.entry.sender._id !== auth.user._id && contextMenu.entry.sender !== auth.user._id)) && <MenuItem \r\n\t\t\t\t\t\tonClick={(event)=>{\r\n\t\t\t\t\t\t\thandleContextClose(event);\r\n\t\t\t\t\t\t\tsetDraft({\r\n\t\t\t\t\t\t\t\tis_reply: true,\r\n\t\t\t\t\t\t\t\tsender: auth.user,\r\n\t\t\t\t\t\t\t\treply_for: contextMenu.entry,\r\n\t\t\t\t\t\t\t\tcontent: \"\",\r\n\t\t\t\t\t\t\t\tconversation: active_conversation._id,\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif (textInputRef.current) {\r\n\t\t\t\t\t\t\t\ttextInputRef.current.value = \"\";\r\n\t\t\t\t\t\t\t\ttextInputRef.current.focus();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tReply Message\r\n\t\t\t\t\t</MenuItem>}\r\n\t\t\t\t\t{(contextMenu.type === \"message\" && (contextMenu.entry.sender._id === auth.user._id || contextMenu.entry.sender === auth.user._id)) && <MenuItem \r\n\t\t\t\t\t\tonClick={(event)=>{\r\n\t\t\t\t\t\t\thandleContextClose(event);\r\n\t\t\t\t\t\t\tif (sockets.default) {\r\n\t\t\t\t\t\t\t\tsockets.default.emit(\"delete-message-for-user\", {message: contextMenu.entry, user: auth.user});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tDelete For Me\r\n\t\t\t\t\t</MenuItem>}\r\n\r\n\t\t\t\t\t{(contextMenu.type === \"message\" && (contextMenu.entry.sender._id === auth.user._id || contextMenu.entry.sender === auth.user._id)) && <MenuItem \r\n\t\t\t\t\t\tonClick={(event)=>{\r\n\t\t\t\t\t\t\thandleContextClose(event);\r\n\t\t\t\t\t\t\tif (sockets.default) {\r\n\t\t\t\t\t\t\t\tsockets.default.emit(\"delete-message-for-all\", {message: contextMenu.entry, user: auth.user});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tDelete For All\r\n\t\t\t\t\t</MenuItem>}\r\n\t\t\t\t</Menu>\r\n\r\n\t\t{error && <Snackbar open={Boolean(error)} autoHideDuration={10000} onClose={() => setError(false)}>\r\n\t        <Alert onClose={() => setError(false)} severity=\"error\">\r\n\t\t\t\t{error}\r\n\t        </Alert>\r\n\t\t</Snackbar>}\r\n\r\n\t\t</Paper>\r\n\t);\r\n}\r\n\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n\tauth: state.auth,\r\n\tcommunication: state.communication,\r\n\tdevice: state.device,\r\n});\r\n\r\nChat.defaultProps = {\r\n\tlayout: \"full\",\r\n\tfirstView: \"conversations\",\r\n\tactiveConversation: undefined,\r\n};\r\n\r\nexport default compose(\r\n\twithStyles(styles),\r\n\tconnect(mapStateToProps, {apiCallRequest, setMessagingCache, clearMessagingCache}),\r\n\twithTheme,\r\n)((Chat));\r\n","/** @format */\r\n\r\nexport default theme => ({\r\n\troot: {\r\n\t\tpadding: \"0\",\r\n\t\theight: \"calc(100vh - \"+theme.spacing(12)+\"px)\",\r\n\t\tmaxHeight: \"100vh\",\r\n\t\tdisplay: \"flex\",\r\n\t\tflexDirection: \"column\",\r\n\t\toverflowX: \"hidden\",\r\n\t},\t\r\n\ttext: {\r\n\t\tpadding: theme.spacing(2, 2, 0),\r\n\t},\r\n\tpaper: {\r\n\t\t/*position: \"absolute\",\r\n\t\ttop: theme.spacing(4),\r\n\t\tbottom: 'auto',*/\r\n\t\tpaddingBottom: theme.spacing(7),\r\n\t\tmarginTop: theme.spacing(8),\r\n\t\tflexGrow: 1,\r\n\t\theight: \"calc(100% - \"+theme.spacing(8)+\"px)\",\r\n\t\tminHeight: \"calc(100% - \"+theme.spacing(8)+\"px)\",\r\n\t\toverflowX: \"hidden\",\r\n\t},\r\n\tchatPaperWrapper: {\r\n\t\tposition: \"relative\",\r\n\t\tmarginTop: theme.spacing(8),\r\n\t\tflexGrow: 1,\r\n\t\theight: \"calc(100% - \"+theme.spacing(8)+\"px)\",\r\n\t\tminHeight: \"calc(100% - \"+theme.spacing(8)+\"px)\",\r\n\t\toverflow: \"hidden\",\r\n\t\tpadding: 0,\r\n\t\tbackgroundColor: theme.palette.background.default,\r\n\t\tbackground: theme.palette.background.default,\r\n\t},\r\n\r\n\tbodyWrapper: {\r\n\t\toverflowY: \"scroll\",\r\n\t\toverflowX: \"hidden\",\r\n\t\theight: \"calc(100% - \"+theme.spacing(4)+\"px)\",\r\n\t},\r\n\r\n\tscrollWrapper: {\r\n\t\toverflowY: \"scroll\",\r\n\t\toverflowX: \"hidden\",\r\n\t},\r\n\r\n\tchatScrollWrapper: {\r\n\t\toverflowY: \"scroll\",\r\n\t\toverflowX: \"hidden\",\r\n\t\ttop: 0,\r\n\t\tbottom: 'auto',\r\n\t\theight: \"80% !important\",\r\n\t},\r\n\r\n\tlist: {\r\n\t\tmarginBottom: theme.spacing(2),\r\n\t},\r\n\r\n\tsubheader: {\r\n\t\tbackgroundColor: theme.palette.background.paper,\r\n\t},\r\n\ticonAvatar:{\r\n\t\tbackgroundColor: theme.palette.background.default,\r\n\t\tcolor: theme.palette.accent.main,\r\n\t},\r\n\tcontactAvatar:{\r\n\t\tbackgroundColor: theme.palette.background.paper,\r\n\t\tcolor: theme.palette.accent.main,\r\n\t},\r\n\tavatar:{\r\n\t\tbackgroundColor: theme.palette.action.hover,\r\n\t\tcolor: theme.palette.text.primary,\r\n\t\twidth: theme.spacing(5),\r\n\t\theight: theme.spacing(5),\r\n\t\tborderRadius: theme.spacing(2.5),\r\n\t},\r\n\tchatsAppBar: {\r\n\t\ttop: 'auto',\r\n\t\tbottom: 0,\r\n\t\tcolor: theme.palette.background.paper,\r\n\t},\r\n\tmainAppBar: {\r\n\t\ttop: 0,\r\n\t\tbottom: 'auto',\r\n\t\tcolor: theme.palette.text.primary,\r\n\t\tboxShadow: \"none\",\r\n\t},\r\n\tgrow: {\r\n\t\tflexGrow: 1,\r\n\t},\r\n\tfabButton: {\r\n\t\tposition: 'absolute',\r\n\t\tzIndex: 1,\r\n\t\ttop: -30,\r\n\t\tleft: 0,\r\n\t\tright: 0,\r\n\t\tmargin: '0 auto',\r\n\t\tbackground: theme.palette.accent.main,\r\n\t\tcolor: theme.palette.background.paper,\r\n\t},\r\n\tdrawer: {\r\n\t\twidth: theme.appDrawer.width,\r\n\t\tflexShrink: 0,\r\n\t},\r\n  \tdrawerPaper: {\r\n\t\twidth: theme.appDrawer.width,\r\n\t\tposition: \"absolute\",\r\n\t\tzIndex: theme.zIndex.appBar+2,\r\n\t\tbackgroundColor: theme.palette.background.default,\r\n  \t},\r\n  \ttemporaryDrawerPaper: {\r\n\t\twidth: theme.appDrawer.width,\r\n\t\tbackground: theme.palette.background.default,\r\n  \t},\r\n  \tcontent: {\r\n\t\tflexGrow: 1,\r\n\t\tpadding: 0,\r\n\t\ttransition: theme.transitions.create('margin', {\r\n\t\t\teasing: theme.transitions.easing.sharp,\r\n\t\t\tduration: theme.transitions.duration.leavingScreen,\r\n\t\t}),\r\n\t},\r\n\r\n\tcontentDrawerMargin: {\r\n\t\tmarginRight: -theme.appDrawer.width,\r\n\t},\r\n\r\n\tcontentShift: {\r\n\t\ttransition: theme.transitions.create('margin', {\r\n\t\t\teasing: theme.transitions.easing.easeOut,\r\n\t\t\tduration: theme.transitions.duration.enteringScreen,\r\n\t\t}),\r\n\t\tmarginRight: 0,\r\n\t},\r\n\r\n\tchatInputsWrapper: {\r\n\t\t/*position: \"relative\",\r\n\t\ttop: 'auto',\r\n\t\tbottom: 0,*/\r\n\t\tminHeight: \"20% !important\",\r\n\t\tpadding: 0,\r\n\t\tpaddingTop: theme.spacing(2),\r\n\t\tpaddingBottom: theme.spacing(2),\r\n\t\tbackground: theme.palette.background.paper,\r\n\t\tcolor: theme.palette.text.primary,\r\n\t},\r\n\r\n\tchatBubbleLocal: {\r\n\t\tmaxWidth: \"40%\",\r\n\t\tbackground: theme.palette.primary.light,\r\n\t\tborderBottomRightRadius: \"1.5rem\",\r\n\t\tborderBottomLeftRadius: \"1.5rem\",\r\n\t\tborderTopRightRadius: 0,\r\n\t\tborderTopLeftRadius: \"1.5rem\",\r\n\t},\r\n\r\n\tchatBubbleExternal: {\r\n\t\tbackground: theme.palette.background.paper,\r\n\t\tborderBottomRightRadius: \"1.5rem\",\r\n\t\tborderBottomLeftRadius: \"1.5rem\",\r\n\t\tborderTopRightRadius: \"1.5rem\",\r\n\t\tborderTopLeftRadius: 0,\r\n\t},\r\n\r\n\tchatBubbleLocalSequential: {\r\n\t\tborderBottomRightRadius: \"1.5rem\",\r\n\t\tborderBottomLeftRadius: \"1.5rem\",\r\n\t\tborderTopRightRadius: \"1.5rem\",\r\n\t\tborderTopLeftRadius: \"1.5rem\",\r\n\t},\r\n\t'@keyframes typing_loader_line': {\r\n\t\t\t'0%': {\r\n\t\t\t\tbackgroundColor: theme.palette.action.active,\r\n\t\t\t\tboxShadow: '12px 0px 0px 0px rgba(0,0,0,0.2),  24px 0px 0px 0px rgba(0,0,0,0.2)'\r\n\t\t\t},\r\n\t\t\t'25%': {\r\n\t\t\t\tbackgroundColor: theme.palette.action.hover,\r\n\t\t\t\tboxShadow: '12px 0px 0px 0px rgba(0,0,0,2), 24px 0px 0px 0px rgba(0,0,0,0.2)'\r\n\t\t\t},\r\n\t\t\t'75%': {\r\n\t\t\t\tbackgroundColor: theme.palette.text.disabled,\r\n\t\t\t\tboxShadow: '12px 0px 0px 0px rgba(0,0,0,0.2), 24px 0px 0px 0px rgba(0,0,0,2)'\r\n\t\t\t}\r\n\t},\r\n\ttyping_loader: {\r\n\t\t\tmargin: theme.spacing(),\r\n\t\t\twidth: theme.spacing(),\r\n\t\t\theight: theme.spacing(),\r\n\t\t\tborderRadius: theme.spacing(0.5),\r\n\t\t\tbackgroundColor: 'rgba(0,0,0, 1)',\r\n\t\t\twebkitAnimation: '$typing_loader_line 1s linear infinite alternate',\r\n\t\t\tmozAnimation: '$typing_loader_line 1s linear infinite alternate',\r\n\t\t\tanimation: '$typing_loader_line 1s linear infinite alternate'\r\n\t},\r\n\t\r\n\t\r\n});\r\n","/** @format */\n\nimport { app } from \"assets/jss/app-theme\";\nimport GridContainer from \"components/Grid/GridContainer\";\nimport GridItem from \"components/Grid/GridItem\";\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport compose from \"recompose/compose\";\nimport { withTheme } from '@material-ui/core/styles';\nimport { appendNavHistory } from \"state/actions\";\nimport ChatApp from \"views/apps/Dashboard/Chat\";\nimport {withErrorHandler} from \"hoc/ErrorHandler\";\n\n\n\nclass Page extends Component {\n\tcomponentDidMount() {\n\t\tconst { location, appendNavHistory, theme } = this.props;\n\t\tif (appendNavHistory && location) {\n\t\t\tappendNavHistory({\n\t\t\t\tname: \"messages\",\n\t\t\t\turi: location.pathname,\n\t\t\t\ttitle: \"Messages\",\n\t\t\t\tview: null,\n\t\t\t\tcolor: theme.palette.primary,\n\t\t\t\tscrollTop: 0,\n\t\t\t});\n\t\t}\n\t}\n\n\t\n\n\trender() {\n\t\tconst { classes } = this.props;\n\n\t\treturn (\n\t\t\t<GridContainer className=\"m-0 p-0\">\n\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t<ChatApp />\n\t\t\t\t</GridItem>\n\t\t\t</GridContainer>\n\t\t);\n\t}\n}\n\nconst mapStateToProps = state => ({\n\tauth: state.auth,\n});\n\nexport default withErrorHandler(\n\tcompose(connect(mapStateToProps, {appendNavHistory}), withTheme)(Page)\n);\n"],"sourceRoot":""}