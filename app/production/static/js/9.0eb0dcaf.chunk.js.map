{"version":3,"sources":["assets/img/empty-state-table.svg","views/widgets/Listings/GoogleMapView/index.jsx","views/widgets/Listings/GoogleMapView/styles.jsx","components/Calendar/index.jsx","views/widgets/Listings/CalendarView/index.jsx","views/widgets/Listings/CalendarView/styles.jsx","views/widgets/Listings/ListView/index.jsx","views/widgets/Listings/ListView/styles.jsx","views/widgets/Listings/TableView/index.jsx","views/widgets/Listings/TableView/styles.jsx","views/widgets/Listings/index.jsx","views/widgets/Listings/styles.jsx","views/widgets/Overview/GoogleMapOverview/index.jsx","views/widgets/Overview/GoogleMapOverview/styles.jsx","../node_modules/@material-ui/icons/ArrowBack.js","../node_modules/@material-ui/icons/People.js","components/ViewPortSensor/index.jsx","../node_modules/@material-ui/icons/AudiotrackOutlined.js","../node_modules/@material-ui/icons/MovieOutlined.js","../node_modules/@material-ui/icons/AttachFile.js","../node_modules/@material-ui/icons/Person.js","../node_modules/@material-ui/icons/Contacts.js","../node_modules/@material-ui/icons/ChevronRight.js","../node_modules/@material-ui/icons/ChevronLeft.js","../node_modules/@material-ui/icons/Block.js","../node_modules/@material-ui/icons/Done.js","../node_modules/@material-ui/icons/DoneAll.js","../node_modules/@material-ui/icons/Refresh.js","../node_modules/@material-ui/icons/ChatBubbleOutline.js","../node_modules/@material-ui/icons/DeleteOutlined.js","views/apps/Dashboard/Chat/index.jsx","views/apps/Dashboard/Chat/styles.jsx","views/pages/Dashboard/Messages/index.jsx"],"names":["module","exports","GoogleMapView","props","state","loading","load_error","defination","service","query","p","records","handleDeleteItemConfirm","item_id","event","openDialog","closeDialog","title","body","actions","cancel","text","color","onClick","delete","handleDeleteItem","close","bind","this","cache","mounted","loadContext","prepareData","Array","isArray","data","name","prevProps","contextReloadRequired","Object","areEqual","dataReloadRequired","dataPreparationRequired","prevState","snapshot","setState","loadData","auth","apiCallRequest","cache_data","onLoadData","load_data","uri","endpoint","type","params","then","Function","isFunction","e","msg","target_data","scope","columns","views","listing","googlemapview","resolveData","resolve","err","classes","googleMapProps","api","GridContainer","className","root","GridItem","xs","GoogleMap","defaultZoom","zoom","polylines","markers","circles","showCurrentPosition","complete","error","Typography","variant","center","fullWidth","React","Component","defaultProps","mapHeight","showClientsPositions","compose","withStyles","theme","padding","connect","ownProps","withErrorHandler","AntTabs","indicator","backgroundColor","colors","hex","accent","Tabs","AntTab","textTransform","minWidth","fontWeight","typography","fontWeightRegular","marginRight","spacing","opacity","fontWeightMedium","selected","Tab","CustomCalendar","calendarRef","createRef","view","view_title","Date","format","formats","dateformats","month","calendars","tasks","schedules","handleChangeCalendarView","current","rendered_date","getInstance","getDate","toDate","date","week","handleClickPrevButton","calendarInstance","prev","handleClickNextButton","next","handleOnEditEntryClick","handleOnDeleteEntryClick","show_actions","icon","subtitle","icon_color","title_color","subtitle_color","calendarProps","initCalendarEvents","refreshRequired","onSelect","onClickEntry","onClickEdit","onClickDelete","calendar","on","clickSchedule","UtilitiesHelper","isOfType","schedule","beforeCreateSchedule","beforeUpdateSchedule","beforeDeleteSchedule","height","defaultView","disableDblClick","disableClick","isReadOnly","useDetailPopup","useCreationPopup","scheduleView","taskView","calProps","Card","elevation","outlineColor","CardHeader","avatar","Avatar","aria-label","style","background","subheader","CardContent","sm","md","value","onChange","indicatorColor","textColor","label","IconButton","ref","CardActions","display","gutterBottom","map","index","Status","bgColor","secondary","key","rgb","grey","primary","primarydark","withRoot","styles","CalendarView","res","console","log","app","handleEditItem","access","update","restricted","user","window","location","href","id","borderColor","calendarview","full_height","justify","alignItems","ProgressIndicator","size","thickness","progress","disableShrink","Icon","fontSize","code","length","Calendar","alt","emptyImage","src","EmptyStateImage","emptyText","ListView","raw_records","dispatch","Actions","entryItemProps","listview","Skeleton","width","List","entry","ListItem","button","listItem","ListItemAvatar","ListItemIcon","ListItemText","Divider","component","show_links","transition","transitions","create","easing","sharp","duration","palette","action","hover","TableView","dt_columns","raw_data","mouseX","mouseY","actionsView","context","_id","new_records","filter","record","handleOnRowContextMenu","preventDefault","clientX","clientY","handleOnRowContextMenuClose","cachedData","actionsType","push","String","isString","singularize","options","sort","customBodyRender","tableMeta","updateValue","data_actions_wrapper","keys","action_name","action_index","link","inline","entries","field","display_field","tableview","reference","possibilities","cursor","undefined","input","Chip","valueChip","FilesHelper","fileType","AttachmentsService","getAttachmentFileUrl","fileIcon","open","focus","parsed_data","field_name","datetime","time","JSON","isJSON","stringify","possibilities_obj","resolved_data","ServiceDataHelper","resolveReferenceColumnsDisplays","that","all_records","parseData","table_options","filterType","downloadOptions","filename","separator","resizableColumns","selectableRows","responsive","pagination","rowHover","customToolbarSelect","selectedRows","displayData","setSelectedRows","ClickAwayListener","onContextMenu","onClickAway","Menu","onClose","anchorReference","anchorPosition","top","left","MenuItem","busy","whiteSpace","margin","maxWidth","marginTop","TablePaginationActions","useTheme","count","page","rowsPerPage","onChangePage","disabled","direction","Math","ceil","max","ListingView","showViewOptions","showAddBtn","searchKeyword","pages","viewMenuAnchorEl","sortFields","filterAccordionExpanded","filterableFields","filterContext","filterMenuAnchor","filters","values","labels","searchkeywordRef","handleViewItemClick","handleShowViewsMenu","currentTarget","handleCloseViewsMenu","handleOnPageChanged","handleOnRecordsPerPageChanged","Number","parseNumber","target","preferences","column_name","column_props","includes","filterContextMatched","filterableColumns","queryColumn","queryValue","q","prepareForRender","prepareForRenderRequired","all_views","vectormapview","default_view","showPagination","showSorter","sorterFormLayoutType","Button","Accordion","expanded","Paper","searchRoot","onSubmit","filterIconButton","humanize","anchorEl","keepMounted","Boolean","filterableField","filterableFieldProps","searchInput","placeholder","inputProps","defaultValue","onFocus","newKeyword","newState","newQuery","fromJSON","searchIconButton","AccordionDetails","filter_name","filter_label","GoogleMapOverview","TablePagination","labelRowsPerPage","rowsPerPageOptions","onChangeRowsPerPage","ActionsComponent","SelectProps","toolbar","paper","borderRight","borderLeft","activeVieBtn","inverse","border","viewBtnGroup","position","right","marginLeft","flex","searchDivider","googleMap","definations","services","drawerOpen","show_client_positions","clients_positions","context_entry","multicontexts","rendered_contexts","contexts_props","toggleDrawer","handleOnDrawerNavigationValueChange","newValue","context_entries","handleClientListItemClick","socketId","client","panTo","lat","latitude","lng","longitude","__SECRET_MAP_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","setZoom","handleToggleContextRender","renderContext","renderedContextIndex","indexOf","removeAtIndex","concat","a","populate","isMounted","context_entry_type","elements","element","loaded","handleContextEntryClick","device","contexts","elementRef","prepareForView","handleOnLoadMap","handleOnToggleShowClients","handleOnClientsPositionsLoaded","handleOnClientPositionAvailable","handleOnClientPositionUnavailable","handleOnClientPositionChanged","defaultMapZoom","current_defination","current_service","possible_definations","possible_services","google","newclientspositions","showAll","sockets","rendered_context","rest","path","mdiForwardburger","rotate","wrapper","classNames","content","contentDrawerMargin","window_size","contentShift","minHeight","onLoadClientsPositions","onClientPositionAvailable","onClientPositionUnavailable","onClientPositionChanged","selectedEntry","selectedEntryType","onMapLoad","SwipeableDrawer","drawer","anchor","onOpen","drawerPaper","temporaryDrawerPaper","BottomNavigation","showLabels","BottomNavigationAction","mdiAccountCircleOutline","mdiFolderOutline","show_entry","gender","trim","toLowerCase","client_user_female_icon","client_user_male_icon","first_name","last_name","role","Listings","commissions","loadedData","tracks","context_entry_name","round","new_value","withGlobals","appDrawer","flexShrink","zIndex","appBar","flexGrow","leavingScreen","easeOut","enteringScreen","withTheme","_interopRequireDefault","require","defineProperty","_react","_default","createElement","d","ViewPortSensor","children","offset","onViewportVisibilityChange","placeholderType","useRef","rootMargin","useState","isIntersecting","setIntersecting","useEffect","observer","IntersectionObserver","observe","unobserve","useOnScreen","animation","Alert","Chat","messaging","layout","communication","activeConversation","setMessagingCache","textInputRef","clearMessagingCache","messagesWrapperRef","useLocation","history","useHistory","useGlobals","conversations","unread_count","unread_ids","active_conversation","contacts","drafts","active_conversation_messages","chats","setChats","desc","contactsQuery","setContactsQuery","loadingConversations","setLoadingConversations","setLoadingContacts","draft","setDraft","setIndividualConversationsRecipients","setError","setContacts","contactsDrawerOpen","setContactsDrawerOpen","attachmentDialOpen","setAttachmentDialOpen","contextMenu","setContextMenu","setLoadingActiveChatMessages","locationHasWith","setLocationHasWith","firstLoad","setFirstLoad","attachmentActions","main","warning","info","loadConversations","errorMsg","handleContextOpen","handleContextClose","handleNewChat","recipients","recipients_ids","recipient","isEmpty","existsAtIndex","chat","owner_id","owner","recipient_id","updatedChats","existingChat","parse","remove","unshift","getConversationMessages","is_reply","sender","reply_for","conversation","newChat","participants","started_by","emit","handlePresenceChanged","presence","currentContacts","newContacts","user_id","forEach","contact","currentChats","newChats","chat_owner_id","handleOnUserStartedTypingMessage","chat_id","typing_users_arr","typing","exists","chat_typing_user","currentActiveChat","newCurrentActiveChat","handleOnUserStoppedTypingMessage","handleOnConversationMessages","messages","handleSocketActionError","handleOnMessageDeletedForUser","message","currentActiveChatMessages","newActiveChatMessages","activeChatMessage","handleOnMessageDeletedForAll","handleOnMessageStateChangedBySocketAction","withRecipient","URLSearchParams","search","get","email_address","newIndividualConversationsRecipients","off","AppBar","mainAppBar","Toolbar","pathname","edge","group_avatar","group_name","ScrollBars","bodyWrapper","users","loadedQuery","square","list","primaryText","chatUser","last_message_content","last_message_deleted","last_message_sender_name","total","last_message","participant","Badge","badgeContent","anchorOrigin","vertical","horizontal","dot","contactAvatar","iconAvatar","divider","incoming_unread","ListItemSecondaryAction","chatsAppBar","Fab","fabButton","grow","chatPaperWrapper","chatScrollWrapper","scrollToBottomOnChildChange","message_deleted","show_message","chatBubbleLocal","chatBubbleExternal","inViewport","attachments","attachment","LazyImage","paragraph","created_on","toLocaleString","typing_loader","chatInputsWrapper","currentDraft","newDraft","filesLimit","acceptedFiles","multiline","rows","onBlur","inputRef","onKeyDown","newMessageValue","messageToSend","newMessage","merge","handleOnSendMessage","Snackbar","autoHideDuration","severity","firstView","maxHeight","flexDirection","overflowX","paddingBottom","overflow","overflowY","scrollWrapper","bottom","marginBottom","borderRadius","boxShadow","paddingTop","light","borderBottomRightRadius","borderBottomLeftRadius","borderTopRightRadius","borderTopLeftRadius","chatBubbleLocalSequential","active","webkitAnimation","mozAnimation","Page","appendNavHistory","scrollTop"],"mappings":"+FAAAA,EAAOC,QAAU,IAA0B,+C,0MCkBrCC,E,kDASL,WAAYC,GAAQ,IAAD,uBAClB,cAAMA,IATPC,MAAQ,CACPC,SAAS,EACTC,YAAY,EACZC,WAAY,KACZC,QAAS,KACTC,MAAO,CAAEC,EAAG,GACZC,QAAS,IAES,EA6CnBC,wBAA0B,SAAAC,GAAO,OAAI,SAAAC,GAAU,IAAD,EACT,EAAKX,MAAjCY,EADqC,EACrCA,WAAYC,EADyB,EACzBA,YACZ,eACRD,EAAW,CACVE,MAAO,iBACPC,KACC,wEACDC,QAAS,CACRC,OAAQ,CACPC,KAAM,SACNC,MAAO,UACPC,QAAS,kBAAMP,MAEhBQ,OAAQ,CACPH,KAAM,SACNC,MAAO,QACPC,QAAS,SAAAT,GACRE,IACA,EAAKS,iBAAiBZ,UA/DR,EAsEnBY,iBAAmB,SAAAZ,GAAO,OAAI,SAAAC,GAAU,IAAD,EACF,EAAKX,MAAjCY,EAD8B,EAC9BA,WAAYC,EADkB,EAClBA,YACpBD,EAAW,CACVE,MAAO,kBACPC,KAAM,wCACNC,QAAS,CACRO,MAAO,CACNL,KAAM,QACNC,MAAO,UACPC,QAAS,kBAAMP,WA/EA,IAEVT,EAA+BJ,EAA/BI,WAAYC,EAAmBL,EAAnBK,QAASC,EAAUN,EAAVM,MAFX,OAIlB,EAAKL,MAAMG,WAAaA,EACxB,EAAKH,MAAMI,QAAUA,EACrB,EAAKJ,MAAMK,MAAQA,EAAK,2BAAQA,GAAR,IAAeC,EAAG,IAAM,CAAEA,EAAG,GAErD,EAAKE,wBAA0B,EAAKA,wBAAwBe,KAA7B,gBAC/B,EAAKF,iBAAmB,EAAKA,iBAAiBE,KAAtB,gBATN,E,gEAYE,IAAD,EACWC,KAAKzB,MAA3B0B,EADW,EACXA,MAAOtB,EADI,EACJA,WACfqB,KAAKE,SAAU,EACfF,KAAKG,cACLH,KAAKI,YAAaC,MAAMC,QAAQL,EAAMM,KAAK5B,EAAW6B,OAAQP,EAAMM,KAAK5B,EAAW6B,MAAQ,M,8CAGrEC,GACvBT,KAAKE,SAAU,EADmB,MAEJF,KAAKzB,MAFD,EAE1B0B,MAF0B,EAEnBtB,WACf,MAAO,CACN+B,uBAAwBC,OAAOC,SAASH,EAAU9B,WAAYqB,KAAKzB,MAAMI,YACzEkC,oBAAqBF,OAAOC,SAASH,EAAU5B,MAAMmB,KAAKzB,MAAMM,OAEhEiC,yBAAyB,K,yCAIRL,EAAWM,EAAWC,GAKxC,GAJIA,EAASN,wBACZV,KAAKG,cACLH,KAAKI,eAEFY,EAASH,mBAAoB,CAAC,IACzBhC,EAAUmB,KAAKzB,MAAfM,MACRmB,KAAKiB,SACJ,CAAEpC,MAAOA,EAAK,2BAAQA,GAAR,IAAeC,EAAG,IAAM,CAAEA,EAAG,IAC3CkB,KAAKkB,a,oCA8CO,IAAD,EACiClB,KAAKzB,MAA3CI,EADK,EACLA,WAAYC,EADP,EACOA,QAASC,EADhB,EACgBA,MADhB,EACuBoB,MAChCtB,GACHqB,KAAKiB,SACJ,CACCtC,WAAYA,EACZC,QAASA,EACTC,MAAOA,EAAK,2BAAQA,GAAR,IAAeC,EAAG,IAAM,CAAEA,EAAG,GACzCL,SAAS,GAEVuB,KAAKkB,Y,iCAMI,IAAD,SAC6ElB,KAAKzB,MAA9E0B,GADJ,EACFkB,KADE,EACIlB,OAAOtB,EADX,EACWA,WAAYyC,EADvB,EACuBA,eAAgBC,EADvC,EACuCA,WAAYC,EADnD,EACmDA,WAAYC,EAD/D,EAC+DA,UACzE,GAAI5C,EACH,GAAI4C,EACHH,EAAgBzC,EAAW6B,KAC1B,CACCgB,IAAK7C,EAAW8C,SAChBC,KAAM,UACNC,OAAQ3B,KAAKxB,MAAMK,MACnB0B,KAAM,GACNN,MAAOoB,IAEPO,MAAK,SAAArB,GACFsB,SAASC,WAAWR,IACvBA,EAAWf,GAEZ,EAAKH,YAAYG,MAZlB,OAaS,SAAAwB,GACR,EAAKd,UAAS,SAAAzC,GAAK,MAAK,CACvBO,QAAS,GACTL,WAAYqD,EACZtD,SAAS,aAIP,CACJ,IAAI8B,EAAOF,MAAMC,QAAQL,EAAMM,KAAK5B,EAAW6B,OAAQP,EAAMM,KAAK5B,EAAW6B,MAAQ,GACjFqB,SAASC,WAAWR,IACvBA,EAAWf,GAEZP,KAAKI,YAAYG,QAIlBP,KAAKiB,UAAS,SAAAzC,GAAK,MAAK,CACvBO,QAAS,GACTL,WAAY,CAAEsD,IAAK,qCACnBvD,SAAS,Q,oCAOY,IAAD,OAAX8B,EAAW,uDAAN,KAAM,EACcP,KAAKzB,MAA3B0B,GADQ,EACdkB,KADc,EACRlB,OAAOtB,EADC,EACDA,WACjBsD,EAAc5B,MAAMC,QAAQC,GAAOA,EAAQF,MAAMC,QAAQL,EAAMM,KAAK5B,EAAW6B,OAASP,EAAMM,KAAK5B,EAAW6B,MAAQ,GAC5G7B,GAAaA,EAAWuD,MAAMC,QAGvCN,SAASC,WAAYnD,EAAWyD,MAAMC,QAAQC,cAAcC,cAChE5D,EAAWyD,MAAMC,QAAQC,cAAcC,YAAYN,GAAa,GAAML,MAAK,SAAAY,GACzE,EAAKvB,UAAS,SAAAzC,GAAK,MAAK,CACvBO,QAASyD,EACT/D,SAAS,SAHZ,OAKS,SAAAgE,GACR,EAAKxB,UAAS,SAAAzC,GAAK,MAAK,CAAEO,QAAS,GAAIN,SAAS,W,+BAIzC,IAAD,EAC6CuB,KAAKzB,MAAlDmE,EADA,EACAA,QAASC,EADT,EACSA,eAAgBC,EADzB,EACyBA,IAAKjE,EAD9B,EAC8BA,WACtC,OACC,kBAACkE,EAAA,EAAD,CAAeC,UAAWJ,EAAQK,MACjC,kBAACC,EAAA,EAAD,CAAUF,UAAU,UAAUG,GAAI,IACjC,kBAACJ,EAAA,EAAD,CAAeC,UAAU,WACxB,kBAACD,EAAA,EAAD,CAAeC,UAAU,WACxB,kBAACE,EAAA,EAAD,CAAUF,UAAU,UAAUG,GAAI,IACjC,kBAACJ,EAAA,EAAD,CAAeC,UAAU,WACvB,kBAACE,EAAA,EAAD,CAAUC,GAAI,GAAIH,UAAU,WAC3B,kBAACI,EAAA,EAAD,eACCC,YAAa,GACbC,KAAM,IACFT,EAHL,CAMCU,UACC1E,GAGC,aAFDA,EAAWyD,MAAMC,QACfC,cAAcZ,KAEb1B,KAAKxB,MAAMO,QACX,GAEJuE,QAGC,WAFA3E,EAAWyD,MAAMC,QACfC,cAAcZ,KAEb1B,KAAKxB,MAAMO,QACX,GAEJwE,QAGC,WAFA5E,EAAWyD,MAAMC,QACfC,cAAcZ,KAEb1B,KAAKxB,MAAMO,QACX,GAEJyE,qBAAqB,WAMzBZ,IAAMA,EAAIa,UAAYb,EAAIc,QAC3B,kBAACb,EAAA,EAAD,KACC,kBAACG,EAAA,EAAD,CAAUC,GAAI,IACb,kBAACU,EAAA,EAAD,CACCjE,MAAM,QACNkE,QAAQ,QACRC,QAAM,EACNC,WAAS,GAER,wBACAlB,EAAIc,MAAM1B,c,GAjOO+B,IAAMC,WA0PlC1F,EAAc2F,aAAe,CAC5BtB,eAAgB,CACfuB,UAAW,IACXC,sBAAsB,EACtBX,qBAAqB,GAEtB3E,MAAO,GACP0C,WAAW,EACXF,YAAY,GAYE+C,IACdC,KC/Rc,SAAAC,GAAK,MAAK,CACxBvB,KAAM,CACLwB,QAAS,SD8RVC,aAXuB,SAAChG,EAAOiG,GACRA,EAAf9F,WACR,MAAO,CACNwC,KAAM3C,EAAM2C,KACZlB,MAAOzB,EAAMyB,MACb2C,IAAKpE,EAAMoE,OAMa,CAAExB,oBAAgBjC,gBAAYC,mBACvDsF,IAHcN,CAIb9F,I,qmBEtQIqG,GAAUN,IAAW,CAC1BO,UAAW,CACVC,gBAAiBC,KAAOC,IAAIC,SAFdX,CAIbY,KAEGC,GAASb,KAAW,SAAAC,GAAK,MAAK,CACnCvB,KAAM,CACLoC,cAAe,OACfC,SAAU,GACVC,WAAYf,EAAMgB,WAAWC,kBAC7BC,YAAalB,EAAMmB,UACnB,UAAW,CACV/F,MAAOoF,KAAOC,IAAP,QACPW,QAAS,GAEV,aAAc,CACbhG,MAAOoF,KAAOC,IAAIC,OAClBK,WAAYf,EAAMgB,WAAWK,kBAE9B,UAAW,CACVjG,MAAOoF,KAAOC,IAAIC,SAGpBY,SAAU,MAlBIvB,EAmBX,SAAA9F,GAAK,OAAI,kBAACsH,EAAA,EAAQtH,MAEhBuH,G,kDAUL,WAAYvH,GAAQ,IAAD,uBAClB,cAAMA,IAVPwH,YAAchC,IAAMiC,YASD,EARnBxH,MAAQ,CACPyH,KAAM,QACNC,YAAY,IAAIC,MAAOC,OAAOC,KAAQC,YAAYC,OAClDC,UAAW,GACXC,MAAO,GACPC,UAAW,IAGO,EAoInBC,yBAA2B,SAACzH,EAAO+G,GAClC,GAAI,EAAKF,YAAYa,QAAS,CAC7B,IACMC,EADmB,EAAKd,YAAYa,QAAQE,cACXC,UAAUC,SACjD,EAAK/F,UAAS,SAAAzC,GAAK,MAAK,CACvByH,KAAMA,EACNC,WACU,QAATD,EACGY,EAAcT,OAAOC,KAAQC,YAAYW,MAChC,SAAThB,EACAY,EAAcT,OAAOC,KAAQC,YAAYY,MACzCL,EAAcT,OAAOC,KAAQC,YAAYC,gBAG9C,EAAKtF,UAAS,SAAAzC,GAAK,MAAK,CAAEyH,KAAMA,OAlJf,EAsJnBkB,sBAAwB,WACvB,GAAI,EAAKpB,YAAYa,QAAS,CAC7B,IAAMQ,EAAmB,EAAKrB,YAAYa,QAAQE,cAClDM,EAAiBC,OACjB,IAAMR,EAAgBO,EAAiBL,UAAUC,SACjD,EAAK/F,UAAS,SAAAzC,GAAK,MAAK,CACvB0H,WACgB,QAAf1H,EAAMyH,KACHY,EAAcT,OAAOC,KAAQC,YAAYW,MAC1B,SAAfzI,EAAMyH,KACNY,EAAcT,OAAOC,KAAQC,YAAYY,MACzCL,EAAcT,OAAOC,KAAQC,YAAYC,aAjK7B,EAsKnBe,sBAAwB,WACvB,GAAI,EAAKvB,YAAYa,QAAS,CAC7B,IAAMQ,EAAmB,EAAKrB,YAAYa,QAAQE,cAClDM,EAAiBG,OACjB,IAAMV,EAAgBO,EAAiBL,UAAUC,SACjD,EAAK/F,UAAS,SAAAzC,GAAK,MAAK,CACvB0H,WACgB,QAAf1H,EAAMyH,KACHY,EAAcT,OAAOC,KAAQC,YAAYW,MAC1B,SAAfzI,EAAMyH,KACNY,EAAcT,OAAOC,KAAQC,YAAYY,MACzCL,EAAcT,OAAOC,KAAQC,YAAYC,aAjL7B,EAsLnBiB,uBAAyB,SAAAtI,GACpB,EAAK6G,YAAYa,SAvLH,EA2LnBa,yBAA2B,SAAAvI,GACtB,EAAK6G,YAAYa,SA5LH,IAGjBtC,EAaG/F,EAbH+F,MACA2B,EAYG1H,EAZH0H,KACAO,EAWGjI,EAXHiI,UACAC,EAUGlI,EAVHkI,MACAC,EASGnI,EATHmI,UACAgB,EAQGnJ,EARHmJ,aACAC,EAOGpJ,EAPHoJ,KACAtI,EAMGd,EANHc,MACAuI,EAKGrJ,EALHqJ,SACAC,EAIGtJ,EAJHsJ,WACAC,EAGGvJ,EAHHuJ,YACAC,EAEGxJ,EAFHwJ,eACAC,EACGzJ,EADHyJ,cAfiB,OAiBlB,EAAKxJ,MAAL,2BACI,EAAKA,OADT,IAEC8F,MAAOA,EACP2B,KAAMA,EACNC,WACU,QAATD,GACG,IAAIE,MAAOC,OAAOC,KAAQC,YAAYW,MAC7B,SAAThB,GACA,IAAIE,MAAOC,OAAOC,KAAQC,YAAYY,OACtC,IAAIf,MAAOC,OAAOC,KAAQC,YAAYC,OAC1CC,UAAWA,EACXC,MAAOA,EACPC,UAAWA,EACXgB,aAAcA,EACdC,KAAMA,EACNtI,MAAOA,EACPuI,SAAUA,EACVC,WAAYA,EACZC,YAAaA,EACbC,eAAgBA,EAChBC,cAAeA,IAEhB,EAAKrB,yBAA2B,EAAKA,yBAAyB5G,KAA9B,gBAGhC,EAAKoH,sBAAwB,EAAKA,sBAAsBpH,KAA3B,gBAC7B,EAAKuH,sBAAwB,EAAKA,sBAAsBvH,KAA3B,gBA3CX,E,gEA+ClBC,KAAKiI,uB,8CAGkBxH,GACvB,MAAO,CAAEyH,iBAAkBvH,OAAOC,SAASH,EAAWT,KAAKzB,U,yCAGzCkC,EAAWM,EAAWC,GAAW,IAAD,EAe9ChB,KAAKzB,MAbR+F,EAFiD,EAEjDA,MACA2B,EAHiD,EAGjDA,KACAO,EAJiD,EAIjDA,UACAC,EALiD,EAKjDA,MACAC,EANiD,EAMjDA,UACAgB,EAPiD,EAOjDA,aACAC,EARiD,EAQjDA,KACAtI,EATiD,EASjDA,MACAuI,EAViD,EAUjDA,SACAC,EAXiD,EAWjDA,WACAC,EAZiD,EAYjDA,YACAC,EAbiD,EAajDA,eACAC,EAdiD,EAcjDA,cAEGhH,EAASkH,iBACZlI,KAAKiB,SACJ,CACCqD,MAAOA,EACP2B,KAAMA,EACNC,WACU,QAATD,GACG,IAAIE,MAAOC,OAAOC,KAAQC,YAAYW,MAC7B,SAAThB,GACA,IAAIE,MAAOC,OAAOC,KAAQC,YAAYY,OACtC,IAAIf,MAAOC,OAAOC,KAAQC,YAAYC,OAC1CC,UAAWA,EACXC,MAAOA,EACPC,UAAWA,EACXgB,aAAcA,EACdC,KAAMA,EACNtI,MAAOA,EACPuI,SAAUA,EACVC,WAAYA,EACZC,YAAaA,EACbC,eAAgBA,EAChBC,cAAeA,GAEhBhI,KAAKiI,sB,2CAKc,IAAD,EAMhBjI,KAAKzB,MAJR4J,EAFmB,EAEnBA,SACAC,EAHmB,EAGnBA,aACAC,EAJmB,EAInBA,YACAC,EALmB,EAKnBA,cAEKC,EAAWvI,KAAK+F,YAAYa,QAAQE,cACtCyB,GACHA,EAASC,GAAG,CACXC,cAAe,SAAS1G,GACnB2G,KAAgBC,SAASP,EAAc,aAC1CA,EAAarG,EAAE6G,WAGjBC,qBAAsB,SAAS9G,GAC1B2G,KAAgBC,SAASR,EAAU,aACtCA,EAASpG,IAGX+G,qBAAsB,SAAS/G,GAC1B2G,KAAgBC,SAASN,EAAa,aACzCA,EAAYtG,IAGdgH,qBAAsB,SAAShH,GAC1B2G,KAAgBC,SAASL,EAAe,aAC3CA,EAAcvG,Q,+BAmET,IAAD,EAYJ/B,KAAKzB,MAVRmE,EAFO,EAEPA,QACAsG,EAHO,EAGPA,OACAC,EAJO,EAIPA,YACAC,EALO,EAKPA,gBACAC,EANO,EAMPA,aACAC,EAPO,EAOPA,WACAC,EARO,EAQPA,eACAC,EATO,EASPA,iBACAC,EAVO,EAUPA,aACAC,EAXO,EAWPA,SAXO,EA4BJxJ,KAAKxB,MAdR8F,EAdO,EAcPA,MACA2B,EAfO,EAePA,KACAC,EAhBO,EAgBPA,WACAM,EAjBO,EAiBPA,UACAC,EAlBO,EAkBPA,MACAC,EAnBO,EAmBPA,UAEAiB,GArBO,EAoBPD,aApBO,EAqBPC,MACAtI,EAtBO,EAsBPA,MACAuI,EAvBO,EAuBPA,SACAC,EAxBO,EAwBPA,WAGAG,GA3BO,EAyBPF,YAzBO,EA0BPC,eA1BO,EA2BPC,eAEKyB,EAAQ,aACbT,OAAQA,EAAS,KACjBC,YAAaA,EACbC,gBAAiBA,EACjBC,aAAcA,EACdC,WAAYA,EACZC,eAAgBA,EAChBC,iBAAkBA,EAClBC,aAAcA,EACdC,SAAUA,GACPxB,GAGJ,OACC,kBAAC0B,GAAA,EAAD,CAAMC,UAAW,EAAGC,aAAa,WAChC,kBAACC,GAAA,EAAD,CACCC,OACC,kBAACC,GAAA,EAAD,CACCC,aAAY3K,EACZ4K,MAAO,CAAEC,WAAYrC,IAEpBF,GAGHtI,MAAOA,EACP8K,UAAWvC,IAEZ,kBAACwC,GAAA,EAAD,CAAatH,UAAU,WACtB,kBAACD,EAAA,EAAD,CAAeC,UAAU,WACxB,kBAACD,EAAA,EAAD,CAAeC,UAAU,WACxB,kBAACE,EAAA,EAAD,CAAUqH,GAAI,EAAGC,GAAI,GACpB,kBAAC3F,GAAD,CACC4F,MAAOtE,EACPuE,SAAUxK,KAAK2G,yBACf8D,eAAe,UACfC,UAAU,UACV9G,QAAQ,YACRoG,aAAW,oBAEX,kBAAC9E,GAAD,CAAQqF,MAAM,QAAQI,MAAM,UAC5B,kBAACzF,GAAD,CAAQqF,MAAM,OAAOI,MAAM,SAC3B,kBAACzF,GAAD,CAAQqF,MAAM,MAAMI,MAAM,UAI5B,kBAAC3H,EAAA,EAAD,CAAUqH,GAAI,EAAGC,GAAI,GACpB,kBAAC3G,EAAA,EAAD,CAAYC,QAAQ,KAAKC,QAAM,GAC7B,IACAqC,EAAY,MAIf,kBAAClD,EAAA,EAAD,CAAUqH,GAAI,GAAIC,GAAI,GACrB,yBAAKxH,UAAU,eACd,kBAAC8H,EAAA,EAAD,CACCjL,QAASK,KAAKmH,uBAEd,kBAAC,IAAD,OAED,kBAACyD,EAAA,EAAD,CACCjL,QAASK,KAAKsH,uBAEd,kBAAC,IAAD,UAMJ,kBAACzE,EAAA,EAAD,CAAeC,UAAU,WACxB,kBAACE,EAAA,EAAD,CAAUC,GAAI,IACb,kBAAC,KAAD,eACCqB,MAAOA,EACP2B,KAAMA,EACNnD,UAAWJ,EAAQ6F,SACnB/B,UAAWA,EACXC,MAAOA,EACPC,UAAWA,EACXmE,IAAK7K,KAAK+F,aACN0D,QAMT,kBAACqB,GAAA,EAAD,KACC,kBAACjI,EAAA,EAAD,CAAeC,UAAU,WACxB,kBAACE,EAAA,EAAD,CAAUC,GAAI,IACb,kBAACU,EAAA,EAAD,CACCC,QAAQ,YACRmH,QAAQ,QACRrL,MAAM,UACNsL,cAAY,GAEX,IANF,iBAOgB,MAGjB,kBAAChI,EAAA,EAAD,CAAUC,GAAI,IACZuD,EAAUyE,KAAI,SAAC1C,EAAU2C,GAAX,OACd,kBAACC,GAAA,EAAD,CACCzL,MACC6I,EAAS6C,QACN7C,EAAS6C,QACTtG,KAAOC,IAAIsG,UAEf5L,KAAM8I,EAAS/H,KACf8K,IAAK,YAAcJ,e,GAjVCnH,IAAMC,WA4XnC8B,GAAe7B,aAAe,CAC7BuC,UAAW,GACXC,MAAO,GACPC,UAAW,GACXT,KAAM,QACN3B,MAAO,CACN,gBAAiB,kBAAoBQ,KAAOyG,IAAIC,KAAO,SACvD,yBAA0B,UAC1B,uBAAwB1G,KAAOC,IAAIyG,KACnC,wBAAyB1G,KAAOC,IAAIyG,KACpC,uBAAwB1G,KAAOC,IAAP,QACxB,qBAAsBD,KAAOC,IAAI0G,QACjC,yBAA0B3G,KAAOC,IAAI2G,aAEtChE,cAAc,EACdC,KAAM,kBAAC,IAAD,MACNtI,MAAO,KACPuI,SAAU,WACVC,WAAY/C,KAAOC,IAAI0G,QACvB3D,YAAahD,KAAOC,IAAI0G,QACxB1D,eAAgBjD,KAAOC,IAAIyG,KAC3BxD,cAAe,GACfgB,OAAQ,IACRC,YAAa,QACbC,iBAAiB,EACjBC,cAAc,EACdC,YAAY,EACZC,gBAAgB,EAChBC,kBAAkB,EAClBC,cAAc,EACdC,UAAU,GAGImC,oBAAStH,IAAWuH,KAAXvH,CAAmByB,K,4BCjcrC+F,G,kDAQL,WAAYtN,GAAQ,IAAD,uBAClB,cAAMA,IARPwH,YAAchC,IAAMiC,YAOD,EANnBxH,MAAQ,CACPC,SAAS,EACTC,YAAY,EACZK,QAAS,IAGS,EAqFnBc,iBAAmB,SAAAZ,GAAO,OAAI,SAAAC,GAAU,IAAD,EACF,EAAKX,MAAjCY,EAD8B,EAC9BA,WAAYC,EADkB,EAClBA,YAEpBD,EAAW,CACVE,MAAO,kBACPC,KAAM,wCACNC,QAAS,KAGV,EAAKf,MAAMI,QAAX,OACSK,GACP2C,MAAK,SAAAkK,GACL1M,IACA,EAAK8B,cAJP,OAMQ,SAAAa,GACNgK,QAAQC,IAAI,4BAA6BjK,GACzC3C,SAtGgB,IAEVT,EAAoCJ,EAApCI,WAAYC,EAAwBL,EAAxBK,QAASC,EAAeN,EAAfM,MAAeN,EAAR0N,IAFlB,OAIlB,EAAKzN,MAAMG,WAAaA,EACxB,EAAKH,MAAMI,QAAUA,EACrB,EAAKJ,MAAMK,MAAQA,EAAK,2BAAQA,GAAR,IAAeC,EAAG,IAAM,CAAEA,EAAG,GAErD,EAAKoN,eAAiB,EAAKA,eAAenM,KAApB,gBACtB,EAAKf,wBAA0B,EAAKA,wBAAwBe,KAA7B,gBAC/B,EAAKF,iBAAmB,EAAKA,iBAAiBE,KAAtB,gBAVN,E,gEAclBC,KAAKG,gB,8CAGkBM,GACvB,MAAO,CACNC,uBACEC,OAAOC,SAASH,EAAU9B,WAAYqB,KAAKzB,MAAMI,cACjDgC,OAAOC,SAASH,EAAU7B,QAASoB,KAAKzB,MAAMK,SAChDiC,oBAAqBF,OAAOC,SAC3BH,EAAU5B,MACVmB,KAAKzB,MAAMM,U,yCAKK4B,EAAWM,EAAWC,GAIxC,GAHIA,EAASN,uBACZV,KAAKG,cAEFa,EAASH,mBAAoB,CAAC,IACzBhC,EAAUmB,KAAKzB,MAAfM,MACRmB,KAAKiB,SACJ,CAAEpC,MAAOA,EAAK,2BAAQA,GAAR,IAAeC,EAAG,IAAM,CAAEA,EAAG,IAC3CkB,KAAKkB,a,6CAKgB,IAAD,EACclB,KAAKzB,MADnB,EACdY,YACRC,EAFsB,EACFA,iB,qCAINF,GAAQ,IACdiC,EAASnB,KAAKzB,MAAd4C,KAGNnB,KAAKxB,MAAMG,WAAWwN,OAAO5M,QAAQ6M,OAAOC,WAAWlL,EAAKmL,QAE7DC,OAAOC,SAASC,KACf,IACAzM,KAAKxB,MAAMG,WAAWwN,OAAO5M,QAAQ6M,OAAO5K,IAC3CtC,EAAM0J,SAAS8D,O,8CAKKxN,GAAQ,IAAD,EACMc,KAAKzB,MAAjCY,EADsB,EACtBA,WAAYC,EADU,EACVA,YAEpBD,EAAW,CACVE,MAAO,iBACPC,KACC,gCACAJ,EAAM0J,SAASvJ,MACf,sCACDE,QAAS,CACRC,OAAQ,CACPC,KAAM,SACNC,MAAO,UACPC,QAAS,kBAAMP,MAEhBQ,OAAQ,CACPH,KAAM,SACNC,MAAO,QACPC,QAASK,KAAKH,iBAAiBX,EAAM0J,SAAS8D,U,oCA2BnC,IAAD,EACgC1M,KAAKzB,MAA1CI,EADK,EACLA,WAAYC,EADP,EACOA,QAASC,EADhB,EACgBA,MADhB,EACuBsC,KAChCxC,GACHqB,KAAKiB,SACJ,CACCtC,WAAYA,EACZC,QAASA,EACTC,MAAOA,EAAK,2BAAQA,GAAR,IAAeC,EAAG,IAAM,CAAEA,EAAG,GACzC0H,UAAW,CACV,CACCkG,GAAI/N,EAAW6B,KACfA,KAAM7B,EAAWgM,MACjBS,QAASzM,EAAWe,MACpBiN,YAAahO,EAAWe,QAG1BX,QAAS,GACTN,SAAS,GAEVuB,KAAKkB,Y,iCAKI,IAAD,SAC6ElB,KAAKzB,MAA9E0B,GADJ,EACFkB,KADE,EACIlB,OAAOtB,EADX,EACWA,WAAYyC,EADvB,EACuBA,eAAgBC,EADvC,EACuCA,WAAYC,EADnD,EACmDA,WAAYC,EAD/D,EAC+DA,UACzE,GAAI5C,EACH,GAAI4C,EACHH,EAAgBzC,EAAW6B,KAC1B,CACCgB,IAAK7C,EAAW8C,SAChBC,KAAM,UACNC,OAAQ3B,KAAKxB,MAAMK,MACnB0B,KAAM,GACNN,MAAOoB,IAEPO,MAAK,SAAArB,GACNwL,QAAQC,IAAI,gBAAiBzL,GACzBsB,SAASC,WAAWR,IACvBA,EAAWf,EAAM,EAAK/B,MAAMK,OAE7B,EAAKuB,YAAYG,MAblB,OAcS,SAAAwB,GACRgK,QAAQC,IAAI,iBAAkBjK,GAC9B,EAAKd,UAAS,SAAAzC,GAAK,MAAK,CACvBO,QAAS,GACTL,WAAYqD,EACZtD,SAAS,aAIP,CACJ,IAAI8B,EAAOF,MAAMC,QAAQL,EAAMM,KAAK5B,EAAW6B,OAAQP,EAAMM,KAAK5B,EAAW6B,MAAQ,GACjFqB,SAASC,WAAWR,IACvBA,EAAWf,EAAMP,KAAKxB,MAAMK,OAE7BmB,KAAKI,YAAYG,QAIlBP,KAAKiB,UAAS,SAAAzC,GAAK,MAAK,CACvBO,QAAS,GACTL,WAAY,CAAEsD,IAAK,qCACnBvD,SAAS,Q,oCAKY,IAAD,OAAX8B,EAAW,uDAAN,KAAM,EACcP,KAAKzB,MAA3B0B,GADQ,EACdkB,KADc,EACRlB,OAAOtB,EADC,EACDA,WACjBsD,EAAc5B,MAAMC,QAAQC,GAAOA,EAAQF,MAAMC,QAAQL,EAAMM,KAAK5B,EAAW6B,OAASP,EAAMM,KAAK5B,EAAW6B,MAAQ,GAC5G7B,GAAaA,EAAWuD,MAAMC,QAGvCN,SAASC,WAAYnD,EAAWyD,MAAMC,QAAQuK,aAAarK,cAC/D5D,EAAWyD,MAAMC,QAAQuK,aAAarK,YAAYN,GAAa,GAAML,MAAK,SAAAY,GACxE,EAAKvB,UAAS,SAAAzC,GAAK,MAAK,CACvBO,QAASyD,EACT/D,SAAS,SAHZ,OAKS,SAAAgE,GACR,EAAKxB,UAAS,SAAAzC,GAAK,MAAK,CAAEO,QAAS,GAAIN,SAAS,W,+BAKzC,IACDiE,EAAY1C,KAAKzB,MAAjBmE,QAER,OACC,kBAACG,EAAA,EAAD,CAAeC,UAAWJ,EAAQK,MAChC/C,KAAKxB,MAAMG,YACX,kBAACqE,EAAA,EAAD,CAAUF,UAAU,UAAUG,GAAI,IAChCjD,KAAKxB,MAAMC,QACX,kBAACoE,EAAA,EAAD,CACCC,UAAWJ,EAAQmK,YACnBC,QAAQ,SACRC,WAAW,UAEX,kBAAC/J,EAAA,EAAD,CAAUC,GAAI,GACb,kBAAC+J,GAAA,EAAD,CACCC,KAAM,GACNC,UAAW,EACXpK,UAAWJ,EAAQyK,SACnBzN,MAAM,YACN0N,eAAa,MAKhB,kBAACvK,EAAA,EAAD,CAAeC,UAAU,WACvB9C,KAAKxB,MAAME,WACX,kBAACmE,EAAA,EAAD,KACC,kBAACG,EAAA,EAAD,CAAUC,GAAI,IACb,kBAACU,EAAA,EAAD,CACCjE,MAAM,QACNkE,QAAQ,KACRC,QAAM,EACNC,WAAS,GAET,kBAACuJ,EAAA,EAAD,CAAMC,SAAS,SAAf,WAKF,kBAACtK,EAAA,EAAD,CAAUC,GAAI,IACb,kBAACU,EAAA,EAAD,CACCjE,MAAM,QACNkE,QAAQ,QACRC,QAAM,EACNC,WAAS,GAJV,oBAOC,6BAPD,gBAQe,IACb9D,KAAKxB,MAAME,WAAW6O,KACvB,6BACCvN,KAAKxB,MAAME,WAAWsD,OAK1B,kBAACa,EAAA,EAAD,CAAeC,UAAU,WACxB,kBAACE,EAAA,EAAD,CAAUF,UAAU,UAAUG,GAAI,IAChC5C,MAAMC,QACNN,KAAKxB,MAAMO,UAEZiB,KAAKxB,MAAMO,QAAQyO,OAAS,EAC3B,kBAAC3K,EAAA,EAAD,CAAeC,UAAU,WACxB,kBAACE,EAAA,EAAD,CAAUC,GAAI,IACb,kBAACwK,GAAD,CACC9F,KACC3H,KAAKxB,MACHG,WACAgJ,KAEHtI,MACCW,KAAKxB,MACHG,WACAgM,MAEH7C,YACC9H,KAAKxB,MACHG,WACAe,MAEHmI,WACC7H,KAAKxB,MACHG,WACAe,MAEHkI,SAAS,GACTpB,UACCxG,KAAKxB,MAAMgI,UAEZP,KAAK,QACLS,UACC1G,KAAKxB,MACHO,QAEH+D,UACCJ,EAAQ6F,SAETF,YACCrI,KACEkM,eAEH5D,cACCtI,KACEhB,4BAMN,kBAAC6D,EAAA,EAAD,CACCC,UAAU,UACVgK,QAAQ,SACRC,WAAW,UAEX,yBACCW,IAAI,aACJ5K,UACCJ,EAAQiL,WAETC,IAAKC,MAEN,kBAAClK,EAAA,EAAD,CACCb,UACCJ,EAAQoL,UAETpO,MAAM,OACNkE,QAAQ,QACRC,QAAM,EACNC,WAAS,GAPV,KASI,IACF9D,KAAKxB,MAAMG,WACVgM,MACC3K,KAAKxB,MACJG,WACAgM,MACD,UAAW,IAff,mB,GAjUc5G,IAAMC,WA4WjC6H,GAAa5H,aAAe,CAC3B+D,cAAe,CACdgB,OAAQ,QACRC,YAAa,QACbC,iBAAiB,EACjBC,cAAc,EACdC,YAAY,EACZC,gBAAgB,EAChBC,kBAAkB,EAClBC,cAAc,EACdC,UAAU,GAEX3K,MAAO,CAAEC,EAAG,GACZuC,YAAY,EACZE,WAAW,GAGZ,IAKemD,gBACdN,IACCC,KCvZa,SAAAC,GAAK,MAAK,CACxBvB,KAAM,CACLwB,QAAS,SDsZTC,aARsB,SAAAhG,GAAK,MAAK,CACjC2C,KAAM3C,EAAM2C,KACZ8K,IAAKzN,EAAMyN,OAMe,CAAE7K,qBAAgBjC,iBAAYC,oBAFxDgF,CAGEyH,K,kGE/XGkC,G,kDAQL,WAAYxP,GAAQ,IAAD,uBAClB,cAAMA,IAPPC,MAAQ,CACPC,SAAS,EACTC,YAAY,EACZsP,YAAa,GACbjP,QAAS,IAES,EA0CnBC,wBAA0B,SAAAC,GAAO,OAAI,SAAAC,GAAU,IACtC+O,EAAa,EAAK1P,MAAlB0P,SACA,eACRA,EACCC,MAAmB,CAClB7O,MAAO,iBACPC,KACC,wEACDC,QAAS,CACRC,OAAQ,CACPC,KAAM,SACNC,MAAO,UACPC,QAAS,kBAAMsO,EAASC,WAEzBtO,OAAQ,CACPH,KAAM,SACNC,MAAO,QACPC,QAAS,EAAKE,iBAAiBZ,UA3DjB,EAkEnBY,iBAAmB,SAAAZ,GAAO,OAAI,SAAAC,GAAU,IAC/B+O,EAAa,EAAK1P,MAAlB0P,SAERA,EACCC,MAAmB,CAClB7O,MAAO,kBACPC,KAAM,wCACNC,QAAS,CACRO,MAAO,CACNL,KAAM,QACNC,MAAO,UACPC,QAAS,kBAAMsO,EAASC,iBA3EL3P,EAAfI,WAFU,OAIlB,EAAKK,wBAA0B,EAAKA,wBAAwBe,KAA7B,gBAC/B,EAAKF,iBAAmB,EAAKA,iBAAiBE,KAAtB,gBALN,E,gEAQE,IAAD,EACWC,KAAKzB,MAA3B0B,EADW,EACXA,MAAOtB,EADI,EACJA,WACfqB,KAAKE,SAAU,EACfF,KAAKG,cACLH,KAAKI,YAAaC,MAAMC,QAAQL,EAAMM,KAAK5B,EAAW6B,OAAQP,EAAMM,KAAK5B,EAAW6B,MAAQ,M,8CAGrEC,GACvBT,KAAKE,SAAU,EADmB,MAEJF,KAAKzB,MAFD,EAE1B0B,MAF0B,EAEnBtB,WACf,MAAO,CACN+B,uBAAwBC,OAAOC,SAASH,EAAU9B,WAAYqB,KAAKzB,MAAMI,YACzEkC,oBAAqBF,OAAOC,SAASH,EAAU5B,MAAMmB,KAAKzB,MAAMM,OAEhEiC,yBAAyB,K,yCAIRL,EAAWM,EAAWC,GAKxC,GAJIA,EAASN,wBACZV,KAAKG,cACLH,KAAKI,eAEFY,EAASH,mBAAoB,CAAC,IACzBhC,EAAUmB,KAAKzB,MAAfM,MACRmB,KAAKiB,SACJ,CAAEpC,MAAOA,EAAK,2BAAQA,GAAR,IAAeC,EAAG,IAAM,CAAEA,EAAG,IAC3CkB,KAAKkB,a,oCAiDO,IAAD,EACiClB,KAAKzB,MAA3CI,EADK,EACLA,WAAYC,EADP,EACOA,QAASC,EADhB,EACgBA,MADhB,EACuBoB,MAChCtB,GACHqB,KAAKiB,SACJ,CACCtC,WAAYA,EACZC,QAASA,EACTC,MAAOA,EAAK,2BAAQA,GAAR,IAAeC,EAAG,IAAM,CAAEA,EAAG,GACzCL,SAAS,GAEVuB,KAAKkB,Y,iCAKI,IAAD,SAC6ElB,KAAKzB,MAA9E0B,GADJ,EACFkB,KADE,EACIlB,OAAOtB,EADX,EACWA,WAAYyC,EADvB,EACuBA,eAAgBC,EADvC,EACuCA,WAAYC,EADnD,EACmDA,WAAYC,EAD/D,EAC+DA,UACzE,GAAI5C,GACH,GAAI4C,EACHH,EAAgBzC,EAAW6B,KAC1B,CACCgB,IAAK7C,EAAW8C,SAChBC,KAAM,UACNC,OAAQ3B,KAAKxB,MAAMK,MACnB0B,KAAM,GACNN,MAAOoB,IAEPO,MAAK,SAAArB,GACFsB,SAASC,WAAWR,IACvBA,EAAWf,EAAM,EAAK/B,MAAMK,OAE7B,EAAKuB,YAAYG,MAZlB,OAaS,SAAAwB,GACR,EAAKd,UAAS,SAAAzC,GAAK,MAAK,CACvBO,QAAS,GACTL,WAAYqD,EACZtD,SAAS,cAIP,GAAI4C,EAAW,CACnB,IAAId,EAAOF,MAAMC,QAAQL,EAAMM,KAAK5B,EAAW6B,OAAQP,EAAMM,KAAK5B,EAAW6B,MAAQ,GACjFqB,SAASC,WAAWR,IACvBA,EAAWf,EAAMP,KAAKxB,MAAMK,OAE7BmB,KAAKI,YAAYG,SAIlBP,KAAKiB,UAAS,SAAAzC,GAAK,MAAK,CACvBO,QAAS,GACTL,WAAY,CAAEsD,IAAK,qCACnBvD,SAAS,Q,oCAOY,IAAD,OAAX8B,EAAW,uDAAN,KAAM,EAC8BP,KAAKzB,MAAjD4C,EADc,EACdA,KAAMlB,EADQ,EACRA,MAAOtB,EADC,EACDA,WAAYwP,EADX,EACWA,eAC7BlM,EAAc5B,MAAMC,QAAQC,GAAOA,EAAQF,MAAMC,QAAQL,EAAMM,KAAK5B,EAAW6B,OAASP,EAAMM,KAAK5B,EAAW6B,MAAQ,GAC5G7B,GAAaA,EAAWuD,MAAMC,QAGvCN,SAASC,WAAYnD,EAAWyD,MAAMC,QAAQ+L,SAAS7L,cAC3D5D,EAAWyD,MAAMC,QAAQ+L,SAAS7L,YAAYN,EAAad,EAAKmL,KAAM6B,GACpEvM,MAAK,SAAAY,GACL,EAAKvB,UAAS,SAAAzC,GAAK,MAAK,CACvBwP,YAAazN,EACbxB,QAASyD,EACT/D,SAAS,SALZ,OAQQ,SAAAgE,GACN,EAAKxB,UAAS,SAAAzC,GAAK,MAAK,CAAEO,QAAS,GAAIiP,YAAa,GAAIvP,SAAS,W,uCAKnD,IAAD,EACgCuB,KAAKzB,MAApCI,GADD,EACR+D,QADQ,EACC/D,YADD,EACawC,KADb,EACmB8M,SAErBtP,EAAWuD,MAAMC,QAE/BnC,KAAKxB,MAAMO,QAAU,GACrBiB,KAAKxB,MAAMC,SAAU,I,+BAIZ,IAAD,SAC+CuB,KAAKzB,MAApDmE,EADA,EACAA,QAAS/D,EADT,EACSA,WAAqByJ,GAD9B,EACqBxJ,QADrB,EAC8BwJ,cACtC,OACC,kBAACvF,EAAA,EAAD,CAAeC,UAAWJ,EAAQK,MACjC,kBAACC,EAAA,EAAD,CAAUF,UAAU,UAAUG,GAAI,IAChCjD,KAAKxB,MAAMC,QACX,kBAACoE,EAAA,EAAD,KACE,kBAACG,EAAA,EAAD,CAAUsH,GAAI,GAAIxH,UAAW,qDAC5B,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,KAC9C,yBAAKlG,UAAU,gCACd,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAOd,UAAU,aAIrC,kBAACE,EAAA,EAAD,CAAUsH,GAAI,GAAIxH,UAAW,qDAC5B,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,KAC9C,yBAAKlG,UAAU,gCACd,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAOd,UAAU,aAIrC,kBAACE,EAAA,EAAD,CAAUsH,GAAI,GAAIxH,UAAW,qDAC5B,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,KAC9C,yBAAKlG,UAAU,gCACd,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAOd,UAAU,aAIrC,kBAACE,EAAA,EAAD,CAAUsH,GAAI,GAAIxH,UAAW,qDAC5B,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,KAC9C,yBAAKlG,UAAU,gCACd,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAOd,UAAU,aAIrC,kBAACE,EAAA,EAAD,CAAUsH,GAAI,GAAIxH,UAAW,qDAC5B,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,KAC9C,yBAAKlG,UAAU,gCACd,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAOd,UAAU,aAIrC,kBAACE,EAAA,EAAD,CAAUsH,GAAI,GAAIxH,UAAW,qDAC5B,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,KAC9C,yBAAKlG,UAAU,gCACd,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAOd,UAAU,aAIrC,kBAACE,EAAA,EAAD,CAAUsH,GAAI,GAAIxH,UAAW,qDAC5B,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,KAC9C,yBAAKlG,UAAU,gCACd,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAOd,UAAU,aAIrC,kBAACE,EAAA,EAAD,CAAUsH,GAAI,GAAIxH,UAAW,qDAC5B,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,KAC9C,yBAAKlG,UAAU,gCACd,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAOd,UAAU,aAIrC,kBAACE,EAAA,EAAD,CAAUsH,GAAI,GAAIxH,UAAW,qDAC5B,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,KAC9C,yBAAKlG,UAAU,gCACd,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAOd,UAAU,cAKvC,kBAACD,EAAA,EAAD,CAAeC,UAAU,WACvB9C,KAAKxB,MAAME,WACX,kBAACmE,EAAA,EAAD,KACC,kBAACG,EAAA,EAAD,CAAUC,GAAI,IACb,kBAACU,EAAA,EAAD,CACCjE,MAAM,QACNkE,QAAQ,KACRC,QAAM,EACNC,WAAS,GAET,kBAACuJ,EAAA,EAAD,CAAMC,SAAS,SAAf,WAGF,kBAACtK,EAAA,EAAD,CAAUC,GAAI,IACb,kBAACU,EAAA,EAAD,CACCjE,MAAM,QACNkE,QAAQ,QACRd,UAAW,qBACXe,QAAM,EACNC,WAAS,GALV,oBAQC,6BARD,gBASe,IACb9D,KAAKxB,MAAME,WAAW6O,KACvB,6BACCvN,KAAKxB,MAAME,WAAWsD,OAK1B,kBAACa,EAAA,EAAD,CAAeC,UAAU,WACxB,kBAACE,EAAA,EAAD,CAAUF,UAAU,UAAUG,GAAI,IAChC5C,MAAMC,QAAQN,KAAKxB,MAAMO,UAC1BiB,KAAKxB,MAAMO,QAAQyO,OAAS,EAC3B,kBAAC3K,EAAA,EAAD,CAAeC,UAAU,WACxB,kBAACE,EAAA,EAAD,CAAUC,GAAI,IACb,kBAACsL,GAAA,EAAD,CACCzL,UAAW,sBAEV9C,KAAKxB,MAAMO,QAAQkM,KACnB,SAACuD,EAAOtD,GAAR,OACC,yBACCI,IACC3M,EAAW6B,KACX,IACA0K,GAGD,kBAACuD,GAAA,EAAD,CACCC,QAAM,EACN3B,WAAW,aACXpN,QAAS,WACJkC,SAASC,WAAWsG,IACvBA,EAAa,EAAK5J,MAAMwP,YAAY9C,GAAQA,IAG9CpI,UAAWJ,EAAQiM,UAElBH,EAAM1E,QACN,kBAAC8E,GAAA,EAAD,KACE,IAEAJ,EAAM1E,OACL,KAGH0E,EAAM7G,MACN,kBAACkH,GAAA,EAAD,KACE,IAEAL,EAAM7G,KACL,KAIJ,kBAACmH,GAAA,EAAD,CACCrD,QACC+C,EAAMnP,MAEPgM,UACCmD,EAAMlP,QAKT,kBAACyP,GAAA,EAAD,CACCC,UAAU,cASjB,kBAACnM,EAAA,EAAD,CACCC,UAAU,UACVgK,QAAQ,SACRC,WAAW,UAEX,yBACCW,IAAI,aACJ5K,UACCJ,EAAQiL,WAETC,IAAKC,MAEN,kBAAClK,EAAA,EAAD,CACCb,UACCJ,EAAQoL,UAETpO,MAAM,OACNkE,QAAQ,QACRC,QAAM,EACNC,WAAS,GAPV,KASI,IACFnF,EAAWgM,MACThM,EAAWgM,MACX,UAAW,IAZf,mB,GAzWW5G,IAAMC,WAiZ7B+J,GAAS9J,aAAe,CACvByD,cAAc,EACduH,YAAY,EACZpQ,MAAO,CAAEC,EAAG,GACZyC,WAAW,EACXF,YAAY,GAGb,IAQe+C,OACdC,KC5bc,SAAAC,GAAK,MAAK,CACxBvB,KAAM,CACLwB,QAAS,KAEVoK,SAAU,CACTzE,WAAY,cACZgF,WAAY5K,EAAM6K,YAAYC,OAAO,aAAc,CAClDC,OAAQ/K,EAAM6K,YAAYE,OAAOC,MACjCC,SAAU,KAEX,UAAW,CACVrF,WAAY5F,EAAMkL,QAAQC,OAAOC,YDkbnClL,aAVuB,SAAChG,EAAOiG,GACRA,EAAf9F,WACR,MAAO,CACNwC,KAAM3C,EAAM2C,KACZlB,MAAOzB,EAAMyB,MACb2C,IAAKpE,EAAMoE,OAKa,CAAExB,qBAAgBjC,iBAAYC,oBACvDsF,KAHcN,CAIb2J,I,+DEpaI4B,G,kDAeL,WAAYpR,GAAQ,IAAD,uBAClB,cAAMA,IAfPC,MAAQ,CACPC,SAAS,EACTC,YAAY,EACZC,WAAY,KACZC,QAAS,KACTC,MAAO,CAAEC,EAAG,GACZ8Q,WAAY,GACZ7Q,QAAS,GACT8Q,SAAU,GACVC,OAAQ,KACRC,OAAQ,KACRC,YAAa,cACbC,QAAS,MAES,EA8CnBjR,wBAA0B,SAAAC,GAAO,OAAI,SAAAC,GAAU,IAAD,EACT,EAAKX,MAAjCY,EADqC,EACrCA,WAAYC,EADyB,EACzBA,YACZ,eACRD,EAAW,CACVE,MAAO,iBACPC,KACC,wEACDC,QAAS,CACRC,OAAQ,CACPC,KAAM,SACNC,MAAO,UACPC,QAAS,kBAAMP,MAEhBQ,OAAQ,CACPH,KAAM,SACNC,MAAO,QACPC,QAAS,EAAKE,iBAAiBZ,SA9DhB,EAoEnBY,iBAAmB,SAAAZ,GAAO,OAAI,SAAAC,GAAU,IAAD,EACF,EAAKX,MAAjCY,EAD8B,EAC9BA,YACRC,EAFsC,EAClBA,eAEhBH,EAAQiR,MACXjR,EAAUA,EAAQiR,KAEnB,EAAK1R,MAAMI,QAAX,OACSK,GACP2C,MAAK,SAAAkK,GACL,EAAK7K,UAAS,SAAAF,GACb,IAAIoP,EAAcpP,EAAUhC,QAoB5B,OAnBIsB,MAAMC,QAAQ6P,KACjBA,EAAcA,EAAYC,QAAO,SAACC,GACjC,GAAIA,EAAO7B,OACV,GAAI6B,EAAO7B,MAAM0B,MAAQjR,EACxB,OAAO,OAGJ,GAAIoR,EAAOH,MAAQjR,EACvB,OAAO,EAGR,OAAO,MAIJoB,MAAMC,QAAQ6P,KAClBA,EAAc,IAGR,CACNpR,QAASoR,SAzBb,OA4BU,SAAApO,GACR5C,EAAW,CACVE,MAAO,gBACPC,KAAMyC,EAAEC,IACRzC,QAAS,UA1GM,EA+GnB+Q,uBAAyB,SAAApF,GAAK,OAAI,SAAAhM,GACjCA,EAAMqR,iBACN,IAAMT,EAAS5Q,EAAMsR,QAAU,EACzBT,EAAS7Q,EAAMuR,QAAU,EAE/B1E,QAAQC,IAAI,6BAA8B,EAAKxN,MAAMqR,SAAS3E,IAC9D,EAAKjK,UAAS,SAAAF,GAAS,MAAK,CAC3B+O,OAAQA,EACRC,OAAQA,EACRE,QAASlP,EAAU8O,SAAS3E,SAxHX,EA4HnBwF,4BAA8B,SAAAxR,GAC7BA,EAAMqR,iBAEN,EAAKtP,SAAS,CACb6O,OAAQ,KACRC,OAAQ,QAjIS,IAEVpR,EAA4DJ,EAA5DI,WAAYC,EAAgDL,EAAhDK,QAASC,EAAuCN,EAAvCM,MAAsB8R,EAAiBpS,EAAhC0B,MAASM,KAF3B,OAGlB,EAAK/B,MAAMG,WAAaA,EACxB,EAAKH,MAAMI,QAAUA,EACrB,EAAKJ,MAAMK,MAAQA,EAAK,2BAAQA,GAAR,IAAeC,EAAG,IAAM,CAAEA,EAAG,GACrD,EAAKN,MAAMO,QAAUsB,MAAMC,QAAQqQ,EAAWhS,EAAW6B,OAAQmQ,EAAWhS,EAAW6B,MAAQ,GAC/F,EAAKN,SAAU,EACf,EAAKlB,wBAA0B,EAAKA,wBAAwBe,KAA7B,gBAC/B,EAAKF,iBAAmB,EAAKA,iBAAiBE,KAAtB,gBACxB,EAAKuQ,uBAAyB,EAAKA,uBAAuBvQ,KAA5B,gBAVZ,E,gEAaE,IAAD,EACWC,KAAKzB,MAA3B0B,EADW,EACXA,MAAOtB,EADI,EACJA,WACfqB,KAAKE,SAAU,EACfF,KAAKG,cACLH,KAAKI,YAAaC,MAAMC,QAAQL,EAAMM,KAAK5B,EAAW6B,OAAQP,EAAMM,KAAK5B,EAAW6B,MAAQ,M,8CAGrEC,GACvBT,KAAKE,SAAU,EADmB,MAEJF,KAAKzB,MAFD,EAE1B0B,MAF0B,EAEnBtB,WACf,MAAO,CACN+B,uBAAwBC,OAAOC,SAASH,EAAU9B,WAAYqB,KAAKzB,MAAMI,YACzEkC,oBAAqBF,OAAOC,SAASH,EAAU5B,MAAMmB,KAAKzB,MAAMM,OAEhEiC,yBAAyB,K,yCAIRL,EAAWM,EAAWC,GAMxC,GALAhB,KAAKE,SAAU,EACXc,EAASN,wBACZV,KAAKG,cACLH,KAAKI,eAEFY,EAASH,mBAAoB,CAAC,IACzBhC,EAAUmB,KAAKzB,MAAfM,MACRmB,KAAKiB,SACJ,CAAEpC,MAAOA,EAAK,2BAAQA,GAAR,IAAeC,EAAG,IAAM,CAAEA,EAAG,IAC3CkB,KAAKkB,a,oCA4FO,IAAD,SACsDlB,KAAKzB,MAAhEmE,EADK,EACLA,QAAS/D,EADJ,EACIA,WAAYC,EADhB,EACgBA,QAASC,EADzB,EACyBA,MAAOsC,EADhC,EACgCA,KAAMyP,EADtC,EACsCA,YACnD,GAAIjS,EAAY,CACf,IAAIwD,EAAUxD,EAAWuD,MAAMC,QAC3ByN,EAAa,GACjB,IAAKjR,EAAWwN,OAAOE,WAAWlL,EAAKmL,MAAO,CAC7CsD,EAAWiB,KAAK,CACfrQ,KAAM,QACNmK,MAAOmG,OAAOC,SAASpS,EAAWgM,OAAQhM,EAAWgM,MAAMqG,cAAiB,SAC5EC,QAAS,CACRb,QAAQ,EACRc,MAAM,EAsCNC,iBAAkB,SAAC5G,EAAO6G,EAAWC,GACpC,GAAoB,WAAhBT,EACH,OACC,kBAAC/N,EAAA,EAAD,CACC4C,QAAS,EACT3C,UAAWJ,EAAQ4O,sBAElB3Q,OAAO4Q,KAAK5S,EAAWwN,OAAO5M,SAAS0L,KAAI,SAACuG,EAAaC,GAAd,OAC1C9S,EAAWwN,OAAO5M,QAAQiS,GAAanF,WAAWlL,EAAKmL,OACvD,yBACChB,IACCf,EACA,IACAiH,EACA,WAGgB,WAAhBA,EAA2B7S,EAAWwN,OAAO5M,QAAQiS,GAAaE,KAAKC,OAAOtP,QAAQkI,EACpF,aACA,EAAKvL,wBACJuL,IAGD5L,EAAWwN,OAAO5M,QAClBiS,GACEE,KAAKC,OAAOtP,QACdkI,YAaZ,cAA0B5J,OAAOiR,QAAQzP,GAAzC,eAAmD,CAAC,IAAD,sBAAzC3B,EAAyC,KAAnCqR,EAAmC,KAC9CC,GAAgB,EAChBD,EAAMxF,YAAc,YAAawF,EAAMxF,YACF,oBAA7BwF,EAAMxF,WAAWtB,UAC3B+G,GAAiBD,EAAMxF,WAAWtB,SACjC,EACA5J,EAAKmL,OAKJwF,IAEFpJ,KAAgBC,SACf3I,KAAKxB,MAAMG,WAAWyD,MAAMC,QAAQ0P,UAClCxP,YACF,YAGGsP,EAAMG,WAAaH,EAAMI,cAC5BrC,EAAWiB,KAAK,CACfrQ,KAAMA,EACNmK,MAAOkH,EAAMlH,MACbsG,QAAS,CACRb,SAAQyB,EAAMI,cAGdf,MAAM,EACNC,iBAAkB,SACjB5G,EACA6G,EACAC,GAEA,OAAIhR,MAAMC,QAAQiK,GAEhB,kBAAC1H,EAAA,EAAD,CAAe4C,QAAS,GACtB8E,EAAMU,KACN,SAACuD,EAAO0D,GAAR,OACC,yBACC5G,IAAK4G,GAEJ,IACA1D,EAAO,SAOI,OAAVjE,QACI4H,IAAV5H,EACEA,EACA,OAMPqF,EAAWiB,KAAK,CACfrQ,KAAMA,EACNmK,MAAOkH,EAAMlH,MACbsG,QAAS,CACRb,SAAQyB,EAAMI,cAGdf,MAAM,KAMRW,EAAMG,WACe,SAArBH,EAAMO,MAAM1Q,KAEZkO,EAAWiB,KAAK,CACfrQ,KAAMA,EACNmK,MAAOkH,EAAMlH,MACbsG,QAAS,CACRb,SAAQyB,EAAMI,cAGdf,MAAM,EACNC,iBAAkB,SACjB5G,EACA6G,EACAC,GAEA,OAAIhR,MAAMC,QAAQiK,GAEhB,kBAAC1H,EAAA,EAAD,CAAe4C,QAAS,GACtB8E,EAAMU,KACN,SAACuD,EAAO0D,GAAR,OACC,kBAACG,GAAA,EAAD,CACCvP,UACCJ,EAAQ4P,UAEThH,IACCkD,EAAMjE,MAEPI,MACC6D,EAAMhM,cAQK,OAAV+H,QACI4H,IAAV5H,EACA,kBAAC8H,GAAA,EAAD,CACC1H,MAAOJ,EAAM/H,UAGd,OAOLqP,EAAMG,WACe,SAArBH,EAAMO,MAAM1Q,KAEZkO,EAAWiB,KAAK,CACfrQ,KAAMA,EACNmK,MAAOkH,EAAMlH,MACbsG,QAAS,CACRb,SAAQyB,EAAMI,cAGdf,MAAM,EACNC,iBAAkB,SACjB5G,EACA6G,EACAC,GAEA,OAAIhR,MAAMC,QAAQiK,GAEhB,kBAAC1H,EAAA,EAAD,CAAe4C,QAAS,GACtB8E,EAAMU,KACN,SAACuD,EAAO0D,GAAR,OACC,kBAACG,GAAA,EAAD,CACCvP,UACCJ,EAAQ4P,UAETxI,OACC,kBAACC,GAAA,EAAD,CACCrK,MAAM,UACNgL,UAAU,UACVkD,IAIC,UAHA2E,KAAYC,SACXhE,EAAMhM,SAGJiQ,eAAmBC,qBACnBlE,EAAMjE,YAEN4H,GAGHI,KAAYI,SACZnE,EAAMhM,UAITmI,MACC6D,EAAMhM,QAEP7C,QAAS,SAAAoC,GACRA,EAAEwO,iBACQhE,OAAOqG,KAChBH,eAAmBC,qBAClBlE,EAAMjE,OAEP,UAEGsI,SAELvH,IACC,QACAkD,EAAMjE,YAQK,OAAVA,QACI4H,IAAV5H,EACA,kBAAC8H,GAAA,EAAD,CACCvI,OACC,kBAACC,GAAA,EAAD,CACCrK,MAAM,UACNgL,UAAU,UACVkD,IAIC,UAHA2E,KAAYC,SACXjI,EAAM/H,SAGJiQ,eAAmBC,qBACnBnI,EAAMA,YAEN4H,GAGHI,KAAYI,SACZpI,EAAM/H,UAIT7C,QAAS,SAAAoC,GACRA,EAAEwO,iBACQhE,OAAOqG,KAChBH,eAAmBC,qBAClBnI,EAAMA,OAEP,UAEGsI,SAELlI,MAAOJ,EAAM/H,UAGd,OAOLoN,EAAWiB,KAAK,CACfrQ,KAAMA,EACNmK,MAAOkH,EAAMlH,MACbsG,QAAS,CACRb,SAAQyB,EAAMI,cAGdf,MAAM,OAablR,KAAKiB,SACJ,CACCtC,WAAYA,EACZC,QAASA,EACTC,MAAOA,EAAK,2BAAQA,GAAR,IAAeC,EAAG,IAAM,CAAEA,EAAG,GACzC8Q,WAAYA,EACZ7Q,QAAS,GACTN,SAAS,GAEVuB,KAAKkB,a,gCAKEsN,GAAQ,IAAD,EACaxO,KAAKzB,MAA1BI,EADQ,EACRA,WAAYwC,EADJ,EACIA,KAChB2R,EAActE,EACdrM,EAAUxD,EAAWuD,MAAMC,QAC/B2Q,EAAW,MAAYtE,EACvB,cAAgC7N,OAAOiR,QAAQzP,GAA/C,eAAyD,CAAC,IAAD,sBAA/C4Q,EAA+C,KAAnClB,EAAmC,KAwCxD,GAvCyB,SAArBA,EAAMO,MAAM1Q,OACX8M,EAAMuE,GACTD,EAAYC,GAAc,IAAI5M,KAC7BqI,EAAMuE,IACL3M,OAAOC,KAAQC,YAAYW,MAE7B6L,EAAYC,GAAc,IAGH,aAArBlB,EAAMO,MAAM1Q,MAAuB8M,EAAMuE,KACxCvE,EAAMuE,GACTD,EAAYC,GAAc,IAAI5M,KAC7BqI,EAAMuE,IACL3M,OAAOC,KAAQC,YAAY0M,UAE7BF,EAAYC,GAAc,IAGH,SAArBlB,EAAMO,MAAM1Q,OACX8M,EAAMuE,GACTD,EAAYC,GAAc,IAAI5M,KAC7BqI,EAAMuE,IACL3M,OAAOC,KAAQC,YAAY2M,MAE7BH,EAAYC,GAAc,IAGT,YAAflB,EAAMnQ,OACL8M,EAAMuE,GACTD,EAAYC,GAAc,MAE1BD,EAAYC,GAAc,MAGxBG,KAAKC,OAAOL,EAAYC,MAAiBlB,EAAMG,YAClDc,EAAYC,GAAcG,KAAKE,UAC9BN,EAAYC,KAGVlB,EAAMI,cACT,GAAIiB,KAAKC,OAAOtB,EAAMI,eACjBzD,EAAMuE,KAAelB,EAAMI,gBAC9Ba,EAAYC,GACXlB,EAAMI,cAAczD,EAAMuE,UAEtB,GAAIlR,SAASC,WAAW+P,EAAMI,eAAgB,CACpD,IAAIoB,EAAoBxB,EAAMI,cAC7BzD,EACArN,EAAKmL,MAEF4G,KAAKC,OAAOE,IACX7E,EAAMuE,KAAeM,IACxBP,EAAYC,GACXM,EAAkB7E,EAAMuE,MAM9B,OAAOD,I,iCAGI,IAAD,SAC6E9S,KAAKzB,MAA9E0B,GADJ,EACFkB,KADE,EACIlB,OAAOtB,EADX,EACWA,WAAYyC,EADvB,EACuBA,eAAgBC,EADvC,EACuCA,WAAYC,EADnD,EACmDA,WAAYC,EAD/D,EAC+DA,UACzE,GAAI5C,EACH,GAAI4C,EACHvB,KAAKiB,SAAS,CAACxC,SAAS,EAAMC,YAAY,IAC1C0C,EAAgBzC,EAAW6B,KAC1B,CACCgB,IAAK7C,EAAW8C,SAChBC,KAAM,UACNC,OAAQ3B,KAAKxB,MAAMK,MACnB0B,KAAM,GACNN,MAAOoB,IAEPO,MAAK,SAAArB,GACFsB,SAASC,WAAWR,IACvBA,EAAWf,EAAM,EAAK/B,MAAMK,OAE7B,EAAKoC,SAAS,CAACxC,SAAS,IACxB,EAAK2B,YAAYG,MAblB,OAcS,SAAAwB,GACR,EAAKd,UAAS,SAAAzC,GAAK,MAAK,CACvBO,QAAS,GACTL,WAAYqD,EACZtD,SAAS,aAIP,CACJ,IAAI8B,EAAOF,MAAMC,QAAQL,EAAMM,KAAK5B,EAAW6B,OAAQP,EAAMM,KAAK5B,EAAW6B,MAAQ,GACjFqB,SAASC,WAAWR,IACvBA,EAAWf,EAAMP,KAAKxB,MAAMK,OAE7BmB,KAAKI,YAAYG,QAIlBP,KAAKiB,UAAS,SAAAzC,GAAK,MAAK,CACvBO,QAAS,GACTL,WAAY,CAAEsD,IAAK,qCACnBvD,SAAS,Q,oCAKY,IAAD,OAAX8B,EAAW,uDAAN,KAAM,EACcP,KAAKzB,MAAjC4C,EADc,EACdA,KAAMlB,EADQ,EACRA,MAAOtB,EADC,EACDA,WACjBsD,EAAc5B,MAAMC,QAAQC,GAAOA,EAAQF,MAAMC,QAAQL,EAAMM,KAAK5B,EAAW6B,OAASP,EAAMM,KAAK5B,EAAW6B,MAAQ,GACtH2B,EAAUxD,EAAaA,EAAWuD,MAAMC,QAAU,GAClDmR,EAAgB,GAIpB,GAAIzR,SAASC,WAAWnD,EAAWyD,MAAMC,QAAQ0P,UAAUxP,aAC1D5D,EAAWyD,MAAMC,QAAQ0P,UACvBxP,YAAYN,GAAa,GACzBL,MAAK,SAAAY,GACD,EAAKtC,QACR,EAAKe,UAAS,SAAAzC,GAAK,MAAK,CACvBqR,SAAU5N,EACVlD,QAASyD,EACT/D,SAAS,OAGV,EAAKD,MAAMO,QAAUyD,EACrB,EAAKhE,MAAMC,SAAU,MAXxB,OAcQ,SAAAsD,GACF,EAAK7B,QACR,EAAKe,UAAS,SAAAzC,GAAK,MAAK,CACvBqR,SAAU,GACV9Q,QAAS,GACTN,SAAS,OAGV,EAAKD,MAAMO,QAAU,GACrB,EAAKP,MAAMC,SAAU,UAGlB,CACN6U,EAAgBC,KAAkBC,gCACjCvR,EACAE,EACAhB,EAAKmL,MAEN,IAAImH,EAAOzT,KACP0T,EAAcJ,EAAcrI,KAAI,SAAAuD,GACnC,OAAOiF,EAAKE,UAAUnF,MAEvBxO,KAAKiB,UAAS,SAAAzC,GAAK,MAAK,CAAEO,QAAS2U,S,+BAI3B,IAAD,EACiD1T,KAAKzB,MAAtDmE,EADA,EACAA,QAAS/D,EADT,EACSA,WAAYiE,EADrB,EACqBA,IAAYgO,GADjC,EAC0B3Q,MAD1B,EACiC2Q,aACnCgD,EAAgB,CACrBC,WAAY,WACZzD,QAAQ,EACR0D,gBAAiB,CAChBC,UACEpV,EAAaA,EAAWgM,MAAQ,WACjC,OACA,IAAIxE,MAAOC,OAAO,iBAClB,OACD4N,UAAW,KAEZC,kBAAkB,EAClBC,eAAgB,OAChBC,WAAY,SACZC,YAAY,EACZC,UAAU,EAYVC,oBAAqB,SAACC,EAAcC,EAAaC,GAChD1I,QAAQC,IAAI,mCAAoCuI,GAChDxI,QAAQC,IAAI,kCAAmCwI,KAmBjD,OACC,kBAAC3R,EAAA,EAAD,CAAeC,UAAWJ,EAAQK,MACjC,kBAACC,EAAA,EAAD,CAAUF,UAAU,UAAUG,GAAI,IAC/BjD,KAAKxB,MAAMC,SAAW,kBAACoE,EAAA,EAAD,CAAeC,UAAWJ,EAAQmK,YAAaC,QAAQ,SAASC,WAAW,UAChG,kBAAC/J,EAAA,EAAD,CAAUC,GAAI,GAAIH,UAAU,0BAC3B,yBAAKA,UAAU,aACd,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAO0K,MAAO,OAEjC,yBAAKxL,UAAU,QACd,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,GAAIlG,UAAU,qBAC5D,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,GAAIlG,UAAU,qBAC5D,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,GAAIlG,UAAU,qBAC5D,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,GAAIlG,UAAU,uBAI9D,kBAACE,EAAA,EAAD,CAAUC,GAAI,IACb,kBAACoL,GAAA,EAAD,CAAUzK,QAAQ,OAAO0K,MAAO,OAAQtF,OAAQ,GAAIlG,UAAU,SAC9D,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAO0K,MAAO,OAAQtF,OAAQ,GAAIlG,UAAU,SAC9D,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAO0K,MAAO,OAAQtF,OAAQ,GAAIlG,UAAU,SAC9D,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAO0K,MAAO,OAAQtF,OAAQ,GAAIlG,UAAU,YAI/D9C,KAAKxB,MAAMC,SAAW4B,MAAMC,QAAQN,KAAKxB,MAAMO,UAAa,kBAAC8D,EAAA,EAAD,CAAeC,UAAU,WACvF,kBAACD,EAAA,EAAD,CAAeC,UAAU,WACxB,kBAACE,EAAA,EAAD,CAAUF,UAAU,UAAUG,GAAI,IAChB,YAAhB2N,GAA6B,kBAAC8D,GAAA,EAAD,CAAmBC,cAAe3U,KAAK0Q,4BAA6BkE,YAAa5U,KAAK0Q,6BAClH,kBAACmE,EAAA,EAAD,CACCjC,KAA4B,OAAtB5S,KAAKxB,MAAMuR,OACjB+E,QAAS9U,KAAK0Q,4BACdqE,gBAAgB,iBAChBC,eAAuC,OAAtBhV,KAAKxB,MAAMuR,QAAyC,OAAtB/P,KAAKxB,MAAMsR,OAAiB,CAAEmF,IAAKjV,KAAKxB,MAAMuR,OAAQmF,KAAMlV,KAAKxB,MAAMsR,aAAWqC,GAEjI,kBAACgD,EAAA,EAAD,CAAUxV,QAAUK,KAAK0Q,6BAAzB,QACA,kBAACyE,EAAA,EAAD,CAAUxV,QAAUK,KAAK0Q,6BAAzB,SACA,kBAACyE,EAAA,EAAD,CAAUxV,QAAUK,KAAK0Q,6BAAzB,aACA,kBAACyE,EAAA,EAAD,CAAUxV,QAAUK,KAAK0Q,6BAAzB,WAIF1Q,KAAKxB,MAAMO,QAAQyO,OAAS,EAC5B,kBAAC,KAAD,CACCnO,OACEuD,EAAInE,QAAU,WAAa,IAC5BE,EAAWgM,OACV/H,EAAInE,QAAU,MAAQ,IAExB8B,KAAMP,KAAKxB,MAAMO,QACjBoD,QAASnC,KAAKxB,MAAMoR,WACpBqB,QAAS2C,IAGV,kBAAC/Q,EAAA,EAAD,CACCC,UAAU,UACVgK,QAAQ,SACRC,WAAW,UAEX,yBACCW,IAAI,aACJ5K,UAAWJ,EAAQiL,WACnBC,IAAKC,MAEN,kBAAClK,EAAA,EAAD,CACCb,UAAWJ,EAAQoL,UACnBpO,MAAM,OACNkE,QAAQ,QACRC,QAAM,EACNC,WAAS,GALV,KAOI,IACFnF,EAAWgM,MACThM,EAAWgM,MACX,UAAW,IAVf,cAiBF/H,IAAMA,EAAIwS,MAAQxS,EAAIc,QACvB,kBAACb,EAAA,EAAD,KACC,kBAACG,EAAA,EAAD,CAAUC,GAAI,IACb,kBAACU,EAAA,EAAD,CACCjE,MAAM,QACNkE,QAAQ,QACRC,QAAM,EACNC,WAAS,GAER,wBAA0BlB,EAAIc,MAAM1B,IAAK,wC,GAlyB5B+B,IAAMC,WA4zB9B2L,GAAU1L,aAAe,CACxByD,cAAc,EACduH,YAAY,EACZpQ,MAAO,CAAEC,EAAG,GACZuC,YAAY,EACZE,WAAW,EACXqP,YAAa,UAGd,IAMelM,gBACdN,IACCC,KCx2Ba,SAAAC,GAAK,MAAK,CACxBvB,KAAM,CACLwB,QAAS,KAEV+M,qBAAsB,CACrBvG,QAAS,eACTsK,WAAY,SACZ,QAAS,CACRtK,QAAS,eACTsK,WAAY,WAGd/C,UAAW,CACVgD,OAAQhR,EAAMmB,QAAQ,KAEvBkI,WAAY,CACX4H,SAAU,IACVjH,MAAO,QAERR,UAAW,CACV0H,UAAWlR,EAAMmB,QAAQ,QDq1BzBjB,aATsB,SAAChG,EAAOiG,GAAR,MAAsB,CAC7CtD,KAAM3C,EAAM2C,KACZlB,MAAOzB,EAAMyB,MACb2C,IAAIpE,EAAMoE,OAMgB,CAAEzD,iBAAYC,kBAAagC,uBAFrDgD,CAGEuL,KEzzBH,SAAS8F,GAAuBlX,GAC/B,IAAM+F,EAAQoR,cACNC,EAA2CpX,EAA3CoX,MAAOC,EAAoCrX,EAApCqX,KAAMC,EAA8BtX,EAA9BsX,YAAaC,EAAiBvX,EAAjBuX,aAmBlC,OACC,yBAAKhT,UAAW,sBACf,kBAAC8H,EAAA,EAAD,CACCjL,QAnBgC,SAACT,GACnC4W,EAAa5W,EAAO,IAmBlB6W,SAAmB,IAATH,EACV5L,aAAW,cAEU,QAApB1F,EAAM0R,UAAsB,kBAAC,IAAD,MAAmB,kBAAC,IAAD,OAEjD,kBAACpL,EAAA,EAAD,CAAYjL,QArBgB,SAACT,GAC9B4W,EAAa5W,EAAO0W,EAAO,IAoBkBG,SAAmB,IAATH,EAAY5L,aAAW,iBACvD,QAApB1F,EAAM0R,UAAsB,kBAAC,IAAD,MAAyB,kBAAC,IAAD,OAEvD,kBAACpL,EAAA,EAAD,CACCjL,QArB2B,SAACT,GAC9B4W,EAAa5W,EAAO0W,EAAO,IAqBzBG,SAAUH,GAAQK,KAAKC,KAAKP,EAAQE,GAAe,EACnD7L,aAAW,aAEU,QAApB1F,EAAM0R,UAAsB,kBAAC,IAAD,MAAwB,kBAAC,IAAD,OAEtD,kBAACpL,EAAA,EAAD,CACCjL,QAxB+B,SAACT,GAClC4W,EAAa5W,EAAO+W,KAAKE,IAAI,EAAGF,KAAKC,KAAKP,EAAQE,GAAe,KAwB/DE,SAAUH,GAAQK,KAAKC,KAAKP,EAAQE,GAAe,EACnD7L,aAAW,aAEU,QAApB1F,EAAM0R,UAAsB,kBAAC,IAAD,MAAoB,kBAAC,IAAD,Q,IAc/CI,G,kDA0BL,WAAY7X,GAAQ,IAAD,uBAClB,cAAMA,IA1BPC,MAAQ,CACPG,WAAY,KACZC,QAAS,KACTqH,KAAM,YACN7D,MAAO,GACPiU,iBAAiB,EACjBC,YAAY,EACZC,cAAe,GACf1X,MAAO,GACP2X,MAAO,GACPZ,KAAM,EACNa,iBAAkB,KAClBC,WAAY,GACZC,yBAAyB,EACzBC,iBAAkB,GAClBC,eAAe,EACfC,iBAAkB,KAClBC,QAAS,CACRC,OAAQ,GACRC,OAAQ,KAMS,EAHnB/W,SAAU,EAGS,EAFnBgX,iBAAmBnT,IAAMiC,YAEN,EAyFnBmR,oBAAsB,SAAA3W,GAAI,OAAI,SAAAtB,GACzB,EAAKgB,QACR,EAAKe,SAAS,CAAEgF,KAAMzF,EAAMiW,iBAAkB,QAE9C,EAAKjY,MAAMyH,KAAOzF,EAClB,EAAKhC,MAAMiY,iBAAmB,QA9Fb,EAkGnBW,oBAAsB,SAAAlY,GACrB,IAAMuX,EAAmBvX,EAAMmY,cAC3B,EAAKnX,QACR,EAAKe,SAAS,CAAEwV,iBAAkBA,IAElC,EAAKjY,MAAMiY,iBAAmBA,GAvGb,EA2GnBa,qBAAuB,WAClB,EAAKpX,QACR,EAAKe,SAAS,CAAEwV,iBAAkB,OAElC,EAAKjY,MAAMiY,iBAAmB,MA/Gb,EAmHnBc,oBAAsB,SAACrY,EAAO0W,GAC7B,EAAK3U,UAAS,SAAAF,GAAS,MAAK,CAC1B6U,KAAMA,EAAK,EACX/W,MAAM,2BACFkC,EAAUlC,OADT,IAEJ+W,KAAMA,EAAK,IAEZa,iBAAkB,UA1HF,EA8HnBe,8BAAgC,SAACtY,GAChC,IAAMkV,EAAaqD,OAAOC,YAAYxY,EAAMyY,OAAOpN,MAAO,EAAK/L,MAAMK,MAAMuV,YAC3E,EAAKnT,UAAS,SAAAF,GAAS,MAAK,CAC1B6U,KAAM,EACN/W,MAAM,2BACFkC,EAAUlC,OADT,IAEJuV,WAAYA,SApIG,IAGVzV,EAA2CJ,EAA3CI,WAAYC,EAA+BL,EAA/BK,QAASC,EAAsBN,EAAtBM,MAAcoN,GAAQ1N,EAAf0B,MAAe1B,EAAR0N,KAC3C,EAAKzN,MAAMG,WAAaA,EACxB,EAAKH,MAAMI,QAAUA,EACrB,EAAKJ,MAAMK,MAAQA,EAAK,2BACpBA,GADoB,IAEvBC,EAAG,EACHsV,WAAa,QAASvV,EAAOA,EAAK,IAAW,eAAgBA,EAAOA,EAAK,WAAiBoN,EAAI2L,YAAYrX,KAAK6T,WAC/GwB,KAAO,OAAQ/W,EAAOA,EAAK,GAAU,SAAUA,EAAOA,EAAK,KAAW,IACnE,CACHC,EAAG,EACHsV,WAAa,QAASvV,EAAOA,EAAK,IAAW,eAAgBA,EAAOA,EAAK,WAAiBoN,EAAI2L,YAAYrX,KAAK6T,WAC/GwB,KAAO,OAAQ/W,EAAOA,EAAK,GAAU,SAAUA,EAAOA,EAAK,KAAW,GAGvE,IAAI+X,EAAmB,GAClBC,GAAgB,EAChBN,EAAgB,GAMpB,GALA5V,OAAOiR,QAAQjT,EAAWuD,MAAMC,SAAS8I,KAAI,WAA8BiH,GAAY,IAAD,mBAAvC2F,EAAuC,KAA1BC,EAA0B,KAChF,CAAC,OAAQ,UAAW,WAAY,WAAY,UAAW,MAAO,OAAQ,SAAU,eAAeC,SAASD,EAAa1F,MAAM1Q,QAC/HkV,EAAiBiB,GAAeC,MAG9B5E,KAAKC,OAAOtU,GAAQ,CACvB,IAAImZ,GAAuB,EACvBC,EAAoBtX,OAAO4Q,KAAKqF,GACpCjW,OAAOiR,QAAQ/S,GAAOoM,KAAI,YAAgC,IAAD,mBAA7BiN,EAA6B,KAAhBC,EAAgB,MACnDH,GAAwBC,EAAkBF,SAASG,KACvDrB,EAAgBqB,EAChB3B,EAAgB4B,EAEf5B,EADGzF,OAAOC,SAASoH,GACHA,EAGArH,OAAOqH,GAExBH,GAAuB,MAtCT,OA4CbnB,IAAkBhY,EAAMuZ,IAAKvZ,EAAMA,OASvC,EAAKL,MAAM+X,cAAgBA,EAC3B,EAAK/X,MAAMqY,cAAgBA,GATvBhY,EAAMuZ,EACT,EAAK5Z,MAAM+X,cAAgB1X,EAAMuZ,EAGjC,EAAK5Z,MAAM+X,cAAgB1X,EAAMA,MASnC,EAAKsY,oBAAsB,EAAKA,oBAAoBpX,KAAzB,gBAC3B,EAAKwX,oBAAsB,EAAKA,oBAAoBxX,KAAzB,gBAE3B,EAAKyX,8BAAgC,EAAKA,8BAA8BzX,KAAnC,gBA7DnB,E,gEAmElBC,KAAKE,SAAU,EACfF,KAAKqY,qB,6CAILrY,KAAKE,SAAU,I,8CAGQO,GAEvB,OADAT,KAAKE,SAAU,EACR,CACNoY,0BAA2B3X,OAAOC,SAASH,EAAU5B,MAAOmB,KAAKzB,MAAMM,U,yCAItD4B,EAAWM,EAAWC,GACxChB,KAAKE,SAAU,EACXc,EAASsX,0BACZtY,KAAKqY,qB,iMAuDN,G,EAD+ErY,KAAKzB,MAA5EI,E,EAAAA,WAAYC,E,EAAAA,QAASC,E,EAAAA,MAAOoH,E,EAAAA,KAAMoQ,E,EAAAA,gBAAiBC,E,EAAAA,WAAYrK,E,EAAAA,IACnEtN,GAAcC,EAAS,CACtB2Z,EAAY,CACfxG,UAAW,aACX3D,SAAU,YACV9L,cAAe,WACfkW,cAAe,kBACf5L,aAAc,iBAEXxK,EAAQ,GACRqW,EAAe,YACf9Z,EAAWyD,MAAMC,QAAjB,WAAoCkW,IACvCE,EAAe9Z,EAAWyD,MAAMC,QAAjB,SAEhB,UAA0B1B,OAAOiR,QAAQ2G,GAAzC,eAAsD,EAAD,oBAA3C/X,EAA2C,KAArCmK,EAAqC,KAChDnK,KAAQ7B,EAAWyD,MAAMC,UAC5BD,EAAM5B,GAAQmK,GAGZiM,EAAmB,GACnBC,GAAgB,EAChBN,EAAgB,GACpB5V,OAAOiR,QAAQjT,EAAWuD,MAAMC,SAAS8I,KAAI,WAA8BiH,GAAY,IAAD,mBAAvC2F,EAAuC,KAA1BC,EAA0B,KAChF,CAAC,OAAQ,UAAW,WAAY,WAAY,UAAW,MAAO,OAAQ,SAAU,eAAeC,SAASD,EAAa1F,MAAM1Q,QAC/HkV,EAAiBiB,GAAeC,MAG9B5E,KAAKC,OAAOtU,KACXmZ,GAAuB,EACvBC,EAAoBtX,OAAO4Q,KAAKqF,GACpCjW,OAAOiR,QAAQ/S,GAAOoM,KAAI,YAAgC,IAAD,mBAA7BiN,EAA6B,KAAhBC,EAAgB,MACnDH,GAAwBC,EAAkBF,SAASG,KACvDrB,EAAgBqB,EAChB3B,EAAgB4B,EAEf5B,EADGzF,OAAOC,SAASoH,GACHA,EAGArH,OAAOqH,GAExBH,GAAuB,OAK1BjM,QAAQC,IAAI,wBAAyB,yBACjChM,KAAKE,QACRF,KAAKiB,UAAS,SAAAzC,GAAK,MAAK,CACvBG,WAAYA,EACZC,QAASA,EACTC,MAAOA,EAAK,2BACRA,GADQ,IAEXC,EAAG,EACHsV,WAAa,QAASvV,EAAOA,EAAK,IAAW,eAAgBA,EAAOA,EAAK,WAAiBoN,EAAI2L,YAAYrX,KAAK6T,WAC/GwB,KAAO,OAAQ/W,EAAOA,EAAK,GAAU,SAAUA,EAAOA,EAAK,KAAW,IACnE,CACHC,EAAG,EACHsV,WAAa,QAASvV,EAAOA,EAAK,IAAW,eAAgBA,EAAOA,EAAK,WAAiBoN,EAAI2L,YAAYrX,KAAK6T,WAC/GwB,KAAO,OAAQ/W,EAAOA,EAAK,GAAU,SAAUA,EAAOA,EAAK,KAAW,GAEvEuD,MAAOA,EACP6D,KAAMA,GAAcwS,EACpBpC,gBAAiBA,EACjBC,WAAYA,EACZM,iBAAkBA,EAClBL,cAAeA,EACfM,cAAeA,MAIhB7W,KAAKxB,MAAL,2BACIwB,KAAKxB,OADT,IAECG,WAAYA,EACZC,QAASA,EACTC,MAAOA,EAAK,2BACRA,GADQ,IAEXC,EAAG,EACHsV,WAAa,QAASvV,EAAOA,EAAK,IAAW,eAAgBA,EAAOA,EAAK,WAAiBoN,EAAI2L,YAAYrX,KAAK6T,WAC/GwB,KAAO,OAAQ/W,EAAOA,EAAK,GAAU,SAAUA,EAAOA,EAAK,KAAW,IACnE,CACHC,EAAG,EACHsV,WAAa,QAASvV,EAAOA,EAAK,IAAW,eAAgBA,EAAOA,EAAK,WAAiBoN,EAAI2L,YAAYrX,KAAK6T,WAC/GwB,KAAO,OAAQ/W,EAAOA,EAAK,GAAU,SAAUA,EAAOA,EAAK,KAAW,GAEvEuD,MAAOA,EACP6D,KAAMA,GAAcwS,EACpBpC,gBAAiBA,EACjBC,WAAYA,EACZM,iBAAkBA,EAClBL,cAAeA,EACfM,cAAeA,I,qIAMT,IAAD,SAC6J7W,KAAKzB,MAAlKmE,EADA,EACAA,QAASvB,EADT,EACSA,KAAaxC,GADtB,EACeE,MADf,EACsBF,YAAqBsB,GAD3C,EACkCrB,QADlC,EAC2CqB,OAAYyY,GADvD,EACkD9V,IADlD,EACuD8V,gBAAgBC,EADvE,EACuEA,WAAYtX,EADnF,EACmFA,WAAYC,EAD/F,EAC+FA,WAAYC,EAD3G,EAC2GA,UAAW6G,EADtH,EACsHA,aACtHnC,GAFA,EACoI2S,qBAC3H5Y,KAAKxB,MAAdyH,MACR,OACC,kBAACpD,EAAA,EAAD,CAAeC,UAAU,WACxB,kBAACD,EAAA,EAAD,CAAeC,UAAU,WACvB9C,KAAKxB,MAAM6X,iBACX,kBAACrT,EAAA,EAAD,CAAUqH,GAAI,GAAIC,GAAI,GAEnB3J,OAAOiR,QAAQ5R,KAAKxB,MAAM4D,OAAO6I,KACjC,WAAgBC,GAAhB,uBAAE1K,EAAF,KAAQmK,EAAR,YACC,kBAACkO,EAAA,EAAD,CACCnZ,MAAO,UACPkE,QAASpD,IAASyF,EAAM,YAAc,OACtCtG,QAAS,SAACT,GACT6M,QAAQC,IAAIxL,GACZ,EAAKS,SAAS,CAAEgF,KAAMzF,EAAMiW,iBAAkB,QAE/CnL,IAAK,YAAY9K,GAEhBmK,OAMN3K,KAAKxB,MAAM8X,YACX3X,IACCA,EAAWwN,OAAO5M,QAAQ6P,OAAO/C,WACjClL,EAAKmL,OAEL,kBAACtJ,EAAA,EAAD,CACCqH,GAAI,GACJC,GAAItK,KAAKxB,MAAM6X,gBAAkB,EAAI,IAEpC1X,EAAWwN,OAAO5M,QAAQ6P,OAAOsC,KAAKC,OAAtC,QACA,CAAE7O,UAAW,kBAMlB,kBAACD,EAAA,EAAD,CAAeC,UAAU,WACrB6V,GAAuB,kBAAT1S,GAA6B,kBAACjD,EAAA,EAAD,CAAUC,GAAI,GAAIH,UAAU,gBACzE,kBAACD,EAAA,EAAD,CAAeC,UAAU,WAGxB,kBAACE,EAAA,EAAD,CAAUC,GAAI,GAAIH,UAAW,OAC5B,kBAACgW,EAAA,EAAD,CACCC,SAAU/Y,KAAKxB,MAAMmY,wBACrB7T,UAAU,MACVc,QAAQ,YASR,kBAACoV,EAAA,EAAD,CACChK,UAAU,OACVrF,UAAW,EACX7G,UAAWJ,EAAQuW,WACnBC,SAAU,SAAAha,GACTA,EAAMqR,iBACN,EAAKtP,UAAS,SAAAF,GAAS,MAAK,CAC3BlC,MAAOkC,EAAU8V,cAAV,2BAA6B9V,EAAUlC,OAAvC,kBAA+CkC,EAAU8V,cAAgB9V,EAAUwV,gBAAnF,2BAAwGxV,EAAUlC,OAAlH,IAAyHuZ,EAAGrX,EAAUwV,oBAE9IxK,QAAQC,IAAI,8BAA+B,EAAKxN,MAAM+X,kBAGrDvW,KAAKxB,MAAMqY,eAAiB,kBAACjM,EAAA,EAAD,CAC7B9H,UAAWJ,EAAQyW,iBACnBnP,aAAW,SACXrK,QAAS,SAACT,GACTA,EAAMqR,iBACN,EAAKtP,SAAS,CAAC6V,iBAAkB5X,EAAMmY,kBAGxC,kBAAC,IAAD,OAECrX,KAAKxB,MAAMqY,eAAiB7W,KAAKxB,MAAMoY,iBAAiB5W,KAAKxB,MAAMqY,gBAAkB,kBAACgC,EAAA,EAAD,CACtF7O,aAAW,SACXiD,KAAM,QACNvN,MAAM,YACNC,QAAS,SAACT,GACTA,EAAMqR,iBACN,EAAKtP,SAAS,CAAC6V,iBAAkB5X,EAAMmY,kBAGvCxV,SAASC,WAAW9B,KAAKxB,MAAMoY,iBAAiB5W,KAAKxB,MAAMqY,eAAelM,OAAQ3K,KAAKxB,MAAMqY,cAAcuC,WAAapZ,KAAKxB,MAAMoY,iBAAiB5W,KAAKxB,MAAMqY,eAAelM,OAEhL,kBAACkK,EAAA,EAAD,CACOnI,GAAG,qBACH2M,SAAUrZ,KAAKxB,MAAMsY,iBACrBwC,aAAW,EACX1G,KAAM2G,QAAQvZ,KAAKxB,MAAMsY,kBACzBhC,QAAS,kBAAM,EAAK7T,SAAS,CAAC6V,iBAAkB,SAE/CnW,OAAOiR,QAAQ5R,KAAKxB,MAAMoY,kBAAkB3L,KAAI,WAA0CiH,GAA1C,uBAAEsH,EAAF,KAAmBC,EAAnB,YAChD,kBAACtE,EAAA,EAAD,CACCxV,QAAS,WACR,EAAKsB,SAAS,CAAC4V,cAAgB,EAAKrY,MAAMqY,gBAAkB2C,GAAyBA,EAAkB1C,iBAAkB,SAGzHjV,SAASC,WAAW2X,EAAqB9O,OAAQ6O,EAAgBJ,WAAaK,EAAqB9O,WAI7G,kBAAC,IAAD,CACC7H,UAAWJ,EAAQgX,YACnBC,YAAY,YACZC,WAAY,CAAE,aAAc,UAC5BC,aAAc7Z,KAAKxB,MAAM+X,cACzBuD,QAAS,WACH,EAAKtb,MAAMmY,yBACf,EAAK1V,SAAS,CAAE0V,yBAAyB,KAG3CnM,SAAU,SAAAuP,GACT,EAAK9Y,UAAS,SAAAF,GACb,IAAIiZ,EAAW,CAAEzD,cAAewD,GAChC,GAAIhZ,EAAUlC,OACTkC,EAAUlC,MAAMuZ,EAAG,CACtB,IAAI6B,EAAW/G,KAAKgH,SAASnZ,EAAUlC,cAChCob,EAAQ,EACfD,EAASnb,MAAQob,EAGnB,OAAOD,MAGTpW,QAAS,OACTiH,IAAK,SAAAA,GAAG,OAAK,EAAKqM,iBAAmBrM,KAEtC,kBAACD,EAAA,EAAD,CACClJ,KAAK,SAASoB,UAAWJ,EAAQyX,iBAAkBnQ,aAAW,UAC9D,kBAAC,IAAD,QAOF,kBAACoQ,EAAA,EAAD,CAAkBtX,UAAW,OACzBnC,OAAO4Q,KAAKvR,KAAKxB,MAAMuY,QAAQC,QAAQxJ,OAAS,GAAK,kBAAC3K,EAAA,EAAD,CAAeC,UAAU,OAC9EnC,OAAOiR,QAAQ5R,KAAKxB,MAAMuY,QAAQE,QAAQhM,KAAI,WAA8BiH,GAAY,IAAD,mBAAvCmI,EAAuC,KAA1BC,EAA0B,KACtF,OACC,kBAACjI,GAAA,EAAD,CACCvP,UAAU,qBACVpD,MAAM,YACNiL,OAAQmG,OAAOC,SAASpS,EAAWuD,MAAMC,QAAQkY,GAAa1P,OAAShM,EAAWuD,MAAMC,QAAQkY,GAAa1P,MAAM,MAAS,IAAI2P,EAChI1W,QAAQ,WACRqG,MAAO,CAACsL,SAAU,KAClBjK,IAAK,eAAe4G,aAc/B,kBAAClP,EAAA,EAAD,CAAUC,GAAI,GAAIH,UAAU,WAClB,aAARmD,GAAuB,kBAAC,GAAD,CACtBtH,WAAYA,EACZC,QAASoB,KAAKxB,MAAMI,QACpBC,MAAOmB,KAAKxB,MAAMK,MAClBwC,WAAYA,EACZE,UAAWA,EACXD,WAAYA,EACZ8G,aAAcA,IAGN,kBAATnC,GACA,kBAACsU,GAAA,QAAD,CACCtK,QAAStR,EAAW6B,KACpB5B,QAASoB,KAAKxB,MAAMI,QACpBC,MAAOmB,KAAKxB,MAAMK,MAClBwC,WAAYA,EACZE,UAAWA,EACXD,WAAYA,EACZ8G,aAAcA,IAIN,iBAATnC,GACA,kBAAC,GAAD,CACCtH,WAAYA,EACZC,QAASoB,KAAKxB,MAAMI,QACpBC,MAAOmB,KAAKxB,MAAMK,MAClBwC,WAAYA,EACZE,UAAWA,EACXD,WAAYA,EACZ8G,aAAcA,IAIN,aAATnC,GACA,kBAAC,GAAD,CACCtH,WAAYA,EACZC,QAASoB,KAAKxB,MAAMI,QACpBC,MAAOmB,KAAKxB,MAAMK,MAClBwC,WAAYA,EACZE,UAAWA,EACXD,WAAYA,EACZ8G,aAAcA,MAOfsQ,GAA0B,iBAARzS,GAA4B,kBAACpD,EAAA,EAAD,CAAeC,UAAU,gBACzE,kBAACE,EAAA,EAAD,CAAUC,GAAI,GAAIH,UAAU,wCAC3B,kBAAC0X,EAAA,EAAD,CACC7E,MAAOhX,EAAW6B,QAAQP,EAAM6L,IAAK7L,EAAM6L,IAAInN,EAAW6B,MAAMmV,MAAQ,EACxEC,KAAMjX,EAAW6B,QAAQP,EAAM6L,IAAK7L,EAAM6L,IAAInN,EAAW6B,MAAMoV,KAAK,EAAI5V,KAAKxB,MAAMoX,KAAK,EACxFC,YAAa7V,KAAKxB,MAAMK,MAAMuV,WAC9B0B,aAAc9V,KAAKuX,oBACnBkD,iBAAkB,mBAClBC,mBAAoB,CAAC,EAAG,GAAI,GAAI,GAAI,IAAK,CAAEnQ,OAAQ,EAAGI,MAAO,QAC7DgQ,oBAAqB3a,KAAKwX,8BAC1BoD,iBAAkBnF,GAClBoF,YAAa,CACZlQ,MAAO,mBACP/G,QAAS,YAEVlB,QAAS,CACRoY,QAAS,kC,GAhfS/W,IAAMC,WA6gBhCoS,GAAYnS,aAAe,CAC1ByD,cAAc,EACduH,YAAY,EACZoH,iBAAiB,EACjBC,YAAY,EACZoC,gBAAgB,EAChBC,YAAY,EACZC,qBAAsB,SACtB/Z,MAAO,GACP0C,WAAW,EACXF,YAAY,GAUE+C,QACdC,KC5oBc,SAAAC,GAAK,MAAK,CACxBvB,KAAM,CACLwB,QAASD,EAAMmB,UACfZ,gBAAiBP,EAAMkL,QAAQtF,WAAW6Q,OAE3CxS,SAAU,CACTyS,YAAa,kBAAoBlW,KAAOyG,IAAIC,KAAO,oBACnDyP,WAAY,kBAAoBnW,KAAOyG,IAAIC,KAAO,qBAEnD0P,aAAc,CACbhR,WAAYpF,KAAOC,IAAI0G,QACvB/L,MAAOoF,KAAOC,IAAIoW,QAClBC,OAAQ,YAActW,KAAOC,IAAI0G,SAElC4P,aAAc,CACbC,SAAU,sBACVC,MAAOjX,EAAMmB,WAEdwT,WAAY,CACX1U,QAAS,UACTwG,QAAS,OACTgC,WAAY,SACZuB,MAAO,OACPgH,OAAQ,GAEToE,YAAa,CACZ8B,WAAYlX,EAAMmB,QAAQ,GAC1BgW,KAAM,GAEPtB,iBAAkB,CACjB5V,QAAS,IAEVmX,cAAe,CACd1S,OAAQ,GACRsM,OAAQ,OD2mBT9Q,aATuB,SAAAhG,GAAK,MAAK,CACjC2C,KAAM3C,EAAM2C,KACZlB,MAAOzB,EAAMyB,MACb2C,IAAKpE,EAAMoE,IACXqJ,IAAKzN,EAAMyN,OAKc,IACzBvH,KAHcN,CAIbgS,K,2gBEhmBEuF,IAAY,EAcVpB,G,kDAuBL,WAAYhc,GAAQ,IAAD,uBAClB,cAAMA,IAvBPC,MAAQ,CACPod,YAAa,GACbC,SAAU,GACVld,WAAY,KACZC,QAAS,KACTkd,YAAY,EACZC,uBAAuB,EACvBC,kBAAmB,GACnB/L,QAAS,cACTgM,cAAe,KACf9Y,YAAa,GACb+Y,eAAe,EACfC,kBAAmB,GACnBC,eAAgB,GAChBhZ,KAAM,GACNvE,MAAO,GACPE,QAAS,GACTuE,QAAS,GACTC,QAAS,GACTF,UAAW,IAGO,EAqFnBgZ,aAAc,SAACzJ,GAAD,OAAU,SAAC1T,KACpBA,GAAwB,YAAfA,EAAMwC,MAAqC,QAAdxC,EAAMoM,KAA+B,UAAdpM,EAAMoM,MAGnEsH,IAAS,EAAKpU,MAAMsd,YACvB,EAAK7a,UAAS,SAAAzC,GAAK,MAAK,CAAEsd,WAAYlJ,QA1FrB,EAiInB0J,oCAAsC,SAACpd,EAAOqd,GAAc,IAAD,EACjB,EAAKhe,MAAtCqd,EADkD,EAClDA,YAAaC,EADqC,EACrCA,SAAU5b,EAD2B,EAC3BA,MAE/B,EAAKgB,UAAS,SAAAzC,GAAK,MAAK,CACvByR,QAAUsM,EACVN,cAAe,KACfO,gBAAiB,CAAC,cAAe,UAAUzE,SAASwE,IAAYlc,MAAMC,QAAQL,EAAMM,KAAKgc,IAAYtc,EAAMM,KAAKgc,GAAkB,GAClI5d,WAAY,CAAC,cAAe,UAAUoZ,SAASwE,GAAWX,EAAYW,GAAY/d,EAAMG,WACxFC,QAAS,CAAC,cAAe,UAAUmZ,SAASwE,GAAWV,EAASU,GAAY/d,EAAMI,aAzIjE,EA6InB6d,0BAA4B,SAACC,EAAUC,GAAX,OAAsB,SAAAzd,GACjD6M,QAAQC,IAAI,mCAAoC2Q,EAAQ,YAAahB,IACjEA,KACDA,GAAUiB,MAAM,CAAEC,IAAKF,EAAOrB,SAASwB,SAAUC,IAAKJ,EAAOrB,SAAS0B,YACtErB,GAAU1L,QAAQgN,6CAA6CC,QAAQ,OAjJxD,EAwJnBC,0BAA4B,SAAClN,EAASmN,GAAmB,IAAD,EACH,EAAK7e,MAAjDqd,EAD+C,EAC/CA,YAAoBxa,GAD2B,EAClCnB,MADkC,EAC3BmB,gBAAgB6K,EADW,EACXA,IAC5C,EAAKhL,UAAS,SAACF,GACd,IAAIsc,EAAuBtc,EAAUob,kBAAkBmB,QAAQrN,GAC/D,MAAO,CACNkM,kBAAmBpb,EAAUob,kBAAkBpE,SAAS9H,GAAUlP,EAAUob,kBAAkBoB,cAAcF,GAAwBtc,EAAUob,kBAAkBqB,OAAO,CAACvN,OAH1K,sBAKG,sBAAAwN,EAAA,sDACE7B,EAAY3L,IAAYmN,EAE3Bhc,EAAgBwa,EAAY3L,GAASzP,KAAM,CAC1CgB,IAAKoa,EAAY3L,GAASxO,SAC1BC,KAAM,UACNC,OAAQuR,KAAKC,OAAO,EAAK3U,MAAM4d,eAAenM,IAAW,EAAKzR,MAAM4d,eAAenM,GAASpR,MAAQ,CAAC+W,KAAM,EAAGxB,WAAYnI,EAAI2L,YAAYrX,KAAK6T,WAAYsJ,SAAU,GACrKnd,KAAM,GACNN,OAAO,IACL2B,MAAK,SAAArB,GACHqb,EAAY3L,IAAYpO,SAASC,WAAY8Z,EAAY3L,GAAS7N,MAAMC,QAAQC,cAAcC,cAAiBlC,MAAMC,QAAQC,IAChIqb,EAAY3L,GAAS7N,MAAMC,QAAQC,cAAcC,YAAYhC,GAAM,GAAMqB,MAAK,SAAAY,GACzE,EAAKmb,YACR,EAAK1c,UAAS,SAAAF,GAAS,MAAK,CAC3B6c,mBAAqBhC,EAAY3L,GAAS7N,MAAMC,QAAQC,cAAcZ,KACtEua,cAAe1b,EAAKiN,OAAQ,EAAG,OAAI2E,EACnCiK,eAAe,2BACZrb,EAAUqb,gBADC,kBAEZnM,EAFY,2BAGTlP,EAAUqb,eAAenM,IAHhB,IAIZ4N,SAAUrb,EACVsb,QAASlC,EAAY3L,GAAS7N,MAAMC,QAAQC,cAAcZ,KAC1Dqc,QAAQ,WAMX,EAAKvf,MAAMof,mBAAqBhC,EAAY3L,GAAS7N,MAAMC,QAAQC,cAAcZ,KACjF,EAAKlD,MAAMyd,cAAgB1b,EAAKiN,OAAQ,EAAG,OAAI2E,EAC/C,EAAK3T,MAAM4d,eAAX,2BACI,EAAK5d,MAAM4d,gBADf,kBAEGnM,EAFH,2BAGM,EAAKzR,MAAM4d,eAAenM,IAHhC,IAIG4N,SAAUrb,EACVsb,QAASlC,EAAY3L,GAAS7N,MAAMC,QAAQC,cAAcZ,KAC1Dqc,QAAQ,aAjCf,OAwCS,SAAAhc,OAID6Z,EAAY3L,KAChB,EAAK0N,YACL,EAAK1c,UAAS,SAAAF,GAAS,MAAK,CAC3B6c,wBAAqBzL,EACrB8J,mBAAe9J,EACfiK,eAAe,2BACZrb,EAAUqb,gBADC,kBAEZnM,EAFY,2BAGTlP,EAAUqb,eAAenM,IAHhB,IAIZ4N,SAAU,GACVC,QAASlC,EAAY3L,GAAS7N,MAAMC,QAAQC,cAAcZ,KAC1Dqc,QAAQ,WAMX,EAAKvf,MAAMof,wBAAqBzL,EAChC,EAAK3T,MAAMyd,mBAAgB9J,EAC3B,EAAK3T,MAAM4d,eAAX,2BACI,EAAK5d,MAAM4d,gBADf,kBAEGnM,EAFH,2BAGM,EAAKzR,MAAM4d,eAAenM,IAHhC,IAIG4N,SAAU,GACVC,QAASlC,EAAY3L,GAAS7N,MAAMC,QAAQC,cAAcZ,KAC1Dqc,QAAQ,QAxEd,6CA/Je,EAqPnBC,wBAA0B,SAACxP,EAAOtD,GAGjC,EAAKjK,SAAS,CAAEgb,cAAe/Q,KAxPb,MAE6C,EAAK3M,MAApD0B,GAFE,EAEVge,OAFU,EAEFhe,OAAOgQ,EAFL,EAEKA,QAASiO,EAFd,EAEcA,SAAuBjS,GAFrC,EAEwB2P,YAFxB,EAEqC3P,KAFrC,OAGlB,EAAKkS,WAAapa,IAAMiC,YACxB,EAAKoY,iBACL,EAAK/B,aAAe,EAAKA,aAAatc,KAAlB,gBAEpB,EAAKse,gBAAkB,EAAKA,gBAAgBte,KAArB,gBACvB,EAAK0c,0BAA4B,EAAKA,0BAA0B1c,KAA/B,gBACjC,EAAKue,0BAA4B,EAAKA,0BAA0Bve,KAA/B,gBACjC,EAAKwe,+BAAiC,EAAKA,+BAA+Bxe,KAApC,gBACtC,EAAKye,gCAAkC,EAAKA,gCAAgCze,KAArC,gBACvC,EAAK0e,kCAAoC,EAAKA,kCAAkC1e,KAAvC,gBACzC,EAAK2e,8BAAgC,EAAKA,8BAA8B3e,KAAnC,gBACrC,EAAKuc,oCAAsC,EAAKA,oCAAoCvc,KAAzC,gBAC3C,EAAKie,wBAA0B,EAAKA,wBAAwBje,KAA7B,gBAC/B,EAAKod,0BAA4B,EAAKA,0BAA0Bpd,KAA/B,gBAEjC,EAAKvB,MAAL,2BACI,EAAKA,OADT,IAGCyR,QAASA,GAAkB,EAAKzR,MAAMyR,QACtC9M,YAAa8I,EAAI2L,YAAYrX,KAAKoe,eAClCzC,gBAAe7b,MAAMC,QAAQ4d,IAAWA,EAAS1Q,OAAS,EAC1D2O,kBAAmBlM,EAAS,CAACA,GAAU,GACvCmM,eAAgBnM,EAAQ,eACtBA,EAAU,CACVpR,MAAO,CAAC+W,KAAM,EAAGxB,WAAYnI,EAAI2L,YAAYrX,KAAK6T,WAAYsJ,SAAU,GACxEI,QAAS,SACT/e,QAAS,KAER,GACHyd,gBAAiBnc,MAAMC,QAAQL,EAAMM,KAAK,EAAK/B,MAAMG,WAAW6B,OAAQP,EAAMM,KAAK,EAAK/B,MAAMG,WAAW6B,MAAQ,GAEjHsb,YAAY,IAlCK,E,wDAuClB,OAAkC,MAA3B9b,KAAKme,WAAWvX,U,oFAiBvB,IAPiB,IAAD,EAC6B5G,KAAKzB,MAA1C4C,EADQ,EACRA,KAAMya,EADE,EACFA,YAAaC,EADX,EACWA,SAAU5P,EADrB,EACqBA,IACjC2S,EAAqB,KACrBC,EAAkB,KAClBC,EAAuB,GACvBC,EAAoB,GACpB3C,EAAiBpc,KAAKxB,MAAM4d,eAChC,MAA+Bzb,OAAOiR,QAAQgK,GAA9C,eAA4D,CAAC,IAAD,sBAAlDpb,EAAkD,KAA5C7B,EAA4C,KACtDA,EAAWwN,OAAOE,WAAWlL,EAAKmL,OAClC3N,EAAWyD,MAAMC,QAAQC,eAAiBT,SAASC,WAAYnD,EAAWyD,MAAMC,QAAQC,cAAcC,eACzGuc,EAAqBte,GAAQ7B,EAC7BogB,EAAkBve,GAAQqb,EAASrb,GACnC4b,EAAe5b,GAAQ,CACtB3B,MAAO,CAAC+W,KAAM,EAAGxB,WAAYnI,EAAI2L,YAAYrX,KAAK6T,WAAYsJ,SAAU,GACxEI,QAASnf,EAAWyD,MAAMC,QAAQC,cAAcZ,KAChDmc,SAAU,GACVE,QAAQ,GAEkB,OAAvBa,IACHA,EAAqBjgB,EACrBkgB,EAAkBhD,EAASrb,KAK/BR,KAAKxB,MAAM4d,eAAiBA,EAC5Bpc,KAAKxB,MAAMod,YAAckD,EACzB9e,KAAKxB,MAAMqd,SAAWkD,EACtB/e,KAAKxB,MAAMG,WAAaigB,EACxB5e,KAAKxB,MAAMI,QAAUigB,I,gDAiBI3f,GACzBc,KAAKiB,UAAS,SAAAzC,GAAK,MAAK,CAAEud,uBAAwBvd,EAAMud,4B,sCAGzC9Q,EAAK+T,GACpBrD,GAAY1Q,I,qDAKkB+Q,GAC9Bhc,KAAKiB,UAAS,SAAAzC,GAAK,MAAK,CAAEwd,kBAAmBA,Q,sDAGdU,EAAUC,GACzC3c,KAAKiB,UAAS,SAAAzC,GAAK,MAAK,CAAEwd,kBAAkB,2BAAKxd,EAAMwd,mBAAZ,kBAAgCU,EAAWC,U,wDAIrDD,EAAUC,GAC3C,IAAIsC,EAAsB/L,KAAKgH,SAASla,KAAKxB,MAAMwd,0BAC5CiD,EAAoBvC,GAC3B1c,KAAKiB,UAAS,SAAAzC,GAAK,MAAK,CAAEwd,kBAAmBiD,Q,oDAGhBvC,EAAUC,GACnC3c,KAAKxB,MAAMsd,YACd9b,KAAKiB,UAAS,SAAAzC,GAAK,MAAK,CAAEwd,kBAAkB,2BAAKxd,EAAMwd,mBAAZ,kBAAgCU,EAAWC,U,+BA+I9E,IAAD,WACuF3c,KAAKzB,MAA5F+F,EADA,EACAA,MAAO5B,EADP,EACOA,QAAkBub,GADzB,EACgBiB,QADhB,EACyBjB,QAAiBrC,GAD1C,EACiCuD,QADjC,EAC0CvD,aAAaC,EADvD,EACuDA,SAAUqC,EADjE,EACiEA,SAAU3e,EAD3E,EAC2EA,QAD3E,EAEyFS,KAAKxB,MAA9FyR,EAFA,EAEAA,QAAS+L,EAFT,EAESA,kBAA0CG,GAFnD,EAE4BJ,sBAF5B,EAEmDI,mBAAmBC,EAFtE,EAEsEA,eAC1E7Y,EAAU,GACVD,EAAU,GACVD,EAAY,GAmBhB,OAjBA8Y,EAAkBlR,KAAI,SAAAmU,GACjBxD,EAAYwD,IAAqBA,KAAoBhD,IAEP,WAA7CA,EAAegD,GAAkBtB,SAAwBzd,MAAMC,QAAQ8b,EAAegD,GAAkBvB,UAC3Gva,EAAUA,EAAQka,OAAOpB,EAAegD,GAAkBvB,UAEL,WAA7CzB,EAAegD,GAAkBtB,SAAwBzd,MAAMC,QAAQ8b,EAAegD,GAAkBvB,UAChHta,EAAUA,EAAQia,OAAOpB,EAAegD,GAAkBvB,UAEL,aAA7CzB,EAAegD,GAAkBtB,SAA0Bzd,MAAMC,QAAQ8b,EAAegD,GAAkBvB,YAClHxa,EAAYA,EAAUma,OAAOpB,EAAegD,GAAkBvB,eAQhE,kBAACnU,EAAA,EAAD,CAAMC,UAAW,EAAGC,aAActF,EAAMkL,QAAQ/P,KAAKgM,QAASxB,MAAO,CAACpF,gBAAiBP,EAAMkL,QAAQtF,WAAW6Q,OAAUlQ,IAAK7K,KAAKme,YACnI,kBAACtU,EAAA,EAAD,CACCC,OACC,kBAACC,EAAA,EAAD,CAAQE,MAAO,CAACpF,gBAAiB,mBAAoBnF,MAAM4E,EAAMkL,QAAQ/P,KAAKgM,UAC7E,kBAAC,IAAD,OAGFpM,MAAOW,KAAKzB,MAAM0R,QAAU2L,EAAY5b,KAAKzB,MAAM0R,SAAW2L,EAAY5b,KAAKzB,MAAM0R,SAAStF,MAAM,OAAS,MAAS,eACtHR,UAAU,gGACVsF,OACC,6BAeEpP,MAAMC,QAAQf,IAAYA,EAAQ0L,KAAI,WAA2BiH,GAA3B,IAAEvS,EAAF,EAAEA,QAASgI,EAAX,EAAWA,KAAS0X,EAApB,yCACtC,kBAACzU,EAAA,EAAD,eACCZ,aAAW,SACXlH,UAAW,iCACXnD,QAASA,EACTsK,MAAO,CAACpF,gBAAiB,oBACzByG,IAAK,iBAAiB4G,GAClBmN,GAEH1X,MAIH,kBAACiD,EAAA,EAAD,CACCZ,aAAW,OACXtK,MAAO,UACPoD,UAAW,qBACXnD,QAASK,KAAKqc,cAAcrc,KAAKxB,MAAMsd,YACvC7R,MAAO,CAACpF,gBAAiB,qBAEzB,kBAAC,IAAD,CACCya,KAAMC,IACNlgB,MAAM,2BACNmgB,OAAQxf,KAAKxB,MAAMsd,WAAY,EAAI,IACnC7O,KAAM,GACNvN,MAAO4E,EAAMkL,QAAQ/P,KAAKgM,cAO/B,kBAACrB,EAAA,EAAD,CAAatH,UAAU,6BACtB,kBAACD,EAAA,EAAD,CAAeC,UAAU,WACxB,kBAACE,EAAA,EAAD,CAAUC,GAAI,GAAIH,UAAWJ,EAAQ+c,SACpC,yBAAK3c,UAAW4c,IAAWhd,EAAQid,SAAT,mBAAqBjd,EAAQkd,oBAAsB3B,EAAO4B,YAAYvR,OAAS,MAA/E,cAAuF5L,EAAQod,aAAe9f,KAAKxB,MAAMsd,YAAcmC,EAAO4B,YAAYvR,OAAS,MAAnK,IAA2KrE,MAAO,CAAC8V,UAAW9B,EAAO4B,YAAY7W,OAAQnE,gBAAiBP,EAAMkL,QAAQtF,WAAW6Q,QAG5R,kBAAC7X,EAAA,EAAD,CACCgB,UAAW+Z,EAAO4B,YAAY7W,OAC9B7E,qBAAsBgY,EAAkBpE,SAAS,qBACjDvU,qBAAqB,EACrBwc,uBAAwBhgB,KAAKue,+BAC7B0B,0BAA2BjgB,KAAKwe,gCAChC0B,4BAA6BlgB,KAAKye,kCAClC0B,wBAAyBngB,KAAK0e,8BAC9B0B,cAAepgB,KAAKxB,MAAMyd,cAC1BoE,kBAAmBrgB,KAAKxB,MAAMof,mBAAoB5d,KAAKxB,MAAMof,mBAAqB,mBAClFza,YAAanD,KAAKxB,MAAM2E,YACxBC,KAAMpD,KAAKxB,MAAM4E,KACjBkd,UAAWtgB,KAAKqe,gBAChBhb,UAAWA,EACXC,QAASA,EACTC,QAASA,KAKX,kBAACgd,EAAA,EAAD,CACCzd,UAAWJ,EAAQ8d,OACnB5c,QAASqa,EAAO4B,YAAYvR,OAAS,KAAM,aAAe,YAC1DmS,OAAO,QACP7N,KAAM5S,KAAKxB,MAAMsd,WACjBhH,QAAS9U,KAAKqc,cAAa,GAClBqE,OAAQ1gB,KAAKqc,cAAa,GACnC3Z,QAAS,CACRqY,MAAOkD,EAAO4B,YAAYvR,OAAS,KAAM5L,EAAQie,YAAcje,EAAQke,uBAGvE5gB,KAAKxB,MAAM0d,eAAiB,kBAAC2E,EAAA,EAAD,CAC5BtW,MAAO0F,EACPzF,SAAUxK,KAAKsc,oCACfwE,YAAU,EACVhe,UAAW,UAEX,kBAACie,EAAA,EAAD,CACCxW,MAAM,oBACNI,MAAM,QACNhD,KACC,kBAAC,IAAD,CACC2X,KAAM0B,IACN3hB,MAAM,yBACN4N,KAAM,MAIRtM,OAAOiR,QAAQ5R,KAAKxB,MAAMod,aAAa3Q,KAAI,WAAqBC,GAArB,uBAAE1K,EAAF,KAAQ7B,EAAR,YAC3C,kBAACoiB,EAAA,EAAD,CACCxW,MAAO/J,EACPmK,MAAOhM,EAAWgM,MAClBhD,KAAMhJ,EAAWgJ,KACjB2D,IAAK,qBAAqB9K,EAAK,gBAKpB,sBAAZyP,GAAsE,IAAnCtP,OAAOsM,KAAK+O,IAA6B,kBAACnZ,EAAA,EAAD,KAC7E,kBAACG,EAAA,EAAD,CAAUC,GAAI,GAAIH,UAAU,wCAC3B,kBAAC,IAAD,CACCwc,KAAM2B,IACN5hB,MAAM,4BACNK,MAAM,UACNuN,KAAM,KAIR,kBAACjK,EAAA,EAAD,CAAUC,GAAI,GAAIH,UAAU,wCAC3B,kBAACa,EAAA,EAAD,oCAOY,sBAAZsM,GAAmC,kBAAC1B,EAAA,EAAD,CAAMzL,UAAWJ,EAAQK,MAC3DpC,OAAOiR,QAAQoK,GAAmB/Q,KAAI,WAAqBC,GAAW,IAAD,mBAA7BwR,EAA6B,KAAnBC,EAAmB,KACjEuE,GAAa,EAajB,GAZIhW,EAAQ,EAEPyR,EAAOrQ,KAAK4D,MAAQ8L,EAAmBrb,OAAO4Q,KAAKyK,GAAoB9Q,EAAM,IAAMoB,KAAK4D,MAC3FgR,GAAa,GAIVvF,KACHA,GAAUiB,MAAM,CAAEC,IAAKF,EAAOrB,SAASwB,SAAUC,IAAKJ,EAAOrB,SAAS0B,YACtErB,GAAU1L,QAAQgN,6CAA6CC,QAAQ,KAGrEP,EAAOrQ,MAAQ4U,EAClB,OACC,kBAACzS,EAAA,EAAD,CAAU3L,UAAW,mCAAoCnD,QAAS,EAAK8c,0BAA0BC,EAAUC,GAASrR,IAAK,UAAUoR,GAClI,kBAAC9N,EAAA,EAAD,KACC,kBAAC7E,EAAA,EAAD,CAAQ6D,IAAMkD,OAAOC,SAAS4L,EAAOrQ,KAAK6U,SAAoD,WAA1CxE,EAAOrQ,KAAK6U,OAAOC,OAAOC,cAA0BC,IAAmDC,QAE5J,kBAACzS,EAAA,EAAD,CAAcrD,QAAUkR,EAAOrQ,KAAKkV,WAAW,IAAI7E,EAAOrQ,KAAKmV,UAAYpW,UAAWyF,OAAOC,SAAS4L,EAAOrQ,KAAKoV,MAAO/E,EAAOrQ,KAAKoV,KAAKtI,WAAa,UAQ/I,gBAAZnJ,GAA6B,kBAAC0R,EAAA,EAAD,CAC7BhjB,WAAYid,EAAYgG,YACxBhjB,QAASid,EAAS+F,YAClB/iB,MAAO,GACPwX,iBAAiB,EACjBC,YAAY,EACZqC,YAAY,EACZC,qBAAsB,SACtB3S,KAAM,WACN3E,WAAY,SAACugB,EAAYhjB,GACpB+c,EAAY3L,IAAYpO,SAASC,WAAY8Z,EAAY3L,GAAS7N,MAAMC,QAAQC,cAAcC,cAAiBlC,MAAMC,QAAQuhB,IAChIjG,EAAY3L,GAAS7N,MAAMC,QAAQC,cAAcC,YAAYsf,GAAY,GAAMjgB,MAAK,SAAAY,GACnF,EAAKvB,UAAS,SAAAF,GAAS,MAAK,CAC1Bqb,eAAe,2BACXrb,EAAUqb,gBADA,kBAEZnM,EAFY,2BAGTlP,EAAUqb,eAAenM,IAHhB,IAIZpR,MAAOA,EACPgf,SAAUrb,EACVub,QAAQ,MAGVhf,QAAS8iB,SAXZ,OAcS,SAAApf,GACR,EAAKxB,UAAS,SAAAF,GAAS,MAAK,CAC3Bqb,eAAe,2BACVrb,EAAUqb,gBADD,kBAEXnM,EAFW,2BAGRlP,EAAUqb,eAAenM,IAHjB,IAIX4N,SAAU,GACVE,QAAQ,MAGXhf,QAAS8iB,UAMbzZ,aAAcpI,KAAKge,0BAGP,WAAZ/N,GAAwB,kBAAC0R,EAAA,EAAD,CACxBhjB,WAAYid,EAAYkG,OACxBljB,QAASid,EAASiG,OAClBzL,iBAAiB,EACjBC,YAAY,EACZqC,YAAY,EACZD,gBAAgB,EAChBE,qBAAsB,SACtB3S,KAAM,WACN3E,WAAY,SAACugB,EAAYhjB,GACpB+c,EAAY3L,IAAYpO,SAASC,WAAY8Z,EAAY3L,GAAS7N,MAAMC,QAAQC,cAAcC,cAAiBlC,MAAMC,QAAQuhB,IAChIjG,EAAY3L,GAAS7N,MAAMC,QAAQC,cAAcC,YAAYsf,GAAY,GAAMjgB,MAAK,SAAAY,GACnF,EAAKvB,UAAS,SAAAF,GAAS,MAAK,CAC1Bqb,eAAe,2BACXrb,EAAUqb,gBADA,kBAEZnM,EAFY,2BAGTlP,EAAUqb,eAAenM,IAHhB,IAIZpR,MAAOA,EACPgf,SAAUrb,EACVub,QAAQ,MAGVhf,QAAS8iB,SAXZ,OAcS,SAAApf,GACR,EAAKxB,UAAS,SAAAF,GAAS,MAAK,CAC3Bqb,eAAe,2BACVrb,EAAUqb,gBADD,kBAEXnM,EAFW,2BAGRlP,EAAUqb,eAAenM,IAHjB,IAIXpR,MAAOA,EACPgf,SAAU,GACVE,QAAQ,MAGXhf,QAAS8iB,UAKbzZ,aAAcpI,KAAKge,8BAOzB,kBAAClT,EAAA,EAAD,KACC,kBAACjI,EAAA,EAAD,CAAeC,UAAU,WACvBzC,MAAMC,QAAQ4d,IAAaA,EAASjT,KAAI,SAAC8W,EAAoB7P,GAArB,OACxC,kBAAClP,EAAA,EAAD,CAAUC,GAAI,GAAIqH,GAAI2L,KAAK+L,MAAO,GAAK9D,EAAS1Q,QAAU1K,UAAW,mCAAoCwI,IAAK,wBAAwB4G,GACpI,kBAAC,IAAD,CACCvH,MAA8B,sBAAvBoX,EAA4C,QAAWnG,EAAYmG,GAAqBnG,EAAYmG,GAAoBpX,MAAQoX,EACvIxX,MAAO,EAAK/L,MAAM2d,kBAAkBpE,SAASgK,GAC7CvX,SAAU,SAACyX,GACV,EAAK9E,0BAA0B4E,EAAoBE,UAMxD,kBAACjf,EAAA,EAAD,CAAUC,GAAI,IACb,kBAACU,EAAA,EAAD,CAAYC,QAAQ,SAClB5D,KAAKzB,MAAM0R,SAAU2L,EAAY5b,KAAKzB,MAAM0R,SAAW2L,EAAY5b,KAAKzB,MAAM0R,SAAStF,MAAM,qBAA8C,6B,GA7kBpH5G,IAAMC,WA+lBtCuW,GAAkBtW,aAAe,CAChCia,SAAU,CAAC,oBAAqB,cAAe,UAC/CjO,QAAS,oBACT1Q,QAAS,IAUK2iB,sBAAY9d,IAC1BC,KC3qBc,SAAAC,GAAK,MAAK,CACxBvB,KAAM,CACLwB,QAAS,KAEVkb,QAAS,CACR1U,QAAS,OACTuK,OAAQ,EACR/Q,QAAS,GAEVic,OAAQ,CACPlS,MAAOhK,EAAM6d,UAAU7T,MACvB8T,WAAY,GAEXzB,YAAa,CACdrS,MAAOhK,EAAM6d,UAAU7T,MACvBgN,SAAU,WACV+G,OAAQ/d,EAAM+d,OAAOC,OAAO,EAC5Bzd,gBAAiBP,EAAMkL,QAAQtF,WAAW6Q,OAEzC6F,qBAAsB,CACvBtS,MAAOhK,EAAM6d,UAAU7T,MACvBpE,WAAY5F,EAAMkL,QAAQtF,WAAd,SAEXyV,QAAS,CACV4C,SAAU,EACVhe,QAAS,EACT2K,WAAY5K,EAAM6K,YAAYC,OAAO,SAAU,CAC9CC,OAAQ/K,EAAM6K,YAAYE,OAAOC,MACjCC,SAAUjL,EAAM6K,YAAYI,SAASiT,iBAIvC5C,oBAAqB,CACpBpa,aAAclB,EAAM6d,UAAU7T,OAG/BwR,aAAc,CACb5Q,WAAY5K,EAAM6K,YAAYC,OAAO,SAAU,CAC9CC,OAAQ/K,EAAM6K,YAAYE,OAAOoT,QACjClT,SAAUjL,EAAM6K,YAAYI,SAASmT,iBAEtCld,YAAa,ODmoBdhB,aATuB,SAAAhG,GAAK,MAAK,CACjCyN,IAAKzN,EAAMyN,IACX9K,KAAM3C,EAAM2C,KACZlB,MAAOzB,EAAMyB,MACbge,OAAQzf,EAAMyf,UAKW,CAAC7c,oBAAgBhC,iBAAaD,kBACvDwjB,IACAje,IAJ0BN,CAKzBmW,M,kCEhrBF,IAAIqI,EAAyBC,EAAQ,IAErCliB,OAAOmiB,eAAezkB,EAAS,aAAc,CAC3CkM,OAAO,IAETlM,EAAO,aAAW,EAElB,IAAI0kB,EAASH,EAAuBC,EAAQ,IAIxCG,GAAW,EAFMJ,EAAuBC,EAAQ,KAEnB,SAAUE,EAAM,QAASE,cAAc,OAAQ,CAC9EC,EAAG,iEACD,aAEJ7kB,EAAO,QAAW2kB,G,kCCflB,IAAIJ,EAAyBC,EAAQ,IAErCliB,OAAOmiB,eAAezkB,EAAS,aAAc,CAC3CkM,OAAO,IAETlM,EAAO,aAAW,EAElB,IAAI0kB,EAASH,EAAuBC,EAAQ,IAIxCG,GAAW,EAFMJ,EAAuBC,EAAQ,KAEnB,SAAUE,EAAM,QAASE,cAAc,OAAQ,CAC9EC,EAAG,sSACD,UAEJ7kB,EAAO,QAAW2kB,G,8DCblB,SAASG,EAAe5kB,GAAQ,IAG9BuE,EAMGvE,EANHuE,UACAsgB,EAKG7kB,EALH6kB,SACAC,EAIG9kB,EAJH8kB,OACAC,EAGG/kB,EAHH+kB,2BAKKzY,GAFFtM,EAFHob,YAEGpb,EADHglB,gBAGWC,qBAOZ,SACC3Y,GAIE,IAHF4Y,EAGC,uDAHY,MAGZ,EAEyCC,oBAAS,GAFlD,mBAEMC,EAFN,KAEsBC,EAFtB,KAIDC,qBAAU,WACT,IAAMC,EAAW,IAAIC,sBACpB,YAAc,IAAZvV,EAAW,oBAEZoV,EAAgBpV,EAAMmV,gBAClB9hB,SAASC,WAAWwhB,IACvBA,EAA2B9U,EAAMmV,kBAGnC,CAAEF,eAKH,OAHI5Y,EAAIjE,SACPkd,EAASE,QAAQnZ,EAAIjE,SAEf,WACNkd,EAASG,UAAUpZ,EAAIjE,YAEtB,IA5Basd,CAAYrZ,EADZ,EAAI4M,OAAOC,YAAY2L,EAAQ,GAAK,MAkCrD,OACC,yBAAKvgB,UAAWA,GAAwB,UAAW+H,IAAKA,GACtDuY,GAgBJD,EAAelf,aAAe,CAC7Bsf,gBAAiB,WACjB5J,YAAa,CACZ/V,QAAS,OACT0K,MAAO,OACPtF,OAAQ,IACRmb,UAAW,QAEZd,OAAQ,GAGMF,O,kCChFf,IAAIP,EAAyBC,EAAQ,IAErCliB,OAAOmiB,eAAezkB,EAAS,aAAc,CAC3CkM,OAAO,IAETlM,EAAO,aAAW,EAElB,IAAI0kB,EAASH,EAAuBC,EAAQ,IAIxCG,GAAW,EAFMJ,EAAuBC,EAAQ,KAEnB,SAAUE,EAAM,QAASE,cAAc,OAAQ,CAC9EC,EAAG,4IACD,sBAEJ7kB,EAAO,QAAW2kB,G,kCCflB,IAAIJ,EAAyBC,EAAQ,IAErCliB,OAAOmiB,eAAezkB,EAAS,aAAc,CAC3CkM,OAAO,IAETlM,EAAO,aAAW,EAElB,IAAI0kB,EAASH,EAAuBC,EAAQ,IAIxCG,GAAW,EAFMJ,EAAuBC,EAAQ,KAEnB,SAAUE,EAAM,QAASE,cAAc,OAAQ,CAC9EC,EAAG,8IACD,iBAEJ7kB,EAAO,QAAW2kB,G,kCCflB,IAAIJ,EAAyBC,EAAQ,IAErCliB,OAAOmiB,eAAezkB,EAAS,aAAc,CAC3CkM,OAAO,IAETlM,EAAO,aAAW,EAElB,IAAI0kB,EAASH,EAAuBC,EAAQ,IAIxCG,GAAW,EAFMJ,EAAuBC,EAAQ,KAEnB,SAAUE,EAAM,QAASE,cAAc,OAAQ,CAC9EC,EAAG,iQACD,cAEJ7kB,EAAO,QAAW2kB,G,kCCflB,IAAIJ,EAAyBC,EAAQ,IAErCliB,OAAOmiB,eAAezkB,EAAS,aAAc,CAC3CkM,OAAO,IAETlM,EAAO,aAAW,EAElB,IAAI0kB,EAASH,EAAuBC,EAAQ,IAIxCG,GAAW,EAFMJ,EAAuBC,EAAQ,KAEnB,SAAUE,EAAM,QAASE,cAAc,OAAQ,CAC9EC,EAAG,kHACD,UAEJ7kB,EAAO,QAAW2kB,G,kCCflB,IAAIJ,EAAyBC,EAAQ,IAErCliB,OAAOmiB,eAAezkB,EAAS,aAAc,CAC3CkM,OAAO,IAETlM,EAAO,aAAW,EAElB,IAAI0kB,EAASH,EAAuBC,EAAQ,IAIxCG,GAAW,EAFMJ,EAAuBC,EAAQ,KAEnB,SAAUE,EAAM,QAASE,cAAc,OAAQ,CAC9EC,EAAG,iQACD,YAEJ7kB,EAAO,QAAW2kB,G,kCCflB,IAAIJ,EAAyBC,EAAQ,IAErCliB,OAAOmiB,eAAezkB,EAAS,aAAc,CAC3CkM,OAAO,IAETlM,EAAO,aAAW,EAElB,IAAI0kB,EAASH,EAAuBC,EAAQ,IAIxCG,GAAW,EAFMJ,EAAuBC,EAAQ,KAEnB,SAAUE,EAAM,QAASE,cAAc,OAAQ,CAC9EC,EAAG,mDACD,gBAEJ7kB,EAAO,QAAW2kB,G,kCCflB,IAAIJ,EAAyBC,EAAQ,IAErCliB,OAAOmiB,eAAezkB,EAAS,aAAc,CAC3CkM,OAAO,IAETlM,EAAO,aAAW,EAElB,IAAI0kB,EAASH,EAAuBC,EAAQ,IAIxCG,GAAW,EAFMJ,EAAuBC,EAAQ,KAEnB,SAAUE,EAAM,QAASE,cAAc,OAAQ,CAC9EC,EAAG,kDACD,eAEJ7kB,EAAO,QAAW2kB,G,kCCflB,IAAIJ,EAAyBC,EAAQ,IAErCliB,OAAOmiB,eAAezkB,EAAS,aAAc,CAC3CkM,OAAO,IAETlM,EAAO,aAAW,EAElB,IAAI0kB,EAASH,EAAuBC,EAAQ,IAIxCG,GAAW,EAFMJ,EAAuBC,EAAQ,KAEnB,SAAUE,EAAM,QAASE,cAAc,OAAQ,CAC9EC,EAAG,8OACD,SAEJ7kB,EAAO,QAAW2kB,G,kCCflB,IAAIJ,EAAyBC,EAAQ,IAErCliB,OAAOmiB,eAAezkB,EAAS,aAAc,CAC3CkM,OAAO,IAETlM,EAAO,aAAW,EAElB,IAAI0kB,EAASH,EAAuBC,EAAQ,IAIxCG,GAAW,EAFMJ,EAAuBC,EAAQ,KAEnB,SAAUE,EAAM,QAASE,cAAc,OAAQ,CAC9EC,EAAG,uDACD,QAEJ7kB,EAAO,QAAW2kB,G,kCCflB,IAAIJ,EAAyBC,EAAQ,IAErCliB,OAAOmiB,eAAezkB,EAAS,aAAc,CAC3CkM,OAAO,IAETlM,EAAO,aAAW,EAElB,IAAI0kB,EAASH,EAAuBC,EAAQ,IAIxCG,GAAW,EAFMJ,EAAuBC,EAAQ,KAEnB,SAAUE,EAAM,QAASE,cAAc,OAAQ,CAC9EC,EAAG,8JACD,WAEJ7kB,EAAO,QAAW2kB,G,kCCflB,IAAIJ,EAAyBC,EAAQ,IAErCliB,OAAOmiB,eAAezkB,EAAS,aAAc,CAC3CkM,OAAO,IAETlM,EAAO,aAAW,EAElB,IAAI0kB,EAASH,EAAuBC,EAAQ,IAIxCG,GAAW,EAFMJ,EAAuBC,EAAQ,KAEnB,SAAUE,EAAM,QAASE,cAAc,OAAQ,CAC9EC,EAAG,+MACD,WAEJ7kB,EAAO,QAAW2kB,G,kCCflB,IAAIJ,EAAyBC,EAAQ,IAErCliB,OAAOmiB,eAAezkB,EAAS,aAAc,CAC3CkM,OAAO,IAETlM,EAAO,aAAW,EAElB,IAAI0kB,EAASH,EAAuBC,EAAQ,IAIxCG,GAAW,EAFMJ,EAAuBC,EAAQ,KAEnB,SAAUE,EAAM,QAASE,cAAc,OAAQ,CAC9EC,EAAG,4FACD,qBAEJ7kB,EAAO,QAAW2kB,G,kCCflB,IAAIJ,EAAyBC,EAAQ,IAErCliB,OAAOmiB,eAAezkB,EAAS,aAAc,CAC3CkM,OAAO,IAETlM,EAAO,aAAW,EAElB,IAAI0kB,EAASH,EAAuBC,EAAQ,IAIxCG,GAAW,EAFMJ,EAAuBC,EAAQ,KAEnB,SAAUE,EAAM,QAASE,cAAc,OAAQ,CAC9EC,EAAG,kGACD,kBAEJ7kB,EAAO,QAAW2kB,G,q5BCyElB,SAASoB,GAAM7lB,GACd,OAAO,kBAAC,IAAD,eAAUoL,UAAW,EAAG/F,QAAQ,UAAarF,IAGrD,SAAS8lB,GAAK9lB,GAAQ,IAAD,EACZmE,EAAqLnE,EAArLmE,QAASI,EAA4KvE,EAA5KuE,UAAmCwhB,GAAyI/lB,EAAjKgmB,OAAiKhmB,EAAzJimB,cAAgBF,WAAiCnjB,GAAwG5C,EAA5HkmB,mBAA4HlmB,EAAxG4C,MAAe0e,EAAyFthB,EAAlG0f,OAAS4B,YAAcze,EAA2E7C,EAA3E6C,eAAgBkD,EAA2D/F,EAA3D+F,MAAOogB,EAAoDnmB,EAApDmmB,kBACrIC,GADyLpmB,EAAjCqmB,oBADxI,YACyKrmB,EADzK,0JAEDwF,IAAMiC,aACrB6e,EAAqB9gB,IAAMiC,YAC3BwG,EAAWsY,eACXC,EAAUC,eALM,EAUuBC,eAAnCrJ,EAVY,EAUZA,YAAaC,EAVD,EAUCA,SAAUsD,EAVX,EAUWA,QACG+F,GAAsGZ,EAAhIa,aAAgIb,EAAlHc,WAAkHd,EAAtGY,eAAgDG,GAAsDf,EAAvFgB,SAAuFhB,EAA9DiB,OAA8DjB,EAAtDe,qBAAqBG,EAAiClB,EAAjCkB,6BAXnF,EAaM9B,mBAASrjB,MAAMC,QAAQ4kB,GAAgBA,EAAgB,IAb7D,mBAabO,EAba,KAaNC,EAbM,OAcgBhC,mBAAS2B,GAdzB,oCAegC3B,mBAAS8B,IAfzC,qCAgBM9B,mBAAS,CAACiC,KAAM,gBAhBtB,qBAgBb9mB,GAhBa,gBAiBsB6kB,mBAAS,CAACiC,KAAM,gBAjBtC,qBAiBbC,GAjBa,MAiBEC,GAjBF,SAkBoCnC,oBAAS,GAlB7C,qBAkBboC,GAlBa,MAkBSC,GAlBT,SAmB0BrC,oBAAS,GAnBnC,qBAmBIsC,IAnBJ,gBAoBMtC,mBAAS,IApBf,qBAoBbuC,GApBa,MAoBNC,GApBM,SAqB8DxC,mBAAS,IArBvE,qBAqBsByC,IArBtB,gBAsBMzC,oBAAS,GAtBf,qBAsBbhgB,GAtBa,MAsBN0iB,GAtBM,SAuBY1C,mBAAS,IAvBrB,qBAuBH2C,IAvBG,gBAwBgC3C,oBAAS,GAxBzC,qBAwBb4C,GAxBa,MAwBOC,GAxBP,SAyBgC7C,oBAAS,GAzBzC,qBAyBb8C,GAzBa,MAyBOC,GAzBP,SA0BkB/C,mBAAS,CAAE5T,OAAQ,KAAMC,OAAQ,OA1BnD,qBA0Bb2W,GA1Ba,MA0BAC,GA1BA,SA2B8CjD,oBAAS,GA3BvD,qBA2BckD,IA3Bd,gBA4B0BlD,oBAAS,GA5BnC,qBA4BbmD,GA5Ba,MA4BIC,GA5BJ,SA6BcpD,oBAAS,GA7BvB,qBA6BbqD,GA7Ba,MA6BFC,GA7BE,SA8BsBtD,oBAAS,GA9B/B,qBAmCduD,IAnCc,YAmCM,CACzB,CAAEtf,KAAM,kBAAC,KAAD,MAAuBnH,KAAM,QAASmK,MAAO,QAASjL,MAAO4E,EAAMkL,QAAQ9L,MAAMwjB,MACzF,CAAEvf,KAAM,kBAAC,KAAD,MAA4BnH,KAAM,QAASmK,MAAO,QAASjL,MAAO4E,EAAMkL,QAAQxK,OAAOkiB,MAC/F,CAAEvf,KAAM,kBAAC,KAAD,MAAuBnH,KAAM,QAASmK,MAAO,QAASjL,MAAO4E,EAAMkL,QAAQ2X,QAAQD,MAC3F,CAAEvf,KAAM,kBAAC,KAAD,MAAoBnH,KAAM,OAAQmK,MAAO,OAAQjL,MAAO4E,EAAMkL,QAAQ4X,KAAKF,QAc9EG,GAAoB,WACrBzL,IACHmK,IAAwB,GACxB3kB,EAAgBwa,EAAYsJ,cAAc1kB,KACxC,CACCgB,IAAK,SACLE,KAAM,UACNC,OAAO,2BAAK9C,IAAN,IAAaC,EAAG,MACtByB,KAAM,GACNN,OAAO,IAER2B,MAAK,SAAArB,GACFF,MAAMC,QAAQC,IACjBmkB,EAAkB,gBAAiBnkB,GAGpC6lB,IAAS,GACTL,IAAwB,MAdzB,OAeS,SAAAhkB,GACRgK,QAAQC,IAAI,kBAAmBjK,GAC/B,IAAIulB,EAAWvlB,EACXmR,KAAKC,OAAOpR,KAEdulB,EADG,QAASvlB,EACDA,EAAEC,IAGFkR,KAAKE,UAAUrR,IAI5BqkB,GAASkB,GACTvB,IAAwB,QA2CrBwB,GAAoB,SAAC7lB,EAAM8M,GAAP,OAAiB,SAAAtP,GAC1CA,EAAMqR,iBACNoW,GAAe,CACbjlB,KAAOA,EACP8M,MAAOA,EACPsB,OAAQ5Q,EAAMsR,QAAU,EACxBT,OAAQ7Q,EAAMuR,QAAU,MAIrB+W,GAAqB,WAC1Bb,GAAe,CAAE7W,OAAQ,KAAMC,OAAQ,QAwDlC0X,GAAgB,SAACC,GACtB,GAAIA,EAAY,CACf,IAAIC,EAAiB,IACrBD,EAAarnB,MAAMC,QAAQonB,GAAaA,EAAa,CAACA,IAE3Czc,KAAI,SAAA2c,GACV1U,KAAKC,OAAOyU,IAAc,QAASA,EACtCD,EAAe9W,KAAK+W,EAAU1X,KAErBY,OAAO+W,QAAQD,IACxBD,EAAe9W,KAAK+W,MAKtBrB,IAAsB,GACtB,IAAIuB,GAAiB,EAsBrB,GArBA5C,EAAcja,KAAI,SAAC8c,EAAM7c,GACxB,IAAuB,IAAnB4c,GAAsC,eAAdC,EAAKrmB,KAAuB,CACvD,IAAIsmB,EAAWD,EAAKE,MAChBC,EAAeH,EAAKL,WAAW,GAC/BxU,KAAKC,OAAO4U,EAAKE,QAAU,QAASF,EAAKE,QAC5CD,EAAWD,EAAKE,MAAM/X,KAEvB8X,EAAWA,EAEVE,EADGhV,KAAKC,OAAO4U,EAAKL,WAAW,KAAO,QAASK,EAAKL,WAAW,GAChDK,EAAKL,WAAW,GAAGxX,IAGnB6X,EAAKL,WAAW,IAE3BM,GAAY7mB,EAAKmL,KAAK4D,KAAOyX,EAAe5P,SAASmQ,IAAmBA,IAAiB/mB,EAAKmL,KAAK4D,KAAOyX,EAAe5P,SAASiQ,MACtIF,EAAgB5c,QAMI,IAAnB4c,EAAsB,CACzB,IAAIK,EAAejD,EACfkD,EAAelV,KAAKmV,MAAMnV,KAAKE,UAAU+U,EAAaL,KAC1DK,EAAaG,OAAOR,GACpBK,EAAaI,QAAQH,GACrBI,GAAwBJ,GACxB1D,EAAkB,gBAAiByD,GACnCzD,EAAkB,+BAAgC,IAClDA,EAAkB,sBAAuB0D,GAGzClC,GAAS,CACPuC,UAAU,EACVC,OAAQvnB,EAAKmL,KACbqc,UAAW,KACXjnB,KAAM,OACNie,QAAS,GACTiJ,aAAcR,EAAalY,UAMzB,CACJ,IAAI2Y,EAAU,CACbnB,WAAYC,EACZmB,aAAcpB,EACdlpB,MAAO,CACN,MAAS,EACT,OAAU,EACV,KAAQ,EACR,aAAiB,IAIlBypB,MAAO9mB,EAAKmL,KAAK4D,IACjB6Y,WAAY5nB,EAAKmL,KACjB5K,KAAMrB,MAAMC,QAAQonB,IAAcA,EAAWla,OAAS,EAAG,QAA0B,cAGpFkX,EAAkB,+BAAgC,IAE9CvF,EAAO,SACVA,EAAO,QAAS6J,KAAK,sBAAuBH,MAY1CI,GAAwB,SAAC,GAAsB,IAArB3c,EAAoB,EAApBA,KAAM4c,EAAc,EAAdA,SACrC7C,IAAY,SAAA8C,GACX,IACC,IAAIC,EAAclW,KAAKmV,MAAMnV,KAAKE,UAAU+V,IACxCE,EAAU/c,EASd,OARI4G,KAAKC,OAAO7G,KACf+c,EAAU/c,EAAK4D,KAEhBkZ,EAAYE,SAAQ,SAASC,GACxBF,IAAYE,EAAQrZ,MACvBqZ,EAAQL,SAAWA,MAGdE,EACN,MAAM3mB,GAEP,OADAsJ,QAAQrI,MAAMjB,GACP0mB,MAITzE,EAAkB,iBAAiB,SAAA8E,GAClC,IACC,IAAIC,EAAWvW,KAAKmV,MAAMnV,KAAKE,UAAUoW,IACrCH,EAAU/c,EAyBd,OAxBI4G,KAAKC,OAAO7G,KACf+c,EAAU/c,EAAK4D,KAEhBuZ,EAASH,SAAQ,SAASvB,GACzB,GAAkB,eAAdA,EAAKrmB,KAAuB,CAC/B,IAAIgoB,EAAgB3B,EAAKE,MACrB/U,KAAKC,OAAO4U,EAAKE,SACpByB,EAAgB3B,EAAKE,MAAM/X,KAExBwZ,IAAkBL,EACjBnW,KAAKC,OAAO4U,EAAKE,SACpBF,EAAKE,MAAMiB,SAAWA,GAInB7oB,MAAMC,QAAQynB,EAAKL,aAAeK,EAAKL,WAAWla,OAAS,GAC1D0F,KAAKC,OAAO4U,EAAKL,WAAW,MAC/BK,EAAKL,WAAW,GAAGwB,SAAWA,OAO5BO,EACN,MAAMhnB,GAEP,OADAsJ,QAAQrI,MAAMjB,GACP+mB,OAOJG,GAAmC,SAAC,GAA0B,IAAzBf,EAAwB,EAAxBA,aAActc,EAAU,EAAVA,KACxDoY,EAAkB,iBAAiB,SAAA8E,GAClC,IACC,IAAIC,EAAWvW,KAAKmV,MAAMnV,KAAKE,UAAUoW,IACrCH,EAAU/c,EACV4G,KAAKC,OAAO7G,KACf+c,EAAU/c,EAAK4D,KAEhB,IAAI0Z,EAAUhB,EAoBd,OAnBI1V,KAAKC,OAAOyV,KACfgB,EAAUhB,EAAa1Y,KAExBuZ,EAASH,SAAQ,SAASvB,GAEzB,GAAIA,EAAK7X,MAAQ0Z,EAAS,CACzB,IAAIC,EAAmBxpB,MAAMC,QAAQynB,EAAK+B,QAAS/B,EAAK+B,OAAS,GAC7DC,GAAS,EACbF,EAAiB5e,KAAI,SAAA+e,GACfD,GAAUC,EAAiB9Z,MAAQmZ,IACvCU,GAAS,MAINA,GAAWV,IAAYloB,EAAKmL,KAAK4D,MACrC6X,EAAK+B,OAASD,EAAiBrM,OAAO,CAAClR,SAInCmd,EACN,MAAMhnB,GAEP,OADAsJ,QAAQrI,MAAMjB,GACP+mB,MAMT9E,EAAkB,uBAAuB,SAAAuF,GACxC,IAAIA,EA+BH,OAAO,EA9BP,IACC,IAAIC,EAAuBhX,KAAKmV,MAAMnV,KAAKE,UAAU6W,IACjDZ,EAAU/c,EAId,GAHI4G,KAAKC,OAAO7G,KACf+c,EAAU/c,EAAK4D,KAEZ7P,MAAMC,QAAQ4pB,EAAqBJ,QAAS,CAC/C,IAAID,EAAmBxpB,MAAMC,QAAQ4pB,EAAqBJ,QAASI,EAAqBJ,OAAS,GAC7FC,GAAS,EACbF,EAAiB5e,KAAI,SAAA+e,GACfD,GAAUC,EAAiB9Z,MAAQmZ,IACvCU,GAAS,MAINA,GAAUV,IAAYloB,EAAKmL,KAAK4D,MACpCga,EAAqBJ,OAASD,EAAiBrM,OAAO,CAAClR,UAGhD+c,IAAYloB,EAAKmL,KAAK4D,MAC9Bga,EAAqBJ,OAAS,CAACxd,IAGhC,OAAO4d,EACN,MAAMznB,GAEP,OADAsJ,QAAQrI,MAAMjB,GACPwnB,OAWLE,GAAmC,SAAC,GAA0B,IAAzBvB,EAAwB,EAAxBA,aAActc,EAAU,EAAVA,KACxDoY,EAAkB,iBAAiB,SAAA8E,GAClC,IACC,IAAIC,EAAWvW,KAAKmV,MAAMnV,KAAKE,UAAUoW,IACrCH,EAAU/c,EACV4G,KAAKC,OAAO7G,KACf+c,EAAU/c,EAAK4D,KAEhB,IAAI0Z,EAAUhB,EAed,OAdI1V,KAAKC,OAAOyV,KACfgB,EAAUhB,EAAa1Y,KAExBuZ,EAASH,SAAQ,SAASvB,GACzB,GAAIA,EAAK7X,MAAQ0Z,EAAS,CACzB,IAAIC,EAAmBxpB,MAAMC,QAAQynB,EAAK+B,QAAS/B,EAAK+B,OAAS,GACjE/B,EAAK+B,OAASD,EAAiBzZ,QAAO,SAAA4Z,GACrC,OAAOA,EAAiB9Z,MAAQmZ,KAE5BhpB,MAAMC,QAAQynB,EAAK+B,UACvB/B,EAAK+B,OAAS,QAIVL,EACN,MAAMhnB,GAEP,OADAsJ,QAAQrI,MAAMjB,GACP+mB,MAKT9E,EAAkB,uBAAuB,SAAAuF,GACxC,IAAIA,EAmCH,OAAO,EAlCP,IAAIZ,EAAU/c,EACV4G,KAAKC,OAAO7G,KACf+c,EAAU/c,EAAK4D,KAEhB,IAAI0Z,EAAUhB,EAId,GAHI1V,KAAKC,OAAOyV,KACfgB,EAAUhB,EAAa1Y,KAEpB0Z,IAAYK,EAAkB/Z,IAoBjC,OAAO+Z,EAnBP,IACC,IAAIC,EAAuBhX,KAAKmV,MAAMnV,KAAKE,UAAU6W,IAEjDJ,EAAmBxpB,MAAMC,QAAQ4pB,EAAqBJ,QAASI,EAAqBJ,OAAS,GAQjG,OAPAI,EAAqBJ,OAASD,EAAiBzZ,QAAO,SAAA4Z,GACrD,OAAOA,EAAiB9Z,MAAQmZ,KAE5BhpB,MAAMC,QAAQ4pB,EAAqBJ,UACvCI,EAAqBJ,OAAS,IAGxBI,EACN,MAAMznB,GAEP,OADAsJ,QAAQrI,MAAMjB,GACPwnB,OAmGNG,GAA+B,SAAC,GAA6B,EAA5BxB,aAA6B,IAAfyB,EAAc,EAAdA,SACpDzD,IAA6B,GAC7BlC,EAAkB,+BAAgC2F,IAS7C7B,GAA0B,SAACI,GAC5BA,GACHhC,IAA6B,GAC7BlC,EAAkB,+BAAgC,IAC9CvF,EAAO,SACVA,EAAO,QAAS6J,KAAK,4BAA6B,CAACJ,aAAcA,EAAa1Y,IAAK5D,KAAMnL,EAAKmL,QAI/Fsa,IAA6B,IAyDzB0D,GAA0B,SAAC5mB,GAChC0iB,GAAS1iB,IAGJ6mB,GAAgC,SAAC,GAAuB,IAArBC,EAAoB,EAApBA,QAAoB,EAAXle,KACjDoY,EAAkB,gCAAgC,SAAA+F,GACjD,IACC,IAAIC,EAAwBxX,KAAKmV,MAAMnV,KAAKE,UAAUqX,IAStD,OARIpqB,MAAMC,QAAQoqB,IACjBA,EAAsBpB,SAAQ,SAAAqB,GACzBA,EAAkBza,MAAQsa,EAAQta,MACrCya,EAAkBnsB,MAAQgsB,EAAQhsB,UAK9BksB,EACN,MAAMjoB,GAEP,OADAsJ,QAAQrI,MAAMjB,GACPgoB,OAKJG,GAA+B,SAAC,GAAuB,IAArBJ,EAAoB,EAApBA,QAAoB,EAAXle,KAChDoY,EAAkB,gCAAgC,SAAA+F,GACjD,IACC,IAAIC,EAAwBxX,KAAKmV,MAAMnV,KAAKE,UAAUqX,IAStD,OARIpqB,MAAMC,QAAQoqB,IACjBA,EAAsBpB,SAAQ,SAAAqB,GACzBA,EAAkBza,MAAQsa,EAAQta,MACrCya,EAAkBnsB,MAAQgsB,EAAQhsB,UAK9BksB,EACN,MAAMjoB,GAEP,OADAsJ,QAAQrI,MAAMjB,GACPgoB,OAKJI,GAA4C,SAAC,GAAuB,IAArBL,EAAoB,EAApBA,QAAoB,EAAXle,KAC7DoY,EAAkB,gCAAgC,SAAA+F,GACjD,IACC,IAAIC,EAAwBxX,KAAKmV,MAAMnV,KAAKE,UAAUqX,IAQtD,OAPIpqB,MAAMC,QAAQoqB,IACjBA,EAAsBpB,SAAQ,SAAAqB,GACzBA,EAAkBza,MAAQsa,EAAQta,MACrCya,EAAkBnsB,MAAQgsB,EAAQhsB,UAI9BksB,EACN,MAAMjoB,GAEP,OADAsJ,QAAQrI,MAAMjB,GACPgoB,OAkJV,OA3IA5G,qBAAU,WACT6B,EAASR,KACP,CAACA,IAEJrB,qBAAU,WACLwB,GAAuB0B,KAC1ByB,GAAwBnD,GACxB2B,IAAa,MAIZ,CAAC3B,EAAqB0B,KAwBzBlD,qBAAU,WACT,GAAIrX,IAAaqa,GAAiB,CACjC,IACMiE,EADO,IAAIC,gBAAgBve,EAASwe,QACbC,IAAI,QACjClf,QAAQC,IAAI,yBAA0B8e,GACjCha,OAAO+W,QAAQiD,MACiB,IAAhCA,EAAcxN,QAAQ,KACzBuI,GAAiB,CAACqF,cAAeJ,EAAc1J,SAG/CyE,GAAiB,CAAC3V,IAAK4a,EAAc1J,SAEtC0F,IAAmB,OAInB,CAACta,EAAUqa,KAEdhD,qBAAU,WACT9X,QAAQC,IAAI,gBAAiB4Z,MAC3B,CAACA,KAEJ/B,qBAAU,WACT,GAAIxjB,MAAMC,QAAQ4kB,GAAgB,CACjC,IAAIiG,EAAuC,GAC3CjG,EAAcja,KAAI,SAAA8c,GACjB,GAAkB,eAAdA,EAAKrmB,KAAuB,CAC/B,IAAIgoB,EAAgB3B,EAAKE,MACrB/U,KAAKC,OAAO4U,EAAKE,SACpByB,EAAgB3B,EAAKE,MAAM/X,KAExBwZ,IAAkBvoB,EAAKmL,KAAK4D,IAC/Bib,EAAqCta,KAAK6Y,GAGtCrpB,MAAMC,QAAQynB,EAAKL,aAAeK,EAAKL,WAAWla,OAAS,IAC1D0F,KAAKC,OAAO4U,EAAKL,WAAW,IAC/ByD,EAAqCta,KAAKkX,EAAKL,WAAW,GAAGxX,KAG7Dib,EAAqCta,KAAKkX,EAAKL,WAAW,SAM/DvB,GAAqCgF,MAEpC,CAACjG,IAEJrB,qBAAU,WAETwD,OACE,CAACzL,EAAa/c,KAIjBglB,qBAAU,WACT,GAAI1E,EAAO,QAsBV,OArBAA,EAAO,QAAS3W,GAAG,mBAAoBygB,IACvC9J,EAAO,QAAS3W,GAAG,wBAAyBygB,IAC5C9J,EAAO,QAAS3W,GAAG,yBAA0BmhB,IAC7CxK,EAAO,QAAS3W,GAAG,yBAA0B2hB,IAC7ChL,EAAO,QAAS3W,GAAG,wBAAyB4hB,IAG5CjL,EAAO,QAAS3W,GAAG,4BAA6B+hB,IAChDpL,EAAO,QAAS3W,GAAG,2BAA4BoiB,IAC/CzL,EAAO,QAAS3W,GAAG,6BAA8BqiB,IACjD1L,EAAO,QAAS3W,GAAG,mBAAoBqiB,IACvC1L,EAAO,QAAS3W,GAAG,yBAA0BqiB,IAC7C1L,EAAO,QAAS3W,GAAG,eAAgBqiB,IACnC1L,EAAO,QAAS3W,GAAG,qCAAsC8hB,IACzDnL,EAAO,QAAS3W,GAAG,gCAAiC8hB,IACpDnL,EAAO,QAAS3W,GAAG,+BAAgC8hB,IAM5C,WACNnL,EAAO,QAASiM,IAAI,mBAAoBnC,IACxC9J,EAAO,QAASiM,IAAI,wBAAyBnC,IAC7C9J,EAAO,QAASiM,IAAI,yBAA0BzB,IAC9CxK,EAAO,QAASiM,IAAI,yBAA0BjB,IAC9ChL,EAAO,QAASiM,IAAI,wBAAyBhB,IAG7CjL,EAAO,QAASiM,IAAI,4BAA6Bb,IACjDpL,EAAO,QAASiM,IAAI,2BAA4BR,IAChDzL,EAAO,QAASiM,IAAI,qCAAsCd,IAC1DnL,EAAO,QAASiM,IAAI,6BAA8BP,IAClD1L,EAAO,QAASiM,IAAI,mBAAoBP,IACxC1L,EAAO,QAASiM,IAAI,yBAA0BP,IAC9C1L,EAAO,QAASiM,IAAI,eAAgBP,IACpC1L,EAAO,QAASiM,IAAI,gCAAiCd,IACrDnL,EAAO,QAASiM,IAAI,+BAAgCd,IACpDnL,EAAO,QAASiM,IAAI,4BAA6Bd,OAGjD,CAACnL,IAKH,kBAACnG,GAAA,EAAD,CAAOlW,UAAW4c,KAAU,GAAE,oBAAoB,GAAtB,cAA6Bhd,EAAQK,MAAQ,GAA7C,cAAoDD,GAAY,GAAhE,KAC3B,kBAACuoB,EAAA,EAAD,CAAQ/P,SAAS,WAAW5b,MAAM,cAAcoD,UAAWJ,EAAQ4oB,YAClE,kBAACC,EAAA,EAAD,KACElG,GAAuB,kBAACza,GAAA,EAAD,CACvBjL,QAAS,WACJolB,GAAW8B,IACd9B,EAAQlU,KAAKkU,EAAQvY,SAASgf,UAE/B9G,EAAkB,+BAAgC,IAClDA,EAAkB,uBAAuB,IAG1C5hB,UAAW,OACX2oB,KAAK,QACL/rB,MAAM,UACNsK,aAAW,yBAEX,kBAAC,IAAD,OAEAqb,IAAoD,cAA5BA,EAAoB3jB,KAAwBP,EAAKmL,KAAK4D,MAAQmV,EAAoB4C,MAAM/X,KAAO/O,EAAKmL,KAAK4D,MAAQmV,EAAoB4C,QAAU5C,EAAoByD,aAAa,GAAGhf,OAA6Iub,EAAoB0D,WAAWjf,OAAS,kBAACC,GAAA,EAAD,CAAQjH,UAAW,eAAgB8K,IAAK6E,eAAmBC,qBAAqB2S,EAAoB0D,WAAWjf,UAAgB,kBAACC,GAAA,EAAD,CAAQjH,UAAW,2CAA2C,kBAAC,IAAD,OAAzW,kBAACiH,GAAA,EAAD,CAAQjH,UAAW,eAAgB8K,IAAK6E,eAAmBC,qBAAqB2S,EAAoByD,aAAa,GAAGhf,UAAmRub,EAAoBqG,aAAe,kBAAC3hB,GAAA,EAAD,CAAQjH,UAAW,OAAQ8K,IAAK6E,eAAmBC,qBAAqB2S,EAAoBqG,gBAAsB,kBAAC3hB,GAAA,EAAD,CAAQjH,UAAW,2CAAnB,IAA6F,UAA7BuiB,EAAoB3jB,KAAkB,kBAAC,IAAD,MAAiB,kBAAC,IAAD,QACv2B2jB,GAAuB,kBAAC1hB,EAAA,EAAD,CAAYC,QAAQ,KAAKd,UAAW,wBAC9B,cAA5BuiB,EAAoB3jB,KAAwBP,EAAKmL,KAAK4D,MAAQmV,EAAoB4C,MAAM/X,KAAO/O,EAAKmL,KAAK4D,MAAQmV,EAAoB4C,MAAS5C,EAAoByD,aAAa,GAAGtH,WAAY,IAAI6D,EAAoByD,aAAa,GAAGrH,UAAc4D,EAAoB0D,WAAWvH,WAAY,IAAI6D,EAAoB0D,WAAWtH,UAA2C,SAA5B4D,EAAoB3jB,KAAiB2jB,EAAoBsG,WAAa,cAGvZtG,GAAuB,kBAAC1hB,EAAA,EAAD,CAAYC,QAAQ,KAAKd,UAAW,wBAApC,kBAKtBuiB,IAAwBiB,IAAuB,kBAAC1b,GAAA,EAAD,CACjDjL,QAAS,kBAAI4mB,IAAsB,IACnCzjB,UAAW,OACX2oB,KAAK,MACL/rB,MAAM,UACNsK,aAAW,YAEX,kBAAC,IAAD,SAIH,kBAACuW,GAAA,EAAD,CACCzd,UAAW4c,IAAW,eAAEhd,EAAQ8d,QAAS,IACzC5c,QAASic,EAAYvR,OAAS,IAAK,aAAe,YAClDmS,OAAO,QACP7N,KAAM0T,GACNxR,QAAS,kBAAIyR,IAAsB,IACnC7F,OAAQ,kBAAI6F,IAAsB,IAClC7jB,QAAS,CACRqY,MAAO8E,EAAYvR,OAAS,IAAK5L,EAAQie,YAAcje,EAAQke,uBAGhE,yBAAK9d,UAAW,oDACf,kBAAC8H,GAAA,EAAD,CAAY9H,UAAW,OAAQpD,MAAM,WACpC,kBAAC,IAAD,OAED,kBAACiE,EAAA,EAAD,CAAYC,QAAQ,KAAKd,UAAW,wBAApC,YAkBA,kBAAC8H,GAAA,EAAD,CAAY9H,UAAW,OAAQpD,MAAM,UAAUC,QAAS,kBAAI4mB,IAAsB,KAC5D,QAApBjiB,EAAM0R,UAAuB,kBAAC,IAAD,MAAuB,kBAAC,IAAD,QAGvD,kBAACjH,EAAA,EAAD,MAEA,kBAAC6c,GAAA,EAAD,CAAY9oB,UAAWJ,EAAQmpB,aAG3BjQ,GAAe,kBAAC+F,GAAA,EAAD,CACfja,cAAc,EACduH,YAAY,EACZoH,iBAAiB,EACjBC,YAAY,EACZjV,YAAY,EACZqX,gBAAc,EACdC,YAAU,EACVha,WAAYid,EAAYkQ,MACxBltB,QAASid,EAASiQ,MAClBjtB,MAAO+mB,GACP3f,KAAM,WACNmC,aAAc,SAACmhB,GAAD,OAAa9B,GAAc8B,IACzCjoB,WAAY,SAACugB,EAAYkK,GACpBlF,IAAmBxmB,MAAMC,QAAQuhB,IACpCA,EAAW5W,KAAI,SAAAuD,GACVA,EAAM0B,MAAQ6b,EAAY7b,KAAO1B,EAAM0c,gBAAkBa,EAAYb,gBACxEzD,GAAcjZ,GACdzC,QAAQC,IAAI,aAAc6V,EAAYkK,aAW7C1G,GAAuB,kBAACriB,EAAA,EAAD,CAAUsH,GAAI,GAAIxH,UAAW,yCACnD,kBAACkW,GAAA,EAAD,CAAOgT,QAAM,EAAClpB,UAAWJ,EAAQqY,OAChC,kBAAC6Q,GAAA,EAAD,CAAY9oB,UAAWJ,EAAQmpB,aAC7B/F,MAA0BzlB,MAAMC,QAAQ4kB,IAAmB7kB,MAAMC,QAAQ4kB,IAA2C,IAAzBA,EAAc1X,SAAmB,kBAAC3K,EAAA,EAAD,KAC7H,kBAACG,EAAA,EAAD,CAAUsH,GAAI,GAAIxH,UAAW,qDAC5B,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,KAC9C,yBAAKlG,UAAU,gCACd,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAO0K,MAAO,GAAIxL,UAAU,SAC9C,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAOd,UAAU,YAIrC,kBAACE,EAAA,EAAD,CAAUsH,GAAI,GAAIxH,UAAW,qDAC5B,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,KAC9C,yBAAKlG,UAAU,gCACd,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAO0K,MAAO,IAAKxL,UAAU,SAC/C,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAOd,UAAU,aAIrC,kBAACE,EAAA,EAAD,CAAUsH,GAAI,GAAIxH,UAAW,qDAC5B,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,KAC9C,yBAAKlG,UAAU,gCACd,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAO0K,MAAO,GAAIxL,UAAU,SAC9C,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAOd,UAAU,aAIrC,kBAACE,EAAA,EAAD,CAAUsH,GAAI,GAAIxH,UAAW,qDAC5B,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,KAC9C,yBAAKlG,UAAU,gCACd,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAO0K,MAAO,GAAIxL,UAAU,SAC9C,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAOd,UAAU,YAIrC,kBAACE,EAAA,EAAD,CAAUsH,GAAI,GAAIxH,UAAW,qDAC5B,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,KAC9C,yBAAKlG,UAAU,gCACd,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAO0K,MAAO,GAAIxL,UAAU,SAC9C,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAOd,UAAU,cAIrC,kBAACE,EAAA,EAAD,CAAUsH,GAAI,GAAIxH,UAAW,qDAC5B,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,KAC9C,yBAAKlG,UAAU,gCACd,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAO0K,MAAO,GAAIxL,UAAU,SAC9C,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAOd,UAAU,aAIrC,kBAACE,EAAA,EAAD,CAAUsH,GAAI,GAAIxH,UAAW,qDAC5B,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,KAC9C,yBAAKlG,UAAU,gCACd,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAO0K,MAAO,IAAKxL,UAAU,SAC/C,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAOd,UAAU,YAIrC,kBAACE,EAAA,EAAD,CAAUsH,GAAI,GAAIxH,UAAW,qDAC5B,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,KAC9C,yBAAKlG,UAAU,gCACd,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAO0K,MAAO,IAAKxL,UAAU,SAC/C,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAOd,UAAU,YAIrC,kBAACE,EAAA,EAAD,CAAUsH,GAAI,GAAIxH,UAAW,qDAC5B,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,SAAS0K,MAAO,GAAItF,OAAQ,KAC9C,yBAAKlG,UAAU,gCACd,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAO0K,MAAO,GAAIxL,UAAU,SAC9C,kBAACuL,GAAA,EAAD,CAAUzK,QAAQ,OAAOd,UAAU,gBAKnCgjB,MAA0BzlB,MAAMC,QAAQ4kB,IAAmB7kB,MAAMC,QAAQ4kB,IAAmC,IAAjBO,EAAMjY,SAAmB,kBAAC3K,EAAA,EAAD,KACtH,kBAACG,EAAA,EAAD,CAAUsH,GAAI,GAAIxH,UAAW,qDAC5B,kBAACa,EAAA,EAAD,CAAYC,QAAQ,YAAYlE,MAAM,gBAAgBoD,UAAU,oHAAoHmH,MAAO,CAACvK,MAAO4E,EAAMkL,QAAQ/P,KAAKsW,SAAU7L,WAAY5F,EAAMkL,QAAQtF,WAAd,UAC3O,kBAAC,IAAD,CAAmBoD,SAAS,aAE7B,kBAAC3J,EAAA,EAAD,CAAYC,QAAQ,QAAQlE,MAAM,gBAAgBoD,UAAU,OAAOmH,MAAO,CAACvK,MAAO4E,EAAMkL,QAAQ/P,KAAKsW,WAArG,iDAMA1V,MAAMC,QAAQ4kB,KAAmBY,IAAyB,kBAACvX,GAAA,EAAD,CAAMzL,UAAWJ,EAAQupB,MACpF/G,EAAcja,KAAI,SAAC8c,EAAM7c,GAEzB,GAAc,IAAVA,GAAgBA,EAAQ,GAAKga,EAAcha,EAAM,GAAGgF,MAAQgV,EAAcha,GAAOgF,IAAO,CAC3F,IAAIgc,EAAc,GACdC,GAAW,EACXriB,GAAS,EACTsiB,GAAuB,EACvBC,GAAuB,EACvBC,GAA2B,EAsB/B,GArBIvE,EAAKvpB,MAAM+tB,MAAQ,GAAKxE,EAAKvpB,MAAMguB,eACtCJ,EAAuBrE,EAAKvpB,MAAMguB,aAAa7M,QAC3CoI,EAAKvpB,MAAMguB,aAAa9D,SAAWvnB,EAAKmL,KAAK4D,IAChDoc,EAA2B,MAEnBvE,EAAKE,QAAUF,EAAKvpB,MAAMguB,aAAa9D,OAC/C4D,EAA2BvE,EAAKgB,WAAWvH,WAGvCnhB,MAAMC,QAAQynB,EAAKe,eACtBf,EAAKe,aAAa7d,KAAI,SAAAwhB,GACjBA,EAAYvc,MAAQ6X,EAAKvpB,MAAMguB,aAAa9D,SAC/C4D,EAA2BG,EAAYjL,gBAKJ,uBAAlCuG,EAAKvpB,MAAMguB,aAAahuB,OAAkCupB,EAAKvpB,MAAMguB,aAAa9D,OAAOxY,MAAQ/O,EAAKmL,KAAK4D,KAA0C,oBAAlC6X,EAAKvpB,MAAMguB,aAAahuB,SAC/I6tB,GAAuB,IAGR,cAAbtE,EAAKrmB,KAAsB,CAC9B,IAAIgoB,EAAgB3B,EAAKE,MACrB/U,KAAKC,OAAO4U,EAAKE,SACpByB,EAAgB3B,EAAKE,MAAM/X,KAExB/O,EAAKmL,KAAK4D,MAAQwZ,EACjBrpB,MAAMC,QAAQynB,EAAKe,eAClBf,EAAKe,aAAatb,OAAS,IAC9B2e,EAAWpE,EAAKe,aAAa,GAC7BoD,EAAcnE,EAAKe,aAAa,GAAGtH,WAAY,IAAIuG,EAAKe,aAAa,GAAGrH,UACxE3X,EAASie,EAAKe,aAAa,GAAGhf,SAOhCqiB,EAAWpE,EAAKgB,WAChBmD,EAAcnE,EAAKgB,WAAWvH,WAAY,IAAIuG,EAAKgB,WAAWtH,UAC9D3X,EAASie,EAAKgB,WAAWjf,YAGL,SAAbie,EAAKrmB,OACbwqB,EAAcnE,EAAK4D,WACnB7hB,EAASie,EAAK2D,cAGf,OACC,kBAACjd,GAAA,EAAD,CACC3L,UAAW,uBACXnD,QAAS,SAACT,GACTwlB,EAAkB,+BAAgC,IAClDA,EAAkB,sBAAuBqD,GACzCS,GAAwBT,IAEzBpT,cAAe4S,GAAkB,eAAgBQ,GACjDzc,IAAK,QAAQJ,EACbjB,MAAO,CAACC,WAAgC,iBAAnBwc,GAAYhlB,MAAwBglB,GAAYlY,MAAM0B,MAAM6X,EAAK7X,IAAK5L,EAAMkL,QAAQtF,WAAd,QAAoD,eAC/IwE,QAAM,GAELyd,GAAY,kBAACvd,GAAA,EAAD,KACZ,kBAAC8d,EAAA,EAAD,CACC9oB,QAAQ,MACR+oB,aAAa,IACbC,aAAc,CACbC,SAAU,SACVC,WAAY,SAEbpqB,QAAS,CACRqqB,IAA2B,WAAtBZ,EAASjD,SAAuB,eAAuC,QAArBiD,EAASjD,SAAoB,gBAAkB,gBAGrGiD,EAASriB,QAAU,kBAACC,GAAA,EAAD,CAAQjH,UAAWJ,EAAQsqB,cAAepf,IAAK6E,eAAmBC,qBAAqByZ,EAASriB,WACnHqiB,EAASriB,QAAU,kBAACC,GAAA,EAAD,CAAQjH,UAAWJ,EAAQsqB,eAC/C,kBAAC,IAAD,UAIDb,GAAY,kBAACvd,GAAA,EAAD,KACX9E,GAAU,kBAACC,GAAA,EAAD,CAAQ6D,IAAK6E,eAAmBC,qBAAqB5I,MAC/DA,GAAU,kBAACC,GAAA,EAAD,CAAQjH,UAAWJ,EAAQuqB,YACvB,UAAdlF,EAAKrmB,KAAkB,kBAAC,IAAD,MAAiB,kBAAC,IAAD,QAG3C,kBAACoN,GAAA,EAAD,CACChM,UAAU,+BACV2I,QACC,kBAAC9H,EAAA,EAAD,CAAYC,QAAQ,QAAQlE,MAAM,cAAcoD,UAAW,wBACzDopB,GAGH7gB,UACC,yBAAKvI,UAAU,wBACbzC,MAAMC,QAAQynB,EAAK+B,SAAW,kBAACnmB,EAAA,EAAD,CAAYC,QAAQ,QAAQlE,MAAM,UAAUoD,UAAU,QACnFilB,EAAK+B,OAAOtc,OAAS,EAAIua,EAAK+B,OAAOtc,OAAO,wBAAmD,IAAvBua,EAAK+B,OAAOtc,OAAeua,EAAK+B,OAAO,GAAGtI,WAAW,gBAAmB,MAE/InhB,MAAMC,QAAQynB,EAAK+B,SAAiC,IAAtB/B,EAAK+B,OAAOtc,SAAgB,yBAAK1K,UAAU,wCAC3E,kBAACa,EAAA,EAAD,CAAYC,QAAQ,QAAQlE,MAAM,cAAcoD,UAAU,kBACxDwpB,GAAoD,IAEtD,kBAAC3oB,EAAA,EAAD,CAAYC,QAAQ,QAAQlE,MAAM,gBAAgBoD,UAAU,uCAC1DspB,GAA6C,mBAE9CC,GAAwB,yBAAKvpB,UAAW,oCAAqCmH,MAAO,CAACvK,MAAO4E,EAAMkL,QAAQ0d,UAC1G,kBAACvpB,EAAA,EAAD,CAAYC,QAAQ,QAAQlE,MAAM,UAAUoD,UAAW,aAAvD,mBAGA,kBAAC,KAAD,CAAWA,UAAW,eAAgBwK,SAAS,YAG9C+e,GAAwB,yBAAKvpB,UAAW,oCAAqCmH,MAAO,CAACvK,MAAO4E,EAAMkL,QAAQ/P,KAAKsW,WAC5E,SAAlCgS,EAAKvpB,MAAMguB,aAAahuB,OAAoBupB,EAAKvpB,MAAMguB,aAAa9D,SAAWvnB,EAAKmL,KAAK4D,KAAQ,kBAAC,KAAD,CAAUpN,UAAW,eAAgBwK,SAAS,WAC5G,uBAAlCya,EAAKvpB,MAAMguB,aAAahuB,OAAoE,aAAlCupB,EAAKvpB,MAAMguB,aAAahuB,QAAyBupB,EAAKvpB,MAAMguB,aAAa9D,SAAWvnB,EAAKmL,KAAK4D,KAAQ,kBAAC,KAAD,CAAapN,UAAW,eAAgBwK,SAAS,WAC/K,mBAAlCya,EAAKvpB,MAAMguB,aAAahuB,OAAgE,SAAlCupB,EAAKvpB,MAAMguB,aAAahuB,QAAqBupB,EAAKvpB,MAAMguB,aAAa9D,SAAWvnB,EAAKmL,KAAK4D,KAAQ,kBAAC,KAAD,CAAapN,UAAW,eAAgBpD,MAAO,YAAa4N,SAAS,cAG/NjN,MAAMC,QAAQynB,EAAK+B,SAAiC,IAAtB/B,EAAK+B,OAAOtc,SAAgB,kBAAC7J,EAAA,EAAD,CAAYC,QAAQ,QAAQlE,MAAM,YAAYoD,UAAU,YAMvHilB,EAAKvpB,MAAM2uB,gBAAkB,GAAK,kBAACC,EAAA,EAAD,KAClC,kBAACrjB,GAAA,EAAD,CAAQjH,UAAW,+CACjBilB,EAAKvpB,MAAM2uB,0BAYnB,kBAAC9B,EAAA,EAAD,CAAQ/P,SAAS,WAAW5b,MAAM,YAAYoD,UAAWJ,EAAQ2qB,aAChE,kBAAC9B,EAAA,EAAD,KACC,kBAAC3gB,GAAA,EAAD,CACC6gB,KAAK,QACL/rB,MAAM,UACNsK,aAAW,UACXrK,QAh6Bc,WACrB0nB,KAjMIzL,IACHoK,IAAmB,GACnB5kB,EAAgB,WACd,CACCI,IAAK,YACLE,KAAM,UACNC,OAAQ,CAAC7C,EAAG,KACZyB,KAAM,GACNN,OAAO,IAER2B,MAAK,SAAArB,GACFF,MAAMC,QAAQC,KACjBmkB,EAAkB,WAAYnkB,GAC9B8lB,GAAY9lB,IAEb6lB,IAAS,GACTJ,IAAmB,MAdpB,OAeS,SAAAjkB,GACRgK,QAAQC,IAAI,aAAcjK,GAC1B,IAAIulB,EAAWvlB,EACXmR,KAAKC,OAAOpR,KAEdulB,EADG,QAASvlB,EACDA,EAAEC,IAGFkR,KAAKE,UAAUrR,IAI5BqkB,GAASkB,GACTtB,IAAmB,SAokCd,kBAAC,IAAD,OAGD,kBAACsH,GAAA,EAAD,CACC5tB,MAAM,UACNsK,aAAW,MACXlH,UAAWJ,EAAQ6qB,UACnB5tB,QAAS,kBAAI4mB,IAAuBD,OAElCA,IAAsB,kBAAC,IAAD,MACvBA,IAAsB,kBAAC,KAAD,OAGxB,yBAAKxjB,UAAWJ,EAAQ8qB,UAkB5BnI,GAAuB,kBAACrM,GAAA,EAAD,CAAOgT,QAAM,EAACriB,UAAW,EAAG7G,UAAWJ,EAAQ+qB,kBACtE,kBAACzqB,EAAA,EAAD,CAAUsH,GAAI,GAAIxH,UAAU,sCACzB,CAAC,QAAS,OAAQ,QAAS,SAASiV,SAASkO,GAAMvkB,OAAS,kBAACkqB,GAAA,EAAD,CAC7D9oB,UAAW,aAAaJ,EAAQgrB,kBAChCzjB,MAAO,CAACwR,KAAM,GAAI5W,gBAAiBP,EAAMkL,QAAQtF,WAAd,SACnCyjB,6BAA6B,EAC7B9iB,IAAKga,GAEL,kBAAChiB,EAAA,EAAD,CAAeC,UAAU,QACvB0iB,EAA6Bva,KAAI,SAAC0f,EAAmBzY,GACrD,IAAI0b,GAAkB,EAClBC,GAAe,EAMnB,GALI3b,EAAS,IACRsT,EAA6BtT,GAAQhC,MAAQsV,EAA8BtT,EAAS,GAAIhC,KAAOya,EAAkB/B,aAAa1Y,MAAQmV,EAAoBnV,MAC7J2d,GAAe,IAGblD,GAAqBkD,EAIxB,OAHiC,uBAA5BlD,EAAkBnsB,OAAkCmsB,EAAkBjC,OAAOxY,MAAQ/O,EAAKmL,KAAK4D,KAAoC,oBAA5Bya,EAAkBnsB,SAC7HovB,GAAkB,GAGlB,kBAAC5qB,EAAA,EAAD,CACCC,GAAI,GACJH,UAAW,kBAAkB6nB,EAAkBjC,OAAOxY,MAAQ/O,EAAKmL,KAAK4D,IAAK,mBAAqB,YAClGxD,GAAI,WAAWie,EAAkBza,IACjC5E,IAAK,gBAAgB+Z,EAAoBnV,IAAI,YAAYgC,GAOzD,kBAACiR,GAAA,EAAD,CACCrgB,UAAW,iCAAiC6nB,EAAkBjC,OAAOxY,MAAQ/O,EAAKmL,KAAK4D,IAAM,gBAAgBxN,EAAQorB,gBAAoB,YAAYprB,EAAQqrB,oBAC7JzK,2BAA4B,SAAC0K,GACxBA,GAAc7O,EAAO,UACQ,SAA5BwL,EAAkBnsB,OAAoBmsB,EAAkBjC,OAAOxY,MAAQ/O,EAAKmL,KAAK4D,IACpFiP,EAAO,QAAS6J,KAAK,2BAA4B,CAACwB,QAASG,EAAmBre,KAAMnL,EAAKmL,OAEpD,aAA5Bqe,EAAkBnsB,OAAoD,uBAA5BmsB,EAAkBnsB,OAAmCmsB,EAAkBjC,OAAOxY,MAAQ/O,EAAKmL,KAAK4D,KACnJiP,EAAO,QAAS6J,KAAK,uBAAwB,CAACwB,QAASG,EAAmBre,KAAMnL,EAAKmL,WAMrFshB,GAAmB1a,KAAKC,OAAOwX,EAAkBjC,SAAY,yBAAK5lB,UAAW,0CAC/E,kBAACa,EAAA,EAAD,CAAYC,QAAQ,QAAQd,UAAW,qCACrC6nB,EAAkBjC,OAAOlH,WAAW,IAAImJ,EAAkBjC,OAAOjH,WAEnE,kBAAC7W,GAAA,EAAD,CAAYZ,aAAW,cAAcrK,QAAS4nB,GAAkB,UAAWoD,GAAoB7nB,UAAW,GAAImK,KAAK,SAClH,kBAAC,IAAD,CAAgBK,SAAS,eAGxBsgB,GAAmB,CAAC,QAAS,OAAQ,QAAS,SAAS7V,SAAS4S,EAAkBjpB,OAASrB,MAAMC,QAAQqqB,EAAkBsD,cAAiB,yBAAKnrB,UAAW,mCAC7J6nB,EAAkBsD,YAAYhjB,KAAI,SAAAijB,GAAU,OAC5C,yBAAKprB,UAAW,8CACa,UAA3B6nB,EAAkBjpB,MAAoB,kBAACysB,GAAA,EAAD,CAAWrrB,UAAW,gBAAiB8K,IAAK6E,eAAmBC,qBAAqBwb,GAAaxgB,IAAKwgB,EAAW1tB,OAC5H,UAA3BmqB,EAAkBjpB,MAAoB,yBAAKoB,UAAW,4CACtD,kBAAC,KAAD,CAAwBA,UAAW,aACnC,kBAACa,EAAA,EAAD,CAAYC,QAAQ,QAAQlE,MAAM,cAAcoD,UAAW,sBACzDorB,EAAW1tB,OAGc,UAA3BmqB,EAAkBjpB,MAAoB,yBAAKoB,UAAW,4CACtD,kBAAC,KAAD,CAAmBA,UAAW,aAC9B,kBAACa,EAAA,EAAD,CAAYC,QAAQ,QAAQlE,MAAM,cAAcoD,UAAW,sBACzDorB,EAAW1tB,OAGc,SAA3BmqB,EAAkBjpB,MAAmB,yBAAKoB,UAAW,4CACrD,kBAAC,KAAD,CAAgBA,UAAW,aAC3B,kBAACa,EAAA,EAAD,CAAYC,QAAQ,QAAQlE,MAAM,cAAcoD,UAAW,sBACzDorB,EAAW1tB,aAOfotB,GAAmB,kBAACjqB,EAAA,EAAD,CAAYC,QAAQ,QAAQlE,MAAM,cAAcoD,UAAW,YAAasrB,WAAS,GACnGzD,EAAkBhL,SAGpBiO,GAAmB,yBAAK9qB,UAAW,oCAAqCmH,MAAO,CAACvK,MAAO4E,EAAMkL,QAAQ0d,UACrG,kBAACvpB,EAAA,EAAD,CAAYC,QAAQ,QAAQlE,MAAM,UAAUoD,UAAW,aAAvD,mBAGA,kBAAC,KAAD,CAAWA,UAAW,OAAQwK,SAAS,YAGtCsgB,GAAmB,yBAAK9qB,UAAW,oCAAqCmH,MAAO,CAACvK,MAAO4E,EAAMkL,QAAQ/P,KAAKsW,WAC1G4U,EAAkB0D,YAAc,kBAAC1qB,EAAA,EAAD,CAAYC,QAAQ,QAAQd,UAAW,qBACtE6nB,EAAkB0D,sBAAsBloB,KAAMwkB,EAAkB0D,WAAWC,iBAAmB,IAAInoB,KAAKwkB,EAAkB0D,YAAYC,kBAEzG,SAA5B3D,EAAkBnsB,OAAoBmsB,EAAkBjC,OAAOxY,MAAQ/O,EAAKmL,KAAK4D,KAAQ,kBAAC,KAAD,CAAUpN,UAAW,OAAQwK,SAAS,WAClG,uBAA5Bqd,EAAkBnsB,OAA8D,aAA5BmsB,EAAkBnsB,QAAyBmsB,EAAkBjC,OAAOxY,MAAQ/O,EAAKmL,KAAK4D,KAAQ,kBAAC,KAAD,CAAapN,UAAW,OAAQwK,SAAS,WAC/J,mBAA5Bqd,EAAkBnsB,OAA0D,SAA5BmsB,EAAkBnsB,QAAqBmsB,EAAkBjC,OAAOxY,MAAQ/O,EAAKmL,KAAK4D,KAAQ,kBAAC,KAAD,CAAapN,UAAW,OAAQpD,MAAO,YAAa4N,SAAS,kBAS9MjN,MAAMC,QAAQ+kB,EAAoByE,SAAUzE,EAAoByE,OAAOtc,OAAS,GAAe,kBAACxK,EAAA,EAAD,CAAUC,GAAI,GAAIH,UAAW,0BAC5H,yBAAMA,UAAWJ,EAAQoH,QAAzB,KACA,yBAAMhH,UAAW,8CAChB,yBAAMA,UAAWJ,EAAQ6rB,kBAG5B,yBAAMzrB,UAAU,aAAa4J,GAAG,iBAAhC,OAMF,kBAAC7J,EAAA,EAAD,CACCC,UAAW,CAAC,QAAS,OAAQ,QAAS,SAASiV,SAASkO,GAAMvkB,MAAO,0BAA4BgB,EAAQ8rB,kBACzGvkB,MAAO,CAAEpF,gBAAiBP,EAAMkL,QAAQtF,WAAW6Q,MAAO9F,IAAK,CAAC,QAAS,OAAQ,QAAS,SAAS8C,SAASkO,GAAMvkB,MAAO,EAAI,SAE5HukB,GAAM0C,WAAa,kBAAC3lB,EAAA,EAAD,CAAUC,GAAI,GAAIH,UAAW,2CAChD,yBAAKA,UAAW,YACb,kBAACa,EAAA,EAAD,CAAYC,QAAQ,QAAQlE,MAAM,cAAcoD,UAAW,aACzDmjB,GAAM0C,UAAUD,OAAOlH,WAAW,IAAIyE,GAAM0C,UAAUD,OAAOjH,WAE/D,kBAAC9d,EAAA,EAAD,CAAYC,QAAQ,QAAQlE,MAAM,cAAcoD,UAAW,IACzDmjB,GAAM0C,UAAUhJ,WAKrB,CAAC,QAAS,OAAQ,QAAS,SAAS5H,SAASkO,GAAMvkB,OAAS,kBAACsB,EAAA,EAAD,CAAUC,GAAI,GAAIH,UAAW,oDACzF,kBAAC,KAAD,CACCc,QAAQ,WACR2G,MAAQ,CAAC,QAAS,OAAQ,QAAS,SAASwN,SAASkO,GAAMvkB,OAAUrB,MAAMC,QAAQ2lB,GAAMgI,cAAehI,GAAMgI,YAAc,EAAchI,GAAMgI,YAAY,QAAK9b,EACjK3H,SAAU,SAAC+R,GACV2J,IAAS,SAAAuI,GACR,IACC,IAAIC,EAAWxb,KAAKmV,MAAMnV,KAAKE,UAAUqb,IAOzC,OANIlS,EACHmS,EAAST,YAAc,CAAC1R,UAGjBmS,EAAST,YAEVS,EACN,MAAMjsB,GAEP,OADAsJ,QAAQrI,MAAMjB,GACPgsB,MAGT1iB,QAAQC,IAAI,sBAAuBuQ,IAEpCoS,WAAY,EACZC,cAA8B,SAAf3I,GAAMvkB,KAAiB,CAAC,UAAW,UAAW,UAAW,iBAAmB,CAAEukB,GAAMvkB,KAAK,SAIzG8kB,IAAsB,kBAACxjB,EAAA,EAAD,CAAUC,GAAI,GAAIH,UAAW,yDAClDmkB,GAAkBhc,KAAI,SAACwE,GAAD,OACrB,kBAAC6d,GAAA,EAAD,CACChiB,IAAKmE,EAAOjP,KACZd,MAAO+P,EAAO/P,MACdsK,aAAY,UAAUyF,EAAO9E,MAC7BhL,QAAS,WA/0Ba,IAAC+B,EAg1BtB+kB,IAAsB,GAh1BA/kB,EAi1BE+N,EAAOjP,KAh1BxC0lB,IAAS,SAAAuI,GACR,IACC,IAAIC,EAAWxb,KAAKmV,MAAMnV,KAAKE,UAAUqb,IAEzC,OADAC,EAAShtB,KAAOA,EACTgtB,EACN,MAAMjsB,GAEP,OADAsJ,QAAQrI,MAAMjB,GACPgsB,OA20BDxkB,MAAO,CAACC,WAAYuF,EAAO/P,MAAOA,MAAO4E,EAAMkL,QAAQtF,WAAW6Q,OAClEjY,UAAW,QAEV2M,EAAO9H,UAKZ,kBAAC3E,EAAA,EAAD,CAAUC,GAAI,GAAIH,UAAW,8BAE5B,kBAAC8H,GAAA,EAAD,CACCjL,QAAS,SAACT,GACTunB,IAAuBD,KAExBxc,aAAYwc,GAAsB,CAAC,QAAS,OAAQ,QAAS,SAASzO,SAASkO,GAAMvkB,OAAUrB,MAAMC,QAAQ2lB,GAAMgI,cAAehI,GAAMgI,YAAc,EAAc,qBAAuB,0BAA6B,wBACxNnrB,UAAW,QAET0jB,GAA2D,CAAC,QAAS,OAAQ,QAAS,SAASzO,SAASkO,GAAMvkB,OAAUrB,MAAMC,QAAQ2lB,GAAMgI,cAAehI,GAAMgI,YAAc,EAAc,kBAAC,KAAD,CAAoBvuB,MAAM,YAAe,kBAAC,KAAD,CAAYA,MAAM,YAApO,kBAAC,KAAD,CAAgBA,MAAM,aAE7C,yBAAKoD,UAAW,+BAChB,kBAAC,KAAD,CACCc,QAAS,CAAC,QAAS,OAAQ,QAAS,SAASmU,SAASkO,GAAMvkB,MAAO,WAAa,WAChFmtB,WAAS,EACTC,KAAM,EACNC,OAAQ,SAAC9M,EAAW/iB,GACfmmB,EAAoBnV,MAAQY,OAAO+W,QAAQ5F,IAC9CiE,IAAS,SAAAuI,GACR,IACC,IAAIC,EAAW,CACb/O,QAASsC,EACT2G,aAAcvD,EAAoBnV,KAOpC,OALIgD,KAAKC,OAAOsb,MACfC,EAAWxb,KAAKmV,MAAMnV,KAAKE,UAAUqb,KAC5B9O,QAAUsC,EACnByM,EAAS9F,aAAevD,EAAoBnV,KAEtCwe,EAEN,MAAMjsB,GAEP,OADAsJ,QAAQrI,MAAMjB,GACPgsB,MAKNpJ,EAAoBnV,KAAOiP,EAAO,SACrCA,EAAO,QAAS6J,KAAK,yBAA0B,CAACJ,aAAcvD,EAAoBnV,IAAK5D,KAAMnL,EAAKmL,QAIpGwN,QAAS,WACJuL,EAAoBnV,KAAOiP,EAAO,SACrCA,EAAO,QAAS6J,KAAK,yBAA0B,CAACJ,aAAcvD,EAAoBnV,IAAK5D,KAAMnL,EAAKmL,QAGpGuN,aAAcwL,EAAoBnV,MAAQ+V,GAAM2C,aAAc3C,GAAMtG,aAAUxN,EAC9E3H,SAAU,SAACyX,KAGXtI,YAAY,4BACZqV,SAAUrK,EACV/K,WAAY,CACXqV,UA10B0B,SAAC/vB,GAClC,GAAkB,UAAdA,EAAMoM,IAAiB,CAC1BpM,EAAMqR,iBACN,IAAI2e,EAAkBhwB,EAAMyY,OAAOpN,MAElC2kB,EADGpe,OAAOC,SAASme,GACDA,EAAgB9N,OAGhB,GAEdtQ,OAAO+W,QAAQqH,KACnB/P,EAAO,QAAS6J,KAAK,yBAA0B,CAACJ,aAAcvD,EAAoBnV,IAAK5D,KAAMnL,EAAKmL,OA9CzE,SAAC6iB,GAC5B,GAAI9J,EAAqB,CACxB,IAAI+J,EAAU,2BAAQnJ,IAAR,IAAeyC,OAAQvnB,EAAKmL,KAAM+hB,WAAY,IAAIloB,OAC5DgpB,IACCjc,KAAKC,OAAOgc,GACfC,EAAalc,KAAKmc,MAAMF,EAAeC,GAE/Bte,OAAOC,SAASoe,KACxBC,EAAWzP,QAAUwP,EAAc/N,WAIhCtQ,OAAO+W,QAAQuH,EAAWzP,UAAa,CAAC,QAAS,OAAQ,QAAS,SAAS5H,SAASqX,EAAW1tB,OAAUrB,MAAMC,QAAQ8uB,EAAWnB,cAAemB,EAAWnB,YAAYzgB,OAAS,KACpL2R,EAAO,QAAS6J,KAAK,eAAgB,CAACwB,QAAS4E,EAAYxG,aAAcvD,EAAqB/Y,KAAMnL,EAAKmL,OAChGqY,EAAa/d,UAChB+d,EAAa/d,QAAQ2D,MAAQ,GAC7Boa,EAAa/d,QAAQiM,SAGtBqT,GAAS,CACRuC,UAAU,EACVC,OAAQvnB,EAAKmL,KACbqc,UAAW,KACXjnB,KAAM,OACNie,QAAS,GACTiJ,aAAcvD,EAAoBnV,QAsBzCof,CAAoBJ,cA40BpB,kBAACra,EAAA,EAAD,CACCyE,aAAW,EACX1G,KAA6B,OAAvB8T,GAAY3W,OAClB+E,QAAS0S,GACTzS,gBAAgB,iBAChBC,eACyB,OAAvB0R,GAAY3W,QAA0C,OAAvB2W,GAAY5W,OAC1C,CAAEmF,IAAKyR,GAAY3W,OAAQmF,KAAMwR,GAAY5W,aAC7CqC,GAGmB,iBAArBuU,GAAYhlB,MAA2B,kBAACyT,EAAA,EAAD,CAAUxV,QAAS,SAACT,GAC3DwlB,EAAkB,sBAAuBgC,GAAYlY,OACrDgZ,OAFuC,qBAIlB,iBAArBd,GAAYhlB,MAA2B,kBAACyT,EAAA,EAAD,CACvCxV,QAAS,SAACT,GAt1CmB,IAAC0pB,IAu1CHlC,GAAYlY,MAt1C3CkW,EAAkB,iBAAiB,SAAA8E,GAClC,IACC,IAAIC,EAAWvW,KAAKmV,MAAMnV,KAAKE,UAAUoW,IAYzC,OAVAC,EAAWA,EAASrZ,QAAO,SAAA2X,GAC1B,OAAIa,IACC1V,KAAKC,OAAOyV,GACRb,EAAK7X,MAAQ0Y,EAAa1Y,IAE3B6X,EAAK7X,MAAQ0Y,MAMrB,MAAMnmB,GAEP,OADAsJ,QAAQrI,MAAMjB,GACP+mB,MAGTrK,EAAO,QAAS6J,KAAK,uBAAwB,CAACJ,aAAcA,EAActc,KAAMnL,EAAKmL,OAm0ChFkb,OAHsC,wBAQlB,iBAArBd,GAAYhlB,MAA2B,kBAACyT,EAAA,EAAD,CACvCxV,QAAS,SAACT,GAr0CkB,IAAC0pB,IAs0CHlC,GAAYlY,MAr0C1CkW,EAAkB,iBAAiB,SAAA8E,GAClC,IACC,IAAIC,EAAWvW,KAAKmV,MAAMnV,KAAKE,UAAUoW,IAYzC,OAVAC,EAAWA,EAASrZ,QAAO,SAAA2X,GAC1B,OAAIa,IACC1V,KAAKC,OAAOyV,GACRb,EAAK7X,MAAQ0Y,EAAa1Y,IAE3B6X,EAAK7X,MAAQ0Y,MAMrB,MAAMnmB,GAEP,OADAsJ,QAAQrI,MAAMjB,GACP+mB,MAITrK,EAAO,QAAS6J,KAAK,+BAAgC,CAACJ,aAAcA,EAActc,KAAMnL,EAAKmL,OAizCxFkb,OAHsC,uBASjB,YAArBd,GAAYhlB,MAAsBglB,GAAYlY,MAAMka,OAAOxY,MAAQ/O,EAAKmL,KAAK4D,KAAQ,kBAACiF,EAAA,EAAD,CACtFxV,QAAS,SAACT,GACTsoB,KACAtB,GAAS,CACRuC,UAAU,EACVC,OAAQvnB,EAAKmL,KACbqc,UAAWjC,GAAYlY,MACvBmR,QAAS,GACTiJ,aAAcvD,EAAoBnV,MAE/ByU,EAAa/d,UAChB+d,EAAa/d,QAAQ2D,MAAQ,GAC7Boa,EAAa/d,QAAQiM,WAZ+D,iBAoBhE,YAArB6T,GAAYhlB,MAAsBglB,GAAYlY,MAAMka,OAAOxY,MAAQ/O,EAAKmL,KAAK4D,KAAQ,kBAACiF,EAAA,EAAD,CACtFxV,QAAS,SAACT,GACTsoB,KACIrI,EAAO,SACVA,EAAO,QAAS6J,KAAK,0BAA2B,CAACwB,QAAS9D,GAAYlY,MAAOlC,KAAMnL,EAAKmL,SAJJ,iBAWhE,YAArBoa,GAAYhlB,MAAsBglB,GAAYlY,MAAMka,OAAOxY,MAAQ/O,EAAKmL,KAAK4D,KAAQ,kBAACiF,EAAA,EAAD,CACtFxV,QAAS,SAACT,GACTsoB,KACIrI,EAAO,SACVA,EAAO,QAAS6J,KAAK,yBAA0B,CAACwB,QAAS9D,GAAYlY,MAAOlC,KAAMnL,EAAKmL,SAJH,mBAYzF5I,IAAS,kBAAC6rB,EAAA,EAAD,CAAU3c,KAAM2G,QAAQ7V,IAAQ8rB,iBAAkB,IAAO1a,QAAS,kBAAMsR,IAAS,KACpF,kBAAC,GAAD,CAAOtR,QAAS,kBAAMsR,IAAS,IAAQqJ,SAAS,SACpD/rB,MAgBL2gB,GAAKpgB,aAAe,CACnBsgB,OAAQ,OACRmL,UAAW,gBACXjL,wBAAoBtS,GAGN/N,WACdC,KCnpDc,SAAAC,GAAK,MAAK,CACxBvB,KAAM,CACLwB,QAAS,IACTyE,OAAQ,gBAAgB1E,EAAMmB,QAAQ,IAAI,MAC1CkqB,UAAW,QACX5kB,QAAS,OACT6kB,cAAe,SACfC,UAAW,UAEZpwB,KAAM,CACL8E,QAASD,EAAMmB,QAAQ,EAAG,EAAG,IAE9BsV,MAAO,CAIN+U,cAAexrB,EAAMmB,QAAQ,GAC7B+P,UAAWlR,EAAMmB,QAAQ,GACzB8c,SAAU,EACVvZ,OAAQ,eAAe1E,EAAMmB,QAAQ,GAAG,MACxCsa,UAAW,eAAezb,EAAMmB,QAAQ,GAAG,MAC3CoqB,UAAW,UAEZpC,iBAAkB,CACjBnS,SAAU,WACV9F,UAAWlR,EAAMmB,QAAQ,GACzB8c,SAAU,EACVvZ,OAAQ,eAAe1E,EAAMmB,QAAQ,GAAG,MACxCsa,UAAW,eAAezb,EAAMmB,QAAQ,GAAG,MAC3CsqB,SAAU,SACVxrB,QAAS,EACTM,gBAAiBP,EAAMkL,QAAQtF,WAAd,QACjBA,WAAY5F,EAAMkL,QAAQtF,WAAd,SAGb2hB,YAAa,CACZmE,UAAW,SACXH,UAAW,SACX7mB,OAAQ,eAAe1E,EAAMmB,QAAQ,GAAG,OAGzCwqB,cAAe,CACdD,UAAW,SACXH,UAAW,UAGZnC,kBAAmB,CAClBsC,UAAW,SACXH,UAAW,SACX5a,IAAK,EACLib,OAAQ,OACRlnB,OAAQ,kBAGTijB,KAAM,CACLkE,aAAc7rB,EAAMmB,QAAQ,IAG7B0E,UAAW,CACVtF,gBAAiBP,EAAMkL,QAAQtF,WAAW6Q,OAE3CkS,WAAW,CACVpoB,gBAAiBP,EAAMkL,QAAQtF,WAAd,QACjBxK,MAAO4E,EAAMkL,QAAQxK,OAAOkiB,MAE7B8F,cAAc,CACbnoB,gBAAiBP,EAAMkL,QAAQtF,WAAW6Q,MAC1Crb,MAAO4E,EAAMkL,QAAQxK,OAAOkiB,MAE7Bpd,OAAO,CACNjF,gBAAiBP,EAAMkL,QAAQC,OAAOC,MACtChQ,MAAO4E,EAAMkL,QAAQ/P,KAAKgM,QAC1B6C,MAAOhK,EAAMmB,QAAQ,GACrBuD,OAAQ1E,EAAMmB,QAAQ,GACtB2qB,aAAc9rB,EAAMmB,QAAQ,MAE7B4nB,YAAa,CACZpY,IAAK,OACLib,OAAQ,EACRxwB,MAAO4E,EAAMkL,QAAQtF,WAAW6Q,OAEjCuQ,WAAY,CACXrW,IAAK,EACLib,OAAQ,OACRxwB,MAAO4E,EAAMkL,QAAQ/P,KAAKgM,QAC1B4kB,UAAW,QAEZ7C,KAAM,CACLjL,SAAU,GAEXgL,UAAW,CACVjS,SAAU,WACV+G,OAAQ,EACRpN,KAAM,GACNC,KAAM,EACNqG,MAAO,EACPjG,OAAQ,SACRpL,WAAY5F,EAAMkL,QAAQxK,OAAOkiB,KACjCxnB,MAAO4E,EAAMkL,QAAQtF,WAAW6Q,OAEjCyF,OAAQ,CACPlS,MAAOhK,EAAM6d,UAAU7T,MACvB8T,WAAY,GAEXzB,YAAa,CACdrS,MAAOhK,EAAM6d,UAAU7T,MACvBgN,SAAU,WACV+G,OAAQ/d,EAAM+d,OAAOC,OAAO,EAC5Bzd,gBAAiBP,EAAMkL,QAAQtF,WAAd,SAEhB0W,qBAAsB,CACvBtS,MAAOhK,EAAM6d,UAAU7T,MACvBpE,WAAY5F,EAAMkL,QAAQtF,WAAd,SAEXyV,QAAS,CACV4C,SAAU,EACVhe,QAAS,EACT2K,WAAY5K,EAAM6K,YAAYC,OAAO,SAAU,CAC9CC,OAAQ/K,EAAM6K,YAAYE,OAAOC,MACjCC,SAAUjL,EAAM6K,YAAYI,SAASiT,iBAIvC5C,oBAAqB,CACpBpa,aAAclB,EAAM6d,UAAU7T,OAG/BwR,aAAc,CACb5Q,WAAY5K,EAAM6K,YAAYC,OAAO,SAAU,CAC9CC,OAAQ/K,EAAM6K,YAAYE,OAAOoT,QACjClT,SAAUjL,EAAM6K,YAAYI,SAASmT,iBAEtCld,YAAa,GAGdgpB,kBAAmB,CAIlBzO,UAAW,iBACXxb,QAAS,EACT+rB,WAAYhsB,EAAMmB,QAAQ,GAC1BqqB,cAAexrB,EAAMmB,QAAQ,GAC7ByE,WAAY5F,EAAMkL,QAAQtF,WAAW6Q,MACrCrb,MAAO4E,EAAMkL,QAAQ/P,KAAKgM,SAG3BqiB,gBAAiB,CAChBvY,SAAU,MACVrL,WAAY5F,EAAMkL,QAAQ/D,QAAQ8kB,MAClCC,wBAAyB,SACzBC,uBAAwB,SACxBC,qBAAsB,EACtBC,oBAAqB,UAGtB5C,mBAAoB,CACnB7jB,WAAY5F,EAAMkL,QAAQtF,WAAW6Q,MACrCyV,wBAAyB,SACzBC,uBAAwB,SACxBC,qBAAsB,SACtBC,oBAAqB,GAGtBC,0BAA2B,CAC1BJ,wBAAyB,SACzBC,uBAAwB,SACxBC,qBAAsB,SACtBC,oBAAqB,UAEtB,gCAAiC,CAC/B,KAAM,CACL9rB,gBAAiBP,EAAMkL,QAAQC,OAAOohB,OACtCR,UAAW,uEAEZ,MAAO,CACNxrB,gBAAiBP,EAAMkL,QAAQC,OAAOC,MACtC2gB,UAAW,oEAEZ,MAAO,CACNxrB,gBAAiBP,EAAMkL,QAAQ/P,KAAKsW,SACpCsa,UAAW,qEAGd9B,cAAe,CACbjZ,OAAQhR,EAAMmB,UACd6I,MAAOhK,EAAMmB,UACbuD,OAAQ1E,EAAMmB,UACd2qB,aAAc9rB,EAAMmB,QAAQ,IAC5BZ,gBAAiB,iBACjBisB,gBAAiB,mDACjBC,aAAc,mDACd5M,UAAW,wDDo9Cb3f,aAduB,SAAAhG,GAAK,MAAK,CACjC2C,KAAM3C,EAAM2C,KACZqjB,cAAehmB,EAAMgmB,cACrBvG,OAAQzf,EAAMyf,UAWW,CAAC7c,oBAAgBsjB,uBAAmBE,2BAC7DjC,IAHcve,CAIZigB,I,SEzoDG2M,G,kLACgB,IAAD,EAC2BhxB,KAAKzB,MAA3CiO,EADW,EACXA,SAAUykB,EADC,EACDA,iBAAkB3sB,EADjB,EACiBA,MAChC2sB,GAAoBzkB,GACvBykB,EAAiB,CAChBzwB,KAAM,WACNgB,IAAKgL,EAASgf,SACdnsB,MAAO,WACP4G,KAAM,KACNvG,MAAO4E,EAAMkL,QAAQ/D,QACrBylB,UAAW,M,+BAQOlxB,KAAKzB,MAAjBmE,QAER,OACC,kBAACG,EAAA,EAAD,CAAeC,UAAU,WACxB,kBAACE,EAAA,EAAD,CAAUC,GAAI,IACb,kBAAC,GAAD,Y,GAvBce,aAkCJU,uBACdN,IAAQI,aALe,SAAAhG,GAAK,MAAK,CACjC2C,KAAM3C,EAAM2C,QAIqB,CAAC8vB,wBAAoBtO,IAAtDve,CAAiE4sB","file":"static/js/9.0eb0dcaf.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/empty-state-table.cdb06dd9.svg\";","/** @format */\n\nimport withStyles from \"@material-ui/core/styles/withStyles\";\nimport EmptyStateImage from \"assets/img/empty-state-table.svg\";\nimport GoogleMap from \"components/GoogleMap\";\nimport GridContainer from \"components/Grid/GridContainer\";\nimport GridItem from \"components/Grid/GridItem\";\nimport Typography from \"components/Typography\";\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\nimport { connect } from \"react-redux\";\nimport compose from \"recompose/compose\";\nimport { apiCallRequest, closeDialog, openDialog } from \"state/actions\";\nimport { withErrorHandler } from \"hoc/ErrorHandler\";\nimport styles from \"./styles\";\n\n\n\nclass GoogleMapView extends React.Component {\n\tstate = {\n\t\tloading: true,\n\t\tload_error: false,\n\t\tdefination: null,\n\t\tservice: null,\n\t\tquery: { p: 1 },\n\t\trecords: [],\n\t};\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tconst { defination, service, query } = props;\n\n\t\tthis.state.defination = defination;\n\t\tthis.state.service = service;\n\t\tthis.state.query = query ? { ...query, p: 1 } : { p: 1 };\n\n\t\tthis.handleDeleteItemConfirm = this.handleDeleteItemConfirm.bind(this);\n\t\tthis.handleDeleteItem = this.handleDeleteItem.bind(this);\n\t}\n\n\tcomponentDidMount() {\n\t\tconst { cache, defination } = this.props;\n\t\tthis.mounted = true;\n\t\tthis.loadContext();\n\t\tthis.prepareData((Array.isArray(cache.data[defination.name])? cache.data[defination.name] : []));\n\t}\n\n\tgetSnapshotBeforeUpdate(prevProps) {\n\t\tthis.mounted = false;\n\t\tconst { cache, defination } = this.props;\n\t\treturn {\n\t\t\tcontextReloadRequired: !Object.areEqual(prevProps.defination, this.props.defination),\n\t\t\tdataReloadRequired: !Object.areEqual(prevProps.query,this.props.query),\n\t\t\t/*dataPreparationRequired: Array.isArray(cache.data[defination.name])? !cache.data[prevProps.defination.name].equals(prevProps.cache.data[defination.name]) : (Array.isArray(prevProps.cache.data[defination.name])? !prevProps.cache.data[prevProps.defination.name].equals(cache.data[defination.name]) : false),*/\n\t\t\tdataPreparationRequired: false,\n\t\t};\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\n\t\tif (snapshot.contextReloadRequired) {\n\t\t\tthis.loadContext();\n\t\t\tthis.prepareData();\n\t\t}\n\t\tif (snapshot.dataReloadRequired) {\n\t\t\tconst { query } = this.props;\n\t\t\tthis.setState(\n\t\t\t\t{ query: query ? { ...query, p: 1 } : { p: 1 } },\n\t\t\t\tthis.loadData\n\t\t\t);\n\t\t}\n\t\t\n\t}\n\n\thandleDeleteItemConfirm = item_id => event => {\n\t\tconst { openDialog, closeDialog } = this.props;\n\t\tlet that = this;\n\t\topenDialog({\n\t\t\ttitle: \"Confirm Delete\",\n\t\t\tbody:\n\t\t\t\t\"Are you sure you want delete entry? This action might be irreversible\",\n\t\t\tactions: {\n\t\t\t\tcancel: {\n\t\t\t\t\ttext: \"Cancel\",\n\t\t\t\t\tcolor: \"default\",\n\t\t\t\t\tonClick: () => closeDialog(),\n\t\t\t\t},\n\t\t\t\tdelete: {\n\t\t\t\t\ttext: \"Delete\",\n\t\t\t\t\tcolor: \"error\",\n\t\t\t\t\tonClick: event => {\n\t\t\t\t\t\tcloseDialog();\n\t\t\t\t\t\tthis.handleDeleteItem(item_id);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t};\n\n\thandleDeleteItem = item_id => event => {\n\t\tconst { openDialog, closeDialog } = this.props;\n\t\topenDialog({\n\t\t\ttitle: \"Deleting safely\",\n\t\t\tbody: \"Please wait. Executing safe delete...\",\n\t\t\tactions: {\n\t\t\t\tclose: {\n\t\t\t\t\ttext: \"Close\",\n\t\t\t\t\tcolor: \"default\",\n\t\t\t\t\tonClick: () => closeDialog(),\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t};\n\n\tloadContext() {\n\t\tconst { defination, service, query, cache } = this.props;\n\t\tif (defination) {\n\t\t\tthis.setState(\n\t\t\t\t{\n\t\t\t\t\tdefination: defination,\n\t\t\t\t\tservice: service,\n\t\t\t\t\tquery: query ? { ...query, p: 1 } : { p: 1 },\n\t\t\t\t\tloading: false,\n\t\t\t\t},\n\t\t\t\tthis.loadData\n\t\t\t);\n\t\t}\n\t}\n\n\t\n\tloadData() {\n\t\tconst { auth, cache, defination, apiCallRequest, cache_data, onLoadData, load_data } = this.props;\n\t\tif (defination ) {\n\t\t\tif (load_data) {\n\t\t\t\tapiCallRequest( defination.name,\n\t\t\t\t\t{\n\t\t\t\t\t\turi: defination.endpoint,\n\t\t\t\t\t\ttype: \"records\",\n\t\t\t\t\t\tparams: this.state.query,\n\t\t\t\t\t\tdata: {},\n\t\t\t\t\t\tcache: cache_data,\n\t\t\t\t\t}\n\t\t\t\t).then(data => {\n\t\t\t\t\tif (Function.isFunction(onLoadData)) {\n\t\t\t\t\t\tonLoadData(data);\n\t\t\t\t\t}\n\t\t\t\t\tthis.prepareData(data);\n\t\t\t\t}).catch(e => {\n\t\t\t\t\tthis.setState(state => ({\n\t\t\t\t\t\trecords: [],\n\t\t\t\t\t\tload_error: e,\n\t\t\t\t\t\tloading: false,\n\t\t\t\t\t}));\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet data = Array.isArray(cache.data[defination.name])? cache.data[defination.name] : [];\n\t\t\t\tif (Function.isFunction(onLoadData)) {\n\t\t\t\t\tonLoadData(data);\n\t\t\t\t}\n\t\t\t\tthis.prepareData(data);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.setState(state => ({\n\t\t\t\trecords: [],\n\t\t\t\tload_error: { msg: \"No Context defination or provided\" },\n\t\t\t\tloading: false,\n\t\t\t}));\n\t\t}\n\t}\n\n\t\n\n\tprepareData(data=null) {\n\t\tconst { auth, cache, defination } = this.props;\n\t\tlet target_data = Array.isArray(data)? data : (Array.isArray(cache.data[defination.name]) ? cache.data[defination.name] : []);\n\t\tlet columns = defination ? defination.scope.columns : {};\n\t\tlet resolved_data = [];\n\n\t\tif ( Function.isFunction( defination.views.listing.googlemapview.resolveData ) ) {\n\t\t\tdefination.views.listing.googlemapview.resolveData(target_data, true).then(resolve => {\n\t\t\t\t\tthis.setState(state => ({\n\t\t\t\t\t\trecords: resolve,\n\t\t\t\t\t\tloading: false,\n\t\t\t\t\t}));\n\t\t\t}).catch(err => {\t\t\t\t\t\n\t\t\t\tthis.setState(state => ({ records: [], loading: false }));\n\t\t\t});\n\t\t}\n\t}\n\trender() {\n\t\tconst { classes, googleMapProps, api, defination } = this.props;\n\t\treturn (\n\t\t\t<GridContainer className={classes.root}>\n\t\t\t\t<GridItem className=\"p-0 m-0\" xs={12}>\n\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t<GridItem className=\"p-0 m-0\" xs={12}>\n\t\t\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t\t\t\t<GridItem xs={12} className=\"p-0 m-0\">\n\t\t\t\t\t\t\t\t\t\t\t<GoogleMap\n\t\t\t\t\t\t\t\t\t\t\t\tdefaultZoom={12}\n\t\t\t\t\t\t\t\t\t\t\t\tzoom={12}\n\t\t\t\t\t\t\t\t\t\t\t\t{...googleMapProps}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\tpolylines={\n\t\t\t\t\t\t\t\t\t\t\t\t\tdefination &&\n\t\t\t\t\t\t\t\t\t\t\t\t\tdefination.views.listing\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.googlemapview.type ===\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"polyline\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? this.state.records\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: []\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tmarkers={\n\t\t\t\t\t\t\t\t\t\t\t\t\tdefination.views.listing\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.googlemapview.type ===\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"marker\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? this.state.records\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: []\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tcircles={\n\t\t\t\t\t\t\t\t\t\t\t\t\tdefination.views.listing\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.googlemapview.type ===\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"circle\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? this.state.records\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: []\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tshowCurrentPosition={true}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t{(api ? api.complete && api.error : false) && (\n\t\t\t\t\t\t\t<GridContainer>\n\t\t\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\t\tcolor=\"error\"\n\t\t\t\t\t\t\t\t\t\tvariant=\"body2\"\n\t\t\t\t\t\t\t\t\t\tcenter\n\t\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{\"An error occured. \\n \" +\n\t\t\t\t\t\t\t\t\t\t\tapi.error.msg}\n\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</GridContainer>\n\t\t\t\t</GridItem>\n\t\t\t</GridContainer>\n\t\t);\n\t}\n}\nGoogleMapView.propTypes = {\n\tclassName: PropTypes.string,\n\tclasses: PropTypes.object.isRequired,\n\tdefination: PropTypes.object.isRequired,\n\tservice: PropTypes.any.isRequired,\n\tshow_actions: PropTypes.bool,\n\tshow_links: PropTypes.bool,\n\tgoogleMapProps: PropTypes.object,\n\tquery: PropTypes.object,\n\tcache_data: PropTypes.bool,\n\tload_data: PropTypes.bool,\n\tonLoadData: PropTypes.func,\n};\n\nGoogleMapView.defaultProps = {\n\tgoogleMapProps: {\n\t\tmapHeight: 900,\n\t\tshowClientsPositions: true,\n\t\tshowCurrentPosition: true,\n\t},\n\tquery: {},\n\tload_data: true,\n\tcache_data: true,\n};\n\nconst mapStateToProps = (state, ownProps) => {\n\tconst { defination } = ownProps;\n\treturn {\n\t\tauth: state.auth,\n\t\tcache: state.cache,\n\t\tapi: state.api,\n\t};\n};\n\nexport default compose(\n\twithStyles(styles),\n\tconnect(mapStateToProps, { apiCallRequest, openDialog, closeDialog }),\n\twithErrorHandler\n)(GoogleMapView);\n","/** @format */\n\nexport default theme => ({\n\troot: {\n\t\tpadding: \"0\",\n\t},\n});\n","/** @format */\n\nimport IconButton from \"@material-ui/core/IconButton\";\nimport withStyles from \"@material-ui/core/styles/withStyles\";\nimport Tab from \"@material-ui/core/Tab\";\n//\nimport Tabs from \"@material-ui/core/Tabs\";\nimport {\n\tArrowBack as PrevIcon,\n\tArrowForward as NextIcon,\n\tEventOutlined as CalendarIcon,\n} from \"@material-ui/icons\";\nimport Calendar from \"@toast-ui/react-calendar\";\nimport { colors } from \"assets/jss/app-theme\";\nimport Avatar from \"components/Avatar\";\nimport Card from \"components/Card\";\nimport CardActions from \"components/Card/CardActions\";\nimport CardContent from \"components/Card/CardContent\";\nimport CardHeader from \"components/Card/CardHeader\";\nimport GridContainer from \"components/Grid/GridContainer\";\nimport GridItem from \"components/Grid/GridItem\";\nimport Status from \"components/Status\";\nimport Typography from \"components/Typography\";\nimport { formats } from \"config/data\";\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\nimport { UtilitiesHelper } from \"hoc/Helpers\";\nimport withRoot from \"hoc/withRoot\";\nimport styles from \"views/pages/styles\";\n\nconst AntTabs = withStyles({\n\tindicator: {\n\t\tbackgroundColor: colors.hex.accent,\n\t},\n})(Tabs);\n\nconst AntTab = withStyles(theme => ({\n\troot: {\n\t\ttextTransform: \"none\",\n\t\tminWidth: 50,\n\t\tfontWeight: theme.typography.fontWeightRegular,\n\t\tmarginRight: theme.spacing(),\n\t\t\"&:hover\": {\n\t\t\tcolor: colors.hex.default,\n\t\t\topacity: 1,\n\t\t},\n\t\t\"&$selected\": {\n\t\t\tcolor: colors.hex.accent,\n\t\t\tfontWeight: theme.typography.fontWeightMedium,\n\t\t},\n\t\t\"&:focus\": {\n\t\t\tcolor: colors.hex.accent,\n\t\t},\n\t},\n\tselected: {},\n}))(props => <Tab {...props} />);\n\nclass CustomCalendar extends React.Component {\n\tcalendarRef = React.createRef();\n\tstate = {\n\t\tview: \"month\",\n\t\tview_title: new Date().format(formats.dateformats.month),\n\t\tcalendars: [],\n\t\ttasks: [],\n\t\tschedules: [],\n\t};\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tconst {\n\t\t\ttheme,\n\t\t\tview,\n\t\t\tcalendars,\n\t\t\ttasks,\n\t\t\tschedules,\n\t\t\tshow_actions,\n\t\t\ticon,\n\t\t\ttitle,\n\t\t\tsubtitle,\n\t\t\ticon_color,\n\t\t\ttitle_color,\n\t\t\tsubtitle_color,\n\t\t\tcalendarProps,\n\t\t} = props;\n\t\tthis.state = {\n\t\t\t...this.state,\n\t\t\ttheme: theme,\n\t\t\tview: view,\n\t\t\tview_title:\n\t\t\t\tview === \"day\"\n\t\t\t\t\t? new Date().format(formats.dateformats.date)\n\t\t\t\t\t: view === \"week\"\n\t\t\t\t\t? new Date().format(formats.dateformats.week)\n\t\t\t\t\t: new Date().format(formats.dateformats.month),\n\t\t\tcalendars: calendars,\n\t\t\ttasks: tasks,\n\t\t\tschedules: schedules,\n\t\t\tshow_actions: show_actions,\n\t\t\ticon: icon,\n\t\t\ttitle: title,\n\t\t\tsubtitle: subtitle,\n\t\t\ticon_color: icon_color,\n\t\t\ttitle_color: title_color,\n\t\t\tsubtitle_color: subtitle_color,\n\t\t\tcalendarProps: calendarProps,\n\t\t};\n\t\tthis.handleChangeCalendarView = this.handleChangeCalendarView.bind(\n\t\t\tthis\n\t\t);\n\t\tthis.handleClickPrevButton = this.handleClickPrevButton.bind(this);\n\t\tthis.handleClickNextButton = this.handleClickNextButton.bind(this);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.initCalendarEvents();\n\t}\n\n\tgetSnapshotBeforeUpdate(prevProps) {\n\t\treturn { refreshRequired: !Object.areEqual(prevProps, this.props) };\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\n\t\tconst {\n\t\t\ttheme,\n\t\t\tview,\n\t\t\tcalendars,\n\t\t\ttasks,\n\t\t\tschedules,\n\t\t\tshow_actions,\n\t\t\ticon,\n\t\t\ttitle,\n\t\t\tsubtitle,\n\t\t\ticon_color,\n\t\t\ttitle_color,\n\t\t\tsubtitle_color,\n\t\t\tcalendarProps,\n\t\t} = this.props;\n\t\tif (snapshot.refreshRequired) {\n\t\t\tthis.setState(\n\t\t\t\t{\n\t\t\t\t\ttheme: theme,\n\t\t\t\t\tview: view,\n\t\t\t\t\tview_title:\n\t\t\t\t\t\tview === \"day\"\n\t\t\t\t\t\t\t? new Date().format(formats.dateformats.date)\n\t\t\t\t\t\t\t: view === \"week\"\n\t\t\t\t\t\t\t? new Date().format(formats.dateformats.week)\n\t\t\t\t\t\t\t: new Date().format(formats.dateformats.month),\n\t\t\t\t\tcalendars: calendars,\n\t\t\t\t\ttasks: tasks,\n\t\t\t\t\tschedules: schedules,\n\t\t\t\t\tshow_actions: show_actions,\n\t\t\t\t\ticon: icon,\n\t\t\t\t\ttitle: title,\n\t\t\t\t\tsubtitle: subtitle,\n\t\t\t\t\ticon_color: icon_color,\n\t\t\t\t\ttitle_color: title_color,\n\t\t\t\t\tsubtitle_color: subtitle_color,\n\t\t\t\t\tcalendarProps: calendarProps,\n\t\t\t\t},\n\t\t\t\tthis.initCalendarEvents\n\t\t\t);\n\t\t}\n\t}\n\n\tinitCalendarEvents() {\n\t\tconst {\n\t\t\tonSelect,\n\t\t\tonClickEntry,\n\t\t\tonClickEdit,\n\t\t\tonClickDelete,\n\t\t} = this.props;\n\t\tconst calendar = this.calendarRef.current.getInstance();\n\t\tif (calendar) {\n\t\t\tcalendar.on({\n\t\t\t\tclickSchedule: function(e) {\n\t\t\t\t\tif (UtilitiesHelper.isOfType(onClickEntry, \"function\")) {\n\t\t\t\t\t\tonClickEntry(e.schedule);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tbeforeCreateSchedule: function(e) {\n\t\t\t\t\tif (UtilitiesHelper.isOfType(onSelect, \"function\")) {\n\t\t\t\t\t\tonSelect(e);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tbeforeUpdateSchedule: function(e) {\n\t\t\t\t\tif (UtilitiesHelper.isOfType(onClickEdit, \"function\")) {\n\t\t\t\t\t\tonClickEdit(e);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tbeforeDeleteSchedule: function(e) {\n\t\t\t\t\tif (UtilitiesHelper.isOfType(onClickDelete, \"function\")) {\n\t\t\t\t\t\tonClickDelete(e);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t}\n\n\thandleChangeCalendarView = (event, view) => {\n\t\tif (this.calendarRef.current) {\n\t\t\tconst calendarInstance = this.calendarRef.current.getInstance();\n\t\t\tconst rendered_date = calendarInstance.getDate().toDate();\n\t\t\tthis.setState(state => ({\n\t\t\t\tview: view,\n\t\t\t\tview_title:\n\t\t\t\t\tview === \"day\"\n\t\t\t\t\t\t? rendered_date.format(formats.dateformats.date)\n\t\t\t\t\t\t: view === \"week\"\n\t\t\t\t\t\t? rendered_date.format(formats.dateformats.week)\n\t\t\t\t\t\t: rendered_date.format(formats.dateformats.month),\n\t\t\t}));\n\t\t} else {\n\t\t\tthis.setState(state => ({ view: view }));\n\t\t}\n\t};\n\n\thandleClickPrevButton = () => {\n\t\tif (this.calendarRef.current) {\n\t\t\tconst calendarInstance = this.calendarRef.current.getInstance();\n\t\t\tcalendarInstance.prev();\n\t\t\tconst rendered_date = calendarInstance.getDate().toDate();\n\t\t\tthis.setState(state => ({\n\t\t\t\tview_title:\n\t\t\t\t\tstate.view === \"day\"\n\t\t\t\t\t\t? rendered_date.format(formats.dateformats.date)\n\t\t\t\t\t\t: state.view === \"week\"\n\t\t\t\t\t\t? rendered_date.format(formats.dateformats.week)\n\t\t\t\t\t\t: rendered_date.format(formats.dateformats.month),\n\t\t\t}));\n\t\t}\n\t};\n\n\thandleClickNextButton = () => {\n\t\tif (this.calendarRef.current) {\n\t\t\tconst calendarInstance = this.calendarRef.current.getInstance();\n\t\t\tcalendarInstance.next();\n\t\t\tconst rendered_date = calendarInstance.getDate().toDate();\n\t\t\tthis.setState(state => ({\n\t\t\t\tview_title:\n\t\t\t\t\tstate.view === \"day\"\n\t\t\t\t\t\t? rendered_date.format(formats.dateformats.date)\n\t\t\t\t\t\t: state.view === \"week\"\n\t\t\t\t\t\t? rendered_date.format(formats.dateformats.week)\n\t\t\t\t\t\t: rendered_date.format(formats.dateformats.month),\n\t\t\t}));\n\t\t}\n\t};\n\n\thandleOnEditEntryClick = event => {\n\t\tif (this.calendarRef.current) {\n\t\t}\n\t};\n\n\thandleOnDeleteEntryClick = event => {\n\t\tif (this.calendarRef.current) {\n\t\t}\n\t};\n\n\trender() {\n\t\tconst {\n\t\t\tclasses,\n\t\t\theight,\n\t\t\tdefaultView,\n\t\t\tdisableDblClick,\n\t\t\tdisableClick,\n\t\t\tisReadOnly,\n\t\t\tuseDetailPopup,\n\t\t\tuseCreationPopup,\n\t\t\tscheduleView,\n\t\t\ttaskView,\n\t\t} = this.props;\n\t\tconst {\n\t\t\ttheme,\n\t\t\tview,\n\t\t\tview_title,\n\t\t\tcalendars,\n\t\t\ttasks,\n\t\t\tschedules,\n\t\t\tshow_actions,\n\t\t\ticon,\n\t\t\ttitle,\n\t\t\tsubtitle,\n\t\t\ticon_color,\n\t\t\ttitle_color,\n\t\t\tsubtitle_color,\n\t\t\tcalendarProps,\n\t\t} = this.state;\n\t\tconst calProps = {\n\t\t\theight: height + \"px\",\n\t\t\tdefaultView: defaultView,\n\t\t\tdisableDblClick: disableDblClick,\n\t\t\tdisableClick: disableClick,\n\t\t\tisReadOnly: isReadOnly,\n\t\t\tuseDetailPopup: useDetailPopup,\n\t\t\tuseCreationPopup: useCreationPopup,\n\t\t\tscheduleView: scheduleView,\n\t\t\ttaskView: taskView,\n\t\t\t...calendarProps,\n\t\t};\n\n\t\treturn (\n\t\t\t<Card elevation={0} outlineColor=\"#cfd8dc\">\n\t\t\t\t<CardHeader\n\t\t\t\t\tavatar={\n\t\t\t\t\t\t<Avatar\n\t\t\t\t\t\t\taria-label={title}\n\t\t\t\t\t\t\tstyle={{ background: icon_color }}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{icon}\n\t\t\t\t\t\t</Avatar>\n\t\t\t\t\t}\n\t\t\t\t\ttitle={title}\n\t\t\t\t\tsubheader={subtitle}\n\t\t\t\t></CardHeader>\n\t\t\t\t<CardContent className=\"p-0 m-0\">\n\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t<GridItem sm={6} md={4}>\n\t\t\t\t\t\t\t\t<AntTabs\n\t\t\t\t\t\t\t\t\tvalue={view}\n\t\t\t\t\t\t\t\t\tonChange={this.handleChangeCalendarView}\n\t\t\t\t\t\t\t\t\tindicatorColor=\"primary\"\n\t\t\t\t\t\t\t\t\ttextColor=\"primary\"\n\t\t\t\t\t\t\t\t\tvariant=\"fullWidth\"\n\t\t\t\t\t\t\t\t\taria-label=\"view change tabs\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<AntTab value=\"month\" label=\"Month\" />\n\t\t\t\t\t\t\t\t\t<AntTab value=\"week\" label=\"Week\" />\n\t\t\t\t\t\t\t\t\t<AntTab value=\"day\" label=\"Day\" />\n\t\t\t\t\t\t\t\t</AntTabs>\n\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t<GridItem sm={6} md={4}>\n\t\t\t\t\t\t\t\t<Typography variant=\"h3\" center>\n\t\t\t\t\t\t\t\t\t{\" \"}\n\t\t\t\t\t\t\t\t\t{view_title}{\" \"}\n\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t<GridItem sm={12} md={4}>\n\t\t\t\t\t\t\t\t<div className=\"float-right\">\n\t\t\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\t\t\tonClick={this.handleClickPrevButton}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<PrevIcon />\n\t\t\t\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\t\t\tonClick={this.handleClickNextButton}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<NextIcon />\n\t\t\t\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t</GridContainer>\n\n\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t\t<Calendar\n\t\t\t\t\t\t\t\t\ttheme={theme}\n\t\t\t\t\t\t\t\t\tview={view}\n\t\t\t\t\t\t\t\t\tclassName={classes.calendar}\n\t\t\t\t\t\t\t\t\tcalendars={calendars}\n\t\t\t\t\t\t\t\t\ttasks={tasks}\n\t\t\t\t\t\t\t\t\tschedules={schedules}\n\t\t\t\t\t\t\t\t\tref={this.calendarRef}\n\t\t\t\t\t\t\t\t\t{...calProps}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t</GridContainer>\n\t\t\t\t</CardContent>\n\t\t\t\t<CardActions>\n\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\tvariant=\"subtitle2\"\n\t\t\t\t\t\t\t\tdisplay=\"block\"\n\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\tgutterBottom\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{\" \"}\n\t\t\t\t\t\t\t\tCalendar index{\" \"}\n\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t{calendars.map((calendar, index) => (\n\t\t\t\t\t\t\t\t<Status\n\t\t\t\t\t\t\t\t\tcolor={\n\t\t\t\t\t\t\t\t\t\tcalendar.bgColor\n\t\t\t\t\t\t\t\t\t\t\t? calendar.bgColor\n\t\t\t\t\t\t\t\t\t\t\t: colors.hex.secondary\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\ttext={calendar.name}\n\t\t\t\t\t\t\t\t\tkey={\"calendar-\" + index}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t</GridContainer>\n\t\t\t\t</CardActions>\n\t\t\t</Card>\n\t\t);\n\t}\n}\n\nCustomCalendar.propTypes = {\n\tclasses: PropTypes.object.isRequired,\n\tclassName: PropTypes.string,\n\tcalendars: PropTypes.array,\n\tview: PropTypes.string,\n\ttasks: PropTypes.array,\n\tschedules: PropTypes.array,\n\tshow_actions: PropTypes.bool,\n\ttheme: PropTypes.object,\n\tcalendarProps: PropTypes.object,\n\tstartDate: PropTypes.string,\n\ticon: PropTypes.node,\n\ttitle: PropTypes.string,\n\tsubtitle: PropTypes.string,\n\ticon_color: PropTypes.string,\n\ttitle_color: PropTypes.string,\n\tsubtitle_color: PropTypes.string,\n\theight: PropTypes.number,\n\tdefaultView: PropTypes.string,\n\tdisableDblClick: PropTypes.bool,\n\tdisableClick: PropTypes.bool,\n\tisReadOnly: PropTypes.bool,\n\tuseDetailPopup: PropTypes.bool,\n\tuseCreationPopup: PropTypes.bool,\n\tscheduleView: PropTypes.bool,\n\ttaskView: PropTypes.bool,\n\tonSelect: PropTypes.func,\n\tonClickEntry: PropTypes.func,\n\tonClickEdit: PropTypes.func,\n\tonClickDelete: PropTypes.func,\n};\n\nCustomCalendar.defaultProps = {\n\tcalendars: [],\n\ttasks: [],\n\tschedules: [],\n\tview: \"month\",\n\ttheme: {\n\t\t\"common.border\": \"1px solid rgba(\" + colors.rgb.grey + \", 0.5)\",\n\t\t\"common.backgroundColor\": \"#fcfcfc\",\n\t\t\"common.holiday.color\": colors.hex.grey,\n\t\t\"common.saturday.color\": colors.hex.grey,\n\t\t\"common.dayname.color\": colors.hex.default,\n\t\t\"common.today.color\": colors.hex.primary,\n\t\t\"week.currentTime.color\": colors.hex.primarydark,\n\t},\n\tshow_actions: true,\n\ticon: <CalendarIcon />,\n\ttitle: \"My\",\n\tsubtitle: \"Calendar\",\n\ticon_color: colors.hex.primary,\n\ttitle_color: colors.hex.primary,\n\tsubtitle_color: colors.hex.grey,\n\tcalendarProps: {},\n\theight: 900,\n\tdefaultView: \"month\",\n\tdisableDblClick: true,\n\tdisableClick: false,\n\tisReadOnly: false,\n\tuseDetailPopup: true,\n\tuseCreationPopup: false,\n\tscheduleView: true,\n\ttaskView: true,\n};\n\nexport default withRoot(withStyles(styles)(CustomCalendar));\n","/** @format */\n\nimport { Icon } from \"@material-ui/core\";\nimport withStyles from \"@material-ui/core/styles/withStyles\";\nimport EmptyStateImage from \"assets/img/empty-state-table.svg\";\n//\nimport Calendar from \"components/Calendar\";\nimport GridContainer from \"components/Grid/GridContainer\";\nimport GridItem from \"components/Grid/GridItem\";\nimport ProgressIndicator from \"components/ProgressIndicator\";\nimport Typography from \"components/Typography\";\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\n//Redux imports\nimport { connect } from \"react-redux\";\nimport compose from \"recompose/compose\";\nimport { apiCallRequest, closeDialog, openDialog } from \"state/actions\";\n//\nimport { withErrorHandler } from \"hoc/ErrorHandler\";\nimport styles from \"./styles\";\n\nclass CalendarView extends React.Component {\n\tcalendarRef = React.createRef();\n\tstate = {\n\t\tloading: true,\n\t\tload_error: false,\n\t\trecords: [],\n\t};\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tconst { defination, service, query, app } = props;\n\n\t\tthis.state.defination = defination;\n\t\tthis.state.service = service;\n\t\tthis.state.query = query ? { ...query, p: 1 } : { p: 1 };\n\n\t\tthis.handleEditItem = this.handleEditItem.bind(this);\n\t\tthis.handleDeleteItemConfirm = this.handleDeleteItemConfirm.bind(this);\n\t\tthis.handleDeleteItem = this.handleDeleteItem.bind(this);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.loadContext();\n\t}\n\n\tgetSnapshotBeforeUpdate(prevProps) {\n\t\treturn {\n\t\t\tcontextReloadRequired:\n\t\t\t\t!Object.areEqual(prevProps.defination, this.props.defination) &&\n\t\t\t\t!Object.areEqual(prevProps.service, this.props.service),\n\t\t\tdataReloadRequired: !Object.areEqual(\n\t\t\t\tprevProps.query,\n\t\t\t\tthis.props.query\n\t\t\t),\n\t\t};\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\n\t\tif (snapshot.contextReloadRequired) {\n\t\t\tthis.loadContext();\n\t\t}\n\t\tif (snapshot.dataReloadRequired) {\n\t\t\tconst { query } = this.props;\n\t\t\tthis.setState(\n\t\t\t\t{ query: query ? { ...query, p: 1 } : { p: 1 } },\n\t\t\t\tthis.loadData\n\t\t\t);\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\tconst { openDialog, closeDialog } = this.props;\n\t\tcloseDialog();\n\t}\n\n\thandleEditItem(event) {\n\t\tconst { auth } = this.props;\n\n\t\tif (\n\t\t\t!this.state.defination.access.actions.update.restricted(auth.user)\n\t\t) {\n\t\t\twindow.location.href =\n\t\t\t\t\"/\" +\n\t\t\t\tthis.state.defination.access.actions.update.uri(\n\t\t\t\t\tevent.schedule.id\n\t\t\t\t);\n\t\t}\n\t}\n\n\thandleDeleteItemConfirm(event) {\n\t\tconst { openDialog, closeDialog } = this.props;\n\t\tlet that = this;\n\t\topenDialog({\n\t\t\ttitle: \"Confirm Delete\",\n\t\t\tbody:\n\t\t\t\t\"Are you sure you want delete \" +\n\t\t\t\tevent.schedule.title +\n\t\t\t\t\"? This action might be irreversible\",\n\t\t\tactions: {\n\t\t\t\tcancel: {\n\t\t\t\t\ttext: \"Cancel\",\n\t\t\t\t\tcolor: \"default\",\n\t\t\t\t\tonClick: () => closeDialog(),\n\t\t\t\t},\n\t\t\t\tdelete: {\n\t\t\t\t\ttext: \"Delete\",\n\t\t\t\t\tcolor: \"error\",\n\t\t\t\t\tonClick: this.handleDeleteItem(event.schedule.id),\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\thandleDeleteItem = item_id => event => {\n\t\tconst { openDialog, closeDialog } = this.props;\n\n\t\topenDialog({\n\t\t\ttitle: \"Deleting safely\",\n\t\t\tbody: \"Please wait. Executing safe delete...\",\n\t\t\tactions: {},\n\t\t});\n\n\t\tthis.state.service\n\t\t\t.delete(item_id)\n\t\t\t.then(res => {\n\t\t\t\tcloseDialog();\n\t\t\t\tthis.loadData();\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tconsole.log(\"CalendarView delete error\", e);\n\t\t\t\tcloseDialog();\n\t\t\t});\n\t};\n\n\tloadContext() {\n\t\tconst { defination, service, query, auth } = this.props;\n\t\tif (defination) {\n\t\t\tthis.setState(\n\t\t\t\t{\n\t\t\t\t\tdefination: defination,\n\t\t\t\t\tservice: service,\n\t\t\t\t\tquery: query ? { ...query, p: 1 } : { p: 1 },\n\t\t\t\t\tcalendars: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: defination.name,\n\t\t\t\t\t\t\tname: defination.label,\n\t\t\t\t\t\t\tbgColor: defination.color,\n\t\t\t\t\t\t\tborderColor: defination.color,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\trecords: [],\n\t\t\t\t\tloading: false,\n\t\t\t\t},\n\t\t\t\tthis.loadData\n\t\t\t);\n\t\t}\n\t}\n\n\tloadData() {\n\t\tconst { auth, cache, defination, apiCallRequest, cache_data, onLoadData, load_data } = this.props;\n\t\tif (defination ) {\n\t\t\tif (load_data) {\n\t\t\t\tapiCallRequest( defination.name,\n\t\t\t\t\t{\n\t\t\t\t\t\turi: defination.endpoint,\n\t\t\t\t\t\ttype: \"records\",\n\t\t\t\t\t\tparams: this.state.query,\n\t\t\t\t\t\tdata: {},\n\t\t\t\t\t\tcache: cache_data,\n\t\t\t\t\t}\n\t\t\t\t).then(data => {\n\t\t\t\t\tconsole.log(\"calendar data\", data);\n\t\t\t\t\tif (Function.isFunction(onLoadData)) {\n\t\t\t\t\t\tonLoadData(data, this.state.query);\n\t\t\t\t\t}\n\t\t\t\t\tthis.prepareData(data);\n\t\t\t\t}).catch(e => {\n\t\t\t\t\tconsole.log(\"calendar error\", e);\n\t\t\t\t\tthis.setState(state => ({\n\t\t\t\t\t\trecords: [],\n\t\t\t\t\t\tload_error: e,\n\t\t\t\t\t\tloading: false,\n\t\t\t\t\t}));\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet data = Array.isArray(cache.data[defination.name])? cache.data[defination.name] : [];\n\t\t\t\tif (Function.isFunction(onLoadData)) {\n\t\t\t\t\tonLoadData(data, this.state.query);\n\t\t\t\t}\n\t\t\t\tthis.prepareData(data);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.setState(state => ({\n\t\t\t\trecords: [],\n\t\t\t\tload_error: { msg: \"No Context defination or provided\" },\n\t\t\t\tloading: false,\n\t\t\t}));\n\t\t}\n\t}\n\n\tprepareData(data=null) {\n\t\tconst { auth, cache, defination } = this.props;\n\t\tlet target_data = Array.isArray(data)? data : (Array.isArray(cache.data[defination.name]) ? cache.data[defination.name] : []);\n\t\tlet columns = defination ? defination.scope.columns : {};\n\t\tlet resolved_data = [];\n\n\t\tif ( Function.isFunction( defination.views.listing.calendarview.resolveData ) ) {\n\t\t\tdefination.views.listing.calendarview.resolveData(target_data, true).then(resolve => {\n\t\t\t\t\tthis.setState(state => ({\n\t\t\t\t\t\trecords: resolve,\n\t\t\t\t\t\tloading: false,\n\t\t\t\t\t}));\n\t\t\t}).catch(err => {\t\t\t\t\t\n\t\t\t\tthis.setState(state => ({ records: [], loading: false }));\n\t\t\t});\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { classes } = this.props;\n\n\t\treturn (\n\t\t\t<GridContainer className={classes.root}>\n\t\t\t\t{this.state.defination && (\n\t\t\t\t\t<GridItem className=\"p-0 m-0\" xs={12}>\n\t\t\t\t\t\t{this.state.loading ? (\n\t\t\t\t\t\t\t<GridContainer\n\t\t\t\t\t\t\t\tclassName={classes.full_height}\n\t\t\t\t\t\t\t\tjustify=\"center\"\n\t\t\t\t\t\t\t\talignItems=\"center\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<GridItem xs={1}>\n\t\t\t\t\t\t\t\t\t<ProgressIndicator\n\t\t\t\t\t\t\t\t\t\tsize={24}\n\t\t\t\t\t\t\t\t\t\tthickness={4}\n\t\t\t\t\t\t\t\t\t\tclassName={classes.progress}\n\t\t\t\t\t\t\t\t\t\tcolor=\"secondary\"\n\t\t\t\t\t\t\t\t\t\tdisableShrink\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t\t{this.state.load_error ? (\n\t\t\t\t\t\t\t\t\t<GridContainer>\n\t\t\t\t\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"error\"\n\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"h1\"\n\t\t\t\t\t\t\t\t\t\t\t\tcenter\n\t\t\t\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<Icon fontSize=\"large\">\n\t\t\t\t\t\t\t\t\t\t\t\t\terror\n\t\t\t\t\t\t\t\t\t\t\t\t</Icon>\n\t\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"error\"\n\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"body1\"\n\t\t\t\t\t\t\t\t\t\t\t\tcenter\n\t\t\t\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\tAn error occured.\n\t\t\t\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t\t\t\t\tStatus Code :{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t{this.state.load_error.code}\n\t\t\t\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t\t\t\t\t{this.state.load_error.msg}\n\t\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t\t\t\t<GridItem className=\"p-0 m-0\" xs={12}>\n\t\t\t\t\t\t\t\t\t\t\t{Array.isArray(\n\t\t\t\t\t\t\t\t\t\t\t\tthis.state.records\n\t\t\t\t\t\t\t\t\t\t\t) &&\n\t\t\t\t\t\t\t\t\t\t\tthis.state.records.length > 0 ? (\n\t\t\t\t\t\t\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Calendar\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.defination\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.icon\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.defination\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.label\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle_color={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.defination\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.color\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon_color={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.defination\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.color\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsubtitle=\"\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcalendars={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state.calendars\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tview=\"month\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tschedules={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.state\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.records\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclasses.calendar\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClickEdit={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.handleEditItem\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClickDelete={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.handleDeleteItemConfirm\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t<GridContainer\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"p-0 m-0\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tjustify=\"center\"\n\t\t\t\t\t\t\t\t\t\t\t\t\talignItems=\"center\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"Empty list\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclasses.emptyImage\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={EmptyStateImage}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclasses.emptyText\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"grey\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"body2\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcenter\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tNo{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{this.state.defination\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.label\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? this.state\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.defination\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.label\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"Records\"}{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfound\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</GridItem>\n\t\t\t\t)}\n\t\t\t</GridContainer>\n\t\t);\n\t}\n}\nCalendarView.propTypes = {\n\tclassName: PropTypes.string,\n\tclasses: PropTypes.object.isRequired,\n\tdefination: PropTypes.object.isRequired,\n\tservice: PropTypes.any.isRequired,\n\tcalendarProps: PropTypes.object,\n\tquery: PropTypes.object,\n\tcache_data: PropTypes.bool,\n\tload_data: PropTypes.bool,\n\tonLoadData: PropTypes.func,\n};\n\nCalendarView.defaultProps = {\n\tcalendarProps: {\n\t\theight: \"900px\",\n\t\tdefaultView: \"month\",\n\t\tdisableDblClick: true,\n\t\tdisableClick: true,\n\t\tisReadOnly: false,\n\t\tuseDetailPopup: true,\n\t\tuseCreationPopup: false,\n\t\tscheduleView: true,\n\t\ttaskView: false,\n\t},\n\tquery: { p: 1 },\n\tcache_data: true,\n\tload_data: true,\n};\n\nconst mapStateToProps = state => ({\n\tauth: state.auth,\n\tapp: state.app,\n});\n\nexport default withErrorHandler(\n\tcompose(\n\t\twithStyles(styles),\n\t\tconnect(mapStateToProps, { apiCallRequest, openDialog, closeDialog })\n\t)(CalendarView)\n);\n","/** @format */\n\nexport default theme => ({\n\troot: {\n\t\tpadding: \"0\",\n\t},\n});\n","/** @format */\n\nimport { Icon } from \"@material-ui/core\";\nimport Divider from \"@material-ui/core/Divider\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemAvatar from \"@material-ui/core/ListItemAvatar\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport withStyles from \"@material-ui/core/styles/withStyles\";\n//\nimport EmptyStateImage from \"assets/img/empty-state-table.svg\";\nimport GridContainer from \"components/Grid/GridContainer\";\nimport GridItem from \"components/Grid/GridItem\";\nimport ProgressIndicator from \"components/ProgressIndicator\";\nimport Typography from \"components/Typography\";\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\nimport { connect } from \"react-redux\";\nimport compose from \"recompose/compose\";\nimport * as Actions from \"state/actions\";\nimport Skeleton from '@material-ui/lab/Skeleton';\nimport { apiCallRequest, closeDialog, openDialog } from \"state/actions\";\n//\nimport { UtilitiesHelper } from \"hoc/Helpers\";\nimport { withErrorHandler } from \"hoc/ErrorHandler\";\nimport styles from \"./styles\";\n\nclass ListView extends React.Component {\n\t\n\tstate = {\n\t\tloading: true,\n\t\tload_error: false,\n\t\traw_records: [],\n\t\trecords: [],\n\t};\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tconst { defination } = props;\n\n\t\tthis.handleDeleteItemConfirm = this.handleDeleteItemConfirm.bind(this);\n\t\tthis.handleDeleteItem = this.handleDeleteItem.bind(this);\n\t}\n\n\tcomponentDidMount() {\n\t\tconst { cache, defination } = this.props;\n\t\tthis.mounted = true;\n\t\tthis.loadContext();\n\t\tthis.prepareData((Array.isArray(cache.data[defination.name])? cache.data[defination.name] : []));\n\t}\n\n\tgetSnapshotBeforeUpdate(prevProps) {\n\t\tthis.mounted = false;\n\t\tconst { cache, defination } = this.props;\n\t\treturn {\n\t\t\tcontextReloadRequired: !Object.areEqual(prevProps.defination, this.props.defination),\n\t\t\tdataReloadRequired: !Object.areEqual(prevProps.query,this.props.query),\n\t\t\t/*dataPreparationRequired: Array.isArray(cache.data[defination.name])? !cache.data[prevProps.defination.name].equals(prevProps.cache.data[defination.name]) : (Array.isArray(prevProps.cache.data[defination.name])? !prevProps.cache.data[prevProps.defination.name].equals(cache.data[defination.name]) : false),*/\n\t\t\tdataPreparationRequired: false,\n\t\t};\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\n\t\tif (snapshot.contextReloadRequired) {\n\t\t\tthis.loadContext();\n\t\t\tthis.prepareData();\n\t\t}\n\t\tif (snapshot.dataReloadRequired) {\n\t\t\tconst { query } = this.props;\n\t\t\tthis.setState(\n\t\t\t\t{ query: query ? { ...query, p: 1 } : { p: 1 } },\n\t\t\t\tthis.loadData\n\t\t\t);\n\t\t}\n\t\t\n\t}\n\n\n\thandleDeleteItemConfirm = item_id => event => {\n\t\tconst { dispatch } = this.props;\n\t\tlet that = this;\n\t\tdispatch(\n\t\t\tActions.openDialog({\n\t\t\t\ttitle: \"Confirm Delete\",\n\t\t\t\tbody:\n\t\t\t\t\t\"Are you sure you want delete entry? This action might be irreversible\",\n\t\t\t\tactions: {\n\t\t\t\t\tcancel: {\n\t\t\t\t\t\ttext: \"Cancel\",\n\t\t\t\t\t\tcolor: \"default\",\n\t\t\t\t\t\tonClick: () => dispatch(Actions.closeDialog()),\n\t\t\t\t\t},\n\t\t\t\t\tdelete: {\n\t\t\t\t\t\ttext: \"Delete\",\n\t\t\t\t\t\tcolor: \"error\",\n\t\t\t\t\t\tonClick: this.handleDeleteItem(item_id),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t})\n\t\t);\n\t};\n\n\thandleDeleteItem = item_id => event => {\n\t\tconst { dispatch } = this.props;\n\n\t\tdispatch(\n\t\t\tActions.openDialog({\n\t\t\t\ttitle: \"Deleting safely\",\n\t\t\t\tbody: \"Please wait. Executing safe delete...\",\n\t\t\t\tactions: {\n\t\t\t\t\tclose: {\n\t\t\t\t\t\ttext: \"Close\",\n\t\t\t\t\t\tcolor: \"default\",\n\t\t\t\t\t\tonClick: () => dispatch(Actions.closeDialog()),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t})\n\t\t);\n\t};\n\n\tloadContext() {\n\t\tconst { defination, service, query, cache } = this.props;\n\t\tif (defination) {\n\t\t\tthis.setState(\n\t\t\t\t{\n\t\t\t\t\tdefination: defination,\n\t\t\t\t\tservice: service,\n\t\t\t\t\tquery: query ? { ...query, p: 1 } : { p: 1 },\n\t\t\t\t\tloading: false,\n\t\t\t\t},\n\t\t\t\tthis.loadData\n\t\t\t);\n\t\t}\n\t}\n\n\tloadData() {\n\t\tconst { auth, cache, defination, apiCallRequest, cache_data, onLoadData, load_data } = this.props;\n\t\tif (defination ) {\n\t\t\tif (load_data) {\n\t\t\t\tapiCallRequest( defination.name,\n\t\t\t\t\t{\n\t\t\t\t\t\turi: defination.endpoint,\n\t\t\t\t\t\ttype: \"records\",\n\t\t\t\t\t\tparams: this.state.query,\n\t\t\t\t\t\tdata: {},\n\t\t\t\t\t\tcache: cache_data,\n\t\t\t\t\t}\n\t\t\t\t).then(data => {\n\t\t\t\t\tif (Function.isFunction(onLoadData)) {\n\t\t\t\t\t\tonLoadData(data, this.state.query);\n\t\t\t\t\t}\n\t\t\t\t\tthis.prepareData(data);\n\t\t\t\t}).catch(e => {\n\t\t\t\t\tthis.setState(state => ({\n\t\t\t\t\t\trecords: [],\n\t\t\t\t\t\tload_error: e,\n\t\t\t\t\t\tloading: false,\n\t\t\t\t\t}));\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (cache_data){\n\t\t\t\tlet data = Array.isArray(cache.data[defination.name])? cache.data[defination.name] : [];\n\t\t\t\tif (Function.isFunction(onLoadData)) {\n\t\t\t\t\tonLoadData(data, this.state.query);\n\t\t\t\t}\n\t\t\t\tthis.prepareData(data);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.setState(state => ({\n\t\t\t\trecords: [],\n\t\t\t\tload_error: { msg: \"No Context defination or provided\" },\n\t\t\t\tloading: false,\n\t\t\t}));\n\t\t}\n\t}\n\n\t\n\n\tprepareData(data=null) {\n\t\tconst { auth, cache, defination, entryItemProps } = this.props;\n\t\tlet target_data = Array.isArray(data)? data : (Array.isArray(cache.data[defination.name]) ? cache.data[defination.name] : []);\n\t\tlet columns = defination ? defination.scope.columns : {};\n\t\tlet resolved_data = [];\n\n\t\tif ( Function.isFunction( defination.views.listing.listview.resolveData ) ) {\n\t\t\tdefination.views.listing.listview.resolveData(target_data, auth.user, entryItemProps)\n\t\t\t\t.then(resolve => {\n\t\t\t\t\tthis.setState(state => ({\n\t\t\t\t\t\traw_records: data,\n\t\t\t\t\t\trecords: resolve,\n\t\t\t\t\t\tloading: false,\n\t\t\t\t\t}));\n\t\t\t\t})\n\t\t\t\t.catch(err => {\t\t\t\t\t\n\t\t\t\t\tthis.setState(state => ({ records: [], raw_records: [], loading: false }));\n\t\t\t\t});\n\t\t}\n\t}\n\n\tprepareForData() {\n\t\tconst { classes, defination, auth, dispatch } = this.props;\n\n\t\tlet columns = defination.scope.columns;\n\n\t\tthis.state.records = [];\n\t\tthis.state.loading = false;\n\t}\n\n\t\n\trender() {\n\t\tconst { classes, defination, service, onClickEntry } = this.props;\n\t\treturn (\n\t\t\t<GridContainer className={classes.root}>\n\t\t\t\t<GridItem className=\"p-0 m-0\" xs={12}>\n\t\t\t\t\t{this.state.loading ? (\n\t\t\t\t\t\t<GridContainer>\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-3/12\"/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-8/12\"/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-4/12\"/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-3/12\"/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-5/12\"/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-9/12\"/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-4/12\"/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-3/12\"/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</GridItem>\n\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-4/12\"/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t{this.state.load_error ? (\n\t\t\t\t\t\t\t\t<GridContainer>\n\t\t\t\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\t\t\tcolor=\"error\"\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"h1\"\n\t\t\t\t\t\t\t\t\t\t\tcenter\n\t\t\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<Icon fontSize=\"large\">error</Icon>\n\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\t\t\tcolor=\"error\"\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"body1\"\n\t\t\t\t\t\t\t\t\t\t\tclassName={\"w-full text-center\"}\n\t\t\t\t\t\t\t\t\t\t\tcenter\n\t\t\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\tAn error occured.\n\t\t\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t\t\t\tStatus Code :{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t{this.state.load_error.code}\n\t\t\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t\t\t\t{this.state.load_error.msg}\n\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t\t\t<GridItem className=\"p-0 m-0\" xs={12}>\n\t\t\t\t\t\t\t\t\t\t{Array.isArray(this.state.records) &&\n\t\t\t\t\t\t\t\t\t\tthis.state.records.length > 0 ? (\n\t\t\t\t\t\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\n\t\t\t\t\t\t\t\t\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<List\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={\"p-0 transparent-bg\"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{this.state.records.map(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(entry, index) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefination.name +\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"-\" +\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tindex\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ListItem \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbutton \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talignItems=\"flex-start\" \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={()=>{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (Function.isFunction(onClickEntry)) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClickEntry(this.state.raw_records[index], index);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={classes.listItem}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{entry.avatar && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ListItemAvatar>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tentry.avatar\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ListItemAvatar>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{entry.icon && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ListItemIcon>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tentry.icon\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ListItemIcon>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ListItemText\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tprimary={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tentry.title\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecondary={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tentry.body\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ListItem>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Divider\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcomponent=\"li\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</List>\n\t\t\t\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t<GridContainer\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"p-0 m-0\"\n\t\t\t\t\t\t\t\t\t\t\t\tjustify=\"center\"\n\t\t\t\t\t\t\t\t\t\t\t\talignItems=\"center\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"Empty list\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclasses.emptyImage\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={EmptyStateImage}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclasses.emptyText\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"grey\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"body2\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tcenter\n\t\t\t\t\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\tNo{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t{defination.label\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? defination.label\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"Records\"}{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\tfound\n\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</GridItem>\n\t\t\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</GridContainer>\n\t\t\t\t\t)}\n\t\t\t\t</GridItem>\n\t\t\t</GridContainer>\n\t\t);\n\t}\n}\nListView.propTypes = {\n\tclassName: PropTypes.string,\n\tclasses: PropTypes.object.isRequired,\n\tdefination: PropTypes.object.isRequired,\n\tservice: PropTypes.any.isRequired,\n\tshow_actions: PropTypes.bool,\n\tquery: PropTypes.object,\n\tcache_data: PropTypes.bool,\n\tload_data: PropTypes.bool,\n\tonLoadData: PropTypes.func,\n\tonClickEntry: PropTypes.func,\n};\n\nListView.defaultProps = {\n\tshow_actions: true,\n\tshow_links: true,\n\tquery: { p: 1 },\n\tload_data: true,\n\tcache_data: true,\n};\n\nconst mapStateToProps = (state, ownProps) => {\n\tconst { defination } = ownProps;\n\treturn {\n\t\tauth: state.auth,\n\t\tcache: state.cache,\n\t\tapi: state.api,\n\t};\n};\nexport default compose(\n\twithStyles(styles),\n\tconnect(mapStateToProps, { apiCallRequest, openDialog, closeDialog }),\n\twithErrorHandler\n)(ListView);\n","/** @format */\n\nexport default theme => ({\n\troot: {\n\t\tpadding: \"0\",\n\t},\n\tlistItem: {\n\t\tbackground: \"transparent\",\n\t\ttransition: theme.transitions.create(\"background\", {\n\t\t\teasing: theme.transitions.easing.sharp,\n\t\t\tduration: 50,\n\t\t}),\n\t\t\"&:hover\": {\n\t\t\tbackground: theme.palette.action.hover,\n\t\t},\n\t},\n});\n","/** @format */\r\n\r\n//\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport Menu from \"@material-ui/core/Menu\";\r\nimport ClickAwayListener from \"@material-ui/core/ClickAwayListener\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport EmptyStateImage from \"assets/img/empty-state-table.svg\";\r\nimport Avatar from \"components/Avatar\";\r\nimport GridContainer from \"components/Grid/GridContainer\";\r\nimport GridItem from \"components/Grid/GridItem\";\r\nimport Typography from \"components/Typography\";\r\nimport Skeleton from \"@material-ui/lab/Skeleton\";\r\nimport { formats } from \"config/data\";\r\nimport MUIDataTable from \"mui-datatables\";\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport PropTypes from \"prop-types\";\r\nimport React, {useEffect, useState} from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport compose from \"recompose/compose\";\r\nimport { attachments as AttachmentsService } from \"services\";\r\nimport { apiCallRequest, closeDialog, openDialog } from \"state/actions\";\r\n//\r\nimport { FilesHelper, ServiceDataHelper, UtilitiesHelper } from \"hoc/Helpers\";\r\nimport { withErrorHandler } from \"hoc/ErrorHandler\";\r\nimport styles from \"./styles\";\r\n\r\nclass TableView extends React.Component {\r\n\tstate = {\r\n\t\tloading: true,\r\n\t\tload_error: false,\r\n\t\tdefination: null,\r\n\t\tservice: null,\r\n\t\tquery: { p: 1 },\r\n\t\tdt_columns: [],\r\n\t\trecords: [],\r\n\t\traw_data: [],\r\n\t\tmouseX: null,\r\n\t\tmouseY: null,\r\n\t\tactionsView: \"contextMenu\",\r\n\t\tcontext: null,\r\n\t};\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tconst { defination, service, query, cache: { data: cachedData } } = props;\r\n\t\tthis.state.defination = defination;\r\n\t\tthis.state.service = service;\r\n\t\tthis.state.query = query ? { ...query, p: 1 } : { p: 1 };\r\n\t\tthis.state.records = Array.isArray(cachedData[defination.name])? cachedData[defination.name] : [];\r\n\t\tthis.mounted = false;\r\n\t\tthis.handleDeleteItemConfirm = this.handleDeleteItemConfirm.bind(this);\r\n\t\tthis.handleDeleteItem = this.handleDeleteItem.bind(this);\r\n\t\tthis.handleOnRowContextMenu = this.handleOnRowContextMenu.bind(this);\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tconst { cache, defination } = this.props;\r\n\t\tthis.mounted = true;\r\n\t\tthis.loadContext();\r\n\t\tthis.prepareData((Array.isArray(cache.data[defination.name])? cache.data[defination.name] : []));\r\n\t}\r\n\r\n\tgetSnapshotBeforeUpdate(prevProps) {\r\n\t\tthis.mounted = false;\r\n\t\tconst { cache, defination } = this.props;\r\n\t\treturn {\r\n\t\t\tcontextReloadRequired: !Object.areEqual(prevProps.defination, this.props.defination),\r\n\t\t\tdataReloadRequired: !Object.areEqual(prevProps.query,this.props.query),\r\n\t\t\t/*dataPreparationRequired: Array.isArray(cache.data[defination.name])? !cache.data[prevProps.defination.name].equals(prevProps.cache.data[defination.name]) : (Array.isArray(prevProps.cache.data[defination.name])? !prevProps.cache.data[prevProps.defination.name].equals(cache.data[defination.name]) : false),*/\r\n\t\t\tdataPreparationRequired: false,\r\n\t\t};\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\r\n\t\tthis.mounted = true;\r\n\t\tif (snapshot.contextReloadRequired) {\r\n\t\t\tthis.loadContext();\r\n\t\t\tthis.prepareData();\r\n\t\t}\r\n\t\tif (snapshot.dataReloadRequired) {\r\n\t\t\tconst { query } = this.props;\r\n\t\t\tthis.setState(\r\n\t\t\t\t{ query: query ? { ...query, p: 1 } : { p: 1 } },\r\n\t\t\t\tthis.loadData\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\thandleDeleteItemConfirm = item_id => event => {\r\n\t\tconst { openDialog, closeDialog } = this.props;\r\n\t\tlet that = this;\r\n\t\topenDialog({\r\n\t\t\ttitle: \"Confirm Delete\",\r\n\t\t\tbody:\r\n\t\t\t\t\"Are you sure you want delete entry? This action might be irreversible\",\r\n\t\t\tactions: {\r\n\t\t\t\tcancel: {\r\n\t\t\t\t\ttext: \"Cancel\",\r\n\t\t\t\t\tcolor: \"default\",\r\n\t\t\t\t\tonClick: () => closeDialog(),\r\n\t\t\t\t},\r\n\t\t\t\tdelete: {\r\n\t\t\t\t\ttext: \"Delete\",\r\n\t\t\t\t\tcolor: \"error\",\r\n\t\t\t\t\tonClick: this.handleDeleteItem(item_id),\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t});\r\n\t};\r\n\r\n\thandleDeleteItem = item_id => event => {\r\n\t\tconst { openDialog, closeDialog } = this.props;\r\n\t\tcloseDialog();\r\n\t\tif (item_id._id) {\r\n\t\t\titem_id = item_id._id;\r\n\t\t}\r\n\t\tthis.state.service\r\n\t\t\t.delete(item_id)\r\n\t\t\t.then(res => {\r\n\t\t\t\tthis.setState(prevState => {\r\n\t\t\t\t\tlet new_records = prevState.records;\r\n\t\t\t\t\tif (Array.isArray(new_records)) {\r\n\t\t\t\t\t\tnew_records = new_records.filter((record)=>{\r\n\t\t\t\t\t\t\tif (record.entry) {\r\n\t\t\t\t\t\t\t\tif (record.entry._id === item_id ) {\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (record._id === item_id) {\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (!Array.isArray(new_records)) {\r\n\t\t\t\t\t\tnew_records = [];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\trecords: new_records,\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}).catch(e => {\r\n\t\t\t\topenDialog({\r\n\t\t\t\t\ttitle: \"Delete failed\",\r\n\t\t\t\t\tbody: e.msg,\r\n\t\t\t\t\tactions: {},\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t};\r\n\r\n\thandleOnRowContextMenu = index => event => {\r\n\t\tevent.preventDefault();\r\n\t\tconst mouseX = event.clientX - 2;\r\n\t\tconst mouseY = event.clientY - 4;\r\n\r\n\t\tconsole.log(\"this.state.raw_data[index]\", this.state.raw_data[index]);\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tmouseX: mouseX,\r\n\t\t\tmouseY: mouseY,\r\n\t\t\tcontext: prevState.raw_data[index],\r\n\t\t}));\r\n\t};\r\n\r\n\thandleOnRowContextMenuClose = event => {\r\n\t\tevent.preventDefault();\r\n\r\n\t\tthis.setState({\r\n\t\t\tmouseX: null,\r\n\t\t\tmouseY: null,\r\n\t\t});\r\n\t};\r\n\r\n\tloadContext() {\r\n\t\tconst { classes, defination, service, query, auth, actionsType } = this.props;\r\n\t\tif (defination) {\r\n\t\t\tlet columns = defination.scope.columns;\r\n\t\t\tlet dt_columns = [];\r\n\t\t\tif (!defination.access.restricted(auth.user)) {\r\n\t\t\t\tdt_columns.push({\r\n\t\t\t\t\tname: \"entry\",\r\n\t\t\t\t\tlabel: String.isString(defination.label)? defination.label.singularize() : (\"Action\"),\r\n\t\t\t\t\toptions: {\r\n\t\t\t\t\t\tfilter: false,\r\n\t\t\t\t\t\tsort: false,\r\n\t\t\t\t\t\t/*customBodyRenderLite: (dataIndex, rowIndex) => {\r\n\t\t\t\t\t\t\tconsole.log(\"dataIndex\", dataIndex);\r\n\t\t\t\t\t\t\tlet value = this.state.records[dataIndex].entry;\r\n\t\t\t\t\t\t\tif (actionsType === \"inline\") {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<GridContainer\r\n\t\t\t\t\t\t\t\t\t\tspacing={2}\r\n\t\t\t\t\t\t\t\t\t\tclassName={classes.data_actions_wrapper}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{Object.keys(defination.access.actions).map((action_name, action_index) =>\r\n\t\t\t\t\t\t\t\t\t\t\t!defination.access.actions[action_name].restricted(auth.user) && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"_\" +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\taction_name +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"_action\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{action_name === \"delete\" ? defination.access.actions[action_name].link.inline.listing(value,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"error_text\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.handleDeleteItemConfirm(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  )\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: defination.access.actions[\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taction_name\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  ].link.inline.listing(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  )}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</GridContainer>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},*/\r\n\t\t\t\t\t\tcustomBodyRender: (value, tableMeta, updateValue) => {\r\n\t\t\t\t\t\t\tif (actionsType === \"inline\") {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<GridContainer\r\n\t\t\t\t\t\t\t\t\t\tspacing={2}\r\n\t\t\t\t\t\t\t\t\t\tclassName={classes.data_actions_wrapper}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{Object.keys(defination.access.actions).map((action_name, action_index) =>\r\n\t\t\t\t\t\t\t\t\t\t\t!defination.access.actions[action_name].restricted(auth.user) && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"_\" +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\taction_name +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"_action\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{action_name === \"delete\" ? defination.access.actions[action_name].link.inline.listing(value,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"error_text\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.handleDeleteItemConfirm(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  )\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: defination.access.actions[\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taction_name\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  ].link.inline.listing(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  )}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</GridContainer>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\r\n\t\t\t\tfor (let [name, field] of Object.entries(columns)) {\r\n\t\t\t\t\tlet display_field = true;\r\n\t\t\t\t\tif (field.restricted && \"display\" in field.restricted) {\r\n\t\t\t\t\t\tif (typeof field.restricted.display === \"function\") {\r\n\t\t\t\t\t\t\tdisplay_field = !field.restricted.display(\r\n\t\t\t\t\t\t\t\tfalse,\r\n\t\t\t\t\t\t\t\tauth.user\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (display_field) {\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\tUtilitiesHelper.isOfType(\r\n\t\t\t\t\t\t\t\tthis.state.defination.views.listing.tableview\r\n\t\t\t\t\t\t\t\t\t.resolveData,\r\n\t\t\t\t\t\t\t\t\"function\"\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tif (field.reference || field.possibilities) {\r\n\t\t\t\t\t\t\t\tdt_columns.push({\r\n\t\t\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\t\t\tlabel: field.label,\r\n\t\t\t\t\t\t\t\t\toptions: {\r\n\t\t\t\t\t\t\t\t\t\tfilter: field.possibilities\r\n\t\t\t\t\t\t\t\t\t\t\t? true\r\n\t\t\t\t\t\t\t\t\t\t\t: false,\r\n\t\t\t\t\t\t\t\t\t\tsort: true,\r\n\t\t\t\t\t\t\t\t\t\tcustomBodyRender: (\r\n\t\t\t\t\t\t\t\t\t\t\tvalue,\r\n\t\t\t\t\t\t\t\t\t\t\ttableMeta,\r\n\t\t\t\t\t\t\t\t\t\t\tupdateValue\r\n\t\t\t\t\t\t\t\t\t\t) => {\r\n\t\t\t\t\t\t\t\t\t\t\tif (Array.isArray(value)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<GridContainer spacing={2}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{value.map(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(entry, cursor) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={cursor}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{entry}{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</GridContainer>\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn value !== null &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue !== undefined\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? value\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: \"\";\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tdt_columns.push({\r\n\t\t\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\t\t\tlabel: field.label,\r\n\t\t\t\t\t\t\t\t\toptions: {\r\n\t\t\t\t\t\t\t\t\t\tfilter: field.possibilities\r\n\t\t\t\t\t\t\t\t\t\t\t? true\r\n\t\t\t\t\t\t\t\t\t\t\t: false,\r\n\t\t\t\t\t\t\t\t\t\tsort: true,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tfield.reference &&\r\n\t\t\t\t\t\t\t\tfield.input.type !== \"file\"\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tdt_columns.push({\r\n\t\t\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\t\t\tlabel: field.label,\r\n\t\t\t\t\t\t\t\t\toptions: {\r\n\t\t\t\t\t\t\t\t\t\tfilter: field.possibilities\r\n\t\t\t\t\t\t\t\t\t\t\t? true\r\n\t\t\t\t\t\t\t\t\t\t\t: false,\r\n\t\t\t\t\t\t\t\t\t\tsort: true,\r\n\t\t\t\t\t\t\t\t\t\tcustomBodyRender: (\r\n\t\t\t\t\t\t\t\t\t\t\tvalue,\r\n\t\t\t\t\t\t\t\t\t\t\ttableMeta,\r\n\t\t\t\t\t\t\t\t\t\t\tupdateValue\r\n\t\t\t\t\t\t\t\t\t\t) => {\r\n\t\t\t\t\t\t\t\t\t\t\tif (Array.isArray(value)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<GridContainer spacing={2}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{value.map(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(entry, cursor) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Chip\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclasses.valueChip\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tentry.value\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tentry.resolve\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</GridContainer>\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn value !== null &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue !== undefined ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Chip\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={value.resolve}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t} else if (\r\n\t\t\t\t\t\t\t\tfield.reference &&\r\n\t\t\t\t\t\t\t\tfield.input.type === \"file\"\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tdt_columns.push({\r\n\t\t\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\t\t\tlabel: field.label,\r\n\t\t\t\t\t\t\t\t\toptions: {\r\n\t\t\t\t\t\t\t\t\t\tfilter: field.possibilities\r\n\t\t\t\t\t\t\t\t\t\t\t? true\r\n\t\t\t\t\t\t\t\t\t\t\t: false,\r\n\t\t\t\t\t\t\t\t\t\tsort: true,\r\n\t\t\t\t\t\t\t\t\t\tcustomBodyRender: (\r\n\t\t\t\t\t\t\t\t\t\t\tvalue,\r\n\t\t\t\t\t\t\t\t\t\t\ttableMeta,\r\n\t\t\t\t\t\t\t\t\t\t\tupdateValue\r\n\t\t\t\t\t\t\t\t\t\t) => {\r\n\t\t\t\t\t\t\t\t\t\t\tif (Array.isArray(value)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<GridContainer spacing={2}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{value.map(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(entry, cursor) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Chip\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclasses.valueChip\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tavatar={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#cfd8dc\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttextColor=\"#000000\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tFilesHelper.fileType(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tentry.resolve\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) ===\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"image\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? AttachmentsService.getAttachmentFileUrl(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tentry.value\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  )\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: undefined\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{FilesHelper.fileIcon(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tentry.resolve\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Avatar>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tentry.resolve\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet win = window.open(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tAttachmentsService.getAttachmentFileUrl(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tentry.value\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"_blank\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twin.focus();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"file-\" +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tentry.value\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</GridContainer>\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn value !== null &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue !== undefined ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Chip\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tavatar={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#cfd8dc\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttextColor=\"#000000\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tFilesHelper.fileType(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue.resolve\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) ===\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"image\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? AttachmentsService.getAttachmentFileUrl(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue.value\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  )\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: undefined\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{FilesHelper.fileIcon(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue.resolve\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Avatar>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet win = window.open(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tAttachmentsService.getAttachmentFileUrl(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue.value\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"_blank\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twin.focus();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={value.resolve}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tdt_columns.push({\r\n\t\t\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\t\t\tlabel: field.label,\r\n\t\t\t\t\t\t\t\t\toptions: {\r\n\t\t\t\t\t\t\t\t\t\tfilter: field.possibilities\r\n\t\t\t\t\t\t\t\t\t\t\t? true\r\n\t\t\t\t\t\t\t\t\t\t\t: false,\r\n\t\t\t\t\t\t\t\t\t\tsort: true,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t/*this.state.dt_columns = dt_columns;\r\n\t\t\tthis.state.records = [];\r\n\t\t\tthis.state.loading = false;*/\r\n\r\n\t\t\tthis.setState(\r\n\t\t\t\t{\r\n\t\t\t\t\tdefination: defination,\r\n\t\t\t\t\tservice: service,\r\n\t\t\t\t\tquery: query ? { ...query, p: 1 } : { p: 1 },\r\n\t\t\t\t\tdt_columns: dt_columns,\r\n\t\t\t\t\trecords: [],\r\n\t\t\t\t\tloading: false,\r\n\t\t\t\t},\r\n\t\t\t\tthis.loadData\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tparseData(entry) {\r\n\t\tconst { defination, auth } = this.props;\r\n\t\tlet parsed_data = entry;\r\n\t\tlet columns = defination.scope.columns;\r\n\t\tparsed_data[\"entry\"] = entry;\r\n\t\tfor (let [field_name, field] of Object.entries(columns)) {\r\n\t\t\tif (field.input.type === \"date\") {\r\n\t\t\t\tif (entry[field_name]) {\r\n\t\t\t\t\tparsed_data[field_name] = new Date(\r\n\t\t\t\t\t\tentry[field_name]\r\n\t\t\t\t\t).format(formats.dateformats.date);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tparsed_data[field_name] = \"\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (field.input.type === \"datetime\" && entry[field_name]) {\r\n\t\t\t\tif (entry[field_name]) {\r\n\t\t\t\t\tparsed_data[field_name] = new Date(\r\n\t\t\t\t\t\tentry[field_name]\r\n\t\t\t\t\t).format(formats.dateformats.datetime);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tparsed_data[field_name] = \"\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (field.input.type === \"time\") {\r\n\t\t\t\tif (entry[field_name]) {\r\n\t\t\t\t\tparsed_data[field_name] = new Date(\r\n\t\t\t\t\t\tentry[field_name]\r\n\t\t\t\t\t).format(formats.dateformats.time);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tparsed_data[field_name] = \"\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (field.type === \"boolean\") {\r\n\t\t\t\tif (entry[field_name]) {\r\n\t\t\t\t\tparsed_data[field_name] = \"Yes\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\tparsed_data[field_name] = \"No\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (JSON.isJSON(parsed_data[field_name]) && !field.reference) {\r\n\t\t\t\tparsed_data[field_name] = JSON.stringify(\r\n\t\t\t\t\tparsed_data[field_name]\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tif (field.possibilities) {\r\n\t\t\t\tif (JSON.isJSON(field.possibilities)) {\r\n\t\t\t\t\tif (entry[field_name] in field.possibilities) {\r\n\t\t\t\t\t\tparsed_data[field_name] =\r\n\t\t\t\t\t\t\tfield.possibilities[entry[field_name]];\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (Function.isFunction(field.possibilities)) {\r\n\t\t\t\t\tlet possibilities_obj = field.possibilities(\r\n\t\t\t\t\t\tentry,\r\n\t\t\t\t\t\tauth.user\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif (JSON.isJSON(possibilities_obj)) {\r\n\t\t\t\t\t\tif (entry[field_name] in possibilities_obj) {\r\n\t\t\t\t\t\t\tparsed_data[field_name] =\r\n\t\t\t\t\t\t\t\tpossibilities_obj[entry[field_name]];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn parsed_data;\r\n\t}\r\n\r\n\tloadData() {\r\n\t\tconst { auth, cache, defination, apiCallRequest, cache_data, onLoadData, load_data } = this.props;\r\n\t\tif (defination ) {\r\n\t\t\tif (load_data) {\r\n\t\t\t\tthis.setState({loading: true, load_error: false});\r\n\t\t\t\tapiCallRequest( defination.name,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\turi: defination.endpoint,\r\n\t\t\t\t\t\ttype: \"records\",\r\n\t\t\t\t\t\tparams: this.state.query,\r\n\t\t\t\t\t\tdata: {},\r\n\t\t\t\t\t\tcache: cache_data,\r\n\t\t\t\t\t}\r\n\t\t\t\t).then(data => {\r\n\t\t\t\t\tif (Function.isFunction(onLoadData)) {\r\n\t\t\t\t\t\tonLoadData(data, this.state.query);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.setState({loading: false});\r\n\t\t\t\t\tthis.prepareData(data);\r\n\t\t\t\t}).catch(e => {\r\n\t\t\t\t\tthis.setState(state => ({\r\n\t\t\t\t\t\trecords: [],\r\n\t\t\t\t\t\tload_error: e,\r\n\t\t\t\t\t\tloading: false,\r\n\t\t\t\t\t}));\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlet data = Array.isArray(cache.data[defination.name])? cache.data[defination.name] : [];\r\n\t\t\t\tif (Function.isFunction(onLoadData)) {\r\n\t\t\t\t\tonLoadData(data, this.state.query);\r\n\t\t\t\t}\r\n\t\t\t\tthis.prepareData(data);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.setState(state => ({\r\n\t\t\t\trecords: [],\r\n\t\t\t\tload_error: { msg: \"No Context defination or provided\" },\r\n\t\t\t\tloading: false,\r\n\t\t\t}));\r\n\t\t}\r\n\t}\r\n\r\n\tprepareData(data=null) {\r\n\t\tconst { auth, cache, defination } = this.props;\r\n\t\tlet target_data = Array.isArray(data)? data : (Array.isArray(cache.data[defination.name]) ? cache.data[defination.name] : []);\r\n\t\tlet columns = defination ? defination.scope.columns : {};\r\n\t\tlet resolved_data = [];\r\n\r\n\r\n\r\n\t\tif (Function.isFunction(defination.views.listing.tableview.resolveData)) {\r\n\t\t\tdefination.views.listing.tableview\r\n\t\t\t\t.resolveData(target_data, true)\r\n\t\t\t\t.then(resolve => {\r\n\t\t\t\t\tif (this.mounted) {\r\n\t\t\t\t\t\tthis.setState(state => ({\r\n\t\t\t\t\t\t\traw_data: target_data,\r\n\t\t\t\t\t\t\trecords: resolve,\r\n\t\t\t\t\t\t\tloading: false,\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.state.records = resolve;\r\n\t\t\t\t\t\tthis.state.loading = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.catch(e => {\r\n\t\t\t\t\tif (this.mounted) {\r\n\t\t\t\t\t\tthis.setState(state => ({\r\n\t\t\t\t\t\t\traw_data: [],\r\n\t\t\t\t\t\t\trecords: [],\r\n\t\t\t\t\t\t\tloading: false,\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.state.records = [];\r\n\t\t\t\t\t\tthis.state.loading = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t} else {\r\n\t\t\tresolved_data = ServiceDataHelper.resolveReferenceColumnsDisplays(\r\n\t\t\t\ttarget_data,\r\n\t\t\t\tcolumns,\r\n\t\t\t\tauth.user\r\n\t\t\t);\r\n\t\t\tlet that = this;\r\n\t\t\tlet all_records = resolved_data.map(entry => {\r\n\t\t\t\treturn that.parseData(entry);\r\n\t\t\t});\r\n\t\t\tthis.setState(state => ({ records: all_records }));\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { classes, defination, api, cache, actionsType } = this.props;\r\n\t\tconst table_options = {\r\n\t\t\tfilterType: \"dropdown\",\r\n\t\t\tfilter: true,\r\n\t\t\tdownloadOptions: {\r\n\t\t\t\tfilename:\r\n\t\t\t\t\t(defination ? defination.label : \"Records\") +\r\n\t\t\t\t\t\" - \" +\r\n\t\t\t\t\tnew Date().format(\"d M Y H:i:s A\") +\r\n\t\t\t\t\t\".csv\",\r\n\t\t\t\tseparator: \",\",\r\n\t\t\t},\r\n\t\t\tresizableColumns: false,\r\n\t\t\tselectableRows: \"none\",\r\n\t\t\tresponsive: \"scroll\",\r\n\t\t\tpagination: false,\r\n\t\t\trowHover: true,\r\n\t\t\t/*onCellClick: (colData, cellMeta) => {\r\n\t\t\t\tconsole.log(\"onCellClick colData\", colData);\r\n\t\t\t},\r\n\t\t\tsetRowProps: (row, dataIndex, rowIndex) => {\r\n\t\t\t\tconsole.log(\"setRowProps dataIndex\", dataIndex);\r\n\t\t\t\tlet rowProps = {};\r\n\t\t\t\tif (actionsType === \"context\") {\r\n\t\t\t\t\trowProps.onContextMenu = this.handleOnRowContextMenu(dataIndex);\r\n\t\t\t\t}\r\n\t\t\t\treturn rowProps;\r\n\t\t\t},*/\r\n\t\t\tcustomToolbarSelect: (selectedRows, displayData, setSelectedRows) => {\r\n\t\t\t\tconsole.log(\"customToolbarSelect selectedRows\", selectedRows);\r\n\t\t\t\tconsole.log(\"customToolbarSelect displayData\", displayData);\r\n\t\t\t}\r\n\t\t};\r\n\t\t/*if (actionsType === \"context\") {\r\n\t\t\ttable_options.customRowRender = (data, dataIndex, rowIndex) => {\r\n\t\t\t\t\t\tconsole.log(\"customRowRender data\", data);\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<TableRow key={\"row-\"+rowIndex} onContextMenu={ this.handleOnRowContextMenu(dataIndex) }>\r\n\t\t\t\t\t\t\t\t{data.map((value, index)=>(\r\n\t\t\t\t\t\t\t\t\t<TableCell \r\n\t\t\t\t\t\t\t\t\t\tkey={\"row-\"+rowIndex+\"-cell-\"+index}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{ value }\r\n\t\t\t\t\t\t\t\t\t</TableCell>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</TableRow>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t};\r\n\t\t}*/\r\n\t\treturn (\r\n\t\t\t<GridContainer className={classes.root}>\r\n\t\t\t\t<GridItem className=\"p-0 m-0\" xs={12}>\r\n\t\t\t\t\t{ this.state.loading && <GridContainer className={classes.full_height} justify=\"center\" alignItems=\"center\">\r\n\t\t\t\t\t\t\t\t<GridItem xs={12} className=\"flex relative flex-row\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" width={150}/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={32} height={32} className=\"float-right mx-2\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={32} height={32} className=\"float-right mx-2\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={32} height={32} className=\"float-right mx-2\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={32} height={32} className=\"float-right mx-2\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<GridItem xs={12}>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"rect\" width={\"100%\"} height={70} className=\"mt-2\"/>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"rect\" width={\"100%\"} height={70} className=\"mt-2\"/>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"rect\" width={\"100%\"} height={70} className=\"mt-2\"/>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"rect\" width={\"100%\"} height={70} className=\"mt-2\"/>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t</GridContainer> }\r\n\r\n\t\t\t\t\t{(!this.state.loading && Array.isArray(this.state.records)) && <GridContainer className=\"p-0 m-0\">\r\n\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\r\n\t\t\t\t\t\t\t<GridItem className=\"p-0 m-0\" xs={12}>\r\n\t\t\t\t\t\t\t\t{actionsType === \"context\" && <ClickAwayListener onContextMenu={this.handleOnRowContextMenuClose} onClickAway={this.handleOnRowContextMenuClose}>\r\n\t\t\t\t\t\t\t\t\t\t<Menu\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\topen={this.state.mouseY !== null}\r\n\t\t\t\t\t\t\t\t\t\t\tonClose={this.handleOnRowContextMenuClose}\r\n\t\t\t\t\t\t\t\t\t\t\tanchorReference=\"anchorPosition\"\r\n\t\t\t\t\t\t\t\t\t\t\tanchorPosition={ this.state.mouseY !== null && this.state.mouseX !== null? { top: this.state.mouseY, left: this.state.mouseX } : undefined }\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<MenuItem onClick={ this.handleOnRowContextMenuClose }>Copy</MenuItem>\r\n\t\t\t\t\t\t\t\t\t\t\t<MenuItem onClick={ this.handleOnRowContextMenuClose }>Print</MenuItem>\r\n\t\t\t\t\t\t\t\t\t\t\t<MenuItem onClick={ this.handleOnRowContextMenuClose }>Highlight</MenuItem>\r\n\t\t\t\t\t\t\t\t\t\t\t<MenuItem onClick={ this.handleOnRowContextMenuClose }>Email</MenuItem>\r\n\t\t\t\t\t\t\t\t\t\t</Menu>\r\n\t\t\t\t\t\t\t\t\t</ClickAwayListener>}\r\n\r\n\t\t\t\t\t\t\t\t{this.state.records.length > 0 ? (\r\n\t\t\t\t\t\t\t\t\t<MUIDataTable\r\n\t\t\t\t\t\t\t\t\t\ttitle={\r\n\t\t\t\t\t\t\t\t\t\t\t(api.loading ? \"Loading \" : \"\") +\r\n\t\t\t\t\t\t\t\t\t\t\tdefination.label +\r\n\t\t\t\t\t\t\t\t\t\t\t(api.loading ? \"...\" : \"\")\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tdata={this.state.records}\r\n\t\t\t\t\t\t\t\t\t\tcolumns={this.state.dt_columns}\r\n\t\t\t\t\t\t\t\t\t\toptions={table_options}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t<GridContainer\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"p-0 m-0\"\r\n\t\t\t\t\t\t\t\t\t\tjustify=\"center\"\r\n\t\t\t\t\t\t\t\t\t\talignItems=\"center\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\t\t\talt=\"Empty list\"\r\n\t\t\t\t\t\t\t\t\t\t\tclassName={classes.emptyImage}\r\n\t\t\t\t\t\t\t\t\t\t\tsrc={EmptyStateImage}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t<Typography\r\n\t\t\t\t\t\t\t\t\t\t\tclassName={classes.emptyText}\r\n\t\t\t\t\t\t\t\t\t\t\tcolor=\"grey\"\r\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"body2\"\r\n\t\t\t\t\t\t\t\t\t\t\tcenter\r\n\t\t\t\t\t\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\tNo{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\t{defination.label\r\n\t\t\t\t\t\t\t\t\t\t\t\t? defination.label\r\n\t\t\t\t\t\t\t\t\t\t\t\t: \"Records\"}{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\tfound\r\n\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t</GridContainer>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t</GridContainer>\r\n\t\t\t\t\t\t{(api ? api.busy && api.error : false) && (\r\n\t\t\t\t\t\t\t<GridContainer>\r\n\t\t\t\t\t\t\t\t<GridItem xs={12}>\r\n\t\t\t\t\t\t\t\t\t<Typography\r\n\t\t\t\t\t\t\t\t\t\tcolor=\"error\"\r\n\t\t\t\t\t\t\t\t\t\tvariant=\"body2\"\r\n\t\t\t\t\t\t\t\t\t\tcenter\r\n\t\t\t\t\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{\"An error occured. \\n \" + api.error.msg +\" \\n Displaying cached data.\"}\r\n\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t\t</GridContainer>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</GridContainer> }\r\n\r\n\t\t\t\t</GridItem>\r\n\t\t\t</GridContainer>\r\n\t\t);\r\n\t}\r\n}\r\nTableView.propTypes = {\r\n\tclassName: PropTypes.string,\r\n\tclasses: PropTypes.object.isRequired,\r\n\tdefination: PropTypes.object.isRequired,\r\n\tservice: PropTypes.any.isRequired,\r\n\tshow_actions: PropTypes.bool,\r\n\tshow_links: PropTypes.bool,\r\n\tquery: PropTypes.object,\r\n\tcache_data: PropTypes.bool,\r\n\tload_data: PropTypes.bool,\r\n\tonLoadData: PropTypes.func,\r\n\t\r\n};\r\n\r\nTableView.defaultProps = {\r\n\tshow_actions: true,\r\n\tshow_links: true,\r\n\tquery: { p: 1 },\r\n\tcache_data: true,\r\n\tload_data: true,\r\n\tactionsType: \"inline\",\r\n};\r\n\r\nconst mapStateToProps = (state, ownProps) => ({\r\n\tauth: state.auth,\r\n\tcache: state.cache,\r\n\tapi:state.api,\r\n});\r\n\r\nexport default withErrorHandler(\r\n\tcompose(\r\n\t\twithStyles(styles),\r\n\t\tconnect(mapStateToProps, { openDialog, closeDialog, apiCallRequest })\r\n\t)(TableView)\r\n);\r\n","/** @format */\n\nexport default theme => ({\n\troot: {\n\t\tpadding: \"0\",\n\t},\n\tdata_actions_wrapper: {\n\t\tdisplay: \"inline-block\",\n\t\twhiteSpace: \"nowrap\",\n\t\t\"& > *\": {\n\t\t\tdisplay: \"inline-block\",\n\t\t\twhiteSpace: \"nowrap\",\n\t\t},\n\t},\n\tvalueChip: {\n\t\tmargin: theme.spacing(0.5),\n\t},\n\temptyImage: {\n\t\tmaxWidth: 200,\n\t\twidth: \"100%\",\n\t},\n\temptyText: {\n\t\tmarginTop: theme.spacing(3),\n\t},\n});\n","/** @format */\r\n\r\nimport Button from \"@material-ui/core/Button\";\r\nimport ButtonGroup from \"@material-ui/core/ButtonGroup\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\n//\r\nimport GridContainer from \"components/Grid/GridContainer\";\r\nimport GridItem from \"components/Grid/GridItem\";\r\nimport Typography from \"components/Typography\";\r\nimport PropTypes from \"prop-types\";\r\nimport React, {useEffect} from \"react\";\r\n//Redux imports\r\nimport { connect } from \"react-redux\";\r\nimport compose from \"recompose/compose\";\r\nimport Pagination from '@material-ui/lab/Pagination';\r\nimport TablePagination from '@material-ui/core/TablePagination';\r\nimport Accordion from '@material-ui/core/Accordion';\r\nimport AccordionDetails from '@material-ui/core/AccordionDetails';\r\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\r\nimport AccordionActions from '@material-ui/core/AccordionActions';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport FirstPageIcon from '@material-ui/icons/FirstPage';\r\nimport KeyboardArrowLeft from '@material-ui/icons/KeyboardArrowLeft';\r\nimport KeyboardArrowRight from '@material-ui/icons/KeyboardArrowRight';\r\nimport LastPageIcon from '@material-ui/icons/LastPage';\r\nimport { useTheme } from '@material-ui/core/styles';\r\nimport {\r\n\tTextInput\r\n} from \"components/FormInputs\";\r\nimport InputBase from '@material-ui/core/InputBase';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport ExpandLessIcon from '@material-ui/icons/ExpandLess';\r\nimport FilterListIcon from '@material-ui/icons/FilterList';\r\nimport CalendarView from \"./CalendarView\";\r\nimport GoogleMapView from \"./GoogleMapView\";\r\nimport GoogleMapOverview from \"views/widgets/Overview/GoogleMapOverview\";\r\nimport ListView from \"./ListView\";\r\nimport Chip from '@material-ui/core/Chip';\r\nimport ContextDataForm from \"views/forms/BaseForm\";\r\nimport { withErrorHandler } from \"hoc/ErrorHandler\";\r\n//\r\nimport styles from \"./styles\";\r\n//\r\nimport TableView from \"./TableView\";\r\n\r\nfunction TablePaginationActions(props) {\r\n\tconst theme = useTheme();\r\n\tconst { count, page, rowsPerPage, onChangePage } = props;\r\n\r\n\t\r\n\tconst handleFirstPageButtonClick = (event) => {\r\n\t\tonChangePage(event, 0);\r\n\t};\r\n\r\n\tconst handleBackButtonClick = (event) => {\r\n\t\tonChangePage(event, page - 1);\r\n\t};\r\n\r\n\tconst handleNextButtonClick = (event) => {\r\n\t\tonChangePage(event, page + 1);\r\n\t};\r\n\r\n\tconst handleLastPageButtonClick = (event) => {\r\n\t\tonChangePage(event, Math.max(0, Math.ceil(count / rowsPerPage) - 1));\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className={\"ml-2 flex-shrink-0\"}>\r\n\t\t\t<IconButton\r\n\t\t\t\tonClick={handleFirstPageButtonClick}\r\n\t\t\t\tdisabled={page === 0}\r\n\t\t\t\taria-label=\"first page\"\r\n\t\t\t>\r\n\t\t\t\t{theme.direction === 'rtl' ? <LastPageIcon /> : <FirstPageIcon />}\r\n\t\t\t</IconButton>\r\n\t\t\t<IconButton onClick={handleBackButtonClick} disabled={page === 0} aria-label=\"previous page\">\r\n\t\t\t\t{theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\r\n\t\t\t</IconButton>\r\n\t\t\t<IconButton\r\n\t\t\t\tonClick={handleNextButtonClick}\r\n\t\t\t\tdisabled={page >= Math.ceil(count / rowsPerPage) - 1}\r\n\t\t\t\taria-label=\"next page\"\r\n\t\t\t>\r\n\t\t\t\t{theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\r\n\t\t\t</IconButton>\r\n\t\t\t<IconButton\r\n\t\t\t\tonClick={handleLastPageButtonClick}\r\n\t\t\t\tdisabled={page >= Math.ceil(count / rowsPerPage) - 1}\r\n\t\t\t\taria-label=\"last page\"\r\n\t\t\t>\r\n\t\t\t\t{theme.direction === 'rtl' ? <FirstPageIcon /> : <LastPageIcon />}\r\n\t\t\t</IconButton>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nTablePaginationActions.propTypes = {\r\n\tcount: PropTypes.number.isRequired,\r\n\tonChangePage: PropTypes.func.isRequired,\r\n\tpage: PropTypes.number.isRequired,\r\n\trowsPerPage: PropTypes.number.isRequired,\r\n};\r\n\r\n\r\nclass ListingView extends React.Component {\r\n\tstate = {\r\n\t\tdefination: null,\r\n\t\tservice: null,\r\n\t\tview: \"tableview\",\r\n\t\tviews: {},\r\n\t\tshowViewOptions: true,\r\n\t\tshowAddBtn: true,\r\n\t\tsearchKeyword: \"\",\r\n\t\tquery: {},\r\n\t\tpages: 10,\r\n\t\tpage: 1,\r\n\t\tviewMenuAnchorEl: null,\r\n\t\tsortFields: [],\r\n\t\tfilterAccordionExpanded: false,\r\n\t\tfilterableFields: {},\r\n\t\tfilterContext: false,\r\n\t\tfilterMenuAnchor: null,\r\n\t\tfilters: {\r\n\t\t\tvalues: {},\r\n\t\t\tlabels: {},\r\n\t\t}\r\n\t};\r\n\tmounted = false;\r\n\tsearchkeywordRef = React.createRef();\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tconst { defination, service, query, cache, app } = props;\r\n\t\tthis.state.defination = defination;\r\n\t\tthis.state.service = service;\r\n\t\tthis.state.query = query ? { \r\n\t\t\t...query, \r\n\t\t\tp: 1, \r\n\t\t\tpagination: ('rpp' in query? query['rpp'] : ('pagination' in query? query['pagination'] : app.preferences.data.pagination)), \r\n\t\t\tpage: ('pg' in query? query['pg'] : ('page' in query? query['page'] : 1)), \r\n\t\t} : { \r\n\t\t\tp: 1, \r\n\t\t\tpagination: ('rpp' in query? query['rpp'] : ('pagination' in query? query['pagination'] : app.preferences.data.pagination)), \r\n\t\t\tpage: ('pg' in query? query['pg'] : ('page' in query? query['page'] : 1)), \r\n\t\t};\r\n\r\n\t\tlet filterableFields = {};\r\n\t\t\tlet filterContext = false;\r\n\t\t\tlet searchKeyword = \"\";\r\n\t\t\tObject.entries(defination.scope.columns).map(([column_name, column_props], cursor) => {\r\n\t\t\t\tif (![\"file\", \"dynamic\", \"textarea\", \"password\", \"wysiwyg\", \"map\", \"file\", \"slider\", \"multiselect\"].includes(column_props.input.type)) {\r\n\t\t\t\t\tfilterableFields[column_name] = column_props;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (JSON.isJSON(query)) {\r\n\t\t\t\tlet filterContextMatched = false;\r\n\t\t\t\tlet filterableColumns = Object.keys(filterableFields);\r\n\t\t\t\tObject.entries(query).map(([queryColumn, queryValue]) => {\r\n\t\t\t\t\tif (!filterContextMatched && filterableColumns.includes(queryColumn)) {\r\n\t\t\t\t\t\tfilterContext = queryColumn;\r\n\t\t\t\t\t\tsearchKeyword = queryValue;\r\n\t\t\t\t\t\tif (String.isString(queryValue)) {\r\n\t\t\t\t\t\t\tsearchKeyword = queryValue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tsearchKeyword = String(queryValue);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfilterContextMatched = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t}\r\n\t\t\r\n\t\tif (!filterContext && (query.q || query.query)) {\r\n\t\t\tif (query.q) {\r\n\t\t\t\tthis.state.searchKeyword = query.q;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.state.searchKeyword = query.query;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.state.searchKeyword = searchKeyword;\r\n\t\t\tthis.state.filterContext = filterContext;\r\n\t\t}\r\n\r\n\r\n\t\tthis.handleViewItemClick = this.handleViewItemClick.bind(this);\r\n\t\tthis.handleOnPageChanged = this.handleOnPageChanged.bind(this);\r\n\r\n\t\tthis.handleOnRecordsPerPageChanged = this.handleOnRecordsPerPageChanged.bind(this);\r\n\t}\r\n\r\n\t\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.mounted = true;\r\n\t\tthis.prepareForRender();\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tthis.mounted = false;\r\n\t}\r\n\r\n\tgetSnapshotBeforeUpdate(prevProps) {\r\n\t\tthis.mounted = false;\r\n\t\treturn {\r\n\t\t\tprepareForRenderRequired: !Object.areEqual(prevProps.query, this.props.query),\r\n\t\t};\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\r\n\t\tthis.mounted = true;\r\n\t\tif (snapshot.prepareForRenderRequired) {\r\n\t\t\tthis.prepareForRender();\r\n\t\t}\r\n\t}\r\n\r\n\thandleViewItemClick = name => event => {\r\n\t\tif (this.mounted) {\r\n\t\t\tthis.setState({ view: name, viewMenuAnchorEl: null });\r\n\t\t} else {\r\n\t\t\tthis.state.view = name;\r\n\t\t\tthis.state.viewMenuAnchorEl = null;\r\n\t\t}\r\n\t};\r\n\r\n\thandleShowViewsMenu = event => {\r\n\t\tconst viewMenuAnchorEl = event.currentTarget;\r\n\t\tif (this.mounted) {\r\n\t\t\tthis.setState({ viewMenuAnchorEl: viewMenuAnchorEl });\r\n\t\t} else {\r\n\t\t\tthis.state.viewMenuAnchorEl = viewMenuAnchorEl;\r\n\t\t}\r\n\t};\r\n\r\n\thandleCloseViewsMenu = () => {\r\n\t\tif (this.mounted) {\r\n\t\t\tthis.setState({ viewMenuAnchorEl: null });\r\n\t\t} else {\r\n\t\t\tthis.state.viewMenuAnchorEl = null;\r\n\t\t}\r\n\t};\r\n\r\n\thandleOnPageChanged = (event, page) => {\r\n\t\tthis.setState(prevState => ({ \r\n\t\t\t\tpage: page+1,\r\n\t\t\t\tquery: {\r\n\t\t\t\t\t...prevState.query,\r\n\t\t\t\t\tpage: page+1\r\n\t\t\t\t},\r\n\t\t\t\tviewMenuAnchorEl: null\r\n\t\t\t}));\r\n\t};\r\n\r\n\thandleOnRecordsPerPageChanged = (event) => {\r\n\t\tconst pagination = Number.parseNumber(event.target.value, this.state.query.pagination);\r\n\t\tthis.setState(prevState => ({ \r\n\t\t\t\tpage: 1,\r\n\t\t\t\tquery: {\r\n\t\t\t\t\t...prevState.query,\r\n\t\t\t\t\tpagination: pagination\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t};\r\n\r\n\r\n\tasync prepareForRender() {\r\n\t\tconst { defination, service, query, view, showViewOptions, showAddBtn, app } = this.props;\r\n\t\tif (defination && service) {\r\n\t\t\tlet all_views = {\r\n\t\t\t\ttableview: \"Table View\",\r\n\t\t\t\tlistview: \"List View\",\r\n\t\t\t\tgooglemapview: \"Map View\",\r\n\t\t\t\tvectormapview: \"Vector Map View\",\r\n\t\t\t\tcalendarview: \"Calendar View\",\r\n\t\t\t};\r\n\t\t\tlet views = {};\r\n\t\t\tlet default_view = \"tableview\";\r\n\t\t\tif (defination.views.listing.default in all_views) {\r\n\t\t\t\tdefault_view = defination.views.listing.default;\r\n\t\t\t}\r\n\t\t\tfor (let [name, label] of Object.entries(all_views)) {\r\n\t\t\t\tif (name in defination.views.listing) {\r\n\t\t\t\t\tviews[name] = label;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet filterableFields = {};\r\n\t\t\tlet filterContext = false;\r\n\t\t\tlet searchKeyword = \"\";\r\n\t\t\tObject.entries(defination.scope.columns).map(([column_name, column_props], cursor) => {\r\n\t\t\t\tif (![\"file\", \"dynamic\", \"textarea\", \"password\", \"wysiwyg\", \"map\", \"file\", \"slider\", \"multiselect\"].includes(column_props.input.type)) {\r\n\t\t\t\t\tfilterableFields[column_name] = column_props;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (JSON.isJSON(query)) {\r\n\t\t\t\tlet filterContextMatched = false;\r\n\t\t\t\tlet filterableColumns = Object.keys(filterableFields);\r\n\t\t\t\tObject.entries(query).map(([queryColumn, queryValue]) => {\r\n\t\t\t\t\tif (!filterContextMatched && filterableColumns.includes(queryColumn)) {\r\n\t\t\t\t\t\tfilterContext = queryColumn;\r\n\t\t\t\t\t\tsearchKeyword = queryValue;\r\n\t\t\t\t\t\tif (String.isString(queryValue)) {\r\n\t\t\t\t\t\t\tsearchKeyword = queryValue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tsearchKeyword = String(queryValue);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfilterContextMatched = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t}\r\n\t\t\tconsole.log(\"this.searchkeywordRef\", \"this.searchkeywordRef\")\r\n\t\t\tif (this.mounted) {\r\n\t\t\t\tthis.setState(state => ({\r\n\t\t\t\t\tdefination: defination,\r\n\t\t\t\t\tservice: service,\r\n\t\t\t\t\tquery: query ? { \r\n\t\t\t\t\t\t...query, \r\n\t\t\t\t\t\tp: 1,\r\n\t\t\t\t\t\tpagination: ('rpp' in query? query['rpp'] : ('pagination' in query? query['pagination'] : app.preferences.data.pagination)), \r\n\t\t\t\t\t\tpage: ('pg' in query? query['pg'] : ('page' in query? query['page'] : 1)), \r\n\t\t\t\t\t} : { \r\n\t\t\t\t\t\tp: 1,\r\n\t\t\t\t\t\tpagination: ('rpp' in query? query['rpp'] : ('pagination' in query? query['pagination'] : app.preferences.data.pagination)), \r\n\t\t\t\t\t\tpage: ('pg' in query? query['pg'] : ('page' in query? query['page'] : 1)), \r\n\t\t\t\t\t},\r\n\t\t\t\t\tviews: views,\r\n\t\t\t\t\tview: view ? view : default_view,\r\n\t\t\t\t\tshowViewOptions: showViewOptions,\r\n\t\t\t\t\tshowAddBtn: showAddBtn,\r\n\t\t\t\t\tfilterableFields: filterableFields,\r\n\t\t\t\t\tsearchKeyword: searchKeyword,\r\n\t\t\t\t\tfilterContext: filterContext,\r\n\r\n\t\t\t\t}));\r\n\t\t\t} else {\r\n\t\t\t\tthis.state = {\r\n\t\t\t\t\t...this.state,\r\n\t\t\t\t\tdefination: defination,\r\n\t\t\t\t\tservice: service,\r\n\t\t\t\t\tquery: query ? { \r\n\t\t\t\t\t\t...query, \r\n\t\t\t\t\t\tp: 1,\r\n\t\t\t\t\t\tpagination: ('rpp' in query? query['rpp'] : ('pagination' in query? query['pagination'] : app.preferences.data.pagination)), \r\n\t\t\t\t\t\tpage: ('pg' in query? query['pg'] : ('page' in query? query['page'] : 1)), \r\n\t\t\t\t\t} : { \r\n\t\t\t\t\t\tp: 1,\r\n\t\t\t\t\t\tpagination: ('rpp' in query? query['rpp'] : ('pagination' in query? query['pagination'] : app.preferences.data.pagination)), \r\n\t\t\t\t\t\tpage: ('pg' in query? query['pg'] : ('page' in query? query['page'] : 1)), \r\n\t\t\t\t\t},\r\n\t\t\t\t\tviews: views,\r\n\t\t\t\t\tview: view ? view : default_view,\r\n\t\t\t\t\tshowViewOptions: showViewOptions,\r\n\t\t\t\t\tshowAddBtn: showAddBtn,\r\n\t\t\t\t\tfilterableFields: filterableFields,\r\n\t\t\t\t\tsearchKeyword: searchKeyword,\r\n\t\t\t\t\tfilterContext: filterContext,\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { classes, auth, query, defination, service, cache, api, showPagination, showSorter, cache_data, onLoadData, load_data, onClickEntry, sorterFormLayoutType } = this.props;\r\n\t\tconst { view } = this.state;\r\n\t\treturn (\r\n\t\t\t<GridContainer className=\"p-0 m-0\">\r\n\t\t\t\t<GridContainer className=\"p-0 m-0\">\r\n\t\t\t\t\t{this.state.showViewOptions && (\r\n\t\t\t\t\t\t<GridItem sm={12} md={8}>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t{Object.entries(this.state.views).map(\r\n\t\t\t\t\t\t\t\t\t([name, label], index) => (\r\n\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\tcolor={\"primary\"}\r\n\t\t\t\t\t\t\t\t\t\t\tvariant={name === view? \"contained\" : \"text\"}\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={(event) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(name);\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({ view: name, viewMenuAnchorEl: null });\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\tkey={\"btn-view-\"+name}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{label}\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t{this.state.showAddBtn &&\r\n\t\t\t\t\t\tdefination &&\r\n\t\t\t\t\t\t!defination.access.actions.create.restricted(\r\n\t\t\t\t\t\t\tauth.user\r\n\t\t\t\t\t\t) && (\r\n\t\t\t\t\t\t\t<GridItem\r\n\t\t\t\t\t\t\t\tsm={12}\r\n\t\t\t\t\t\t\t\tmd={this.state.showViewOptions ? 4 : 12}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{defination.access.actions.create.link.inline.default(\r\n\t\t\t\t\t\t\t\t\t{ className: \"float-right\" }\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t</GridContainer>\r\n\r\n\t\t\t\t<GridContainer className=\"p-1 m-0\">\r\n\t\t\t\t\t{ (showSorter && view !== \"googlemapview\") && <GridItem xs={12} className=\"p-0 m-0 mb-2\" >\r\n\t\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\r\n\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t<GridItem xs={12} className={\"p-0\"}>\r\n\t\t\t\t\t\t\t\t<Accordion \r\n\t\t\t\t\t\t\t\t\texpanded={this.state.filterAccordionExpanded}\r\n\t\t\t\t\t\t\t\t\tclassName=\"p-0\"\r\n\t\t\t\t\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{/*<AccordionSummary\r\n\t\t\t\t\t\t\t\t\t\texpandIcon={this.state.filterAccordionExpanded? <ExpandLessIcon /> : <FilterListIcon />}\r\n\t\t\t\t\t\t\t\t\t\taria-controls=\"filter-panel1c-content\"\r\n\t\t\t\t\t\t\t\t\t\tid=\"filter-panel1c-header\"\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"flex m-0 p-0 flex-grow\"\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t>*/}\r\n\t\t\t\t\t\t\t\t\t<Paper \r\n\t\t\t\t\t\t\t\t\t\tcomponent=\"form\" \r\n\t\t\t\t\t\t\t\t\t\televation={0}\r\n\t\t\t\t\t\t\t\t\t\tclassName={classes.searchRoot} \r\n\t\t\t\t\t\t\t\t\t\tonSubmit={event => {\r\n\t\t\t\t\t\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\tquery: prevState.filterContext? {...prevState.query, [prevState.filterContext]: prevState.searchKeyword} : {...prevState.query, q: prevState.searchKeyword}\r\n\t\t\t\t\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"Search submit searchKeyword\", this.state.searchKeyword)\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{!this.state.filterContext && <IconButton \r\n\t\t\t\t\t\t\t\t\t\t\tclassName={classes.filterIconButton} \r\n\t\t\t\t\t\t\t\t\t\t\taria-label=\"Filter\"\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={(event)=>{\r\n\t\t\t\t\t\t\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({filterMenuAnchor: event.currentTarget});\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<MenuIcon />\r\n\t\t\t\t\t\t\t\t\t\t</IconButton>}\r\n\t\t\t\t\t\t\t\t\t\t{(this.state.filterContext && this.state.filterableFields[this.state.filterContext])&& <Button  \r\n\t\t\t\t\t\t\t\t\t\t\taria-label=\"Filter\"\r\n\t\t\t\t\t\t\t\t\t\t\tsize={\"small\"}\r\n\t\t\t\t\t\t\t\t\t\t\tcolor=\"secondary\"\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={(event)=>{\r\n\t\t\t\t\t\t\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({filterMenuAnchor: event.currentTarget});\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{Function.isFunction(this.state.filterableFields[this.state.filterContext].label)? this.state.filterContext.humanize() : this.state.filterableFields[this.state.filterContext].label}\r\n\t\t\t\t\t\t\t\t\t\t</Button>}\r\n\t\t\t\t\t\t\t\t\t\t<Menu\r\n\t\t\t\t\t\t\t\t\t        id=\"filter-fields-menu\"\r\n\t\t\t\t\t\t\t\t\t        anchorEl={this.state.filterMenuAnchor}\r\n\t\t\t\t\t\t\t\t\t        keepMounted\r\n\t\t\t\t\t\t\t\t\t        open={Boolean(this.state.filterMenuAnchor)}\r\n\t\t\t\t\t\t\t\t\t        onClose={() => this.setState({filterMenuAnchor: null})}\r\n\t\t\t\t\t\t\t\t\t    >\r\n\t\t\t\t\t\t\t\t\t        {Object.entries(this.state.filterableFields).map(([filterableField, filterableFieldProps], cursor) => (\r\n\t\t\t\t\t\t\t\t\t        \t<MenuItem \r\n\t\t\t\t\t\t\t\t\t        \t\tonClick={()=> {\r\n\t\t\t\t\t\t\t\t\t        \t\t\tthis.setState({filterContext: (this.state.filterContext === filterableField? false : filterableField), filterMenuAnchor: null});\t\t\t\t\t\t\t\t\t        \t\t\t\r\n\t\t\t\t\t\t\t\t\t        \t\t}}\r\n\t\t\t\t\t\t\t\t\t        \t>\r\n\t\t\t\t\t\t\t\t\t        \t\t{Function.isFunction(filterableFieldProps.label)? filterableField.humanize() : filterableFieldProps.label}\r\n\t\t\t\t\t\t\t\t\t        \t</MenuItem>\r\n\t\t\t\t\t\t\t\t\t        ))}\r\n\t\t\t\t\t\t\t\t\t    </Menu>\r\n\t\t\t\t\t\t\t\t\t\t<TextInput\r\n\t\t\t\t\t\t\t\t\t\t\tclassName={classes.searchInput}\r\n\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Search...\"\r\n\t\t\t\t\t\t\t\t\t\t\tinputProps={{ 'aria-label': 'Search' }}\r\n\t\t\t\t\t\t\t\t\t\t\tdefaultValue={this.state.searchKeyword}\r\n\t\t\t\t\t\t\t\t\t\t\tonFocus={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (!this.state.filterAccordionExpanded) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({ filterAccordionExpanded: true });\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\tonChange={newKeyword => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.setState(prevState=>{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet newState = { searchKeyword: newKeyword };\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (prevState.query) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (prevState.query.q) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet newQuery = JSON.fromJSON(prevState.query);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdelete newQuery[\"q\"];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnewState.query = newQuery;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn newState;\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\tvariant={\"base\"}\r\n\t\t\t\t\t\t\t\t\t\t\tref={ref => (this.searchkeywordRef = ref)}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t<IconButton \r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"submit\" className={classes.searchIconButton} aria-label=\"search\">\r\n\t\t\t\t\t\t\t\t\t\t\t<SearchIcon />\r\n\t\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t\t</Paper>\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t{/*</AccordionSummary>*/}\r\n\t\t\t\t\t\t\t\t\t<AccordionDetails className={\"p-0\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t{ Object.keys(this.state.filters.values).length > 0 && <GridContainer className=\"m-0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{Object.entries(this.state.filters.labels).map(([filter_name, filter_label], cursor) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Chip \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"mx-1 my-1 max-w-xs\" \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"secondary\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={(String.isString(defination.scope.columns[filter_name].label)? (defination.scope.columns[filter_name].label+\" : \") : \"\")+filter_label} \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outlined\" \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{maxWidth: 180}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={\"filter-chip-\"+cursor}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t</GridContainer>}\r\n\t\t\t\t\t\t\t\t\t</AccordionDetails>\r\n\t\t\t\t\t\t\t\t</Accordion>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t</GridContainer>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</GridItem>}\r\n\t\t\t\t\t\r\n\t\t\t\t\t<GridItem xs={12} className=\"p-0 m-0\">\r\n\t\t\t\t\t\t{view == \"tableview\" && <TableView\r\n\t\t\t\t\t\t\t\tdefination={defination}\r\n\t\t\t\t\t\t\t\tservice={this.state.service}\r\n\t\t\t\t\t\t\t\tquery={this.state.query}\r\n\t\t\t\t\t\t\t\tcache_data={cache_data}\r\n\t\t\t\t\t\t\t\tload_data={load_data}\r\n\t\t\t\t\t\t\t\tonLoadData={onLoadData}\r\n\t\t\t\t\t\t\t\tonClickEntry={onClickEntry}\r\n\t\t\t\t\t\t/>}\r\n\r\n\t\t\t\t\t\t{view === \"googlemapview\" && (\r\n\t\t\t\t\t\t\t<GoogleMapOverview\r\n\t\t\t\t\t\t\t\tcontext={defination.name}\r\n\t\t\t\t\t\t\t\tservice={this.state.service}\r\n\t\t\t\t\t\t\t\tquery={this.state.query}\r\n\t\t\t\t\t\t\t\tcache_data={cache_data}\r\n\t\t\t\t\t\t\t\tload_data={load_data}\r\n\t\t\t\t\t\t\t\tonLoadData={onLoadData}\r\n\t\t\t\t\t\t\t\tonClickEntry={onClickEntry}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t{view === \"calendarview\" && (\r\n\t\t\t\t\t\t\t<CalendarView\r\n\t\t\t\t\t\t\t\tdefination={defination}\r\n\t\t\t\t\t\t\t\tservice={this.state.service}\r\n\t\t\t\t\t\t\t\tquery={this.state.query}\r\n\t\t\t\t\t\t\t\tcache_data={cache_data}\r\n\t\t\t\t\t\t\t\tload_data={load_data}\r\n\t\t\t\t\t\t\t\tonLoadData={onLoadData}\r\n\t\t\t\t\t\t\t\tonClickEntry={onClickEntry}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t{view === \"listview\" && (\r\n\t\t\t\t\t\t\t<ListView\r\n\t\t\t\t\t\t\t\tdefination={defination}\r\n\t\t\t\t\t\t\t\tservice={this.state.service}\r\n\t\t\t\t\t\t\t\tquery={this.state.query}\r\n\t\t\t\t\t\t\t\tcache_data={cache_data}\r\n\t\t\t\t\t\t\t\tload_data={load_data}\r\n\t\t\t\t\t\t\t\tonLoadData={onLoadData}\r\n\t\t\t\t\t\t\t\tonClickEntry={onClickEntry}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</GridItem>\r\n\r\n\t\t\t\t</GridContainer>\r\n\r\n\t\t\t\t{ (showPagination && view != \"googlemapview\") && <GridContainer className=\"p-0 m-0 mb-4\">\r\n\t\t\t\t\t<GridItem xs={12} className=\"p-2 flex items-center justify-center\">\r\n\t\t\t\t\t\t<TablePagination \r\n\t\t\t\t\t\t\tcount={defination.name in cache.res? cache.res[defination.name].count : 1}\r\n\t\t\t\t\t\t\tpage={defination.name in cache.res? cache.res[defination.name].page-1 : this.state.page-1}\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\trowsPerPage={this.state.query.pagination}\r\n\t\t\t\t\t\t\tonChangePage={this.handleOnPageChanged}\r\n\t\t\t\t\t\t\tlabelRowsPerPage={\"Records per page\"}\r\n\t\t\t\t\t\t\trowsPerPageOptions={[5, 10, 25, 50, 100, { value: -1, label: 'All' }]}\r\n\t\t\t\t\t\t\tonChangeRowsPerPage={this.handleOnRecordsPerPageChanged}\r\n\t\t\t\t\t\t\tActionsComponent={TablePaginationActions}\r\n\t\t\t\t\t\t\tSelectProps={{\r\n\t\t\t\t\t\t\t\tlabel: \"Records per page\",\r\n\t\t\t\t\t\t\t\tvariant: \"outlined\",\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tclasses={{\r\n\t\t\t\t\t\t\t\ttoolbar: \"flex-col-reverse px-2\",\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</GridItem>\r\n\t\t\t\t</GridContainer> }\r\n\t\t\t</GridContainer>\r\n\t\t);\r\n\t}\r\n}\r\nListingView.propTypes = {\r\n\tclassName: PropTypes.string,\r\n\tclasses: PropTypes.object.isRequired,\r\n\tdefination: PropTypes.object.isRequired,\r\n\tservice: PropTypes.any.isRequired,\r\n\tview: PropTypes.string,\r\n\tquery: PropTypes.object,\r\n\tshowViewOptions: PropTypes.bool,\r\n\tshow_actions: PropTypes.bool,\r\n\tshow_links: PropTypes.bool,\r\n\tshowAddBtn: PropTypes.bool,\r\n\tshowSorter: PropTypes.bool,\r\n\tsorterFormLayoutType: PropTypes.string,\r\n\tshowPagination: PropTypes.bool,\r\n\tcache_data: PropTypes.bool,\r\n\tload_data: PropTypes.bool,\r\n\tonLoadData: PropTypes.func,\r\n\tonClickEntry: PropTypes.func,\r\n};\r\n\r\nListingView.defaultProps = {\r\n\tshow_actions: true,\r\n\tshow_links: true,\r\n\tshowViewOptions: true,\r\n\tshowAddBtn: true,\r\n\tshowPagination: true,\r\n\tshowSorter: true,\r\n\tsorterFormLayoutType: \"inline\",\r\n\tquery: {},\r\n\tload_data: true,\r\n\tcache_data: true,\r\n};\r\n\r\nconst mapStateToProps = state => ({\r\n\tauth: state.auth,\r\n\tcache: state.cache,\r\n\tapi: state.api,\r\n\tapp: state.app,\r\n});\r\n\r\nexport default compose(\r\n\twithStyles(styles),\r\n\tconnect(mapStateToProps, {}),\r\n\twithErrorHandler\r\n)(ListingView);\r\n","/** @format */\r\n\r\nimport { colors } from \"assets/jss/app-theme\";\r\n\r\nexport default theme => ({\r\n\troot: {\r\n\t\tpadding: theme.spacing(),\r\n\t\tbackgroundColor: theme.palette.background.paper,\r\n\t},\r\n\tcalendar: {\r\n\t\tborderRight: \"1px solid rgba(\" + colors.rgb.grey + \", 0.5) !important\",\r\n\t\tborderLeft: \"1px solid rgba(\" + colors.rgb.grey + \", 0.5) !important\",\r\n\t},\r\n\tactiveVieBtn: {\r\n\t\tbackground: colors.hex.primary,\r\n\t\tcolor: colors.hex.inverse,\r\n\t\tborder: \"1px solid\" + colors.hex.primary,\r\n\t},\r\n\tviewBtnGroup: {\r\n\t\tposition: \"absolute !important\",\r\n\t\tright: theme.spacing(),\r\n\t},\r\n\tsearchRoot: {\r\n\t\tpadding: '2px 4px',\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\twidth: \"100%\",\r\n\t\tmargin: 0,\r\n\t},\r\n\tsearchInput: {\r\n\t\tmarginLeft: theme.spacing(1),\r\n\t\tflex: 1,\r\n\t},\r\n\tsearchIconButton: {\r\n\t\tpadding: 10,\r\n\t},\r\n\tsearchDivider: {\r\n\t\theight: 28,\r\n\t\tmargin: 4,\r\n\t},\r\n});\r\n","/** @format */\r\n\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport classNames from \"classnames\";\r\nimport Menu from \"@material-ui/core/Menu\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\n\r\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer';\r\nimport List from '@material-ui/core/List';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\r\nimport Icon from '@mdi/react'\r\nimport { mdiMapMarkerMultiple, mdiMapMarkerMultipleOutline, mdiMapMarkerOff, mdiForwardburger, mdiTooltipAccount as clientPositionMarkerPath, mdiAccountCircleOutline, mdiFolderOutline } from '@mdi/js';\r\nimport MenuOpenIcon from '@material-ui/icons/MenuOpen';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport ImageIcon from '@material-ui/icons/Image';\r\nimport { colors } from \"assets/jss/app-theme\";\r\nimport Avatar from \"components/Avatar\";\r\nimport Card from \"components/Card\";\r\nimport CardActions from \"components/Card/CardActions\";\r\nimport CardContent from \"components/Card/CardContent\";\r\nimport CardHeader from \"components/Card/CardHeader\";\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport GridContainer from \"components/Grid/GridContainer\";\r\nimport GridItem from \"components/Grid/GridItem\";\r\nimport Typography from \"components/Typography\";\r\nimport BottomNavigation from '@material-ui/core/BottomNavigation';\r\nimport BottomNavigationAction from '@material-ui/core/BottomNavigationAction';\r\nimport { withTheme } from '@material-ui/core/styles';\r\nimport MapOutlinedIcon from '@material-ui/icons/MapOutlined';\r\nimport PeopleIcon from '@material-ui/icons/People';\r\nimport PersonOutlinedIcon from \"@material-ui/icons/PersonOutlined\";\r\nimport React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { apiCallRequest, closeDialog, openDialog } from \"state/actions\";\r\nimport {withGlobals} from \"contexts/Globals\";\r\nimport Pagination from '@material-ui/lab/Pagination';\r\nimport compose from \"recompose/compose\";\r\nimport GoogleMap from \"components/GoogleMap\";\r\nimport GoogleMapView from \"views/widgets/Listings/GoogleMapView\";\r\nimport Listings from \"views/widgets/Listings\";\r\nimport { SwitchInput } from \"components/FormInputs\";\r\nimport {withErrorHandler} from \"hoc/ErrorHandler\";\r\nimport client_user_female_icon from \"assets/img/maps/marker-person-female.png\";\r\nimport client_user_male_icon from \"assets/img/maps/marker-person-male.png\";\r\nimport PropTypes from \"prop-types\";\r\nimport styles from \"./styles\";\r\n\r\n\r\nlet googleMap = false;\r\n\r\nlet commission_status_colors = {\r\n\tscheduled: \"#880e4f\",\r\n\tongoing: \"#e65100\",\r\n\tcomplete: \"#4caf50\",\r\n\tcancelled: \"#b71c1c\",\r\n};\r\n\r\nlet track_timetype_colors = {\r\n\tlive: \"#4caf50\",\r\n\tpast: \"#b71c1c\",\r\n};\r\n\r\nclass GoogleMapOverview extends React.Component {\r\n\tstate = {\r\n\t\tdefinations: {},\r\n\t\tservices: {},\r\n\t\tdefination: null,\r\n\t\tservice: null,\r\n\t\tdrawerOpen: true,\r\n\t\tshow_client_positions: true,\r\n\t\tclients_positions: {},\r\n\t\tcontext: \"commissions\",\r\n\t\tcontext_entry: null,\r\n\t\tdefaultZoom: 10,\r\n\t\tmulticontexts: true,\r\n\t\trendered_contexts: [],\r\n\t\tcontexts_props: {},\r\n\t\tzoom: 15,\r\n\t\tquery: {},\r\n\t\trecords: [],\r\n\t\tmarkers: [],\r\n\t\tcircles: [],\r\n\t\tpolylines: [],\r\n\t};\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tconst { device, cache, context, contexts, definations, app } = this.props;\r\n\t\tthis.elementRef = React.createRef();\r\n\t\tthis.prepareForView();\r\n\t\tthis.toggleDrawer = this.toggleDrawer.bind(this);\r\n\t\t\r\n\t\tthis.handleOnLoadMap = this.handleOnLoadMap.bind(this);\r\n\t\tthis.handleClientListItemClick = this.handleClientListItemClick.bind(this);\r\n\t\tthis.handleOnToggleShowClients = this.handleOnToggleShowClients.bind(this);\r\n\t\tthis.handleOnClientsPositionsLoaded = this.handleOnClientsPositionsLoaded.bind(this);\r\n\t\tthis.handleOnClientPositionAvailable = this.handleOnClientPositionAvailable.bind(this);\r\n\t\tthis.handleOnClientPositionUnavailable = this.handleOnClientPositionUnavailable.bind(this);\r\n\t\tthis.handleOnClientPositionChanged = this.handleOnClientPositionChanged.bind(this);\r\n\t\tthis.handleOnDrawerNavigationValueChange = this.handleOnDrawerNavigationValueChange.bind(this);\r\n\t\tthis.handleContextEntryClick = this.handleContextEntryClick.bind(this);\r\n\t\tthis.handleToggleContextRender = this.handleToggleContextRender.bind(this);\r\n\t\t\r\n\t\tthis.state = { \r\n\t\t\t...this.state, \r\n\t\t\t//context: Object.keys(this.state.definations)[0],\r\n\t\t\tcontext: context? context: this.state.context,\r\n\t\t\tdefaultZoom: app.preferences.data.defaultMapZoom,\r\n\t\t\tmulticontexts: Array.isArray(contexts)? contexts.length > 1 : false,\r\n\t\t\trendered_contexts: context? [context]: [],\r\n\t\t\tcontexts_props: context? {\r\n\t\t\t\t[context]: {\r\n\t\t\t\t\tquery: {page: 1, pagination: app.preferences.data.pagination, populate: 1},\r\n\t\t\t\t\telement: \"marker\",\r\n\t\t\t\t\trecords: [],\r\n\t\t\t\t}\r\n\t\t\t}: {},\r\n\t\t\tcontext_entries: Array.isArray(cache.data[this.state.defination.name])? cache.data[this.state.defination.name] : [],\r\n\t\t\t//drawerOpen: device.window_size.width >= 1280,\r\n\t\t\tdrawerOpen: false,\r\n\t\t};\r\n\t}\r\n\r\n\tisMounted() {\r\n\t\treturn this.elementRef.current != null;\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\t//throw new Error('This is a withErrorHandler test.');\r\n\r\n\r\n\t\t\r\n\t}\r\n\r\n\tprepareForView() {\r\n\t\tconst { auth, definations, services, app } = this.props;\r\n\t\tlet current_defination = null;\r\n\t\tlet current_service = null;\r\n\t\tlet possible_definations = {};\r\n\t\tlet possible_services = {};\r\n\t\tlet contexts_props = this.state.contexts_props;\r\n\t\tfor (let [name, defination] of Object.entries(definations)) {\r\n\t\t\tif (!defination.access.restricted(auth.user)) {\r\n\t\t\t\tif (defination.views.listing.googlemapview && Function.isFunction( defination.views.listing.googlemapview.resolveData )) {\r\n\t\t\t\t\tpossible_definations[name] = defination;\r\n\t\t\t\t\tpossible_services[name] = services[name];\r\n\t\t\t\t\tcontexts_props[name] = {\r\n\t\t\t\t\t\tquery: {page: 1, pagination: app.preferences.data.pagination, populate: 1},\r\n\t\t\t\t\t\telement: defination.views.listing.googlemapview.type,\r\n\t\t\t\t\t\telements: [],\r\n\t\t\t\t\t\tloaded: false,\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (current_defination === null) {\r\n\t\t\t\t\t\tcurrent_defination = defination;\r\n\t\t\t\t\t\tcurrent_service = services[name];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.state.contexts_props = contexts_props;\r\n\t\tthis.state.definations = possible_definations;\r\n\t\tthis.state.services = possible_services;\r\n\t\tthis.state.defination = current_defination;\r\n\t\tthis.state.service = current_service;\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\r\n\r\n\ttoggleDrawer= (open) => (event) => {\r\n\t\tif (event && event.type === 'keydown' && (event.key === 'Tab' || event.key === 'Shift')) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (open !== this.state.drawerOpen) {\r\n\t\t\tthis.setState(state => ({ drawerOpen: open }));\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\thandleOnToggleShowClients(event) {\r\n\t\tthis.setState(state => ({ show_client_positions: !state.show_client_positions }));\r\n\t}\r\n\r\n\thandleOnLoadMap(map, google) {\r\n\t\tgoogleMap = map;\r\n\t\t\r\n\t}\r\n\r\n\r\n\thandleOnClientsPositionsLoaded(clients_positions) {\r\n\t\tthis.setState(state => ({ clients_positions: clients_positions }));\r\n\t}\r\n\r\n\thandleOnClientPositionAvailable(socketId, client) {\r\n\t\tthis.setState(state => ({ clients_positions: {...state.clients_positions, [socketId]: client } }));\r\n\t\t//console.log(\"handleOnClientPositionAvailable socketId\", socketId);\r\n\t}\r\n\r\n\thandleOnClientPositionUnavailable(socketId, client) {\r\n\t\tlet newclientspositions = JSON.fromJSON(this.state.clients_positions);\r\n\t\tdelete newclientspositions[socketId];\r\n\t\tthis.setState(state => ({ clients_positions: newclientspositions }));\r\n\t}\r\n\r\n\thandleOnClientPositionChanged(socketId, client) {\r\n\t\tif (this.state.drawerOpen) {\r\n\t\t\tthis.setState(state => ({ clients_positions: {...state.clients_positions, [socketId]: client } }));\r\n\t\t}\t\t\r\n\t}\r\n\r\n\r\n\t\r\n\r\n\thandleOnDrawerNavigationValueChange = (event, newValue) => {\r\n\t\tconst { definations, services, cache } = this.props;\r\n\t\t\r\n\t\tthis.setState(state => ({\r\n\t\t\tcontext : newValue,\r\n\t\t\tcontext_entry: null,\r\n\t\t\tcontext_entries: [\"commissions\", \"tracks\"].includes(newValue)? (Array.isArray(cache.data[newValue])? cache.data[newValue] : []) : [],\r\n\t\t\tdefination: [\"commissions\", \"tracks\"].includes(newValue)? definations[newValue] : state.defination,\r\n\t\t\tservice: [\"commissions\", \"tracks\"].includes(newValue)? services[newValue] : state.service,\r\n\t\t}));\r\n\t};\r\n\r\n\thandleClientListItemClick = (socketId, client) => event => {\r\n\t\tconsole.log(\"handleClientListItemClick client\", client, \"googleMap\", googleMap);\r\n\t\tif (googleMap) {\t\t\r\n\t\t\t\t\tgoogleMap.panTo({ lat: client.position.latitude, lng: client.position.longitude });\r\n\t\t\t\t\tgoogleMap.context.__SECRET_MAP_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.setZoom(15);\r\n\t\t}\r\n\t\t\t\r\n\t\t\t\r\n\t\t\r\n\t};\r\n\r\n\thandleToggleContextRender = (context, renderContext) => {\r\n\t\tconst { definations, cache, apiCallRequest, app } = this.props;\r\n\t\tthis.setState((prevState)=>{\r\n\t\t\tlet renderedContextIndex = prevState.rendered_contexts.indexOf(context);\r\n\t\t\treturn {\r\n\t\t\t\trendered_contexts: prevState.rendered_contexts.includes(context)? prevState.rendered_contexts.removeAtIndex(renderedContextIndex) : prevState.rendered_contexts.concat([context]),\r\n\t\t\t}\r\n\t\t}, async ()=>{\r\n\t\t\tif (definations[context] && renderContext) {\r\n\t\t\t\t\r\n\t\t\t\tapiCallRequest( definations[context].name, {\r\n\t\t\t\t\turi: definations[context].endpoint,\r\n\t\t\t\t\ttype: \"records\",\r\n\t\t\t\t\tparams: JSON.isJSON(this.state.contexts_props[context])? this.state.contexts_props[context].query : {page: 1, pagination: app.preferences.data.pagination, populate: 1},\r\n\t\t\t\t\tdata: {},\r\n\t\t\t\t\tcache: true,\r\n\t\t\t\t}).then(data => {\r\n\t\t\t\t\tif (definations[context] && Function.isFunction( definations[context].views.listing.googlemapview.resolveData ) && Array.isArray(data)) {\r\n\t\t\t\t\t\tdefinations[context].views.listing.googlemapview.resolveData(data, true).then(resolve => {\r\n\t\t\t\t\t\t\tif (this.isMounted()) {\r\n\t\t\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\t\t\tcontext_entry_type : definations[context].views.listing.googlemapview.type,\r\n\t\t\t\t\t\t\t\t\tcontext_entry: data.length> 0? 0 : undefined,\r\n\t\t\t\t\t\t\t\t\tcontexts_props: {\r\n\t\t\t\t\t\t\t\t\t...prevState.contexts_props, \r\n\t\t\t\t\t\t\t\t\t\t[context]: { \r\n\t\t\t\t\t\t\t\t\t\t\t...prevState.contexts_props[context], \r\n\t\t\t\t\t\t\t\t\t\t\telements: resolve,\r\n\t\t\t\t\t\t\t\t\t\t\telement: definations[context].views.listing.googlemapview.type,\r\n\t\t\t\t\t\t\t\t\t\t\tloaded: true,\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tthis.state.context_entry_type = definations[context].views.listing.googlemapview.type;\r\n\t\t\t\t\t\t\t\tthis.state.context_entry = data.length> 0? 0 : undefined;\r\n\t\t\t\t\t\t\t\tthis.state.contexts_props = {\r\n\t\t\t\t\t\t\t\t\t...this.state.contexts_props, \r\n\t\t\t\t\t\t\t\t\t\t[context]: { \r\n\t\t\t\t\t\t\t\t\t\t\t...this.state.contexts_props[context], \r\n\t\t\t\t\t\t\t\t\t\t\telements: resolve,\r\n\t\t\t\t\t\t\t\t\t\t\telement: definations[context].views.listing.googlemapview.type,\r\n\t\t\t\t\t\t\t\t\t\t\tloaded: true,\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t}).catch(e => {\r\n\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse if (definations[context]) {\r\n\t\t\t\tif (this.isMounted()) {\r\n\t\t\t\t\t\t\t\tthis.setState(prevState => ({ \r\n\t\t\t\t\t\t\t\t\tcontext_entry_type : undefined,\r\n\t\t\t\t\t\t\t\t\tcontext_entry: undefined,\r\n\t\t\t\t\t\t\t\t\tcontexts_props: {\r\n\t\t\t\t\t\t\t\t\t...prevState.contexts_props, \r\n\t\t\t\t\t\t\t\t\t\t[context]: { \r\n\t\t\t\t\t\t\t\t\t\t\t...prevState.contexts_props[context], \r\n\t\t\t\t\t\t\t\t\t\t\telements: [],\r\n\t\t\t\t\t\t\t\t\t\t\telement: definations[context].views.listing.googlemapview.type,\r\n\t\t\t\t\t\t\t\t\t\t\tloaded: false,\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tthis.state.context_entry_type = undefined;\r\n\t\t\t\t\t\t\t\tthis.state.context_entry = undefined;\r\n\t\t\t\t\t\t\t\tthis.state.contexts_props = {\r\n\t\t\t\t\t\t\t\t\t...this.state.contexts_props, \r\n\t\t\t\t\t\t\t\t\t\t[context]: { \r\n\t\t\t\t\t\t\t\t\t\t\t...this.state.contexts_props[context], \r\n\t\t\t\t\t\t\t\t\t\t\telements: [],\r\n\t\t\t\t\t\t\t\t\t\t\telement: definations[context].views.listing.googlemapview.type,\r\n\t\t\t\t\t\t\t\t\t\t\tloaded: false,\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t});\r\n\t\t\t\t\t\t\r\n\t\t\t\r\n\t\t\r\n\t};\r\n\r\n\thandleContextEntryClick = (entry, index) => {\r\n\t\t//console.log(\"handleContextEntryClick index\", index);\r\n\r\n\t\tthis.setState({ context_entry: index });\r\n\t\t/*if (googleMap) {\r\n\t\t\tif (this.state.context === \"commissions\") {\r\n\t\t\t\tgoogleMap.panTo(entry.focus_center);\r\n\t\t\t}\r\n\t\t\tif (this.state.context === \"tracks\") {\r\n\t\t\t\tif (entry.positions) {\r\n\t\t\t\t\tif (Array.isArray(entry.positions)) {\r\n\t\t\t\t\t\tif (JSON.isJSON(entry.positions[0])) {\r\n\t\t\t\t\t\t\tgoogleMap.panTo({ lat: entry.positions[0].latitude, lng: entry.positions[0].longitude });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\t\t\t\t\r\n\t\t\t}\t\t\t\t\r\n\t\t}*/\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { theme, classes, showAll, device, sockets, definations, services, contexts, actions } = this.props;\r\n\t\tconst { context, clients_positions, show_client_positions, rendered_contexts, contexts_props } = this.state;\r\n\t\tlet circles = [];\r\n\t\tlet markers = [];\r\n\t\tlet polylines = [];\r\n\t\t//console.log(\"rendered_contexts\", rendered_contexts);\r\n\t\trendered_contexts.map(rendered_context => {\r\n\t\t\tif (definations[rendered_context] && rendered_context in contexts_props ) {\r\n\r\n\t\t\t\tif (contexts_props[rendered_context].element === \"marker\" && Array.isArray(contexts_props[rendered_context].elements)) {\r\n\t\t\t\t\tmarkers = markers.concat(contexts_props[rendered_context].elements);\r\n\t\t\t\t}\r\n\t\t\t\telse if (contexts_props[rendered_context].element === \"circle\" && Array.isArray(contexts_props[rendered_context].elements)) {\r\n\t\t\t\t\tcircles = circles.concat(contexts_props[rendered_context].elements);\r\n\t\t\t\t}\r\n\t\t\t\telse if (contexts_props[rendered_context].element === \"polyline\" && Array.isArray(contexts_props[rendered_context].elements)) {\r\n\t\t\t\t\tpolylines = polylines.concat(contexts_props[rendered_context].elements);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t//console.log(\"circles\", circles);\r\n\t\t\r\n\r\n\t\treturn (\r\n\t\t\t<Card elevation={0} outlineColor={theme.palette.text.primary} style={{backgroundColor: theme.palette.background.paper }}  ref={this.elementRef}>\r\n\t\t\t\t<CardHeader\r\n\t\t\t\t\tavatar={\r\n\t\t\t\t\t\t<Avatar style={{backgroundColor: \"rgba(0,0,0,0.05)\", color:theme.palette.text.primary}}>\r\n\t\t\t\t\t\t\t<MapOutlinedIcon />\r\n\t\t\t\t\t\t</Avatar>\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttitle={this.props.context? (definations[this.props.context]? (definations[this.props.context].label+\" Map\"): \"Map\") : \"Map Overview\"}\r\n\t\t\t\t\tsubheader=\"Click on any context marker, route or polyline in the map for more infomation on the context \"\r\n\t\t\t\t\taction={\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t{/*<IconButton\r\n\t\t\t\t\t\t\t\taria-label=\"Clients Locations Button\"\r\n\t\t\t\t\t\t\t\tclassName={\"mx-1 inverse-text translucent \"}\r\n\t\t\t\t\t\t\t\tonClick={this.handleOnToggleShowClients}\r\n\t\t\t\t\t\t\t\tstyle={{backgroundColor: \"rgba(0,0,0,0.05)\"}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<Icon \r\n\t\t\t\t\t\t\t\t\tpath={show_client_positions? mdiMapMarkerMultiple : mdiMapMarkerMultipleOutline}\r\n\t\t\t\t\t\t\t\t\ttitle=\"Clients Locations\"\r\n\t\t\t\t\t\t\t\t\tsize={0.8}   \r\n\t\t\t\t\t\t\t\t\tcolor={theme.palette.text.primary}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</IconButton>*/}\r\n\r\n\t\t\t\t\t\t\t{Array.isArray(actions) && actions.map(({onClick, icon, ...rest}, cursor)=> (\r\n\t\t\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\t\t\taria-label=\"Action\"\r\n\t\t\t\t\t\t\t\t\tclassName={\"mx-1 inverse-text translucent \"}\r\n\t\t\t\t\t\t\t\t\tonClick={onClick}\r\n\t\t\t\t\t\t\t\t\tstyle={{backgroundColor: \"rgba(0,0,0,0.05)\"}}\r\n\t\t\t\t\t\t\t\t\tkey={\"action-button-\"+cursor}\r\n\t\t\t\t\t\t\t\t\t{...rest}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{icon}\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t))}\r\n\r\n\t\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\t\taria-label=\"menu\"\r\n\t\t\t\t\t\t\t\tcolor={\"inherit\"}\r\n\t\t\t\t\t\t\t\tclassName={\"mx-1 inverse-text \"}\r\n\t\t\t\t\t\t\t\tonClick={this.toggleDrawer(!this.state.drawerOpen)}\r\n\t\t\t\t\t\t\t\tstyle={{backgroundColor: \"rgba(0,0,0,0.05)\"}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<Icon \r\n\t\t\t\t\t\t\t\t\tpath={mdiForwardburger}\r\n\t\t\t\t\t\t\t\t\ttitle=\"Map Overview Drawer Menu\"\r\n\t\t\t\t\t\t\t\t\trotate={this.state.drawerOpen? 0 : 180}\t    \r\n\t\t\t\t\t\t\t\t\tsize={0.8}\r\n\t\t\t\t\t\t\t\t\tcolor={theme.palette.text.primary}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t/>\r\n\t\t\t\t<CardContent className=\"p-0 m-0 overflow-x-hidden\">\r\n\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\r\n\t\t\t\t\t\t<GridItem xs={12} className={classes.wrapper}>\r\n\t\t\t\t\t\t\t<div className={classNames(classes.content, { [classes.contentDrawerMargin]: device.window_size.width >= 1280,  [classes.contentShift]: this.state.drawerOpen && device.window_size.width >= 1280})} style={{minHeight: device.window_size.height, backgroundColor: theme.palette.background.paper }}>\r\n\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t<GoogleMap\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tmapHeight={device.window_size.height}\r\n\t\t\t\t\t\t\t\t\tshowClientsPositions={rendered_contexts.includes(\"clients_positions\")}\r\n\t\t\t\t\t\t\t\t\tshowCurrentPosition={true}\r\n\t\t\t\t\t\t\t\t\tonLoadClientsPositions={this.handleOnClientsPositionsLoaded}\r\n\t\t\t\t\t\t\t\t\tonClientPositionAvailable={this.handleOnClientPositionAvailable}\r\n\t\t\t\t\t\t\t\t\tonClientPositionUnavailable={this.handleOnClientPositionUnavailable}\r\n\t\t\t\t\t\t\t\t\tonClientPositionChanged={this.handleOnClientPositionChanged}\r\n\t\t\t\t\t\t\t\t\tselectedEntry={this.state.context_entry} \r\n\t\t\t\t\t\t\t\t\tselectedEntryType={this.state.context_entry_type? this.state.context_entry_type : \"clients_position\"}\r\n\t\t\t\t\t\t\t\t\tdefaultZoom={this.state.defaultZoom}\r\n\t\t\t\t\t\t\t\t\tzoom={this.state.zoom}\r\n\t\t\t\t\t\t\t\t\tonMapLoad={this.handleOnLoadMap}\r\n\t\t\t\t\t\t\t\t\tpolylines={polylines}\r\n\t\t\t\t\t\t\t\t\tmarkers={markers}\r\n\t\t\t\t\t\t\t\t\tcircles={circles}\t\t\t\t\t\t\t\t\t  \r\n\t\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<SwipeableDrawer\r\n\t\t\t\t\t\t\t\tclassName={classes.drawer}\r\n\t\t\t\t\t\t\t\tvariant={device.window_size.width >= 1280? \"persistent\" : \"temporary\" }\r\n\t\t\t\t\t\t\t\tanchor=\"right\"\r\n\t\t\t\t\t\t\t\topen={this.state.drawerOpen}\r\n\t\t\t\t\t\t\t\tonClose={this.toggleDrawer(false)}\r\n            \t\t\t\t\tonOpen={this.toggleDrawer(true)}\r\n\t\t\t\t\t\t\t\tclasses={{\r\n\t\t\t\t\t\t\t\t\tpaper: device.window_size.width >= 1280? classes.drawerPaper : classes.temporaryDrawerPaper,\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{this.state.multicontexts && <BottomNavigation\r\n\t\t\t\t\t\t\t\t\tvalue={context}\r\n\t\t\t\t\t\t\t\t\tonChange={this.handleOnDrawerNavigationValueChange}\r\n\t\t\t\t\t\t\t\t\tshowLabels\r\n\t\t\t\t\t\t\t\t\tclassName={\"w-full\"}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<BottomNavigationAction \r\n\t\t\t\t\t\t\t\t\t\tvalue=\"clients_positions\"\r\n\t\t\t\t\t\t\t\t\t\tlabel=\"Users\" \r\n\t\t\t\t\t\t\t\t\t\ticon={\r\n\t\t\t\t\t\t\t\t\t\t\t<Icon \r\n\t\t\t\t\t\t\t\t\t\t\t\tpath={mdiAccountCircleOutline}\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"Clients Postions Users\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tsize={1}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t{Object.entries(this.state.definations).map(([name, defination], index) => (\r\n\t\t\t\t\t\t\t\t\t\t<BottomNavigationAction \r\n\t\t\t\t\t\t\t\t\t\t\tvalue={name}\r\n\t\t\t\t\t\t\t\t\t\t\tlabel={defination.label} \r\n\t\t\t\t\t\t\t\t\t\t\ticon={defination.icon} \r\n\t\t\t\t\t\t\t\t\t\t\tkey={\"googlemapview-btn-\"+name+\"-option\"}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t</BottomNavigation>}\r\n\r\n\t\t\t\t\t\t\t\t{(context === \"clients_positions\" && Object.size(clients_positions) === 0) && <GridContainer>\r\n\t\t\t\t\t\t\t\t\t<GridItem xs={12} className=\"flex items-center justify-center p-2\">\r\n\t\t\t\t\t\t\t\t\t\t<Icon \r\n\t\t\t\t\t\t\t\t\t\t\tpath={mdiFolderOutline}\r\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"No Records available yet.\"\r\n\t\t\t\t\t\t\t\t\t\t\tcolor=\"#CCCCCC\"\r\n\t\t\t\t\t\t\t\t\t\t\tsize={5}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</GridItem>\r\n\r\n\t\t\t\t\t\t\t\t\t<GridItem xs={12} className=\"flex items-center justify-center p-2\">\r\n\t\t\t\t\t\t\t\t\t\t<Typography>\r\n\t\t\t\t\t\t\t\t\t\tNo Records available yet.\r\n\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t\t\t</GridContainer>}\r\n\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t{context === \"clients_positions\" && <List className={classes.root}>\r\n\t\t\t\t\t\t\t\t\t\t{Object.entries(clients_positions).map(([socketId, client], index) => {\r\n\t\t\t\t\t\t\t\t\t\t\tlet show_entry = true;\r\n\t\t\t\t\t\t\t\t\t\t\tif (index > 0) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (client.user._id === clients_positions[(Object.keys(clients_positions)[(index-1)])].user._id) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshow_entry = false;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (googleMap) {\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tgoogleMap.panTo({ lat: client.position.latitude, lng: client.position.longitude });\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tgoogleMap.context.__SECRET_MAP_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.setZoom(15);\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tif (client.user && show_entry) {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ListItem className={\"cursor-pointer hover:bg-gray-400\"} onClick={this.handleClientListItemClick(socketId, client)} key={\"client-\"+socketId}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ListItemAvatar>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar src={(String.isString(client.user.gender)? (client.user.gender.trim().toLowerCase()===\"female\"? client_user_female_icon : client_user_male_icon) : client_user_male_icon)} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ListItemAvatar>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ListItemText primary={ client.user.first_name+\" \"+client.user.last_name } secondary={String.isString(client.user.role)? client.user.role.humanize() : \"\"} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t</List>}\r\n\r\n\t\t\t\t\t\t\t\t\t{context === \"commissions\" && <Listings \r\n\t\t\t\t\t\t\t\t\t\tdefination={definations.commissions} \r\n\t\t\t\t\t\t\t\t\t\tservice={services.commissions}\r\n\t\t\t\t\t\t\t\t\t\tquery={{}}\r\n\t\t\t\t\t\t\t\t\t\tshowViewOptions={false}\r\n\t\t\t\t\t\t\t\t\t\tshowAddBtn={false}\r\n\t\t\t\t\t\t\t\t\t\tshowSorter={true}\r\n\t\t\t\t\t\t\t\t\t\tsorterFormLayoutType={\"normal\"}\r\n\t\t\t\t\t\t\t\t\t\tview={\"listview\"}\r\n\t\t\t\t\t\t\t\t\t\tonLoadData={(loadedData, query)=>{\r\n\t\t\t\t\t\t\t\t\t\t\tif (definations[context] && Function.isFunction( definations[context].views.listing.googlemapview.resolveData ) && Array.isArray(loadedData)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tdefinations[context].views.listing.googlemapview.resolveData(loadedData, true).then(resolve => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontexts_props: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prevState.contexts_props,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t[context]: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prevState.contexts_props[context],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tquery: query,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\telements: resolve,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tloaded: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trecords: loadedData,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t}).catch(err => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontexts_props: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prevState.contexts_props,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t[context]: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prevState.contexts_props[context],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\telements: [],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tloaded: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\trecords: loadedData,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\tonClickEntry={this.handleContextEntryClick}\r\n\t\t\t\t\t\t\t\t\t/>}\r\n\r\n\t\t\t\t\t\t\t\t\t{context === \"tracks\" && <Listings \r\n\t\t\t\t\t\t\t\t\t\tdefination={definations.tracks} \r\n\t\t\t\t\t\t\t\t\t\tservice={services.tracks}\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tshowViewOptions={false}\r\n\t\t\t\t\t\t\t\t\t\tshowAddBtn={false}\r\n\t\t\t\t\t\t\t\t\t\tshowSorter={true}\r\n\t\t\t\t\t\t\t\t\t\tshowPagination={true}\r\n\t\t\t\t\t\t\t\t\t\tsorterFormLayoutType={\"normal\"}\r\n\t\t\t\t\t\t\t\t\t\tview={\"listview\"}\r\n\t\t\t\t\t\t\t\t\t\tonLoadData={(loadedData, query)=>{\r\n\t\t\t\t\t\t\t\t\t\t\tif (definations[context] && Function.isFunction( definations[context].views.listing.googlemapview.resolveData ) && Array.isArray(loadedData)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tdefinations[context].views.listing.googlemapview.resolveData(loadedData, true).then(resolve => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontexts_props: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prevState.contexts_props,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t[context]: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prevState.contexts_props[context],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tquery: query,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\telements: resolve,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tloaded: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trecords: loadedData,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t}).catch(err => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontexts_props: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prevState.contexts_props,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t[context]: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prevState.contexts_props[context],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tquery: query,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\telements: [],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tloaded: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\trecords: loadedData,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\tonClickEntry={this.handleContextEntryClick}\r\n\t\t\t\t\t\t\t\t\t/>}\r\n\r\n\t\t\t\t\t\t\t</SwipeableDrawer>\r\n\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t</GridContainer>\r\n\t\t\t\t</CardContent>\r\n\t\t\t\t<CardActions>\r\n\t\t\t\t\t<GridContainer className=\"p-0 m-0\">\r\n\t\t\t\t\t\t{Array.isArray(contexts) && contexts.map((context_entry_name, cursor) => (\r\n\t\t\t\t\t\t\t<GridItem xs={12} md={Math.round((12 / contexts.length))} className={\"flex items-center justify-center\"} key={\"context_entry_switch-\"+cursor}>\r\n\t\t\t\t\t\t\t\t\t<SwitchInput \r\n\t\t\t\t\t\t\t\t\t\tlabel={context_entry_name === \"clients_positions\"? \"Users\" : (definations[context_entry_name]? definations[context_entry_name].label : context_entry_name) }\r\n\t\t\t\t\t\t\t\t\t\tvalue={this.state.rendered_contexts.includes(context_entry_name)}\r\n\t\t\t\t\t\t\t\t\t\tonChange={(new_value)=>{\r\n\t\t\t\t\t\t\t\t\t\t\tthis.handleToggleContextRender(context_entry_name, new_value);\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t<GridItem xs={12}>\r\n\t\t\t\t\t\t\t<Typography variant=\"body2\">\r\n\t\t\t\t\t\t\t\t{this.props.context? (definations[this.props.context]? (definations[this.props.context].label+\" Map from a glance\"): \"Map from a glance\") : \"Map from a glance\"}\r\n\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t</GridContainer>\r\n\t\t\t\t</CardActions>\r\n\t\t\t</Card>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nGoogleMapOverview.propTypes = {\r\n\tclassName: PropTypes.string,\r\n\tclasses: PropTypes.object,\r\n\tcontexts: PropTypes.array,\r\n\tcontext: PropTypes.string.isRequired,\r\n\tactions: PropTypes.array,\r\n};\r\n\r\nGoogleMapOverview.defaultProps = {\r\n\tcontexts: [\"clients_positions\", \"commissions\", \"tracks\"],\r\n\tcontext: \"clients_positions\",\r\n\tactions: [],\r\n};\r\n\r\nconst mapStateToProps = state => ({\r\n\tapp: state.app,\r\n\tauth: state.auth,\r\n\tcache: state.cache,\r\n\tdevice: state.device,\r\n});\r\n\r\nexport default withGlobals(compose(\r\n\twithStyles(styles),\r\n\tconnect(mapStateToProps, {apiCallRequest, closeDialog, openDialog}),\r\n\twithTheme,\r\n\twithErrorHandler\r\n)(GoogleMapOverview));\r\n","/** @format */\n\n\nexport default theme => ({\n\troot: {\n\t\tpadding: \"0\",\n\t},\n\twrapper: {\n\t\tdisplay: 'flex',\n\t\tmargin: 0,\n\t\tpadding: 0,\n\t},\n\tdrawer: {\n\t\twidth: theme.appDrawer.width,\n\t\tflexShrink: 0,\n\t},\n  \tdrawerPaper: {\n\t\twidth: theme.appDrawer.width,\n\t\tposition: \"absolute\",\n\t\tzIndex: theme.zIndex.appBar/2,\n\t\tbackgroundColor: theme.palette.background.paper,\n  \t},\n  \ttemporaryDrawerPaper: {\n\t\twidth: theme.appDrawer.width,\n\t\tbackground: theme.palette.background.default,\n  \t},\n  \tcontent: {\n\t\tflexGrow: 1,\n\t\tpadding: 0,\n\t\ttransition: theme.transitions.create('margin', {\n\t\t\teasing: theme.transitions.easing.sharp,\n\t\t\tduration: theme.transitions.duration.leavingScreen,\n\t\t}),\n\t},\n\n\tcontentDrawerMargin: {\n\t\tmarginRight: -theme.appDrawer.width,\n\t},\n\n\tcontentShift: {\n\t\ttransition: theme.transitions.create('margin', {\n\t\t\teasing: theme.transitions.easing.easeOut,\n\t\t\tduration: theme.transitions.duration.enteringScreen,\n\t\t}),\n\t\tmarginRight: 0,\n\t},\n});\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z\"\n}), 'ArrowBack');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z\"\n}), 'People');\n\nexports.default = _default;","import React, { useState, useEffect, useRef } from \"react\";\n\nimport PropTypes from \"prop-types\";\n\nfunction ViewPortSensor(props) {\n\n\tlet {\n\t\tclassName,\n\t\tchildren,\n\t\toffset,\n\t\tonViewportVisibilityChange,\n\t\tplaceholder,\n\t\tplaceholderType\n\t} = props;\n\t// Ref for the element that we want to detect whether on screen\n\tconst ref = useRef();\n\t// Call the hook passing in ref and root margin\n\t// In this case it would only be considered onScreen if more ...\n\t// ... than 300px of element is visible.\n\tlet rootMargin = 0 - Number.parseNumber(offset, 0) + \"px\";\n\tconst onScreen = useOnScreen(ref, rootMargin);\n\t// Hook\n\tfunction useOnScreen(\n\t\tref,\n\t\trootMargin = \"0px\",\n\t\tonEnterViewPort,\n\t\tonExitViewPort\n\t) {\n\t\t// State and setter for storing whether element is visible\n\t\tconst [isIntersecting, setIntersecting] = useState(false);\n\n\t\tuseEffect(() => {\n\t\t\tconst observer = new IntersectionObserver(\n\t\t\t\t([entry]) => {\n\t\t\t\t\t// Update our state when observer callback fires\n\t\t\t\t\tsetIntersecting(entry.isIntersecting);\n\t\t\t\t\tif (Function.isFunction(onViewportVisibilityChange)) {\n\t\t\t\t\t\tonViewportVisibilityChange(entry.isIntersecting);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{ rootMargin }\n\t\t\t);\n\t\t\tif (ref.current) {\n\t\t\t\tobserver.observe(ref.current);\n\t\t\t}\n\t\t\treturn () => {\n\t\t\t\tobserver.unobserve(ref.current);\n\t\t\t};\n\t\t}, []); // Empty array ensures that effect is only run on mount and unmount\n\n\t\treturn isIntersecting;\n\t}\n\n\treturn (\n\t\t<div className={className ? className : \"w-full \"} ref={ref}>\n\t\t\t{children}\n\t\t</div>\n\t);\n}\n\nViewPortSensor.propTypes = {\n\tplaceholderType: PropTypes.string,\n\tplaceholder: PropTypes.oneOfType([\n\t\tPropTypes.node,\n\t\tPropTypes.object,\n\t\tPropTypes.array,\n\t\tPropTypes.string\n\t]),\n\tonViewportVisibilityChange: PropTypes.func,\n\toffset: PropTypes.number\n};\nViewPortSensor.defaultProps = {\n\tplaceholderType: \"skeleton\",\n\tplaceholder: {\n\t\tvariant: \"rect\",\n\t\twidth: \"100%\",\n\t\theight: 200,\n\t\tanimation: \"wave\"\n\t},\n\toffset: 0\n};\n\nexport default ViewPortSensor;\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6zm-2 16c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z\"\n}), 'AudiotrackOutlined');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M4 6.47L5.76 10H20v8H4V6.47M22 4h-4l2 4h-3l-2-4h-2l2 4h-3l-2-4H8l2 4H7L5 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4z\"\n}), 'MovieOutlined');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z\"\n}), 'AttachFile');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z\"\n}), 'Person');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M20 0H4v2h16V0zM4 24h16v-2H4v2zM20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-8 2.75c1.24 0 2.25 1.01 2.25 2.25s-1.01 2.25-2.25 2.25S9.75 10.24 9.75 9 10.76 6.75 12 6.75zM17 17H7v-1.5c0-1.67 3.33-2.5 5-2.5s5 .83 5 2.5V17z\"\n}), 'Contacts');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z\"\n}), 'ChevronRight');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z\"\n}), 'ChevronLeft');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM4 12c0-4.42 3.58-8 8-8 1.85 0 3.55.63 4.9 1.69L5.69 16.9C4.63 15.55 4 13.85 4 12zm8 8c-1.85 0-3.55-.63-4.9-1.69L18.31 7.1C19.37 8.45 20 10.15 20 12c0 4.42-3.58 8-8 8z\"\n}), 'Block');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z\"\n}), 'Done');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z\"\n}), 'DoneAll');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z\"\n}), 'Refresh');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z\"\n}), 'ChatBubbleOutline');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M16 9v10H8V9h8m-1.5-6h-5l-1 1H5v2h14V4h-3.5l-1-1zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7z\"\n}), 'DeleteOutlined');\n\nexports.default = _default;","/** @format */\r\n\r\nimport React, {memo, useState, useEffect, useCallback, useRef} from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport classNames from \"classnames\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Badge from \"@material-ui/core/Badge\";\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Button from '@material-ui/core/Button';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\nimport MoreIcon from '@material-ui/icons/MoreVert';\r\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\r\nimport PersonIcon from '@material-ui/icons/Person';\r\nimport PeopleIcon from '@material-ui/icons/People';\r\nimport ContactsIcon from '@material-ui/icons/Contacts';\r\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\r\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\r\nimport SendIcon from '@material-ui/icons/Send';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport MuiAlert from '@material-ui/lab/Alert';\r\n\r\nimport Backdrop from '@material-ui/core/Backdrop';\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\r\nimport SpeedDial from '@material-ui/lab/SpeedDial';\r\nimport SpeedDialIcon from '@material-ui/lab/SpeedDialIcon';\r\nimport SpeedDialAction from '@material-ui/lab/SpeedDialAction';\r\n\r\nimport ChatBubbleOutlineIcon from '@material-ui/icons/ChatBubbleOutline';\r\nimport ForumOutlinedIcon from '@material-ui/icons/ForumOutlined';\r\nimport ForumIcon from '@material-ui/icons/Forum';\r\nimport RefreshIcon from '@material-ui/icons/Refresh';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport AttachFileIcon from '@material-ui/icons/AttachFile';\r\nimport ImageOutlinedIcon from '@material-ui/icons/ImageOutlined';\r\nimport MovieOutlinedIcon from '@material-ui/icons/MovieOutlined';\r\nimport AudiotrackOutlinedIcon from '@material-ui/icons/AudiotrackOutlined';\r\nimport DeleteOutlinedIcon from '@material-ui/icons/DeleteOutlined';\r\nimport BlockIcon from '@material-ui/icons/Block';\r\nimport DoneIcon from '@material-ui/icons/Done';\r\nimport DoneAllIcon from '@material-ui/icons/DoneAll';\r\n\r\nimport List from '@material-ui/core/List';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer';\r\nimport Fab from '@material-ui/core/Fab';\r\nimport Card from \"components/Card\";\r\nimport CardActions from \"components/Card/CardActions\";\r\nimport CardContent from \"components/Card/CardContent\";\r\nimport CardHeader from \"components/Card/CardHeader\";\r\nimport GridContainer from \"components/Grid/GridContainer\";\r\nimport GridItem from \"components/Grid/GridItem\";\r\nimport Skeleton from '@material-ui/lab/Skeleton';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\r\nimport ScrollBars from \"components/ScrollBars\";\r\nimport LazyImage from \"components/LazyImage\";\r\nimport ViewPortSensor from \"components/ViewPortSensor\";\r\nimport Listings from \"views/widgets/Listings\";\r\nimport {\r\n\tFileInput,\r\n\tTextInput,\r\n} from \"components/FormInputs\";\r\n\r\nimport { useGlobals } from \"contexts/Globals\";\r\nimport { app } from \"assets/jss/app-theme.jsx\";\r\nimport { useLocation, useHistory } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport { withTheme } from '@material-ui/core/styles';\r\nimport compose from \"recompose/compose\";\r\nimport { apiCallRequest, setMessagingCache, clearMessagingCache } from \"state/actions\";\r\n\r\nimport { attachments as AttachmentsService } from \"services\";\r\n\r\nimport styles from \"./styles\";\r\n\r\nconst contactsDrawerWidth = 240;\r\n\r\nfunction Alert(props) {\r\n\treturn <MuiAlert elevation={6} variant=\"filled\" {...props} />;\r\n}\r\n\r\nfunction Chat(props) {\r\n\tconst { classes, className, layout, communication:{ messaging }, activeConversation, auth, device: {window_size}, apiCallRequest, theme, setMessagingCache, clearMessagingCache, ...rest } = props;\r\n\tlet textInputRef = React.createRef();\r\n\tlet messagesWrapperRef = React.createRef();\r\n\tlet location = useLocation();\r\n\tlet history = useHistory();\r\n\r\n\t\r\n\t\r\n\r\n\tconst { definations, services, sockets } = useGlobals();\r\n\tconst { unread_count, unread_ids, conversations, contacts: cacheContacts, drafts, active_conversation, active_conversation_messages } = messaging;\r\n\r\n\tconst [chats, setChats] = useState(Array.isArray(conversations)? conversations : []);\r\n\tconst [activeChat, setActiveChat] = useState(active_conversation);\r\n\tconst [activeChatMessages, setActiveChatMessages] = useState(active_conversation_messages);\r\n\tconst [query, setQuery] = useState({desc: \"created_on\"});\r\n\tconst [contactsQuery, setContactsQuery] = useState({desc: \"created_on\"});\r\n\tconst [loadingConversations, setLoadingConversations] = useState(true);\r\n\tconst [loadingContacts, setLoadingContacts] = useState(true);\r\n\tconst [draft, setDraft] = useState({});\r\n\tconst [individualConversationsRecipients, setIndividualConversationsRecipients] = useState([]);\r\n\tconst [error, setError] = useState(false);\r\n\tconst [contacts, setContacts] = useState([]);\r\n\tconst [contactsDrawerOpen, setContactsDrawerOpen] = useState(false);\r\n\tconst [attachmentDialOpen, setAttachmentDialOpen] = useState(false);\r\n\tconst [contextMenu, setContextMenu] = useState({ mouseX: null, mouseY: null,});\r\n\tconst [loadingActiveChatMessages, setLoadingActiveChatMessages] = useState(false);\r\n\tconst [locationHasWith, setLocationHasWith] = useState(false);\r\n\tconst [firstLoad, setFirstLoad] = useState(true);\r\n\tconst [searchKeyword, setSearchKeyword] = useState(false);\r\n\r\n\t\r\n\r\n\r\n\tconst attachmentActions = [\r\n\t\t{ icon: <ImageOutlinedIcon />, name: 'image', label: 'Image', color: theme.palette.error.main },\r\n\t\t{ icon: <AudiotrackOutlinedIcon />, name: 'audio', label: 'Audio', color: theme.palette.accent.main },\t\t\t\r\n\t\t{ icon: <MovieOutlinedIcon />, name: 'video', label: 'Video', color: theme.palette.warning.main },\r\n\t\t{ icon: <AttachFileIcon />, name: 'file', label: 'File', color: theme.palette.info.main },\t\t\r\n\t];\r\n\t\r\n\r\n\tconst gotoLastMessage = () => {\r\n\t   let element = document.getElementById(\"chatLastChild\");\r\n\t   if (element) {\r\n\r\n\t\t\t//element.scrollIntoView({behavior: \"smooth\"});\r\n\t   }\r\n\t   \r\n\t}\r\n\r\n\r\n\tconst loadConversations = () => {\r\n\t\tif (definations) {\r\n\t\t\tsetLoadingConversations(true);\r\n\t\t\tapiCallRequest( definations.conversations.name,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\turi: \"/inbox\",\r\n\t\t\t\t\t\ttype: \"records\",\r\n\t\t\t\t\t\tparams: {...query, p: \"1\"},\r\n\t\t\t\t\t\tdata: {},\r\n\t\t\t\t\t\tcache: false,\r\n\t\t\t\t\t}\r\n\t\t\t).then(data => {\r\n\t\t\t\tif (Array.isArray(data)) {\r\n\t\t\t\t\tsetMessagingCache(\"conversations\", data);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tsetError(false);\r\n\t\t\t\tsetLoadingConversations(false);\t\t\t\t\t\r\n\t\t\t}).catch(e => {\r\n\t\t\t\tconsole.log(\"conversations e\", e);\r\n\t\t\t\tlet errorMsg = e;\r\n\t\t\t\tif (JSON.isJSON(e)) {\r\n\t\t\t\t\tif (\"msg\" in e) {\r\n\t\t\t\t\t\terrorMsg = e.msg;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\terrorMsg = JSON.stringify(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tsetError(errorMsg);\r\n\t\t\t\tsetLoadingConversations(false);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tconst loadContacts = () => {\r\n\t\tif (definations) {\r\n\t\t\tsetLoadingContacts(true);\r\n\t\t\tapiCallRequest( \"contacts\",\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\turi: \"/contacts\",\r\n\t\t\t\t\t\ttype: \"records\",\r\n\t\t\t\t\t\tparams: {p: \"1\"},\r\n\t\t\t\t\t\tdata: {},\r\n\t\t\t\t\t\tcache: false,\r\n\t\t\t\t\t}\r\n\t\t\t).then(data => {\r\n\t\t\t\tif (Array.isArray(data)) {\r\n\t\t\t\t\tsetMessagingCache(\"contacts\", data);\r\n\t\t\t\t\tsetContacts(data);\r\n\t\t\t\t}\r\n\t\t\t\tsetError(false);\r\n\t\t\t\tsetLoadingContacts(false);\t\t\t\t\t\r\n\t\t\t}).catch(e => {\r\n\t\t\t\tconsole.log(\"contacts e\", e);\r\n\t\t\t\tlet errorMsg = e;\r\n\t\t\t\tif (JSON.isJSON(e)) {\r\n\t\t\t\t\tif (\"msg\" in e) {\r\n\t\t\t\t\t\terrorMsg = e.msg;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\terrorMsg = JSON.stringify(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tsetError(errorMsg);\r\n\t\t\t\tsetLoadingContacts(false);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t\r\n\r\n\tconst handleContextOpen = (type, entry) => event => {\r\n\t\tevent.preventDefault();\r\n\t\tsetContextMenu({\r\n\t\t  type : type, \r\n\t\t  entry: entry,\r\n\t\t  mouseX: event.clientX - 2,\r\n\t\t  mouseY: event.clientY - 4,\r\n\t\t});\r\n\t};\r\n\r\n\tconst handleContextClose = () => {\r\n\t\tsetContextMenu({ mouseX: null, mouseY: null,});\r\n\t};\r\n\r\n\tconst handleArchiveConversation = (conversation) => {\r\n\t\tsetMessagingCache(\"conversations\", currentChats => {\r\n\t\t\ttry {\r\n\t\t\t\tlet newChats = JSON.parse(JSON.stringify(currentChats));\r\n\r\n\t\t\t\tnewChats = newChats.filter(chat =>{\r\n\t\t\t\t\tif (conversation) {\r\n\t\t\t\t\t\tif (JSON.isJSON(conversation)) {\r\n\t\t\t\t\t\t\treturn chat._id !== conversation._id;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn chat._id !== conversation;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\t \r\n\t\t\t\t});\r\n\r\n\t\t\t\treturn newChats;\r\n\t\t\t} catch(err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\treturn currentChats;\r\n\t\t\t}\r\n\t\t});\r\n\t\tsockets.default.emit(\"archive-conversation\", {conversation: conversation, user: auth.user});\r\n\r\n\t};\r\n\r\n\tconst handleDeleteConversation = (conversation) => {\r\n\t\tsetMessagingCache(\"conversations\", currentChats => {\r\n\t\t\ttry {\r\n\t\t\t\tlet newChats = JSON.parse(JSON.stringify(currentChats));\r\n\r\n\t\t\t\tnewChats = newChats.filter(chat =>{\r\n\t\t\t\t\tif (conversation) {\r\n\t\t\t\t\t\tif (JSON.isJSON(conversation)) {\r\n\t\t\t\t\t\t\treturn chat._id !== conversation._id;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn chat._id !== conversation;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\t \r\n\t\t\t\t});\r\n\r\n\t\t\t\treturn newChats;\r\n\t\t\t} catch(err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\treturn currentChats;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tsockets.default.emit(\"delete-conversation-for-user\", {conversation: conversation, user: auth.user});\t\r\n\r\n\t};\r\n\r\n\r\n\r\n\tconst handleNewChat = (recipients) => {\r\n\t\tif (recipients) {\r\n\t\t\tlet recipients_ids = [];\r\n\t\t\trecipients = Array.isArray(recipients)? recipients : [recipients];\r\n\r\n\t\t\trecipients.map(recipient => {\r\n\t\t\t\tif (JSON.isJSON(recipient) && \"_id\" in recipient) {\r\n\t\t\t\t\trecipients_ids.push(recipient._id);\r\n\t\t\t\t}\r\n\t\t\t\telse if (!String.isEmpty(recipient)) {\r\n\t\t\t\t\trecipients_ids.push(recipient);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\r\n\t\t\tsetContactsDrawerOpen(false);\r\n\t\t\tlet existsAtIndex = -1;\r\n\t\t\tconversations.map((chat, index) => {\r\n\t\t\t\tif (existsAtIndex === -1 && chat.type === \"individual\") {\r\n\t\t\t\t\tlet owner_id = chat.owner;\r\n\t\t\t\t\tlet recipient_id = chat.recipients[0];\r\n\t\t\t\t\tif (JSON.isJSON(chat.owner) && \"_id\" in chat.owner) {\r\n\t\t\t\t\t\towner_id = chat.owner._id;\r\n\t\t\t\t\t}\r\n\t\t\t\t\towner_id = owner_id;\r\n\t\t\t\t\tif (JSON.isJSON(chat.recipients[0]) && \"_id\" in chat.recipients[0]) {\r\n\t\t\t\t\t\trecipient_id = chat.recipients[0]._id;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\trecipient_id = chat.recipients[0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ((owner_id == auth.user._id && recipients_ids.includes(recipient_id)) || (recipient_id === auth.user._id && recipients_ids.includes(owner_id))) {\r\n\t\t\t\t\t\texistsAtIndex = index;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\r\n\t\t\tif (existsAtIndex !== -1) {\r\n\t\t\t\tlet updatedChats = conversations;\r\n\t\t\t\tlet existingChat = JSON.parse(JSON.stringify(updatedChats[existsAtIndex]));\r\n\t\t\t\tupdatedChats.remove(existsAtIndex);\r\n\t\t\t\tupdatedChats.unshift(existingChat);\r\n\t\t\t\tgetConversationMessages(existingChat);\r\n\t\t\t\tsetMessagingCache(\"conversations\", updatedChats);\r\n\t\t\t\tsetMessagingCache(\"active_conversation_messages\", []);\t\r\n\t\t\t\tsetMessagingCache(\"active_conversation\", existingChat);\t\r\n\r\n\r\n\t\t\t\tsetDraft({\r\n\t\t\t\t\t\tis_reply: false,\r\n\t\t\t\t\t\tsender: auth.user,\r\n\t\t\t\t\t\treply_for: null,\r\n\t\t\t\t\t\ttype: \"text\",\r\n\t\t\t\t\t\tcontent: \"\",\r\n\t\t\t\t\t\tconversation: existingChat._id,\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlet newChat = {\r\n\t\t\t\t\trecipients: recipients_ids,\r\n\t\t\t\t\tparticipants: recipients,\r\n\t\t\t\t\tstate: {\r\n\t\t\t\t\t\t\"total\": 0,\r\n\t\t\t\t\t\t\"unread\": 0,\r\n\t\t\t\t\t\t\"read\": 0,\r\n\t\t\t\t\t\t\"last_message\" : {\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\towner: auth.user._id,\r\n\t\t\t\t\tstarted_by: auth.user,\r\n\t\t\t\t\ttype: Array.isArray(recipients)? (recipients.length > 1? \"group\" : \"individual\") : \"individual\",\r\n\t\t\t\t};\r\n\r\n\t\t\t\tsetMessagingCache(\"active_conversation_messages\", []);\r\n\r\n\t\t\t\tif (sockets.default) {\r\n\t\t\t\t\tsockets.default.emit(\"create-conversation\", newChat);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleRefresh = () => {\r\n\t\tloadConversations();\r\n\t\tloadContacts();\t\r\n\t}\r\n\r\n\tconst handlePresenceChanged = ({user, presence}) => {\t\t\r\n\t\tsetContacts(currentContacts => {\r\n\t\t\ttry {\r\n\t\t\t\tlet newContacts = JSON.parse(JSON.stringify(currentContacts));\r\n\t\t\t\tlet user_id = user;\r\n\t\t\t\tif (JSON.isJSON(user)) {\r\n\t\t\t\t\tuser_id = user._id;\r\n\t\t\t\t}\r\n\t\t\t\tnewContacts.forEach(function(contact) {\r\n\t\t\t\t\tif (user_id === contact._id) {\r\n\t\t\t\t\t\tcontact.presence = presence;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\treturn newContacts;\r\n\t\t\t} catch(err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\treturn currentContacts;\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t});\r\n\t\tsetMessagingCache(\"conversations\", currentChats => {\r\n\t\t\ttry {\r\n\t\t\t\tlet newChats = JSON.parse(JSON.stringify(currentChats));\r\n\t\t\t\tlet user_id = user;\r\n\t\t\t\tif (JSON.isJSON(user)) {\r\n\t\t\t\t\tuser_id = user._id;\r\n\t\t\t\t}\r\n\t\t\t\tnewChats.forEach(function(chat) {\r\n\t\t\t\t\tif (chat.type === \"individual\") {\r\n\t\t\t\t\t\tlet chat_owner_id = chat.owner;\r\n\t\t\t\t\t\tif (JSON.isJSON(chat.owner)) {\r\n\t\t\t\t\t\t\tchat_owner_id = chat.owner._id;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (chat_owner_id === user_id) {\r\n\t\t\t\t\t\t\tif (JSON.isJSON(chat.owner)) {\r\n\t\t\t\t\t\t\t\tchat.owner.presence = presence;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tif (Array.isArray(chat.recipients) && chat.recipients.length > 0) {\r\n\t\t\t\t\t\t\t\tif (JSON.isJSON(chat.recipients[0])) {\r\n\t\t\t\t\t\t\t\t\tchat.recipients[0].presence = presence;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\treturn newChats;\r\n\t\t\t} catch(err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\treturn currentChats;\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t});\r\n\t}\r\n\r\n\tconst handleOnUserStartedTypingMessage = ({conversation, user}) => {\r\n\t\tsetMessagingCache(\"conversations\", currentChats => {\r\n\t\t\ttry {\r\n\t\t\t\tlet newChats = JSON.parse(JSON.stringify(currentChats));\r\n\t\t\t\tlet user_id = user; \r\n\t\t\t\tif (JSON.isJSON(user)) {\r\n\t\t\t\t\tuser_id = user._id;\r\n\t\t\t\t}\r\n\t\t\t\tlet chat_id = conversation;\r\n\t\t\t\tif (JSON.isJSON(conversation)) {\r\n\t\t\t\t\tchat_id = conversation._id;\r\n\t\t\t\t}\r\n\t\t\t\tnewChats.forEach(function(chat) {\r\n\r\n\t\t\t\t\tif (chat._id === chat_id) {\r\n\t\t\t\t\t\tlet typing_users_arr = Array.isArray(chat.typing)? chat.typing : [];\r\n\t\t\t\t\t\tlet exists = false;\r\n\t\t\t\t\t\ttyping_users_arr.map(chat_typing_user => {\r\n\t\t\t\t\t\t\tif (!exists && chat_typing_user._id === user_id) {\r\n\t\t\t\t\t\t\t\texists = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (!exists  && user_id !== auth.user._id) {\r\n\t\t\t\t\t\t\tchat.typing = typing_users_arr.concat([user]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\treturn newChats;\r\n\t\t\t} catch(err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\treturn currentChats;\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t});\r\n\r\n\t\tsetMessagingCache(\"active_conversation\", currentActiveChat => {\r\n\t\t\tif (currentActiveChat) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tlet newCurrentActiveChat = JSON.parse(JSON.stringify(currentActiveChat));\r\n\t\t\t\t\tlet user_id = user; \r\n\t\t\t\t\tif (JSON.isJSON(user)) {\r\n\t\t\t\t\t\tuser_id = user._id;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (Array.isArray(newCurrentActiveChat.typing)) {\r\n\t\t\t\t\t\tlet typing_users_arr = Array.isArray(newCurrentActiveChat.typing)? newCurrentActiveChat.typing : [];\r\n\t\t\t\t\t\tlet exists = false;\r\n\t\t\t\t\t\ttyping_users_arr.map(chat_typing_user => {\r\n\t\t\t\t\t\t\tif (!exists && chat_typing_user._id === user_id) {\r\n\t\t\t\t\t\t\t\texists = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (!exists && user_id !== auth.user._id) {\r\n\t\t\t\t\t\t\tnewCurrentActiveChat.typing = typing_users_arr.concat([user]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (user_id !== auth.user._id) {\r\n\t\t\t\t\t\tnewCurrentActiveChat.typing = [user];\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn newCurrentActiveChat;\r\n\t\t\t\t} catch(err) {\r\n\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t\treturn currentActiveChat;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t});\r\n\t}\r\n\t\r\n\r\n\tconst handleOnUserStoppedTypingMessage = ({conversation, user}) => {\r\n\t\tsetMessagingCache(\"conversations\", currentChats => {\r\n\t\t\ttry {\r\n\t\t\t\tlet newChats = JSON.parse(JSON.stringify(currentChats));\r\n\t\t\t\tlet user_id = user; \r\n\t\t\t\tif (JSON.isJSON(user)) {\r\n\t\t\t\t\tuser_id = user._id;\r\n\t\t\t\t}\r\n\t\t\t\tlet chat_id = conversation;\r\n\t\t\t\tif (JSON.isJSON(conversation)) {\r\n\t\t\t\t\tchat_id = conversation._id;\r\n\t\t\t\t}\r\n\t\t\t\tnewChats.forEach(function(chat) {\r\n\t\t\t\t\tif (chat._id === chat_id) {\r\n\t\t\t\t\t\tlet typing_users_arr = Array.isArray(chat.typing)? chat.typing : [];\r\n\t\t\t\t\t\tchat.typing = typing_users_arr.filter(chat_typing_user => {\r\n\t\t\t\t\t\t\treturn chat_typing_user._id !== user_id\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (!Array.isArray(chat.typing)) {\r\n\t\t\t\t\t\t\tchat.typing = []\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\treturn newChats;\r\n\t\t\t} catch(err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\treturn currentChats;\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t});\r\n\t\tsetMessagingCache(\"active_conversation\", currentActiveChat => {\r\n\t\t\tif (currentActiveChat) {\r\n\t\t\t\tlet user_id = user; \r\n\t\t\t\tif (JSON.isJSON(user)) {\r\n\t\t\t\t\tuser_id = user._id;\r\n\t\t\t\t}\r\n\t\t\t\tlet chat_id = conversation;\r\n\t\t\t\tif (JSON.isJSON(conversation)) {\r\n\t\t\t\t\tchat_id = conversation._id;\r\n\t\t\t\t}\r\n\t\t\t\tif (chat_id === currentActiveChat._id) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tlet newCurrentActiveChat = JSON.parse(JSON.stringify(currentActiveChat));\r\n\r\n\t\t\t\t\t\tlet typing_users_arr = Array.isArray(newCurrentActiveChat.typing)? newCurrentActiveChat.typing : [];\r\n\t\t\t\t\t\tnewCurrentActiveChat.typing = typing_users_arr.filter(chat_typing_user => {\r\n\t\t\t\t\t\t\treturn chat_typing_user._id !== user_id\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (!Array.isArray(newCurrentActiveChat.typing)) {\r\n\t\t\t\t\t\t\tnewCurrentActiveChat.typing = []\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\treturn newCurrentActiveChat;\r\n\t\t\t\t\t} catch(err) {\r\n\t\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t\t\treturn currentActiveChat;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn currentActiveChat;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t\t\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t});\r\n\t}\r\n\r\n\t\r\n\r\n\t\r\n\t\r\n\r\n\r\n\r\n\r\n\t/*const handleOnNewMessage = ({conversation, message, user}) => {\t\r\n\t\tconsole.log(\"handleOnNewMessage\", message)\t\r\n\t\tsetActiveChatMessages(currentChatMessages => {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tlet newChatMessages = JSON.parse(JSON.stringify(currentChatMessages));\r\n\r\n\t\t\t\t\t\t\tnewChatMessages.push(message);\r\n\t\t\t\t\t\t\treturn newChatMessages;\r\n\t\t\t\t\t\t} catch(err) {\r\n\t\t\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t\t\t\treturn currentChatMessages;\r\n\t\t\t\t\t\t}\r\n\t\t});\r\n\t\tsetMessagingCache(\"active_conversation\", currentActiveChat => {\r\n\t\t\tif (currentActiveChat) {\r\n\t\t\t\tlet conversation_id = conversation;\r\n\t\t\t\tif (JSON.isJSON(conversation)) {\r\n\t\t\t\t\tconversation_id = conversation._id;\r\n\t\t\t\t}\r\n\t\t\t\tif (conversation_id === currentActiveChat._id) {\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn currentActiveChat;\r\n\t\t});\t\r\n\t\t\t\t\r\n\t}\r\n\r\n\tconst handleOnMessageSent = ({conversation, message, user}) => {\t\r\n\t\tconsole.log(\"handleOnMessageSent\", message)\t\r\n\t\tsetMessagingCache(\"active_conversation\", currentActiveChat => {\r\n\t\t\tif (currentActiveChat) {\r\n\t\t\t\tlet conversation_id = conversation;\r\n\t\t\t\tif (JSON.isJSON(conversation)) {\r\n\t\t\t\t\tconversation_id = conversation._id;\r\n\t\t\t\t}\r\n\t\t\t\tlet message_id = message;\r\n\t\t\t\tif (JSON.isJSON(message)) {\r\n\t\t\t\t\tmessage_id = message._id;\r\n\t\t\t\t}\r\n\t\t\t\tif (conversation_id === currentActiveChat._id) {\r\n\t\t\t\t\tsetActiveChatMessages(currentChatMessages => {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tlet newChatMessages = JSON.parse(JSON.stringify(currentChatMessages));\r\n\r\n\t\t\t\t\t\t\tnewChatMessages.push(message);\r\n\t\t\t\t\t\t\treturn newChatMessages;\r\n\t\t\t\t\t\t} catch(err) {\r\n\t\t\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t\t\t\treturn currentChatMessages;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn currentActiveChat;\r\n\t\t});\r\n\t\t\r\n\t}*/\r\n\r\n\tconst handleOnChangeDraftType= (type) => {\r\n\t\tsetDraft(currentDraft => {\r\n\t\t\ttry {\r\n\t\t\t\tlet newDraft = JSON.parse(JSON.stringify(currentDraft));\r\n\t\t\t\tnewDraft.type = type;\t\t\t\t\t\r\n\t\t\t\treturn newDraft;\r\n\t\t\t} catch(err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\treturn currentDraft;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tconst handleOnConversationMessages = ({conversation, messages}) => {\r\n\t\tsetLoadingActiveChatMessages(false);\r\n\t\tsetMessagingCache(\"active_conversation_messages\", messages);\r\n\t}\r\n\r\n\tconst handleOnConversationCreated = (conversation) => {\r\n\t\t\r\n\t}\r\n\r\n\t\r\n\r\n\tconst getConversationMessages = (conversation) => {\r\n\t\tif (conversation) {\r\n\t\t\tsetLoadingActiveChatMessages(true);\r\n\t\t\tsetMessagingCache(\"active_conversation_messages\", []);\t\r\n\t\t\tif (sockets.default) {\r\n\t\t\t\tsockets.default.emit(\"get-conversation-messages\", {conversation: conversation._id, user: auth.user});\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tsetLoadingActiveChatMessages(false);\r\n\t\t}\t\t\t\t\r\n\t}\r\n\r\n\tconst handleOnSendMessage = (messageToSend) => {\r\n\t\tif (active_conversation) {\r\n\t\t\tlet newMessage = { ...draft, sender: auth.user, created_on: new Date()};\r\n\t\t\tif (messageToSend) {\t\t\t\r\n\t\t\t\tif (JSON.isJSON(messageToSend)) {\r\n\t\t\t\t\tnewMessage = JSON.merge(messageToSend, newMessage);\r\n\t\t\t\t}\r\n\t\t\t\telse if (String.isString(messageToSend)) {\r\n\t\t\t\t\tnewMessage.content = messageToSend.trim();\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!String.isEmpty(newMessage.content) || ([\"audio\", \"file\", \"video\", \"image\"].includes(newMessage.type) && (Array.isArray(newMessage.attachments)? (newMessage.attachments.length > 0) : false))) {\r\n\t\t\t\t\tsockets.default.emit(\"send-message\", {message: newMessage, conversation: active_conversation, user: auth.user});\r\n\t\t\t\t\t\t\t\t\t\tif (textInputRef.current) {\r\n\t\t\t\t\t\t\t\t\t\t\ttextInputRef.current.value = \"\";\r\n\t\t\t\t\t\t\t\t\t\t\ttextInputRef.current.focus();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tsetDraft({\r\n\t\t\t\t\t\t\t\t\t\t\tis_reply: false,\r\n\t\t\t\t\t\t\t\t\t\t\tsender: auth.user,\r\n\t\t\t\t\t\t\t\t\t\t\treply_for: null,\r\n\t\t\t\t\t\t\t\t\t\t\ttype: \"text\",\r\n\t\t\t\t\t\t\t\t\t\t\tcontent: \"\",\r\n\t\t\t\t\t\t\t\t\t\t\tconversation: active_conversation._id,\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t}\r\n\r\n\tconst handleMessageInputKeyDown = (event) => {\r\n\t\tif (event.key === 'Enter') {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tlet newMessageValue = event.target.value;\r\n\t\t\tif (String.isString(newMessageValue)) {\r\n\t\t\t\tnewMessageValue = newMessageValue.trim();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnewMessageValue = \"\";\r\n\t\t\t}\r\n\t\t\tif (!String.isEmpty(newMessageValue)) {\r\n\t\t\t\tsockets.default.emit(\"stopped-typing-message\", {conversation: active_conversation._id, user: auth.user});\r\n\t\t\t\thandleOnSendMessage(newMessageValue);\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleSocketActionError = (error) => {\r\n\t\tsetError(error);\r\n\t}\r\n\r\n\tconst handleOnMessageDeletedForUser = ({ message, user }) => {\r\n\t\tsetMessagingCache(\"active_conversation_messages\", currentActiveChatMessages =>{\r\n\t\t\ttry {\r\n\t\t\t\tlet newActiveChatMessages = JSON.parse(JSON.stringify(currentActiveChatMessages));\r\n\t\t\t\tif (Array.isArray(newActiveChatMessages)) {\r\n\t\t\t\t\tnewActiveChatMessages.forEach(activeChatMessage => {\r\n\t\t\t\t\t\tif (activeChatMessage._id === message._id) {\r\n\t\t\t\t\t\t\tactiveChatMessage.state = message.state;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\treturn newActiveChatMessages;\r\n\t\t\t} catch(err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\treturn currentActiveChatMessages;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tconst handleOnMessageDeletedForAll = ({ message, user }) => {\r\n\t\tsetMessagingCache(\"active_conversation_messages\", currentActiveChatMessages =>{\r\n\t\t\ttry {\r\n\t\t\t\tlet newActiveChatMessages = JSON.parse(JSON.stringify(currentActiveChatMessages));\r\n\t\t\t\tif (Array.isArray(newActiveChatMessages)) {\r\n\t\t\t\t\tnewActiveChatMessages.forEach(activeChatMessage => {\r\n\t\t\t\t\t\tif (activeChatMessage._id === message._id) {\r\n\t\t\t\t\t\t\tactiveChatMessage.state = message.state;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\treturn newActiveChatMessages;\r\n\t\t\t} catch(err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\treturn currentActiveChatMessages;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tconst handleOnMessageStateChangedBySocketAction = ({ message, user }) => {\r\n\t\tsetMessagingCache(\"active_conversation_messages\", currentActiveChatMessages =>{\r\n\t\t\ttry {\r\n\t\t\t\tlet newActiveChatMessages = JSON.parse(JSON.stringify(currentActiveChatMessages));\r\n\t\t\t\tif (Array.isArray(newActiveChatMessages)) {\r\n\t\t\t\t\tnewActiveChatMessages.forEach(activeChatMessage => {\r\n\t\t\t\t\t\tif (activeChatMessage._id === message._id) {\r\n\t\t\t\t\t\t\tactiveChatMessage.state = message.state;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t\treturn newActiveChatMessages;\r\n\t\t\t} catch(err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\treturn currentActiveChatMessages;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\r\n\r\n\tuseEffect(() => {\r\n\t\tsetChats(conversations);\r\n\t}, [conversations]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (active_conversation && firstLoad) {\r\n\t\t\tgetConversationMessages(active_conversation);\r\n\t\t\tsetFirstLoad(false);\t\t\t\r\n\t\t}\r\n\r\n\t\t\t\r\n\t}, [active_conversation, firstLoad]);\r\n\r\n\t/*useEffect(() => {\r\n\r\n\t\treturn () => {\r\n\t\t\tif (!activeChat) {\r\n\t\t\t\tsetMessagingCache(\"active_conversation\", false);\t\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tlet newActiveChat = JSON.parse(JSON.stringify(activeChat));\r\n\t\t\t\t\tnewActiveChat.typing = [];\r\n\t\t\t\t\tsetMessagingCache(\"active_conversation\", newActiveChat);\r\n\t\t\t\t} catch(err) {\r\n\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t}, [activeChat]);*/\r\n\r\n\r\n\tuseEffect(()=>{\r\n\t\tif (location && !locationHasWith) {\r\n\t\t\tlet params = new URLSearchParams(location.search);\r\n\t\t\tconst withRecipient = params.get('with');\r\n\t\t\tconsole.log(\"location withRecipient\", withRecipient);\t\r\n\t\t\tif (!String.isEmpty(withRecipient)) {\r\n\t\t\t\tif (withRecipient.indexOf(\"@\") !== -1) {\r\n\t\t\t\t\tsetContactsQuery({email_address: withRecipient.trim()});\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tsetContactsQuery({_id: withRecipient.trim()});\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t\tsetLocationHasWith(true);\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t}, [location, locationHasWith]);\r\n\r\n\tuseEffect(() => {\t\t\t\r\n\t\tconsole.log(\"contactsQuery\", contactsQuery);\r\n\t}, [contactsQuery]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (Array.isArray(conversations)) {\r\n\t\t\tlet newIndividualConversationsRecipients = [];\r\n\t\t\tconversations.map(chat => {\r\n\t\t\t\tif (chat.type === \"individual\") {\r\n\t\t\t\t\tlet chat_owner_id = chat.owner;\r\n\t\t\t\t\tif (JSON.isJSON(chat.owner)) {\r\n\t\t\t\t\t\tchat_owner_id = chat.owner._id;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (chat_owner_id !== auth.user._id) {\r\n\t\t\t\t\t\tnewIndividualConversationsRecipients.push(chat_owner_id);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif (Array.isArray(chat.recipients) && chat.recipients.length > 0) {\r\n\t\t\t\t\t\t\tif (JSON.isJSON(chat.recipients[0])) {\r\n\t\t\t\t\t\t\t\tnewIndividualConversationsRecipients.push(chat.recipients[0]._id);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tnewIndividualConversationsRecipients.push(chat.recipients[0]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tsetIndividualConversationsRecipients(newIndividualConversationsRecipients);\r\n\t\t}\t\t\t\r\n\t}, [conversations]);\r\n\r\n\tuseEffect(() => {\r\n\t\t//loadContacts();\r\n\t\tloadConversations();\r\n\t}, [definations, query]);\r\n\r\n\r\n\r\n\tuseEffect(() => {\r\n\t\tif (sockets.default) {\r\n\t\t\tsockets.default.on(\"presence-changed\", handlePresenceChanged);\r\n\t\t\tsockets.default.on(\"user-changed-presence\", handlePresenceChanged);\r\n\t\t\tsockets.default.on(\"message-typing-started\", handleOnUserStartedTypingMessage);\r\n\t\t\tsockets.default.on(\"message-typing-stopped\", handleOnUserStoppedTypingMessage);\r\n\t\t\tsockets.default.on(\"conversation-messages\", handleOnConversationMessages);\r\n\t\t\t/*sockets.default.on(\"new-message\", handleOnNewMessage);\r\n\t\t\tsockets.default.on(\"message-sent\", handleOnMessageSent);*/\r\n\t\t\tsockets.default.on(\"messages-deleted-for-user\", handleOnMessageDeletedForUser);\r\n\t\t\tsockets.default.on(\"messages-deleted-for-all\", handleOnMessageDeletedForAll);\r\n\t\t\tsockets.default.on(\"message-marked-as-received\", handleOnMessageStateChangedBySocketAction);\r\n\t\t\tsockets.default.on(\"message-received\", handleOnMessageStateChangedBySocketAction);\r\n\t\t\tsockets.default.on(\"message-marked-as-read\", handleOnMessageStateChangedBySocketAction);\r\n\t\t\tsockets.default.on(\"message-read\", handleOnMessageStateChangedBySocketAction);\r\n\t\t\tsockets.default.on(\"delete-conversation-for-user-error\", handleSocketActionError);\r\n\t\t\tsockets.default.on(\"delete-message-for-user-error\", handleSocketActionError);\r\n\t\t\tsockets.default.on(\"delete-message-for-all-error\", handleSocketActionError);\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\r\n\t\t\treturn ()=>{\r\n\t\t\t\tsockets.default.off(\"presence-changed\", handlePresenceChanged);\r\n\t\t\t\tsockets.default.off(\"user-changed-presence\", handlePresenceChanged);\r\n\t\t\t\tsockets.default.off(\"message-typing-started\", handleOnUserStartedTypingMessage);\r\n\t\t\t\tsockets.default.off(\"message-typing-stopped\", handleOnUserStoppedTypingMessage);\r\n\t\t\t\tsockets.default.off(\"conversation-messages\", handleOnConversationMessages);\r\n\t\t\t\t/*sockets.default.off(\"new-message\", handleOnNewMessage);\r\n\t\t\t\tsockets.default.off(\"message-sent\", handleOnMessageSent);*/\r\n\t\t\t\tsockets.default.off(\"messages-deleted-for-user\", handleOnMessageDeletedForUser);\r\n\t\t\t\tsockets.default.off(\"messages-deleted-for-all\", handleOnMessageDeletedForAll);\r\n\t\t\t\tsockets.default.off(\"delete-conversation-for-user-error\", handleSocketActionError);\r\n\t\t\t\tsockets.default.off(\"message-marked-as-received\", handleOnMessageStateChangedBySocketAction);\r\n\t\t\t\tsockets.default.off(\"message-received\", handleOnMessageStateChangedBySocketAction);\r\n\t\t\t\tsockets.default.off(\"message-marked-as-read\", handleOnMessageStateChangedBySocketAction);\r\n\t\t\t\tsockets.default.off(\"message-read\", handleOnMessageStateChangedBySocketAction);\r\n\t\t\t\tsockets.default.off(\"delete-message-for-user-error\", handleSocketActionError);\r\n\t\t\t\tsockets.default.off(\"delete-message-for-all-error\", handleSocketActionError);\r\n\t\t\t\tsockets.default.off(\"create-conversation-error\", handleSocketActionError);\r\n\t\t\t}\r\n\t\t}\r\n\t}, [sockets]);\r\n\r\n\r\n\t\r\n\treturn (\r\n\t\t<Paper className={classNames({\"p-0 m-0 relative\": true, [classes.root] : true, [className]: true})} >\r\n\t\t\t<AppBar position=\"absolute\" color=\"transparent\" className={classes.mainAppBar}>\r\n\t\t\t\t<Toolbar>\r\n\t\t\t\t\t{active_conversation && <IconButton \r\n\t\t\t\t\t\tonClick={()=>{\r\n\t\t\t\t\t\t\tif (history && locationHasWith) {\r\n\t\t\t\t\t\t\t\thistory.push(history.location.pathname);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tsetMessagingCache(\"active_conversation_messages\", []);\r\n\t\t\t\t\t\t\tsetMessagingCache(\"active_conversation\", false);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tclassName={\"mr-2\"}\r\n\t\t\t\t\t\tedge=\"start\" \r\n\t\t\t\t\t\tcolor=\"inherit\" \r\n\t\t\t\t\t\taria-label=\"back-to-conversations\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<ArrowBackIcon />\r\n\t\t\t\t\t</IconButton>}\r\n\t\t\t\t\t{active_conversation && (active_conversation.type == \"individual\"? ((auth.user._id === active_conversation.owner._id || auth.user._id === active_conversation.owner) && active_conversation.participants[0].avatar? (<Avatar className={\"mr-6 w-6 h-6\"} src={AttachmentsService.getAttachmentFileUrl(active_conversation.participants[0].avatar)} />) : (active_conversation.started_by.avatar? (<Avatar className={\"mr-6 w-6 h-6\"} src={AttachmentsService.getAttachmentFileUrl(active_conversation.started_by.avatar)} />) : (<Avatar className={\"mr-2 w-6 h-6 bg-transparent accent-text\"}><PersonIcon /></Avatar>))) : (active_conversation.group_avatar? (<Avatar className={\"mr-6\"} src={AttachmentsService.getAttachmentFileUrl(active_conversation.group_avatar)} />) : (<Avatar className={\"mr-6 w-6 h-6 bg-transparent accent-text\"}> {active_conversation.type === \"group\"? <PeopleIcon /> : <PersonIcon />}</Avatar>)))}\r\n\t\t\t\t\t{active_conversation && <Typography variant=\"h6\" className={\"capitalize flex-grow\"}>\r\n\t\t\t\t\t\t{active_conversation.type == \"individual\"? ((auth.user._id === active_conversation.owner._id || auth.user._id === active_conversation.owner)? (active_conversation.participants[0].first_name +\" \"+active_conversation.participants[0].last_name) : (active_conversation.started_by.first_name +\" \"+active_conversation.started_by.last_name)) : (active_conversation.type == \"group\"? active_conversation.group_name : \"Realfield\")}\r\n\t\t\t\t\t</Typography>}\r\n\r\n\t\t\t\t\t{!active_conversation && <Typography variant=\"h6\" className={\"capitalize flex-grow\"}>\r\n\t\t\t\t\t\tConversations\r\n\t\t\t\t\t</Typography>}\r\n\r\n\r\n\t\t\t\t\t{(!active_conversation && !contactsDrawerOpen) && <IconButton \r\n\t\t\t\t\t\tonClick={()=>setContactsDrawerOpen(true)}\r\n\t\t\t\t\t\tclassName={\"mr-2\"}\r\n\t\t\t\t\t\tedge=\"end\" \r\n\t\t\t\t\t\tcolor=\"inherit\" \r\n\t\t\t\t\t\taria-label=\"Contacts\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<ContactsIcon />\r\n\t\t\t\t\t</IconButton>}\r\n\t\t\t\t</Toolbar>\r\n\t\t\t</AppBar>\r\n\t\t\t<SwipeableDrawer\r\n\t\t\t\tclassName={classNames({[classes.drawer]: true/*, \"hidden\": !contactsDrawerOpen*/})}\r\n\t\t\t\tvariant={window_size.width >= 768? \"persistent\" : \"temporary\" }\r\n\t\t\t\tanchor=\"right\"\r\n\t\t\t\topen={contactsDrawerOpen}\r\n\t\t\t\tonClose={()=>setContactsDrawerOpen(false)}\r\n\t\t\t\tonOpen={()=>setContactsDrawerOpen(true)}\r\n\t\t\t\tclasses={{\r\n\t\t\t\t\tpaper: window_size.width >= 768? classes.drawerPaper : classes.temporaryDrawerPaper,\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<div className={\"w-full flex flex-row items-center h-16 secondary\"}>\r\n\t\t\t\t\t<IconButton className={\"mx-2\"} color=\"inherit\">\r\n\t\t\t\t\t\t<ContactsIcon />\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t<Typography variant=\"h6\" className={\"capitalize flex-grow\"}>\r\n\t\t\t\t\t\tContacts\r\n\t\t\t\t\t</Typography>\r\n\t\t\t\t\t{/*<TextInput\r\n\t\t\t\t\t\t\t\tvariant={\"outlined\"}\r\n\t\t\t\t\t\t\t\tdefaultValue={active_conversation._id === draft.conversation? draft.content : undefined}\r\n\t\t\t\t\t\t\t\tonChange={(new_value)=>{\r\n\t\t\t\t\t\t\t\t\tif (!String.isEmpty(new_value)) {\r\n\t\t\t\t\t\t\t\t\t\tsetSearchKeyword(new_value);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\tsetSearchKeyword(false);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tplaceholder=\"Search...\"\r\n\t\t\t\t\t\t\t\tlabel=\"Search\"\r\n\t\t\t\t\t\t\t/>*/}\r\n\r\n\t\t\t\t\t<IconButton className={\"mx-2\"} color=\"inherit\" onClick={()=>setContactsDrawerOpen(false)}>\r\n\t\t\t\t\t\t{theme.direction === 'ltr' ?  <ChevronRightIcon /> : <ChevronLeftIcon />}\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t</div>\r\n\t\t\t\t<Divider />\r\n\r\n\t\t\t\t<ScrollBars className={classes.bodyWrapper}>\r\n\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t{definations && <Listings\r\n\t\t\t\t\t\t\t\tshow_actions={false}\r\n\t\t\t\t\t\t\t\tshow_links={false}\r\n\t\t\t\t\t\t\t\tshowViewOptions={false}\r\n\t\t\t\t\t\t\t\tshowAddBtn={false}\r\n\t\t\t\t\t\t\t\tcache_data={false}\r\n\t\t\t\t\t\t\t\tshowPagination\r\n\t\t\t\t\t\t\t\tshowSorter\r\n\t\t\t\t\t\t\t\tdefination={definations.users}\r\n\t\t\t\t\t\t\t\tservice={services.users}\r\n\t\t\t\t\t\t\t\tquery={contactsQuery}\r\n\t\t\t\t\t\t\t\tview={\"listview\"}\r\n\t\t\t\t\t\t\t\tonClickEntry={(contact) => handleNewChat(contact)}\r\n\t\t\t\t\t\t\t\tonLoadData={(loadedData, loadedQuery) => {\r\n\t\t\t\t\t\t\t\t\tif (locationHasWith && Array.isArray(loadedData)) {\r\n\t\t\t\t\t\t\t\t\t\tloadedData.map(entry => {\r\n\t\t\t\t\t\t\t\t\t\t\tif (entry._id === loadedQuery._id || entry.email_address === loadedQuery.email_address) {\r\n\t\t\t\t\t\t\t\t\t\t\t\thandleNewChat(entry);\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"onLoadData\", loadedData, loadedQuery);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>}\r\n\r\n\r\n\t\t\t\t</ScrollBars>\r\n\t\t\t</SwipeableDrawer>\r\n\t\t\t{!active_conversation && <GridItem md={12} className={\"flex flex-col relative min-h-full p-0\"}>\t\t\t\t\t\r\n\t\t\t\t\t\t<Paper square className={classes.paper}>\r\n\t\t\t\t\t\t\t<ScrollBars className={classes.bodyWrapper}>\r\n\t\t\t\t\t\t\t{(loadingConversations && (!Array.isArray(conversations) || (Array.isArray(conversations) && conversations.length === 0))) && <GridContainer>\r\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" width={80} className=\"mb-1\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-3/6\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\r\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" width={110} className=\"mb-1\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-8/12\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\r\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" width={80} className=\"mb-1\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-4/12\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\r\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" width={90} className=\"mb-1\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-3/6\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\r\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" width={70} className=\"mb-1\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-10/12\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\r\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" width={80} className=\"mb-1\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-9/12\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\r\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" width={120} className=\"mb-1\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-4/5\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\r\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" width={100} className=\"mb-1\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-3/6\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\r\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-row items-center relative p-0 px-4 my-4\"}>\r\n\t\t\t\t\t\t\t\t\t<Skeleton variant=\"circle\" width={40} height={40} />\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2 flex flex-col\">\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" width={80} className=\"mb-1\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton variant=\"text\" className=\"w-11/12\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t\t</GridContainer>}\r\n\r\n\t\t\t\t\t\t\t{(!loadingConversations && (!Array.isArray(conversations) || (Array.isArray(conversations) && chats.length === 0))) && <GridContainer>\r\n\t\t\t\t\t\t\t\t<GridItem md={12} className={\"flex flex-col items-center relative p-0 px-4 my-4\"}>\r\n\t\t\t\t\t\t\t\t\t<Typography variant=\"subtitle1\" color=\"textSecondary\" className=\"mx-0 my-12 h-20 w-20 md:w-40  md:h-40 rounded-full text-4xl md:text-6xl flex flex-row items-center justify-center\" style={{color: theme.palette.text.disabled, background: theme.palette.background.default}}>\r\n\t\t\t\t\t\t\t\t\t\t<ForumOutlinedIcon fontSize=\"inherit\"/>\r\n\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t<Typography variant=\"body2\" color=\"textSecondary\" className=\"mx-0\" style={{color: theme.palette.text.disabled}}>\r\n\t\t\t\t\t\t\t\t\t\tYou don't have any active conversations yet\r\n\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t\t</GridContainer>}\r\n\r\n\t\t\t\t\t\t\t{(Array.isArray(conversations) && !loadingConversations) && <List className={classes.list}>\r\n\t\t\t\t\t\t\t{conversations.map((chat, index)=> {\r\n\r\n\t\t\t\t\t\t\t\tif (index === 0 || (index > 0 && conversations[index-1]._id !== conversations[index]._id )) {\r\n\t\t\t\t\t\t\t\t\tlet primaryText = \"\";\r\n\t\t\t\t\t\t\t\t\tlet chatUser = false;\r\n\t\t\t\t\t\t\t\t\tlet avatar = false;\r\n\t\t\t\t\t\t\t\t\tlet last_message_content = false;\r\n\t\t\t\t\t\t\t\t\tlet last_message_deleted = false;\r\n\t\t\t\t\t\t\t\t\tlet last_message_sender_name = false;\r\n\t\t\t\t\t\t\t\t\tif (chat.state.total > 0 && chat.state.last_message) {\r\n\t\t\t\t\t\t\t\t\t\tlast_message_content = chat.state.last_message.content;\r\n\t\t\t\t\t\t\t\t\t\tif (chat.state.last_message.sender === auth.user._id) {\r\n\t\t\t\t\t\t\t\t\t\t\tlast_message_sender_name = \"You\";\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse if (chat.owner === chat.state.last_message.sender) {\r\n\t\t\t\t\t\t\t\t\t\t\tlast_message_sender_name = chat.started_by.first_name;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\t\tif (Array.isArray(chat.participants)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tchat.participants.map(participant => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (participant._id === chat.state.last_message.sender) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlast_message_sender_name = participant.first_name;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tif ((chat.state.last_message.state === \"deleted-for-sender\" && chat.state.last_message.sender._id === auth.user._id) || chat.state.last_message.state === \"deleted-for-all\") {\r\n\t\t\t\t\t\t\t\t\t\t\tlast_message_deleted = true;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (chat.type == \"individual\") {\r\n\t\t\t\t\t\t\t\t\t\tlet chat_owner_id = chat.owner;\r\n\t\t\t\t\t\t\t\t\t\tif (JSON.isJSON(chat.owner)) {\r\n\t\t\t\t\t\t\t\t\t\t\tchat_owner_id = chat.owner._id;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tif (auth.user._id === chat_owner_id) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (Array.isArray(chat.participants)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (chat.participants.length > 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tchatUser = chat.participants[0];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tprimaryText = chat.participants[0].first_name +\" \"+chat.participants[0].last_name\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tavatar = chat.participants[0].avatar;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse{\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tchatUser = chat.started_by;\r\n\t\t\t\t\t\t\t\t\t\t\tprimaryText = chat.started_by.first_name +\" \"+chat.started_by.last_name;\r\n\t\t\t\t\t\t\t\t\t\t\tavatar = chat.started_by.avatar;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\t\t\telse if (chat.type == \"group\") {\r\n\t\t\t\t\t\t\t\t\t\tprimaryText = chat.group_name;\r\n\t\t\t\t\t\t\t\t\t\tavatar = chat.group_avatar;\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<ListItem \r\n\t\t\t\t\t\t\t\t\t\t\tclassName={\"px-8 content-between\"} \r\n\t\t\t\t\t\t\t\t\t\t\tonClick={(event)=> {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetMessagingCache(\"active_conversation_messages\", []);\t\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetMessagingCache(\"active_conversation\", chat);\t\r\n\t\t\t\t\t\t\t\t\t\t\t\tgetConversationMessages(chat);\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t}}\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\tonContextMenu={handleContextOpen(\"conversation\", chat)}\r\n\t\t\t\t\t\t\t\t\t\t\tkey={\"chat-\"+index}\r\n\t\t\t\t\t\t\t\t\t\t\tstyle={{background: (contextMenu.type===\"conversation\"? (contextMenu.entry._id===chat._id? theme.palette.background.default : \"transparent\") : \"transparent\")}}\r\n\t\t\t\t\t\t\t\t\t\t\tbutton\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{chatUser && <ListItemAvatar>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Badge \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"dot\" \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbadgeContent=\" \"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tanchorOrigin={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvertical: 'bottom',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thorizontal: 'right',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclasses={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdot: chatUser.presence === \"online\"? \"bg-green-600\" : (chatUser.presence == \"away\"? \"bg-orange-500\" : \"bg-gray-500\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{ chatUser.avatar && <Avatar className={classes.contactAvatar} src={AttachmentsService.getAttachmentFileUrl(chatUser.avatar)} />}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{!chatUser.avatar && <Avatar className={classes.contactAvatar}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<PersonIcon />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Avatar>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Badge>\r\n\t\t\t\t\t\t\t\t\t\t\t</ListItemAvatar>}\r\n\t\t\t\t\t\t\t\t\t\t\t{!chatUser && <ListItemAvatar>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{ avatar && <Avatar src={AttachmentsService.getAttachmentFileUrl(avatar)} />}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{!avatar && <Avatar className={classes.iconAvatar}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{chat.type === \"group\"? <PeopleIcon /> : <PersonIcon />}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Avatar>}\r\n\t\t\t\t\t\t\t\t\t\t\t</ListItemAvatar>}\r\n\t\t\t\t\t\t\t\t\t\t\t<ListItemText \r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex flex-col justify-center\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tprimary={(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography variant=\"body1\" color=\"textPrimary\" className={\"capitalize font-bold\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{primaryText}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)} \r\n\t\t\t\t\t\t\t\t\t\t\t\tsecondary={(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-full flex flex-row\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{Array.isArray(chat.typing) && <Typography variant=\"body2\" color=\"primary\" className=\"mx-0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{chat.typing.length > 1? (chat.typing.length+\" people are typing...\") : (chat.typing.length === 1? (chat.typing[0].first_name+\" is typing...\") : \"\")}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(!Array.isArray(chat.typing) || chat.typing.length ===0) && <div className=\"flex flex-row items-center flex-grow\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography variant=\"body2\" color=\"textPrimary\" className=\"font-bold mr-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{last_message_sender_name? last_message_sender_name: \"\"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography variant=\"body2\" color=\"textSecondary\" className=\"flex-grow truncate mr-2 font-normal\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{last_message_content? last_message_content : \"No messages yet\"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{last_message_deleted && <div className={\"flex flex-row items-center w-full\"} style={{color: theme.palette.divider}}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography variant=\"body1\" color=\"inherit\" className={\"flex-grow\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tMessage deleted\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<BlockIcon className={\"mx-2 text-xs\"} fontSize=\"small\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{!last_message_deleted && <div className={\"flex flex-row items-center w-full\"} style={{color: theme.palette.text.disabled}}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(chat.state.last_message.state === \"sent\" && chat.state.last_message.sender === auth.user._id) && <DoneIcon className={\"mx-1 text-xs\"} fontSize=\"small\"/>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{((chat.state.last_message.state === \"partially-received\" || chat.state.last_message.state === \"received\") && chat.state.last_message.sender === auth.user._id) && <DoneAllIcon className={\"mx-1 text-xs\"} fontSize=\"small\"/>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{((chat.state.last_message.state === \"partially-read\" || chat.state.last_message.state === \"read\") && chat.state.last_message.sender === auth.user._id) && <DoneAllIcon className={\"mx-1 text-xs\"} color={\"secondary\"} fontSize=\"small\"/>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(!Array.isArray(chat.typing) || chat.typing.length ===0) && <Typography variant=\"body2\" color=\"secondary\" className=\"mx-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/*<DoneAllIcon fontSize=\"inherit\" />*/}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t{chat.state.incoming_unread > 0 && <ListItemSecondaryAction>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Avatar className={\"bg-transparent primary-text h-4 w-4 text-xs\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{chat.state.incoming_unread}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Avatar>\r\n\t\t\t\t\t\t\t\t\t\t\t</ListItemSecondaryAction>}\r\n\t\t\t\t\t\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t</List>}\r\n\t\t\t\t\t\t\t</ScrollBars>\r\n\t\t\t\t\t\t</Paper>\r\n\t\t\t\t\t\t<AppBar position=\"absolute\" color=\"secondary\" className={classes.chatsAppBar}>\r\n\t\t\t\t\t\t\t<Toolbar>\r\n\t\t\t\t\t\t\t\t<IconButton \r\n\t\t\t\t\t\t\t\t\tedge=\"start\" \r\n\t\t\t\t\t\t\t\t\tcolor=\"inherit\" \r\n\t\t\t\t\t\t\t\t\taria-label=\"Refresh\"\r\n\t\t\t\t\t\t\t\t\tonClick={handleRefresh}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<RefreshIcon />\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t</IconButton>\r\n\r\n\t\t\t\t\t\t\t\t<Fab \r\n\t\t\t\t\t\t\t\t\tcolor=\"primary\" \r\n\t\t\t\t\t\t\t\t\taria-label=\"add\" \r\n\t\t\t\t\t\t\t\t\tclassName={classes.fabButton}\r\n\t\t\t\t\t\t\t\t\tonClick={()=>setContactsDrawerOpen(!contactsDrawerOpen)}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{!contactsDrawerOpen && <ChatBubbleOutlineIcon />}\r\n\t\t\t\t\t\t\t\t\t{contactsDrawerOpen && <CloseIcon />}\r\n\t\t\t\t\t\t\t\t</Fab>\r\n\r\n\t\t\t\t\t\t\t\t<div className={classes.grow} />\r\n\r\n\t\t\t\t\t\t\t\t{/*<IconButton edge=\"end\" color=\"inherit\">\r\n\t\t\t\t\t\t\t\t\t<MoreIcon />\r\n\t\t\t\t\t\t\t\t</IconButton>*/}\r\n\r\n\t\t\t\t\t\t\t\t{/*<IconButton \r\n\t\t\t\t\t\t\t\t\tcolor=\"inherit\" \r\n\t\t\t\t\t\t\t\t\taria-label=\"Search\"\r\n\t\t\t\t\t\t\t\t\tedge=\"end\"\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<SearchIcon />\r\n\t\t\t\t\t\t\t\t</IconButton>*/}\r\n\t\t\t\t\t\t\t</Toolbar>\r\n\t\t\t\t\t\t</AppBar>\r\n\t\t\t</GridItem>}\r\n\r\n\t\t\t{active_conversation && <Paper square elevation={0} className={classes.chatPaperWrapper}>\r\n\t\t\t\t<GridItem md={12} className=\"h-full p-0 flex flex-col relative\">\r\n\t\t\t\t\t{![\"audio\", \"file\", \"video\", \"image\"].includes(draft.type) && <ScrollBars \r\n\t\t\t\t\t\tclassName={\"flex-grow \"+classes.chatScrollWrapper} \r\n\t\t\t\t\t\tstyle={{flex: 10, backgroundColor: theme.palette.background.default}}\r\n\t\t\t\t\t\tscrollToBottomOnChildChange={false}\r\n\t\t\t\t\t\tref={messagesWrapperRef}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<GridContainer className=\"px-4\">\r\n\t\t\t\t\t\t\t{active_conversation_messages.map((activeChatMessage, cursor) =>{\r\n\t\t\t\t\t\t\t\tlet message_deleted = false;\r\n\t\t\t\t\t\t\t\tlet show_message = true;\r\n\t\t\t\t\t\t\t\tif (cursor > 0) {\r\n\t\t\t\t\t\t\t\t\tif (active_conversation_messages[cursor]._id === active_conversation_messages[(cursor - 1)]._id || activeChatMessage.conversation._id !== active_conversation._id) {\r\n\t\t\t\t\t\t\t\t\t\tshow_message = false;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (activeChatMessage && show_message) {\r\n\t\t\t\t\t\t\t\t\tif ((activeChatMessage.state === \"deleted-for-sender\" && activeChatMessage.sender._id === auth.user._id) || activeChatMessage.state === \"deleted-for-all\") {\r\n\t\t\t\t\t\t\t\t\t\tmessage_deleted = true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<GridItem \r\n\t\t\t\t\t\t\t\t\t\t\txs={12} \r\n\t\t\t\t\t\t\t\t\t\t\tclassName={\"flex p-0 py-1 \"+(activeChatMessage.sender._id === auth.user._id? \"flex-row-reverse\" : \"flex-row\")}\r\n\t\t\t\t\t\t\t\t\t\t\tid={\"message-\"+activeChatMessage._id}\r\n\t\t\t\t\t\t\t\t\t\t\tkey={\"conversation-\"+active_conversation._id+\"-message-\"+cursor}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{/* activeChatMessage.sender.avatar && <Avatar className={classes.contactAvatar} src={AttachmentsService.getAttachmentFileUrl(activeChatMessage.sender.avatar)} />}\r\n\t\t\t\t\t\t\t\t\t\t\t{!activeChatMessage.sender.avatar && <Avatar className={classes.contactAvatar}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<PersonIcon />\r\n\t\t\t\t\t\t\t\t\t\t\t</Avatar> */}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<ViewPortSensor  \r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={\"p-2 mx-4  flex flex-col px-4 \"+(activeChatMessage.sender._id === auth.user._id? (\"bg-green-200 \"+classes.chatBubbleLocal) : (\"bg-white \"+classes.chatBubbleExternal))}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonViewportVisibilityChange={(inViewport) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (inViewport && sockets.default) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (activeChatMessage.state === \"sent\" && activeChatMessage.sender._id !== auth.user._id) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsockets.default.emit(\"mark-message-as-received\", {message: activeChatMessage, user: auth.user});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse if ((activeChatMessage.state === \"received\" || activeChatMessage.state === \"partially-received\") && activeChatMessage.sender._id !== auth.user._id) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsockets.default.emit(\"mark-message-as-read\", {message: activeChatMessage, user: auth.user});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{(!message_deleted && JSON.isJSON(activeChatMessage.sender)) && <div className={\"flex flex-row w-full items-center mb-1\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography variant=\"body1\" className={\"flex-grow text-gray-500 font-bold\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{activeChatMessage.sender.first_name+\" \"+activeChatMessage.sender.last_name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<IconButton aria-label=\"Toggle Menu\" onClick={handleContextOpen(\"message\", activeChatMessage)} className={\"\"} size=\"small\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ExpandMoreIcon fontSize=\"inherit\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{(!message_deleted && [\"audio\", \"file\", \"video\", \"image\"].includes(activeChatMessage.type) && Array.isArray(activeChatMessage.attachments)) && <div className={\"flex flex-col items-center mb-2\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{activeChatMessage.attachments.map(attachment => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className={\"p-2 w-11/12 border border-gray-400 rounded\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{activeChatMessage.type === \"image\" && <LazyImage className={\"w-full h-auto\"} src={AttachmentsService.getAttachmentFileUrl(attachment)} alt={attachment.name}/>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{activeChatMessage.type === \"audio\" && <div className={\"w-full h-auto flex flex-row items-center\"} >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AudiotrackOutlinedIcon className={\"text-2xl\"}/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography variant=\"body1\" color=\"textPrimary\" className={\"flex-grow truncate\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{attachment.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{activeChatMessage.type === \"video\" && <div className={\"w-full h-auto flex flex-row items-center\"} >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<MovieOutlinedIcon className={\"text-2xl\"}/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography variant=\"body1\" color=\"textPrimary\" className={\"flex-grow truncate\"} >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{attachment.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{activeChatMessage.type === \"file\" && <div className={\"w-full h-auto flex flex-row items-center\"} >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AttachFileIcon className={\"text-2xl\"}/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography variant=\"body1\" color=\"textPrimary\" className={\"flex-grow truncate\"} >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{attachment.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{!message_deleted && <Typography variant=\"body1\" color=\"textPrimary\" className={\"flex-grow\"} paragraph>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{activeChatMessage.content}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Typography>}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t{message_deleted && <div className={\"flex flex-row items-center w-full\"} style={{color: theme.palette.divider}}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography variant=\"body1\" color=\"inherit\" className={\"flex-grow\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tMessage deleted\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<BlockIcon className={\"mx-2\"} fontSize=\"small\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t{!message_deleted && <div className={\"flex flex-row items-center w-full\"} style={{color: theme.palette.text.disabled}}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{activeChatMessage.created_on && <Typography variant=\"body2\" className={\"text-xs flex-grow\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{activeChatMessage.created_on instanceof Date? activeChatMessage.created_on.toLocaleString() : new Date(activeChatMessage.created_on).toLocaleString()}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{(activeChatMessage.state === \"sent\" && activeChatMessage.sender._id === auth.user._id) && <DoneIcon className={\"mx-2\"} fontSize=\"small\"/>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{((activeChatMessage.state === \"partially-received\" || activeChatMessage.state === \"received\") && activeChatMessage.sender._id === auth.user._id) && <DoneAllIcon className={\"mx-2\"} fontSize=\"small\"/>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{((activeChatMessage.state === \"partially-read\" || activeChatMessage.state === \"read\") && activeChatMessage.sender._id === auth.user._id) && <DoneAllIcon className={\"mx-2\"} color={\"secondary\"} fontSize=\"small\"/>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t\t\t\t\t\t</ViewPortSensor>\r\n\t\t\t\t\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t})}\r\n\r\n\t\t\t\t\t\t\t{(Array.isArray(active_conversation.typing)? (active_conversation.typing.length > 0) : false) && <GridItem xs={12} className={\"flex p-0 py-1 flex-row\"} >\r\n\t\t\t\t\t\t\t\t\t<div  className={classes.avatar}> </div>\r\n\t\t\t\t\t\t\t\t\t<div  className={\"p-2 mx-4  flex flex-col px-4  rounded-full\"}>\r\n\t\t\t\t\t\t\t\t\t\t<div  className={classes.typing_loader}></div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</GridItem>}\r\n\t\t\t\t\t\t\t<div  className=\"w-full h-1\" id=\"chatLastChild\"> </div>\r\n\t\t\t\t\t\t</GridContainer>\r\n\t\t\t\t\t</ScrollBars>}\r\n\r\n\t\t\t\t\t\r\n\r\n\t\t\t\t\t<GridContainer \r\n\t\t\t\t\t\tclassName={[\"audio\", \"file\", \"video\", \"image\"].includes(draft.type)? \"flex-grow flex flex-col\" : classes.chatInputsWrapper} \r\n\t\t\t\t\t\tstyle={{ backgroundColor: theme.palette.background.paper, top: [\"audio\", \"file\", \"video\", \"image\"].includes(draft.type)? 0 : \"auto\"}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{draft.reply_for && <GridItem xs={12} className={\"flex flex-row items-center bg-green-200\"}>\r\n\t\t\t\t\t\t\t<div className={\"p-2 mx-4\"}>\r\n\t\t\t\t\t\t\t\t\t\t<Typography variant=\"body1\" color=\"textPrimary\" className={\"font-bold\"}>\r\n\t\t\t\t\t\t\t\t\t\t\t{draft.reply_for.sender.first_name+\" \"+draft.reply_for.sender.last_name}\r\n\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t<Typography variant=\"body1\" color=\"textPrimary\" className={\"\"} >\r\n\t\t\t\t\t\t\t\t\t\t\t{draft.reply_for.content}\r\n\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</GridItem>}\r\n\r\n\t\t\t\t\t\t{[\"audio\", \"file\", \"video\", \"image\"].includes(draft.type) && <GridItem xs={12} className={\"flex flex-grow flex-row items-center bg-grey-200\"}>\r\n\t\t\t\t\t\t\t<FileInput\r\n\t\t\t\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\t\t\t\tvalue={([\"audio\", \"file\", \"video\", \"image\"].includes(draft.type) && (Array.isArray(draft.attachments)? (draft.attachments > 0) : false))? draft.attachments[0] : undefined}\r\n\t\t\t\t\t\t\t\tonChange={(newValue)=>{\r\n\t\t\t\t\t\t\t\t\tsetDraft(currentDraft => {\r\n\t\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\t\tlet newDraft = JSON.parse(JSON.stringify(currentDraft));\r\n\t\t\t\t\t\t\t\t\t\t\tif (newValue) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tnewDraft.attachments = [newValue];\r\n\t\t\t\t\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\t\t\tdelete newDraft.attachments;\r\n\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\treturn newDraft;\r\n\t\t\t\t\t\t\t\t\t\t} catch(err) {\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t\t\t\t\t\t\t\treturn currentDraft;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\tconsole.log(\"FileInput newValue \", newValue);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tfilesLimit={1}\r\n\t\t\t\t\t\t\t\tacceptedFiles={draft.type === \"file\"? [\"image/*\", \"video/*\", \"audio/*\", \"application/*\"] : [(draft.type+\"/*\")]}\r\n\t\t\t\t\t\t\t/>\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</GridItem>}\r\n\r\n\t\t\t\t\t\t{attachmentDialOpen && <GridItem xs={12} className={\"flex flex-row items-center justify-evenly bg-grey-200\"}>\r\n\t\t\t\t\t\t\t{attachmentActions.map((action) => (\r\n\t\t\t\t\t\t\t\t\t<Fab\r\n\t\t\t\t\t\t\t\t\t\tkey={action.name}\r\n\t\t\t\t\t\t\t\t\t\tcolor={action.color}\r\n\t\t\t\t\t\t\t\t\t\taria-label={\"Attach \"+action.label}\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tonClick={()=>{\r\n\t\t\t\t\t\t\t\t\t\t\tsetAttachmentDialOpen(false);\r\n\t\t\t\t\t\t\t\t\t\t\thandleOnChangeDraftType(action.name);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\tstyle={{background: action.color, color: theme.palette.background.paper}}\r\n\t\t\t\t\t\t\t\t\t\tclassName={\"mx-2\"}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{action.icon}\r\n\t\t\t\t\t\t\t\t\t</Fab>\r\n\t\t\t\t\t\t\t))}\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</GridItem>}\r\n\r\n\t\t\t\t\t\t<GridItem xs={12} className={\"flex flex-row items-center\"}>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<IconButton \r\n\t\t\t\t\t\t\t\tonClick={(event)=>{\r\n\t\t\t\t\t\t\t\t\tsetAttachmentDialOpen(!attachmentDialOpen)\r\n\t\t\t\t\t\t\t\t}} \r\n\t\t\t\t\t\t\t\taria-label={attachmentDialOpen? (([\"audio\", \"file\", \"video\", \"image\"].includes(draft.type) && (Array.isArray(draft.attachments)? (draft.attachments > 0) : false))? \"Remove Attachments\" : \"Dismiss File Attachment\") : \"Close File Attachment\"} \r\n\t\t\t\t\t\t\t\tclassName={\"mx-2\"} \r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{!attachmentDialOpen? <AttachFileIcon color=\"inherit\" /> : (([\"audio\", \"file\", \"video\", \"image\"].includes(draft.type) && (Array.isArray(draft.attachments)? (draft.attachments > 0) : false))? <DeleteOutlinedIcon color=\"inherit\" /> : <CloseIcon  color=\"inherit\" />)}\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t<div className={\"flex-grow rounded-full mx-8\"}>\r\n\t\t\t\t\t\t\t<TextInput\r\n\t\t\t\t\t\t\t\tvariant={[\"audio\", \"file\", \"video\", \"image\"].includes(draft.type)? \"standard\" : \"outlined\"}\r\n\t\t\t\t\t\t\t\tmultiline\r\n\t\t\t\t\t\t\t\trows={2}\r\n\t\t\t\t\t\t\t\tonBlur={(new_value, event)=>{\r\n\t\t\t\t\t\t\t\t\tif (active_conversation._id && !String.isEmpty(new_value)) {\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tsetDraft(currentDraft => {\r\n\t\t\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet newDraft = {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent: new_value,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconversation: active_conversation._id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (JSON.isJSON(currentDraft)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tnewDraft = JSON.parse(JSON.stringify(currentDraft));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tnewDraft.content = new_value;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tnewDraft.conversation = active_conversation._id;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn newDraft;\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t} catch(err) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn currentDraft;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (active_conversation._id && sockets.default) {\r\n\t\t\t\t\t\t\t\t\t\tsockets.default.emit(\"stopped-typing-message\", {conversation: active_conversation._id, user: auth.user});\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tonFocus={()=>{\r\n\t\t\t\t\t\t\t\t\tif (active_conversation._id && sockets.default) {\r\n\t\t\t\t\t\t\t\t\t\tsockets.default.emit(\"started-typing-message\", {conversation: active_conversation._id, user: auth.user});\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tdefaultValue={active_conversation._id === draft.conversation? draft.content : undefined}\r\n\t\t\t\t\t\t\t\tonChange={(new_value)=>{\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tplaceholder=\"Type your message here...\"\r\n\t\t\t\t\t\t\t\tinputRef={textInputRef}\r\n\t\t\t\t\t\t\t\tinputProps={{\r\n\t\t\t\t\t\t\t\t\tonKeyDown: handleMessageInputKeyDown,\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/*<IconButton onClick={(event)=>handleOnSendMessage()} aria-label=\"send\" className={\"primary-text\"} >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<SendIcon color=\"inherit\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</IconButton>*/}\r\n\t\t\t\t\t\t</GridItem>\r\n\t\t\t\t\t</GridContainer>\r\n\r\n\t\t\t\t</GridItem>\r\n\t\t\t</Paper>}\r\n\r\n\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tkeepMounted\r\n\t\t\t\t\topen={contextMenu.mouseY !== null}\r\n\t\t\t\t\tonClose={handleContextClose}\r\n\t\t\t\t\tanchorReference=\"anchorPosition\"\r\n\t\t\t\t\tanchorPosition={\r\n\t\t\t\t\t  contextMenu.mouseY !== null && contextMenu.mouseX !== null\r\n\t\t\t\t\t\t? { top: contextMenu.mouseY, left: contextMenu.mouseX }\r\n\t\t\t\t\t\t: undefined\r\n\t\t\t\t\t}\r\n\t\t\t\t  >\r\n\t\t\t\t\t{contextMenu.type === \"conversation\" && <MenuItem onClick={(event)=>{\r\n\t\t\t\t\t\tsetMessagingCache(\"active_conversation\", contextMenu.entry);\r\n\t\t\t\t\t\thandleContextClose(event);\r\n\t\t\t\t\t}}>Open Conversation</MenuItem>}\r\n\t\t\t\t\t{contextMenu.type === \"conversation\" && <MenuItem \r\n\t\t\t\t\t\tonClick={(event)=>{\r\n\t\t\t\t\t\t\thandleArchiveConversation(contextMenu.entry);\r\n\t\t\t\t\t\t\thandleContextClose(event);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tArchive Conversation\r\n\t\t\t\t\t</MenuItem>}\r\n\t\t\t\t\t{contextMenu.type === \"conversation\" && <MenuItem \r\n\t\t\t\t\t\tonClick={(event)=>{\r\n\t\t\t\t\t\t\thandleDeleteConversation(contextMenu.entry);\r\n\t\t\t\t\t\t\thandleContextClose(event);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tDelete Conversation\r\n\t\t\t\t\t</MenuItem>}\r\n\r\n\t\t\t\t\t{(contextMenu.type === \"message\" && contextMenu.entry.sender._id !== auth.user._id) && <MenuItem \r\n\t\t\t\t\t\tonClick={(event)=>{\r\n\t\t\t\t\t\t\thandleContextClose(event);\r\n\t\t\t\t\t\t\tsetDraft({\r\n\t\t\t\t\t\t\t\tis_reply: true,\r\n\t\t\t\t\t\t\t\tsender: auth.user,\r\n\t\t\t\t\t\t\t\treply_for: contextMenu.entry,\r\n\t\t\t\t\t\t\t\tcontent: \"\",\r\n\t\t\t\t\t\t\t\tconversation: active_conversation._id,\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif (textInputRef.current) {\r\n\t\t\t\t\t\t\t\ttextInputRef.current.value = \"\";\r\n\t\t\t\t\t\t\t\ttextInputRef.current.focus();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tReply Message\r\n\t\t\t\t\t</MenuItem>}\r\n\t\t\t\t\t{(contextMenu.type === \"message\" && contextMenu.entry.sender._id === auth.user._id) && <MenuItem \r\n\t\t\t\t\t\tonClick={(event)=>{\r\n\t\t\t\t\t\t\thandleContextClose(event);\r\n\t\t\t\t\t\t\tif (sockets.default) {\r\n\t\t\t\t\t\t\t\tsockets.default.emit(\"delete-message-for-user\", {message: contextMenu.entry, user: auth.user});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tDelete For Me\r\n\t\t\t\t\t</MenuItem>}\r\n\r\n\t\t\t\t\t{(contextMenu.type === \"message\" && contextMenu.entry.sender._id === auth.user._id) && <MenuItem \r\n\t\t\t\t\t\tonClick={(event)=>{\r\n\t\t\t\t\t\t\thandleContextClose(event);\r\n\t\t\t\t\t\t\tif (sockets.default) {\r\n\t\t\t\t\t\t\t\tsockets.default.emit(\"delete-message-for-all\", {message: contextMenu.entry, user: auth.user});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tDelete For All\r\n\t\t\t\t\t</MenuItem>}\r\n\t\t\t\t</Menu>\r\n\r\n\t\t{error && <Snackbar open={Boolean(error)} autoHideDuration={10000} onClose={() => setError(false)}>\r\n\t        <Alert onClose={() => setError(false)} severity=\"error\">\r\n\t\t\t\t{error}\r\n\t        </Alert>\r\n\t\t</Snackbar>}\r\n\r\n\t\t</Paper>\r\n\t);\r\n}\r\n\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n\tauth: state.auth,\r\n\tcommunication: state.communication,\r\n\tdevice: state.device,\r\n});\r\n\r\nChat.defaultProps = {\r\n\tlayout: \"full\",\r\n\tfirstView: \"conversations\",\r\n\tactiveConversation: undefined,\r\n};\r\n\r\nexport default compose(\r\n\twithStyles(styles),\r\n\tconnect(mapStateToProps, {apiCallRequest, setMessagingCache, clearMessagingCache}),\r\n\twithTheme,\r\n)((Chat));\r\n","/** @format */\r\n\r\nexport default theme => ({\r\n\troot: {\r\n\t\tpadding: \"0\",\r\n\t\theight: \"calc(100vh - \"+theme.spacing(12)+\"px)\",\r\n\t\tmaxHeight: \"100vh\",\r\n\t\tdisplay: \"flex\",\r\n\t\tflexDirection: \"column\",\r\n\t\toverflowX: \"hidden\",\r\n\t},\t\r\n\ttext: {\r\n\t\tpadding: theme.spacing(2, 2, 0),\r\n\t},\r\n\tpaper: {\r\n\t\t/*position: \"absolute\",\r\n\t\ttop: theme.spacing(4),\r\n\t\tbottom: 'auto',*/\r\n\t\tpaddingBottom: theme.spacing(7),\r\n\t\tmarginTop: theme.spacing(8),\r\n\t\tflexGrow: 1,\r\n\t\theight: \"calc(100% - \"+theme.spacing(8)+\"px)\",\r\n\t\tminHeight: \"calc(100% - \"+theme.spacing(8)+\"px)\",\r\n\t\toverflowX: \"hidden\",\r\n\t},\r\n\tchatPaperWrapper: {\r\n\t\tposition: \"relative\",\r\n\t\tmarginTop: theme.spacing(8),\r\n\t\tflexGrow: 1,\r\n\t\theight: \"calc(100% - \"+theme.spacing(8)+\"px)\",\r\n\t\tminHeight: \"calc(100% - \"+theme.spacing(8)+\"px)\",\r\n\t\toverflow: \"hidden\",\r\n\t\tpadding: 0,\r\n\t\tbackgroundColor: theme.palette.background.default,\r\n\t\tbackground: theme.palette.background.default,\r\n\t},\r\n\r\n\tbodyWrapper: {\r\n\t\toverflowY: \"scroll\",\r\n\t\toverflowX: \"hidden\",\r\n\t\theight: \"calc(100% - \"+theme.spacing(4)+\"px)\",\r\n\t},\r\n\r\n\tscrollWrapper: {\r\n\t\toverflowY: \"scroll\",\r\n\t\toverflowX: \"hidden\",\r\n\t},\r\n\r\n\tchatScrollWrapper: {\r\n\t\toverflowY: \"scroll\",\r\n\t\toverflowX: \"hidden\",\r\n\t\ttop: 0,\r\n\t\tbottom: 'auto',\r\n\t\theight: \"80% !important\",\r\n\t},\r\n\r\n\tlist: {\r\n\t\tmarginBottom: theme.spacing(2),\r\n\t},\r\n\r\n\tsubheader: {\r\n\t\tbackgroundColor: theme.palette.background.paper,\r\n\t},\r\n\ticonAvatar:{\r\n\t\tbackgroundColor: theme.palette.background.default,\r\n\t\tcolor: theme.palette.accent.main,\r\n\t},\r\n\tcontactAvatar:{\r\n\t\tbackgroundColor: theme.palette.background.paper,\r\n\t\tcolor: theme.palette.accent.main,\r\n\t},\r\n\tavatar:{\r\n\t\tbackgroundColor: theme.palette.action.hover,\r\n\t\tcolor: theme.palette.text.primary,\r\n\t\twidth: theme.spacing(5),\r\n\t\theight: theme.spacing(5),\r\n\t\tborderRadius: theme.spacing(2.5),\r\n\t},\r\n\tchatsAppBar: {\r\n\t\ttop: 'auto',\r\n\t\tbottom: 0,\r\n\t\tcolor: theme.palette.background.paper,\r\n\t},\r\n\tmainAppBar: {\r\n\t\ttop: 0,\r\n\t\tbottom: 'auto',\r\n\t\tcolor: theme.palette.text.primary,\r\n\t\tboxShadow: \"none\",\r\n\t},\r\n\tgrow: {\r\n\t\tflexGrow: 1,\r\n\t},\r\n\tfabButton: {\r\n\t\tposition: 'absolute',\r\n\t\tzIndex: 1,\r\n\t\ttop: -30,\r\n\t\tleft: 0,\r\n\t\tright: 0,\r\n\t\tmargin: '0 auto',\r\n\t\tbackground: theme.palette.accent.main,\r\n\t\tcolor: theme.palette.background.paper,\r\n\t},\r\n\tdrawer: {\r\n\t\twidth: theme.appDrawer.width,\r\n\t\tflexShrink: 0,\r\n\t},\r\n  \tdrawerPaper: {\r\n\t\twidth: theme.appDrawer.width,\r\n\t\tposition: \"absolute\",\r\n\t\tzIndex: theme.zIndex.appBar+2,\r\n\t\tbackgroundColor: theme.palette.background.default,\r\n  \t},\r\n  \ttemporaryDrawerPaper: {\r\n\t\twidth: theme.appDrawer.width,\r\n\t\tbackground: theme.palette.background.default,\r\n  \t},\r\n  \tcontent: {\r\n\t\tflexGrow: 1,\r\n\t\tpadding: 0,\r\n\t\ttransition: theme.transitions.create('margin', {\r\n\t\t\teasing: theme.transitions.easing.sharp,\r\n\t\t\tduration: theme.transitions.duration.leavingScreen,\r\n\t\t}),\r\n\t},\r\n\r\n\tcontentDrawerMargin: {\r\n\t\tmarginRight: -theme.appDrawer.width,\r\n\t},\r\n\r\n\tcontentShift: {\r\n\t\ttransition: theme.transitions.create('margin', {\r\n\t\t\teasing: theme.transitions.easing.easeOut,\r\n\t\t\tduration: theme.transitions.duration.enteringScreen,\r\n\t\t}),\r\n\t\tmarginRight: 0,\r\n\t},\r\n\r\n\tchatInputsWrapper: {\r\n\t\t/*position: \"relative\",\r\n\t\ttop: 'auto',\r\n\t\tbottom: 0,*/\r\n\t\tminHeight: \"20% !important\",\r\n\t\tpadding: 0,\r\n\t\tpaddingTop: theme.spacing(2),\r\n\t\tpaddingBottom: theme.spacing(2),\r\n\t\tbackground: theme.palette.background.paper,\r\n\t\tcolor: theme.palette.text.primary,\r\n\t},\r\n\r\n\tchatBubbleLocal: {\r\n\t\tmaxWidth: \"40%\",\r\n\t\tbackground: theme.palette.primary.light,\r\n\t\tborderBottomRightRadius: \"1.5rem\",\r\n\t\tborderBottomLeftRadius: \"1.5rem\",\r\n\t\tborderTopRightRadius: 0,\r\n\t\tborderTopLeftRadius: \"1.5rem\",\r\n\t},\r\n\r\n\tchatBubbleExternal: {\r\n\t\tbackground: theme.palette.background.paper,\r\n\t\tborderBottomRightRadius: \"1.5rem\",\r\n\t\tborderBottomLeftRadius: \"1.5rem\",\r\n\t\tborderTopRightRadius: \"1.5rem\",\r\n\t\tborderTopLeftRadius: 0,\r\n\t},\r\n\r\n\tchatBubbleLocalSequential: {\r\n\t\tborderBottomRightRadius: \"1.5rem\",\r\n\t\tborderBottomLeftRadius: \"1.5rem\",\r\n\t\tborderTopRightRadius: \"1.5rem\",\r\n\t\tborderTopLeftRadius: \"1.5rem\",\r\n\t},\r\n\t'@keyframes typing_loader_line': {\r\n\t\t\t'0%': {\r\n\t\t\t\tbackgroundColor: theme.palette.action.active,\r\n\t\t\t\tboxShadow: '12px 0px 0px 0px rgba(0,0,0,0.2),  24px 0px 0px 0px rgba(0,0,0,0.2)'\r\n\t\t\t},\r\n\t\t\t'25%': {\r\n\t\t\t\tbackgroundColor: theme.palette.action.hover,\r\n\t\t\t\tboxShadow: '12px 0px 0px 0px rgba(0,0,0,2), 24px 0px 0px 0px rgba(0,0,0,0.2)'\r\n\t\t\t},\r\n\t\t\t'75%': {\r\n\t\t\t\tbackgroundColor: theme.palette.text.disabled,\r\n\t\t\t\tboxShadow: '12px 0px 0px 0px rgba(0,0,0,0.2), 24px 0px 0px 0px rgba(0,0,0,2)'\r\n\t\t\t}\r\n\t},\r\n\ttyping_loader: {\r\n\t\t\tmargin: theme.spacing(),\r\n\t\t\twidth: theme.spacing(),\r\n\t\t\theight: theme.spacing(),\r\n\t\t\tborderRadius: theme.spacing(0.5),\r\n\t\t\tbackgroundColor: 'rgba(0,0,0, 1)',\r\n\t\t\twebkitAnimation: '$typing_loader_line 1s linear infinite alternate',\r\n\t\t\tmozAnimation: '$typing_loader_line 1s linear infinite alternate',\r\n\t\t\tanimation: '$typing_loader_line 1s linear infinite alternate'\r\n\t},\r\n\t\r\n\t\r\n});\r\n","/** @format */\n\nimport { app } from \"assets/jss/app-theme\";\nimport GridContainer from \"components/Grid/GridContainer\";\nimport GridItem from \"components/Grid/GridItem\";\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport compose from \"recompose/compose\";\nimport { withTheme } from '@material-ui/core/styles';\nimport { appendNavHistory } from \"state/actions\";\nimport ChatApp from \"views/apps/Dashboard/Chat\";\nimport {withErrorHandler} from \"hoc/ErrorHandler\";\n\n\n\nclass Page extends Component {\n\tcomponentDidMount() {\n\t\tconst { location, appendNavHistory, theme } = this.props;\n\t\tif (appendNavHistory && location) {\n\t\t\tappendNavHistory({\n\t\t\t\tname: \"messages\",\n\t\t\t\turi: location.pathname,\n\t\t\t\ttitle: \"Messages\",\n\t\t\t\tview: null,\n\t\t\t\tcolor: theme.palette.primary,\n\t\t\t\tscrollTop: 0,\n\t\t\t});\n\t\t}\n\t}\n\n\t\n\n\trender() {\n\t\tconst { classes } = this.props;\n\n\t\treturn (\n\t\t\t<GridContainer className=\"m-0 p-0\">\n\t\t\t\t<GridItem xs={12}>\n\t\t\t\t\t<ChatApp />\n\t\t\t\t</GridItem>\n\t\t\t</GridContainer>\n\t\t);\n\t}\n}\n\nconst mapStateToProps = state => ({\n\tauth: state.auth,\n});\n\nexport default withErrorHandler(\n\tcompose(connect(mapStateToProps, {appendNavHistory}), withTheme)(Page)\n);\n"],"sourceRoot":""}