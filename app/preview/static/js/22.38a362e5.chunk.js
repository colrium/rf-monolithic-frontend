(this.webpackJsonpdashboard=this.webpackJsonpdashboard||[]).push([[22],{2063:function(e,a,t){"use strict";t.r(a);var s=t(9),r=t(6),g=t(8),n=t(31),o=t(15),l=t(16),c=t(1051),i=t(2040),h=t(2074),u=t(21),d=t(39),p=t(17),b=t(13),m=t(29),j=t(1),f=t.n(j),v=t(491),O=t(30),A=t(53),y=t.n(A),x=t(19),C=(t(34),t(46)),M=t(0);v.c.global.legend.display=!1;var k=function(e){Object(o.a)(t,e);var a=Object(l.a)(t);function t(e){var s;return Object(r.a)(this,t),(s=a.call(this,e)).state={loading:!0,load_error:!1,aggregate:"status",aggregates:[],chart_data:{labels:[],datasets:[{data:[]}]},aggregateMenuEl:null},s.aggregatables=[],s.colors=[],s.handleShowAggregateMenu=function(e){var a=e.currentTarget;s.setState({aggregateMenuEl:a})},s.handleAggregateMenuItemClick=function(e){return function(a){s.setState({aggregateMenuEl:null}),s.loadAggregates({g:e})}},s.handleShowAggregateMenu=s.handleShowAggregateMenu.bind(Object(n.a)(s)),s.handleCloseAggregateMenu=s.handleCloseAggregateMenu.bind(Object(n.a)(s)),s}return Object(g.a)(t,[{key:"componentDidMount",value:function(){this.prepareForData(),this.loadAggregates(),this.prepareChartData()}},{key:"componentDidUpdate",value:function(e){Object.areEqual(this.props.defination,e.defination)?Object.areEqual(e.api,this.props.api)?Array.isArray(this.props.cache)?this.props.cache.equals(e.cache)||this.prepareChartData():Array.isArray(e.cache)&&(e.cache.equals(this.props.cache)||this.prepareChartData()):this.prepareChartData():(this.prepareForData(),this.loadAggregates())}},{key:"prepareForData",value:function(){var e=this.props,a=e.dynamic,t=e.monochrome,r=e.color,g=e.colors,n=e.defination,o=(e.service,e.aggregate),l=e.onResolveAggregates;if(a){this.aggregatables=[];for(var c=0,i=Object.entries(n.scope.columns);c<i.length;c++){var h=Object(s.a)(i[c],2),u=h[0],d=h[1];d.possibilities&&this.aggregatables.push({name:u,label:d.label})}}if(!o&&this.aggregatables.length>0&&(o=this.aggregatables[0].name,l&&l(n.name,this.aggregatables)),a)if(this.state.aggregate=o,t){var p=this.aggregatables.length>0?this.aggregatables.length:1,b=C.d.monochromeColorScheme(r,p);this.colors=b}else if(g)this.colors=g;else{var m=this.aggregatables.length>0?this.aggregatables.length:1,j=C.d.rotationColorScheme(r,m);this.colors=j}}},{key:"prepareChartData",value:function(){var e=this.props,a=e.monochrome,t=e.color,s=e.colors,r=(e.aggregate,e.defination),g=(e.service,e.auth),n=e.onLoadAggregates,o=e.cache,l=e.api;if(Array.isArray(o)){var c=r.scope.columns[this.state.aggregate]?r.scope.columns[this.state.aggregate].possibilities:{};if("function"===typeof c&&(c=c(!1,g.user)),a){var i=o.length>0?o.length:1,h=C.d.monochromeColorScheme(l.loading||l.error?"#595959":t,i);this.colors=h}else if(s)this.colors=l.loading||l.error?C.d.monochromeColorScheme("#595959"):s;else{var u=o.length>0?o.length:1,d=C.d.rotationColorScheme(l.loading||l.error?"#595959":t,u);this.colors=d}var p=[],b=[],m=[];if("object"===typeof c)for(var j=0;j<o.length;j++)o[j]._id in c&&(p.push(c[o[j]._id]),b.push(o[j].count),n&&m.push({name:o[j]._id,label:c[o[j]._id],count:o[j].count,color:this.colors[j]}));var f={labels:p,datasets:[{data:b,backgroundColor:this.colors}]};this.setState((function(e){return{aggregates:o,chart_data:f,loading:!1}})),n&&n(m)}else{var v={labels:[],datasets:[{data:[],backgroundColor:this.colors}]};this.setState((function(e){return{aggregates:o,chart_data:v,loading:!1}})),n&&n([])}}},{key:"loadAggregates",value:function(e){var a=this.props,t=a.apiCallRequest,s=a.defination;e||(e={g:this.state.aggregate});var r="g"in e?e.g:"group"in e&&e.group;this.setState((function(e){return{aggregate:r}})),s&&t(s.name+"_aggregates",{uri:s.endpoint,type:"aggregates",params:e,data:{},cache:!0})}},{key:"handleCloseAggregateMenu",value:function(){this.setState({aggregateMenuEl:null})}},{key:"render",value:function(){var e=this,a=this.props,t=a.className,s=(a.aggregate,a.dynamic),r=a.defination,g=(a.service,a.showTitle),n=a.showMenu,o=a.api;a.cache;return Object(M.jsx)(p.a,{className:t+" p-0 m-0",children:Object(M.jsx)(b.a,{xs:12,className:"p-0 m-0",children:Object(M.jsxs)(p.a,{className:"p-0 m-0",children:[Object(M.jsxs)(p.a,{className:"p-0 m-0",children:[(n||g)&&Object(M.jsx)(b.a,{xs:12,children:Object(M.jsxs)(p.a,{children:[g&&!n&&Object(M.jsx)(b.a,{xs:12,children:Object(M.jsxs)(m.a,{variant:"body1",fullWidth:!0,children:[r.scope.columns[this.state.aggregate]?r.scope.columns[this.state.aggregate].label:"Unknown"," ","Aggregate"]})}),s&&n&&Object(M.jsxs)(b.a,{className:"p-0 m-0",xs:12,children:[Object(M.jsxs)(d.a,{"aria-controls":"aggregate-menu","aria-haspopup":"true",onClick:this.handleShowAggregateMenu,className:"float-right",size:"md","aria-label":"Aggregate Menu",children:[r.scope.columns[this.state.aggregate]?r.scope.columns[this.state.aggregate].label:"Unknown"," ","Aggregate",Object(M.jsx)(h.a,{})]}),Object(M.jsx)(c.a,{id:"surveys-aggregate-menu",anchorEl:this.state.aggregateMenuEl,keepMounted:!0,open:Boolean(this.state.aggregateMenuEl),onClose:this.handleCloseAggregateMenu,children:this.aggregatables.map((function(a,t){return Object(M.jsx)(i.a,{onClick:e.handleAggregateMenuItemClick(a.name),children:a.label+" Aggregate"},"aggregate_"+a.name)}))})]})]})}),Object(M.jsx)(b.a,{className:"p-0 m-0",xs:12,children:Array.isArray(this.state.chart_data.labels)&&this.state.chart_data.labels.length>0?Object(M.jsx)(v.b,{data:this.state.chart_data}):Object(M.jsxs)(p.a,{className:"p-0 m-0",justify:"center",alignItems:"center",children:[Object(M.jsx)("img",{alt:"Empty Aggregates",className:"w-9/12",src:"https://realfield.nyc3.cdn.digitaloceanspaces.com/public/img/empty-state-table.svg"}),Object(M.jsxs)(m.a,{className:"mt-4",color:"grey",variant:"body2",fullWidth:!0,children:["No"," ",r.scope.columns[this.state.aggregate]?r.scope.columns[this.state.aggregate].label:""," ","Aggregates"]})]})})]}),o.complete&&o.error&&Object(M.jsx)(p.a,{children:Object(M.jsx)(b.a,{xs:12,children:Object(M.jsx)(m.a,{color:"error",variant:"body2",fullWidth:!0,children:"An error occured. \n "+o.error.msg})})})]})})})}}]),t}(f.a.Component);k.defaultProps={color:u.b.hex.accent,monochrome:!0};a.default=y()(Object(O.b)((function(e,a){var t=a.defination;return{auth:e.auth,cache:t?e.cache.data[t.name+"_aggregates"]:null,api:t&&e.api[t.name]?e.api[t.name]:{}}}),{apiCallRequest:x.hb}))(k)},2074:function(e,a,t){"use strict";var s=t(37),r=t(0);a.a=Object(s.a)(Object(r.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVert")}}]);